<!doctype html><html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>4.3.9 Test File Permission (OTG-CONFIG-009)  </title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles3.css" type="text/css" />
  
    <script type="text/javascript">
        function in_frame () { try { return window.self !== window.top; } catch (e) { return true; } }
        if (!in_frame()) {
            var page = location.pathname.substring(location.pathname.lastIndexOf("/") + 1);
            window.location = 'index.html#' + page;
        }
    </script>
</head>
<body><div class="page"><h1 class="title">4.3.9 Test File Permission (OTG-CONFIG-009)  </h1><br/><br /><h2>Summary</h2><br />Impoper file permission configuration may result in privilledge  escalation, information explousure, DLL injection, or unauthorized file  access. <br />Therefore, files permission must be properly configured with  minium access permission by default. The file permission needs to be  configured include - <br />•  Web files/directory<br />•  Configuration files/directory<br />•  Sensitive files (encrypted data, password, key)/directory<br />•  Log files (security logs, operation logs, admin logs)/directory<br />•  Executables (scripts, EXE, JAR, class, PHP, ASP)/directory<br />•  Database files/directory<br />•  Temp files /directory<br />•  Upload files/directory<br /><br /><h2>How to Test</h2><br /><br /><h3>Review file Permission</h3><br />Under the linux, use ls command to check the file permission.  Alternatively, namei can also be used to recursively list the files  permission. <br /><code>$ namei -l /PathToCheck/</code> <br />Generally, the files permission is suggested as below. <br /><table class="table"><col/><col/><tr><th>File Type</th><th>Configuration</th></tr><tr><td>Scripts</td><td>750rwx-wx---）</td></tr><tr><td>Scripts directory </td><td>750rwx-wx---）</td></tr><tr><td>Configuration</td><td>600(rw-------)</td></tr><tr><td>Configuration Directory</td><td>700(rwx------)</td></tr><tr><td>Log files</td><td>640(rw-r-----）</td></tr><tr><td>Archieved Log files</td><td>400(r--------)</td></tr><tr><td>Log files directory</td><td>700(rwx------)</td></tr><tr><td>Debug files</td><td>600(rw-------)</td></tr><tr><td>Debug files directory</td><td>700(rwx------)</td></tr><tr><td>database files</td><td>600(rw-------)</td></tr><tr><td>database files direcotry</td><td>700(rwx------)</td></tr><tr><td>Sensitive info files (Key, encryption)</td><td>600（rw------）</td></tr></table><br /><br /><h2>Tools</h2><br />•  Windows AccessEnum <a href="https://technet.microsoft.com/en-us/sysinternals/accessenum">https://technet.microsoft.com/en-us/sysinternals/accessenum</a><br />•  Windows AccessChk <a href="https://technet.microsoft.com/en-us/sysinternals/accesschk">https://technet.microsoft.com/en-us/sysinternals/accesschk</a><br />•  Linux namei<br /></div></body></html>