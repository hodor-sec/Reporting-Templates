<!doctype html><html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>4.11.7 Test Defenses Against Application Mis-use (OTG-BUSLOGIC-007)  </title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles3.css" type="text/css" />
  
    <script type="text/javascript">
        function in_frame () { try { return window.self !== window.top; } catch (e) { return true; } }
        if (!in_frame()) {
            var page = location.pathname.substring(location.pathname.lastIndexOf("/") + 1);
            window.location = 'index.html#' + page;
        }
    </script>
</head>
<body><div class="page"><h1 class="title">4.11.7 Test Defenses Against Application Mis-use (OTG-BUSLOGIC-007)  </h1><br/><br /><h2>Summary</h2><br />The misuse and invalid use of of valid functionality can identify  attacks attempting to enumerate the web application, identify  weaknesses, and exploit vulnerabilities. Tests should be undertaken to  determine whether there are application-layer defensive mechanisms in  place to protect the application. <br /><br /> The lack of active defenses allows an attacker to hunt for  vulnerabilities without any recourse. The application's owner will thus  not know their application is under attack.  <br /><br /> <br /><br /><h2>Example</h2><br />An authenticated user undertakes the following (unlikely) sequence of actions: <br />1. Attempt to access a file ID their roles is not permitted to download<br />2. Substitutes a single tick (') instead of the file ID number<br />3. Alters a GET request to a POST<br />4. Adds an extra parameter<br />5. Duplicates a parameter name/value pair<br /><br /> The application is monitoring for misuse and responds after the 5th  event with extremely high confidence the user is an attacker. For  example the application: <br />• Disables critical functionality<br />• Enables additional authentication steps to the remaining functionality<br />• Adds time-delays into every request-response cycle<br />• Begins to record additional data about the user's interactions (e.g. sanitized HTTP request headers, bodies and response bodies)<br /><br /> If the application does not respond in any way and the attacker can  continue to abuse functionality and submit clearly malicious content at  the application, the application has failed this test case. In practice  the discrete example actions in the example above are unlikely to occur  like that. It is much more probable that a fuzzing tool is used to  identify weaknesses in each parameter in turn. This is what a security  tester will have undertaken too. <br /><br /> <br /><br /><h2>How to Test</h2><br />This test is unusual in that the result can be drawn from all the  other tests performed against the web application. While performing all  the other tests, take note of measures that might indicate the  application has in-built self-defense: <br />•  Changed responses<br />•  Blocked requests<br />•  Actions that log a user out or lock their account<br /><br /> These may only be localised. Common localized (per function) defenses are: <br />•  Rejecting input containing certain characters<br />•  Locking out an account temporarily after a number of authentication failures<br /><br /> Localized security controls are not sufficient. There are often no defenses against general mis-use such as: <br />•  Forced browsing<br />•  Bypassing presentation layer input validation<br />•  Multiple access control errors<br />•  Additional, duplicated or missing parameter names<br />•  Multiple input validation or business logic verification failures with values that cannot be the result user mistakes or typos<br />•  Structured data (e.g. JSPN, XML) of an invalid format is received<br />•  Blatant cross-site scripting or SQL injection payloads are received<br />•  Utilising the application faster than would be possible without automation tools<br />•  Change in continental geo-location of a user<br />•  Change of user agent<br />•  Accessing a multi-stage business process in the wrong order<br />•  Large number of, or high rate of use of, application-specific functionality (e.g. voucher code submission, failed credit card payments, file uploads, file downloads, log outs, etc).<br /><br /> These defenses work best in authenticated parts of the application,  although rate of creation of new accounts or accessing content (e.g. to  scrape information) can be of use in public areas. <br /><br /> Not all the above need to be monitored by the application, but there is a  problem if none of them are. By testing the web application, doing the  above type of actions, was any response taken against the tester? If  not, the tester should report that the application appears to have no  application-wide active defenses against misuse. Note it is sometimes  possible that all responses to attack detection are silent to the user  (e.g. logging changes, increased monitoring, alerts to administrators  and and request proxying), so confidence in this finding cannot be  guaranteed. In practice, very few applications (or related  infrastructure such as a web application firewall) are detecting these  types of misuse. <br /><br /> <br /><br /><h2>Related Test Cases</h2><br />All other test cases are relevant. <br /><br /> <br /><br /><h2>Tools</h2><br />The tester can use many of the tools used for the other test cases. <br /><br /> <br /><br /><h2>References</h2><br />•  <a href="https://buildsecurityin.us-cert.gov/swa/resilient.html">Resilient Software</a>, Software Assurance, US Department Homeland Security<br />•  <a href="http://csrc.nist.gov/publications/nistir/ir7864/nistir-7864.pdf">IR 7684</a> Common Misuse Scoring System (CMSS), NIST<br />•  <a href="http://capec.mitre.org/">Common Attack Pattern Enumeration and Classification</a> (CAPEC), The Mitre Corporation<br />•  <a href="https://www.owasp.org/index.php/OWASP_AppSensor_Project">OWASP_AppSensor_Project</a><br />•  <a href="https://www.owasp.org/index.php/File:Owasp-appensor-guide-v2.doc"> AppSensor Guide v2</a>, OWASP<br />•  Watson C, Coates M, Melton J and Groves G, <a href="http://www.crosstalkonline.org/storage/issue-archives/2011/201109/201109-Watson.pdf">Creating Attack-Aware Software Applications with Real-Time Defenses</a>, CrossTalk The Journal of Defense Software Engineering, Vol. 24, No. 5, Sep/Oct 2011<br /><br /> <br /><br /><h2>Remediation</h2><br />Build inactive defenses against application misuse. <br /></div></body></html>