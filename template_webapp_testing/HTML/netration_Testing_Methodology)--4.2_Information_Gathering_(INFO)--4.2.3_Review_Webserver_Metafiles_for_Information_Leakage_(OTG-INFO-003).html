<!doctype html><html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>4.2.3 Review Webserver Metafiles for Information Leakage (OTG-INFO-003)  </title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles3.css" type="text/css" />
  
    <script type="text/javascript">
        function in_frame () { try { return window.self !== window.top; } catch (e) { return true; } }
        if (!in_frame()) {
            var page = location.pathname.substring(location.pathname.lastIndexOf("/") + 1);
            window.location = 'index.html#' + page;
        }
    </script>
</head>
<body><div class="page"><h1 class="title">4.2.3 Review Webserver Metafiles for Information Leakage (OTG-INFO-003)  </h1><br/><br /><h2>Summary</h2><br />This section describes how to test the robots.txt file for  information leakage of the web application's directory or folder  path(s).  Furthermore, the list of directories that are to be avoided by  Spiders, Robots, or Crawlers can also be created as a dependency for <a href="https://www.owasp.org/index.php/Map_execution_paths_through_application_(OTG-INFO-007)">Map execution paths through application (OTG-INFO-007)</a> <br /><br /> <br /><br /><h2>Test Objectives</h2><br />1. Information leakage of the web application's directory or folder path(s). <br />2. Create the list of directories that are to be avoided by Spiders, Robots, or Crawlers. <br /><br /> <br /><br /><h2>How to Test</h2><br /><br /><h3>robots.txt</h3><br />Web Spiders, Robots, or Crawlers retrieve a web page and then  recursively traverse hyperlinks to retrieve further web content. Their  accepted behavior is specified by the <em>Robots Exclusion Protocol</em> of the robots.txt file in the web root directory [1]. <br /> <br />As an example, the beginning of the robots.txt file from <a href="http://www.google.com/robots.txt">http://www.google.com/robots.txt</a> sampled on 11 August 2013 is quoted below: <br />User-agent: *<br />Disallow: /search<br />Disallow: /sdch<br />Disallow: /groups<br />Disallow: /images<br />Disallow: /catalogs<br />...<br /><br /> The <em>User-Agent</em> directive refers to the specific web spider/robot/crawler.  For example the <em>User-Agent: Googlebot</em> refers to the spider from Google while "User-Agent: bingbot"<a href="http://www.bing.com/blogs/site_blogs/b/webmaster/archive/2010/06/28/bing-crawler-bingbot-on-the-horizon.aspx">[1]</a> refers to crawler from Microsoft/Yahoo!.  <em>User-Agent: *</em> in the example above applies to all web spiders/robots/crawlers [2] as quoted below: <br />User-agent: *<br /><br /> The <em>Disallow</em> directive specifies which resources are prohibited  by spiders/robots/crawlers. In the example above, directories such as  the following are prohibited: <br />... <br />Disallow: /search<br />Disallow: /sdch<br />Disallow: /groups<br />Disallow: /images<br />Disallow: /catalogs<br />...<br /><br /> Web spiders/robots/crawlers can intentionally ignore the <em>Disallow</em> directives specified in a robots.txt file [3], such as those from Social Networks<a href="https://www.htbridge.com/news/social_networks_can_robots_violate_user_privacy.html">[2]</a>  to ensure that shared linked are still valid.  Hence, robots.txt should  not be considered as a mechanism to enforce restrictions on how web  content is accessed, stored, or republished by third parties.  <br /> <br /><strong>robots.txt in webroot - with "wget" or "curl"<br /></strong> <br />The robots.txt file is retrieved from the web root directory of  the web server. For example, to retrieve the robots.txt from  www.google.com using "wget" or "curl": <br />cmlh$ wget http://www.google.com/robots.txt<br />--2013-08-11 14:40:36--  http://www.google.com/robots.txt<br />Resolving www.google.com... 74.125.237.17, 74.125.237.18, 74.125.237.19, ...<br />Connecting to www.google.com|74.125.237.17|:80... connected.<br />HTTP request sent, awaiting response... 200 OK<br />Length: unspecified [text/plain]<br />Saving to: ‘robots.txt.1’<br /><br />    [ &lt;=&gt;                                   ] 7,074       --.-K/s   in 0s      <br /><br />2013-08-11 14:40:37 (59.7 MB/s) - ‘robots.txt’ saved [7074]<br /><br />cmlh$ head -n5 robots.txt<br />User-agent: *<br />Disallow: /search<br />Disallow: /sdch<br />Disallow: /groups<br />Disallow: /images<br />cmlh$ <br />cmlh$ curl -O http://www.google.com/robots.txt<br />  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current<br />                                 Dload  Upload   Total   Spent    Left  Speed<br />101  7074    0  7074    0     0   9410      0 --:--:-- --:--:-- --:--:-- 27312<br /><br />cmlh$ head -n5 robots.txt<br />User-agent: *<br />Disallow: /search<br />Disallow: /sdch<br />Disallow: /groups<br />Disallow: /images<br />cmlh$ <br /><br /> <strong>robots.txt in webroot - with rockspider</strong><br /> "rockspider"<a href="https://github.com/cmlh/rockspider/releases">[3]</a> automates the creation of the initial scope for Spiders/Robots/Crawlers of files and directories/folders of a web site. <br /><br /> For example, to create the initial scope based on the Allowed: directive from www.google.com using "rockspider"<a href="https://github.com/cmlh/rockspider/releases">[4]</a>: <br />cmlh$ ./rockspider.pl -www www.google.com<br /><br />"Rockspider" Alpha v0.1_2<br /><br />Copyright 2013 Christian Heinrich<br />Licensed under the Apache License, Version 2.0<br /><br />1. Downloading http://www.google.com/robots.txt<br />2. "robots.txt" saved as "www.google.com-robots.txt"<br />3. Sending Allow: URIs of www.google.com to web proxy i.e. 127.0.0.1:8080<br />	 /catalogs/about sent<br />	 /catalogs/p? sent<br />	 /news/directory sent<br />	...<br />4. Done.<br /><br />cmlh$<br /><br /> <strong>Analyze robots.txt using Google Webmaster Tools</strong><br /> Web site owners can use the Google "Analyze robots.txt" function to  analyse the website as part of its "Google Webmaster Tools" (<a href="https://www.google.com/webmasters/tools">https://www.google.com/webmasters/tools</a>). This tool can assist with testing and the procedure is as follows: <br />1. Sign into Google Webmaster Tools with a Google account.<br /> 2. On the dashboard, write the URL for the site to be analyzed.<br /> 3. Choose between the available methods and follow the on screen instruction.<br /> <br /><br /> <br /><br /><h3>META Tag</h3><br />&lt;META&gt; tags are located within the HEAD section of each HTML  Document and should be consistent across a web site in the likely event  that the robot/spider/crawler start point does not begin from a document  link other than webroot i.e. a "deep link"<a href="http://en.wikipedia.org/wiki/Deep_linking">[5]</a>. <br /><br /> If there is no "&lt;META NAME="ROBOTS" ... &gt;" entry then the "Robots  Exclusion Protocol" defaults to "INDEX,FOLLOW" respectively.  Therefore,  the other two valid entries defined by the "Robots Exclusion Protocol"  are prefixed with "NO..." i.e. "NOINDEX" and "NOFOLLOW". <br /><br /> Web spiders/robots/crawlers can intentionally ignore the "&lt;META  NAME="ROBOTS"" tag as the robots.txt file convention is preferred.   Hence, <strong>&lt;META&gt; Tags should not be considered the primary mechanism, rather a complementary control to robots.txt</strong>.  <br /><strong>&lt;META&gt; Tags - with Burp</strong><br /> <br /><br /> Based on the Disallow directive(s) listed within the robots.txt file in  webroot, a regular expression search for "&lt;META NAME="ROBOTS"" within  each web page is undertaken and the result compared to the robots.txt  file in webroot. <br /><br /> For example, the robots.txt file from facebook.com has a "Disallow: /ac.php" entry<a href="http://facebook.com/robots.txt">[6]</a> and the resulting search for "&lt;META NAME="ROBOTS"" shown below: <br /> <img src="images/178-1.png" alt="images/178-1.png" /> <br /> <br />The above might be considered a fail since "INDEX,FOLLOW" is the  default &lt;META&gt; Tag specified by the "Robots Exclusion Protocol"  yet "Disallow: /ac.php" is listed in robots.txt. <br /><br /> <br /><br /><h2>Tools</h2><br />•  Browser (View Source function)<br />•  curl<br />•  wget<br />•  rockspider<a href="https://github.com/cmlh/rockspider/releases">[7]</a><br /><br /> <br /><br /><h2>References</h2><br /><strong>Whitepapers</strong><br /> <br />•  [1] "The Web Robots Pages" - <a href="http://www.robotstxt.org/">http://www.robotstxt.org/</a><br />•  [2] "Block and Remove Pages Using a robots.txt File" - <a href="https://support.google.com/webmasters/answer/156449">https://support.google.com/webmasters/answer/156449</a><br />•  [3] "(ISC)2 Blog: The Attack of the Spiders from the Clouds" - <a href="http://blog.isc2.org/isc2_blog/2008/07/the-attack-of-t.html">http://blog.isc2.org/isc2_blog/2008/07/the-attack-of-t.html</a><br />•  [4] "Telstra customer database exposed" - <a href="http://www.smh.com.au/it-pro/security-it/telstra-customer-database-exposed-20111209-1on60.html">http://www.smh.com.au/it-pro/security-it/telstra-customer-database-exposed-20111209-1on60.html</a><br /><br /> <br /></div></body></html>