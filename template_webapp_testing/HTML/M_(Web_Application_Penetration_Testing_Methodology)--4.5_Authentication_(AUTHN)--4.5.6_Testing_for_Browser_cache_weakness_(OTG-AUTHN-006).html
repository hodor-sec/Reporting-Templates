<!doctype html><html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>4.5.6 Testing for Browser cache weakness (OTG-AUTHN-006)  </title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles3.css" type="text/css" />
  
    <script type="text/javascript">
        function in_frame () { try { return window.self !== window.top; } catch (e) { return true; } }
        if (!in_frame()) {
            var page = location.pathname.substring(location.pathname.lastIndexOf("/") + 1);
            window.location = 'index.html#' + page;
        }
    </script>
</head>
<body><div class="page"><h1 class="title">4.5.6 Testing for Browser cache weakness (OTG-AUTHN-006)  </h1><br/><h2>Summary</h2><br /><br />In this phase the tester checks that the application correctly instructs the browser to not remember sensitive data.  <br /><br /> Browsers can store information for purposes of caching and history.  Caching is used to improve performance, so that previously displayed  information doesn't need to be downloaded again. History mechanisms are  used for user convenience, so the user can see exactly what they saw at  the time when the resource was retrieved. If sensitive information is  displayed to the user (such as their address, credit card details,  Social Security Number, or username), then this information could be  stored for purposes of caching or history, and therefore retrievable  through examining the browser's cache or by simply pressing the  browser's "Back" button. <br /> <br /><br /><h2>How to Test</h2><br /><strong>Browser History</strong><br /> <br />Technically, the "Back" button is a history and not a cache (see <a href="http://www.w3.org/Protocols/rfc2616/rfc2616-sec13.html#sec13.13">http://www.w3.org/Protocols/rfc2616/rfc2616-sec13.html#sec13.13</a>).  The cache and the history are two different entities. However, they  share the same weakness of presenting previously displayed sensitive  information. <br /><br /> The first and simplest test consists of entering sensitive information  into the application and logging out. Then the tester clicks the "Back"  button of the browser to check whether previously displayed sensitive  information can be accessed whilst unauthenticated. <br /><br /> If by pressing the "Back" button the tester can access previous pages  but not access new ones, then it is not an authentication issue, but a  browser history issue. If these pages contain sensitive data, it means  that the application did not forbid the browser from storing it. <br /><br /> Authentication does not necessarily need to be involved in the testing.  For example, when a user enters their email address in order to sign up  to a newsletter, this information could be retrievable if not properly  handled. <br /><br /> The "Back" button can be stopped from showing sensitive data. This can be done by: <br />•  Delivering the page over HTTPS.<br />•  Setting Cache-Control: must-re-validate<br /><br /> <strong>Browser Cache</strong><br /> Here testers check that the application does not leak any sensitive data  into the browser cache. In order to do that, they can use a proxy (such  as WebScarab) and search through the server responses that belong to  the session, checking that for every page that contains sensitive  information the server instructed the browser not to cache any data.  Such a directive can be issued in the HTTP response headers: <br />•  Cache-Control: no-cache, no-store<br />•  Expires: 0<br />•  Pragma: no-cache<br /><br /> These directives are generally robust, although additional flags may be  necessary for the Cache-Control header in order to better prevent  persistently linked files on the filesystem. These include: <br />•  Cache-Control: must-revalidate, pre-check=0, post-check=0, max-age=0, s-maxage=0<br />HTTP/1.1:<br />Cache-Control: no-cache<br />HTTP/1.0:<br />Pragma: no-cache<br />Expires: &lt;past date or illegal value (e.g., 0)&gt;<br /><br /> For instance, if testers are testing an e-commerce application, they  should look for all pages that contain a credit card number or some  other financial information, and check that all those pages enforce the  no-cache directive. If they find pages that contain critical information  but that fail to instruct the browser not to cache their content, they  know that sensitive information will be stored on the disk, and they can  double-check this simply by looking for the page in the browser cache.  <br /><br /> The exact location where that information is stored depends on the  client operating system and on the browser that has been used. Here are  some examples: <br />•  Mozilla Firefox:•  Unix/Linux: ~/.mozilla/firefox/&lt;profile-id&gt;/Cache/<br />•  Windows: C:\Documents and Settings\&lt;user_name&gt;\Local Settings\Application Data\Mozilla\Firefox\Profiles\&lt;profile-id&gt;\Cache<br /><br />•  Internet Explorer:•  C:\Documents and Settings\&lt;user_name&gt;\Local Settings\Temporary Internet Files<br /><br /><br /> <br /><br /><h2>Gray Box testing</h2><br />The methodology for testing is equivalent to the black box case, as  in both scenarios testers have full access to the server response  headers and to the HTML code. However, with gray box testing, the tester  may have access to account credentials that will allow them to test  sensitive pages that are accessible only to authenticated users. <br /> <br /><br /><h2>Tools</h2><br />•  <a href="https://www.owasp.org/index.php/OWASP_Zed_Attack_Proxy_Project">OWASP Zed Attack Proxy</a><br />•  Firefox add-on <a href="https://addons.mozilla.org/en-US/firefox/addon/cacheviewer2/?src=api">CacheViewer2</a><br /><br /> <br /><br /><h2>References</h2><br /><strong>Whitepapers</strong><br /> <br />•  <a href="http://www.w3.org/Protocols/rfc2616/rfc2616-sec13.html">Caching in HTTP</a><br /></div></body></html>