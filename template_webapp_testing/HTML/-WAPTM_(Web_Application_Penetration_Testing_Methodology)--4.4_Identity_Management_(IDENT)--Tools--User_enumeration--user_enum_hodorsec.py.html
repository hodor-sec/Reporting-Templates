<!doctype html><html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>user_enum_hodorsec.py</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles3.css" type="text/css" />
  
    <script type="text/javascript">
        function in_frame () { try { return window.self !== window.top; } catch (e) { return true; } }
        if (!in_frame()) {
            var page = location.pathname.substring(location.pathname.lastIndexOf("/") + 1);
            window.location = 'index.html#' + page;
        }
    </script>
</head>
<body><div class="page"><h1 class="title">user_enum_hodorsec.py</h1><br/><div class="codebox"><div class="codebox"><span style="color:#0088ff;font-weight:400">#&nbsp;user_enum.py</span><br /><span style="color:#0088ff;font-weight:400">#&nbsp;TODO:&nbsp;create&nbsp;timing&nbsp;method</span><br /><span style="color:#0088ff;font-weight:400">#&nbsp;Modified&nbsp;by&nbsp;hodorsec&nbsp;for&nbsp;URL&nbsp;as&nbsp;a&nbsp;parameter</span><br /><span style="color:#0088ff;font-weight:400">#&nbsp;Original&nbsp;by&nbsp;Adrien&nbsp;de&nbsp;Beaupre&nbsp;for&nbsp;the&nbsp;SANS&nbsp;Sec542&nbsp;class,&nbsp;with&nbsp;comments</span><br /><br /><span style="color:#0088ff;font-weight:400">#&nbsp;Import&nbsp;some&nbsp;libraries&nbsp;to&nbsp;use</span><br /><span style="color:#333333;font-weight:400">import</span>&nbsp;sys			<span style="color:#0088ff;font-weight:400">#(for&nbsp;sys.exit(1)</span><br /><span style="color:#333333;font-weight:400">import</span>&nbsp;os			<span style="color:#0088ff;font-weight:400">#(for&nbsp;os.path.isfile())</span><br /><span style="color:#333333;font-weight:400">import</span>&nbsp;urllib2,&nbsp;urllib		<span style="color:#0088ff;font-weight:400">#(HTTP&nbsp;libraries)</span><br /><span style="color:#333333;font-weight:400">import</span>&nbsp;string			<span style="color:#0088ff;font-weight:400">#(to&nbsp;strip&nbsp;whitespace&nbsp;and&nbsp;for&nbsp;alphabet)</span><br /><br /><span style="color:#ff9d00;font-weight:700">def</span>&nbsp;main(argv):<br />	<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;<span style="color:#ff9d00;font-weight:700">len</span>(sys.argv)&nbsp;==&nbsp;<span style="color:#ff0044;font-weight:400">4</span>:&nbsp;<br />		<span style="color:#0088ff;font-weight:400">#&nbsp;Make&nbsp;sure&nbsp;we&nbsp;have&nbsp;one&nbsp;argument&nbsp;of&nbsp;the&nbsp;file&nbsp;to&nbsp;read</span><br />		filetoread&nbsp;=&nbsp;sys.argv[<span style="color:#ff0044;font-weight:400">1</span>]<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;url&nbsp;=&nbsp;sys.argv[<span style="color:#ff0044;font-weight:400">2</span>]<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;prefix_lastname&nbsp;=&nbsp;sys.argv[<span style="color:#ff0044;font-weight:400">3</span>]<br />	<span style="color:#ff9d00;font-weight:700">else</span>:<br />		<span style="color:#0088ff;font-weight:400">#&nbsp;Otherwise&nbsp;error&nbsp;and&nbsp;exit</span><br />		<span style="color:#ff9d00;font-weight:700">print</span>&nbsp;<span style="color:#3ad900;font-weight:400">"Usage:&nbsp;"</span>&nbsp;+&nbsp;sys.argv[<span style="color:#ff0044;font-weight:400">0</span>]&nbsp;+&nbsp;<span style="color:#3ad900;font-weight:400">"&nbsp;inputfile&nbsp;URL&nbsp;prefixchar(optional,&nbsp;0&nbsp;or&nbsp;1)\n"</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">print</span>&nbsp;<span style="color:#3ad900;font-weight:400">"Example:&nbsp;"</span>&nbsp;+&nbsp;sys.argv[<span style="color:#ff0044;font-weight:400">0</span>]&nbsp;+&nbsp;<span style="color:#3ad900;font-weight:400">"&nbsp;/opt/wordlist/fuzz.txt&nbsp;http://www.website.com/login.php&nbsp;0"</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">print</span>&nbsp;<span style="color:#3ad900;font-weight:400">"Example:&nbsp;"</span>&nbsp;+&nbsp;sys.argv[<span style="color:#ff0044;font-weight:400">0</span>]&nbsp;+&nbsp;<span style="color:#3ad900;font-weight:400">"&nbsp;/opt/wordlist/fuzz.txt&nbsp;http://www.website.com/login.php&nbsp;1\n"</span><br />		sys.exit(<span style="color:#ff0044;font-weight:400">1</span>)<br />	<span style="color:#0088ff;font-weight:400">#&nbsp;Check&nbsp;to&nbsp;see&nbsp;if&nbsp;it&nbsp;is&nbsp;a&nbsp;file&nbsp;to&nbsp;read&nbsp;as&nbsp;an&nbsp;argument</span><br />	<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;os.path.isfile(filetoread):<br />		<span style="color:#0088ff;font-weight:400">#&nbsp;File&nbsp;exists&nbsp;and&nbsp;keep&nbsp;going</span><br />		<span style="color:#ff9d00;font-weight:700">pass</span><br />	<span style="color:#ff9d00;font-weight:700">else</span>:<br />		<span style="color:#0088ff;font-weight:400">#&nbsp;Print&nbsp;error&nbsp;and&nbsp;bail,&nbsp;file&nbsp;not&nbsp;there</span><br />		<span style="color:#ff9d00;font-weight:700">print</span>&nbsp;<span style="color:#3ad900;font-weight:400">"The&nbsp;following&nbsp;file&nbsp;does&nbsp;not&nbsp;exist:"</span>,&nbsp;filetoread<br />		sys.exit(<span style="color:#ff0044;font-weight:400">1</span>)<br />	<span style="color:#0088ff;font-weight:400">#&nbsp;Open&nbsp;up&nbsp;the&nbsp;file&nbsp;handle</span><br />	infile&nbsp;=&nbsp;<span style="color:#ff9d00;font-weight:700">open</span>(filetoread,&nbsp;<span style="color:#3ad900;font-weight:400">'r'</span>)<br />	<span style="color:#0088ff;font-weight:400">#&nbsp;Iterate&nbsp;through&nbsp;the&nbsp;file</span><br />	<span style="color:#ff9d00;font-weight:700">for</span>&nbsp;line&nbsp;<span style="color:#ff9d00;font-weight:700">in</span>&nbsp;infile:<br />		<span style="color:#0088ff;font-weight:400">#&nbsp;Iterate&nbsp;through&nbsp;the&nbsp;alphabet</span><br />		<span style="color:#ff9d00;font-weight:700">for</span>&nbsp;initial&nbsp;<span style="color:#ff9d00;font-weight:700">in</span>&nbsp;string.ascii_lowercase:&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;prefix_lastname&nbsp;!=&nbsp;<span style="color:#3ad900;font-weight:400">"1"</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">for</span>&nbsp;char&nbsp;<span style="color:#ff9d00;font-weight:700">in</span>&nbsp;string.ascii_lowercase:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;username&nbsp;=&nbsp;char&nbsp;+&nbsp;initial&nbsp;+&nbsp;line.strip()<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">else</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;username&nbsp;=&nbsp;initial&nbsp;+&nbsp;line.strip()<br />			<span style="color:#0088ff;font-weight:400">#&nbsp;Create&nbsp;the&nbsp;URL</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;login_args&nbsp;=&nbsp;{&nbsp;<span style="color:#3ad900;font-weight:400">'user'</span>:&nbsp;username,&nbsp;<span style="color:#3ad900;font-weight:400">'pass'</span>:<span style="color:#3ad900;font-weight:400">'bar'</span>&nbsp;}&nbsp;<br />			<span style="color:#0088ff;font-weight:400">#&nbsp;Get&nbsp;the&nbsp;URL&nbsp;and&nbsp;grab&nbsp;the&nbsp;response</span><br />			<span style="color:#ff9d00;font-weight:700">try</span>:<br />				<span style="color:#0088ff;font-weight:400">#&nbsp;Use&nbsp;urllib&nbsp;to&nbsp;encode&nbsp;the&nbsp;parameters</span><br />				mydata&nbsp;=&nbsp;urllib.urlencode(login_args)&nbsp;<br />				<span style="color:#0088ff;font-weight:400">#&nbsp;Send&nbsp;the&nbsp;data&nbsp;as&nbsp;a&nbsp;POST</span><br />				myresponse&nbsp;=&nbsp;urllib2.urlopen(url,&nbsp;mydata,&nbsp;<span style="color:#ff0044;font-weight:400">1</span>)<br />				<span style="color:#0088ff;font-weight:400">#&nbsp;Grab&nbsp;the&nbsp;HTML&nbsp;payload</span><br />				mypage&nbsp;=&nbsp;myresponse.read(<span style="color:#ff0044;font-weight:400">200000</span>)<br />				<span style="color:#0088ff;font-weight:400">#&nbsp;Look&nbsp;for&nbsp;the&nbsp;username&nbsp;in&nbsp;the&nbsp;HTML</span><br />				<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;username&nbsp;<span style="color:#ff9d00;font-weight:700">in</span>&nbsp;mypage:<br />					<span style="color:#0088ff;font-weight:400">#&nbsp;Found&nbsp;one</span><br />					<span style="color:#ff9d00;font-weight:700">print</span>&nbsp;<span style="color:#3ad900;font-weight:400">'Found:'</span>,&nbsp;username<br />			<span style="color:#ff9d00;font-weight:700">except</span>&nbsp;urllib2.HTTPError,&nbsp;e:<br />				<span style="color:#0088ff;font-weight:400">#&nbsp;Some&nbsp;error,&nbsp;typically&nbsp;404&nbsp;response&nbsp;code</span><br />&nbsp;&nbsp;&nbsp;&nbsp;				<span style="color:#ff9d00;font-weight:700">print</span>&nbsp;<span style="color:#3ad900;font-weight:400">'We&nbsp;failed&nbsp;with&nbsp;error&nbsp;code&nbsp;-&nbsp;%s.'</span>&nbsp;%&nbsp;e.code<br /><br /><span style="color:#0088ff;font-weight:400">#&nbsp;If&nbsp;we&nbsp;were&nbsp;called&nbsp;as&nbsp;a&nbsp;program,&nbsp;go&nbsp;execute&nbsp;the&nbsp;main&nbsp;function.&nbsp;</span><br /><span style="color:#ff9d00;font-weight:700">if</span>&nbsp;<span style="color:#333333;font-weight:400">__name__</span>&nbsp;==&nbsp;<span style="color:#3ad900;font-weight:400">"__main__"</span>:<br />	main(sys.argv[<span style="color:#ff0044;font-weight:400">1</span>:])<br /></div></div></div></body></html>