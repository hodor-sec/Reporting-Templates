<!doctype html><html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>4.3.7 Test HTTP Strict Transport Security (OTG-CONFIG-007) </title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles3.css" type="text/css" />
  
    <script type="text/javascript">
        function in_frame () { try { return window.self !== window.top; } catch (e) { return true; } }
        if (!in_frame()) {
            var page = location.pathname.substring(location.pathname.lastIndexOf("/") + 1);
            window.location = 'index.html#' + page;
        }
    </script>
</head>
<body><div class="page"><h1 class="title">4.3.7 Test HTTP Strict Transport Security (OTG-CONFIG-007) </h1><br/><br /><h2>Summary</h2><br />The HTTP Strict Transport Security (HSTS) header is a mechanism that  web sites have to communicate to the web browsers that all traffic  exchanged with a given domain must always be sent over https, this will  help protect the information from being passed over unencrypted  requests.<br /> <br /><br /> Considering the importance of this security measure it is important to  verify that the web site is using this HTTP header, in order to ensure  that all the data travels encrypted from the web browser to the server.<br /> <br /><br /> The HTTP Strict Transport Security (HSTS) feature lets a web application  to inform the browser, through the use of a special response header,  that it should never establish a connection to the the specified domain  servers using HTTP. Instead it should automatically establish all  connection requests to access the site through HTTPS. <br /><br /> The HTTP strict transport security header uses two directives: <br />• max-age: to indicate the number of seconds that the browser should  automatically convert all HTTP requests to HTTPS.<br />• includeSubDomains:  to indicate that all web application’s sub-domains must use HTTPS.<br /><br /> Here's an example of the HSTS header implementation:<br /> <br />Strict-Transport-Security: max-age=60000; includeSubDomains<br /><br /> The use of this header by web applications must be checked to find if the following security issues could be produced: <br />•  Attackers sniffing the network traffic and accessing the information transferred through an unencrypted channel.<br />•  Attackers exploiting a man in the middle attack because of the problem of accepting certificates that are not trusted.<br />•  Users who mistakenly entered an address in the browser putting HTTP instead of HTTPS, or users who click on a link in a web application which mistakenly indicated the http protocol.<br /><br /> <br /><br /><h2>How to Test</h2><br />Testing for the presence of HSTS header can be done by checking for  the existence of the HSTS header in the server's response in an  interception proxy, or by using curl as follows: <br /> <br />   $ curl -s -D- https://domain.com/ | grep Strict<br />Result expected:<br /> <br />   Strict-Transport-Security: max-age=...<br /><br /> <br /><br /><h2>References</h2><br />•  OWASP HTTP Strict Transport Security - <a href="https://www.owasp.org/index.php/HTTP_Strict_Transport_Security">https://www.owasp.org/index.php/HTTP_Strict_Transport_Security</a><br />•  OWASP Appsec Tutorial Series - Episode 4: Strict Transport Security - <a href="http://www.youtube.com/watch?v=zEV3HOuM_Vw">http://www.youtube.com/watch?v=zEV3HOuM_Vw</a><br />•  HSTS Specification: <a href="http://tools.ietf.org/html/rfc6797">http://tools.ietf.org/html/rfc6797</a><br /></div></body></html>