<!doctype html><html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>4.2.4 Enumerate Applications on Webserver (OTG-INFO-004)  </title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles3.css" type="text/css" />
  
    <script type="text/javascript">
        function in_frame () { try { return window.self !== window.top; } catch (e) { return true; } }
        if (!in_frame()) {
            var page = location.pathname.substring(location.pathname.lastIndexOf("/") + 1);
            window.location = 'index.html#' + page;
        }
    </script>
</head>
<body><div class="page"><h1 class="title">4.2.4 Enumerate Applications on Webserver (OTG-INFO-004)  </h1><br/><br /><h2>Summary</h2><br />A paramount step in testing for web application vulnerabilities is to  find out which particular applications are hosted on a web server. Many  applications have known vulnerabilities and known attack strategies  that can be exploited in order to gain remote control or to exploit  data. In addition, many applications are often misconfigured or not  updated, due to the perception that they are only used "internally" and  therefore no threat exists.<br /> <br />With the proliferation of virtual web servers, the traditional  1:1-type relationship between an IP address and a web server is losing  much of its original significance. It is not uncommon to have multiple  web sites or applications whose symbolic names resolve to the same IP  address. This scenario is not limited to hosting environments, but also  applies to ordinary corporate environments as well. <br /><br /> Security professionals are sometimes given a set of IP addresses as a  target to test. It is arguable that this scenario is more akin to a  penetration test-type engagement, but in any case it is expected that  such an assignment would test all web applications accessible through  this target. The problem is that the given IP address hosts an HTTP  service on port 80, but if a tester should access it by specifying the  IP address (which is all they know) it reports "No web server configured  at this address" or a similar message. But that system could "hide" a  number of web applications, associated to unrelated symbolic (DNS)  names. Obviously, the extent of the analysis is deeply affected by the  tester tests all applications or only tests the applications that they  are aware of. <br /><br /> Sometimes, the target specification is richer. The tester may be given a  list of IP addresses and their corresponding symbolic names.  Nevertheless, this list might convey partial information, i.e., it could  omit some symbolic names and the client may not even being aware of  that (this is more likely to happen in large organizations). <br /><br /> Other issues affecting the scope of the assessment are represented by web applications published at non-obvious URLs (e.g., <a href="http://www.example.com/some-strange-URL">http://www.example.com/some-strange-URL</a>),  which are not referenced elsewhere. This may happen either by error  (due to misconfigurations), or intentionally (for example, unadvertised  administrative interfaces). <br /><br /> To address these issues, it is necessary to perform web application discovery. <br /><br /> <br /><br /><h2>Test Objectives</h2><br />Enumerate the applications within scope that exist on a web server <br /><br /> <br /><br /><h2>How to Test</h2><br /><br /><h3>Black Box Testing</h3><br />Web application discovery is a process aimed at identifying web  applications on a given infrastructure. The latter is usually specified  as a set of IP addresses (maybe a net block), but may consist of a set  of DNS symbolic names or a mix of the two. This information is handed out prior to the execution of an assessment,  be it a classic-style penetration test or an application-focused  assessment. In both cases, unless the rules of engagement specify  otherwise (e.g., “test only the application located at the URL <a href="http://www.example.com/”">http://www.example.com/”</a>),  the assessment should strive to be the most comprehensive in scope,  i.e. it should identify all the applications accessible through the  given target. The following examples examine a few techniques that can  be employed to achieve this goal.  <br /><br /> <strong>Note:</strong> Some of the following techniques apply to Internet-facing  web servers, namely DNS and reverse-IP web-based search services and the  use of search engines. Examples make use of private IP addresses (such  as <em>192.168.1.100</em>), which, unless indicated otherwise, represent <em>generic</em> IP addresses and are used only for anonymity purposes. <br /><br /> There are three factors influencing how many applications are related to a given DNS name (or an IP address): <br /><strong>1. Different base URL</strong> <br /> The obvious entry point for a web application is <em>www.example.com</em>, i.e., with this shorthand notation we think of the web application originating at <a href="http://www.example.com/">http://www.example.com/</a>  (the same applies for https). However, even though this is the most  common situation, there is nothing forcing the application to start at  “/”. <br /><br /> For example, the same symbolic name may be associated to three web applications such as: <a href="http://www.example.com/url1">http://www.example.com/url1</a>  <a href="http://www.example.com/url2">http://www.example.com/url2</a>  <a href="http://www.example.com/url3">http://www.example.com/url3</a>  <br /><br /> In this case, the URL <a href="http://www.example.com/">http://www.example.com/</a>  would not be associated with a meaningful page, and the three  applications would be “hidden”, unless the tester explicitly knows how  to reach them, i.e., the tester knows <em>url1</em>, <em>url2</em> or <em>url3</em>.  There is usually no need to publish web applications in this way,  unless the owner doesn’t want them to be accessible in a standard way,  and is prepared to inform the users about their exact location. This  doesn’t mean that these applications are secret, just that their  existence and location is not explicitly advertised. <br /><br /> <strong>2. Non-standard ports</strong><br /> While web applications usually live on port 80 (http) and 443 (https),  there is nothing magic about these port numbers. In fact, web  applications may be associated with arbitrary TCP ports, and can be  referenced by specifying the port number as follows:  http[s]://www.example.com:port/. For example, <a href="http://www.example.com:20000/">http://www.example.com:20000/</a>. <br /><br /> <strong>3. Virtual hosts</strong><br /> DNS allows a single IP address to be associated with one or more symbolic names. For example, the IP address <em>192.168.1.100</em> might be associated to DNS names <em>www.example.com, helpdesk.example.com, webmail.example.com</em>.  It is not necessary that all the names belong to the same DNS domain.  This 1-to-N relationship may be reflected to serve different content by  using so called virtual hosts. The information specifying the virtual  host we are referring to is embedded in the HTTP 1.1 <em>Host:</em> header [1]. <br /><br /> One would not suspect the existence of other web applications in addition to the obvious <em>www.example.com</em>, unless they know of <em>helpdesk.example.com</em> and <em>webmail.example.com</em>. <br /><br /> <strong>Approaches to address issue 1 - non-standard URLs</strong><br /> There is no way to fully ascertain the existence of non-standard-named  web applications. Being non-standard, there is no fixed criteria  governing the naming convention, however there are a number of  techniques that the tester can use to gain some additional insight.  <br /><br /> First, if the web server is mis-configured and allows directory  browsing, it may be possible to spot these applications. Vulnerability  scanners may help in this respect. <br /><br /> Second, these applications may be referenced by other web pages and  there is a chance that they have been spidered and indexed by web search  engines. If testers suspect the existence of such “hidden” applications  on <em>www.example.com</em> they could search using the <em>site</em>  operator and examining the result of a query for “site:  www.example.com”. Among the returned URLs there could be one pointing to  such a non-obvious application. <br /><br /> Another option is to probe for URLs which might be likely candidates for  non-published applications. For example, a web mail front end might be  accessible from URLs such as <a href="https://www.example.com/webmail">https://www.example.com/webmail</a>, <a href="https://webmail.example.com/">https://webmail.example.com/</a>, or <a href="https://mail.example.com/">https://mail.example.com/</a>.  The same holds for administrative interfaces, which may be published at  hidden URLs (for example, a Tomcat administrative interface), and yet  not referenced anywhere. So doing a bit of dictionary-style searching  (or “intelligent guessing”) could yield some results. Vulnerability  scanners may help in this respect. <br /><br /> <strong>Approaches to address issue 2 - non-standard ports</strong><br /> It is easy to check for the existence of web applications on  non-standard ports. A port scanner such as nmap [2] is capable of  performing service recognition by means of the -sV option, and will  identify http[s] services on arbitrary ports. What is required is a full  scan of the whole 64k TCP port address space. <br /><br /> For example, the following command will look up, with a TCP connect scan, all open ports on IP <em>192.168.1.100</em> and will try to determine what services are bound to them (only <em>essential</em> switches are shown – nmap features a broad set of options, whose discussion is out of scope): <br />nmap –PN –sT –sV –p0-65535 192.168.1.100<br />It is sufficient to examine the output and look for http or the  indication of SSL-wrapped services (which should be probed to confirm  that they are https). For example, the output of the previous command  could look like: <br />Interesting ports on 192.168.1.100:<br />(The 65527 ports scanned but not shown below are in state: closed)<br />PORT      STATE SERVICE     VERSION<br />22/tcp    open  ssh         OpenSSH 3.5p1 (protocol 1.99)<br />80/tcp    open  http        Apache httpd 2.0.40 ((Red Hat Linux))<br />443/tcp   open  ssl         OpenSSL<br />901/tcp   open  http        Samba SWAT administration server<br />1241/tcp  open  ssl         Nessus security scanner<br />3690/tcp  open  unknown<br />8000/tcp  open  http-alt?<br />8080/tcp  open  http        Apache Tomcat/Coyote JSP engine 1.1<br />From this example, one see that: <br />•  There is an Apache http server running on port 80.<br />•  It looks like there is an https server on port 443 (but this needs to be confirmed, for example, by visiting <a href="https://192.168.1.100">https://192.168.1.100</a> with a browser).<br />•  On port 901 there is a Samba SWAT web interface.<br />•  The service on port 1241 is not https, but is the SSL-wrapped Nessus daemon.<br />•  Port 3690 features an unspecified service (nmap gives back its <em>fingerprint</em> - here omitted for clarity - together with instructions to submit it for incorporation in the nmap fingerprint database, provided you know which service it represents).<br />•  Another unspecified service on port 8000; this might possibly be http, since it is not uncommon to find http servers on this port. Let's examine this issue:<br />$ telnet 192.168.10.100 8000<br />Trying 192.168.1.100...<br />Connected to 192.168.1.100.<br />Escape character is '^]'.<br />GET / HTTP/1.0<br /><br />HTTP/1.0 200 OK<br />pragma: no-cache<br />Content-Type: text/html<br />Server: MX4J-HTTPD/1.0<br />expires: now<br />Cache-Control: no-cache<br /><br />&lt;html&gt;<br />...<br />This confirms that in fact it is an HTTP server. Alternatively,  testers could have visited the URL with a web browser; or used the GET  or HEAD Perl commands, which mimic HTTP interactions such as the one  given above (however HEAD requests may not be honored by all servers). <br />•  Apache Tomcat running on port 8080.<br /><br /> The same task may be performed by vulnerability scanners, but first  check that the scanner of choice is able to identify http[s] services  running on non-standard ports. For example, Nessus [3] is capable of  identifying them on arbitrary ports (provided it is instructed to scan  all the ports), and will provide, with respect to nmap, a number of  tests on known web server vulnerabilities, as well as on the SSL  configuration of https services. As hinted before, Nessus is also able  to spot popular applications or web interfaces which could otherwise go  unnoticed (for example, a Tomcat administrative interface). <br /><br /> <strong>Approaches to address issue 3 - virtual hosts</strong><br /> There are a number of techniques which may be used to identify DNS names associated to a given IP address <em>x.y.z.t</em>. <br /><br /> <em>DNS zone transfers</em><br /> This technique has limited use nowadays, given the fact that zone  transfers are largely not honored by DNS servers. However, it may be  worth a try. First of all, testers must determine the name servers  serving <em>x.y.z.t</em>. If a symbolic name is known for <em>x.y.z.t</em> (let it be <em>www.example.com</em>), its name servers can be determined by means of tools such as <em>nslookup</em>, <em>host</em>, or <em>dig</em>, by requesting DNS NS records. <br /><br /> If no symbolic names are known for <em>x.y.z.t</em>, but the target  definition contains at least a symbolic name, testers may try to apply  the same process and query the name server of that name (hoping that <em>x.y.z.t</em> will be served as well by that name server). For example, if the target consists of the IP address <em>x.y.z.t</em> and the name <em>mail.example.com</em>, determine the name servers for domain <em>example.com</em>. <br /><br /> The following example shows how to identify the name servers for www.owasp.org by using the host command: <br />$ host -t ns www.owasp.org<br />www.owasp.org is an alias for owasp.org.<br />owasp.org name server ns1.secure.net.<br />owasp.org name server ns2.secure.net.<br /><br /> A zone transfer may now be requested to the name servers for domain <em>example.com</em>. If the tester is lucky, they will get back a list of the DNS entries for this domain. This will include the obvious <em>www.example.com</em> and the not-so-obvious <em>helpdesk.example.com</em> and <em>webmail.example.com</em>  (and possibly others). Check all names returned by the zone transfer  and consider all of those which are related to the target being  evaluated. <br /> <br />Trying to request a zone transfer for owasp.org from one of its name servers: <br />$ host -l www.owasp.org ns1.secure.net<br />Using domain server:<br />Name: ns1.secure.net<br />Address: 192.220.124.10#53<br />Aliases:<br /><br />Host www.owasp.org not found: 5(REFUSED)<br />; Transfer failed.<br /><br /> <em>DNS inverse queries</em><br /> This process is similar to the previous one, but relies on inverse (PTR)  DNS records. Rather than requesting a zone transfer, try setting the  record type to PTR and issue a query on the given IP address. If the  testers are lucky, they may get back a DNS name entry. This technique  relies on the existence of IP-to-symbolic name maps, which is not  guaranteed. <br /><br /> <em>Web-based DNS searches</em><br /> This kind of search is akin to DNS zone transfer, but relies on  web-based services that enable name-based searches on DNS. One such  service is the <em>Netcraft Search DNS</em> service, available at <a href="http://searchdns.netcraft.com/?host">http://searchdns.netcraft.com/?host</a>. The tester may query for a list of names belonging to your domain of choice, such as <em>example.com</em>. Then they will check whether the names they obtained are pertinent to the target they are examining. <br /><br /> <em>Reverse-IP services</em><br /> Reverse-IP services are similar to DNS inverse queries, with the  difference that the testers query a web-based application instead of a  name server. There are a number of such services available. Since they  tend to return partial (and often different) results, it is better to  use multiple services to obtain a more comprehensive analysis. <br /><br /> <em>Domain tools reverse IP</em>: <a href="http://www.domaintools.com/reverse-ip/">http://www.domaintools.com/reverse-ip/</a>  (requires free membership)  <br /><br /> <em>MSN search</em>: <a href="http://search.msn.com">http://search.msn.com</a>  syntax: "ip:x.x.x.x" (without the quotes)  <br /><br /> <em>Webhosting info</em>: <a href="http://whois.webhosting.info/">http://whois.webhosting.info/</a>   syntax: <a href="http://whois.webhosting.info/x.x.x.x">http://whois.webhosting.info/x.x.x.x</a>  <br /><br /> <em>DNSstuff</em>: <a href="http://www.dnsstuff.com/">http://www.dnsstuff.com/</a>  (multiple services available)  <br /><a href="http://www.net-square.com/mspawn.html">http://www.net-square.com/mspawn.html</a>  (multiple queries on domains and IP addresses, requires installation)  <br /><br /> <em>tomDNS</em>: <a href="http://www.tomdns.net/index.php">http://www.tomdns.net/index.php</a>  (some services are still private at the time of writing)  <br /><br /> <em>SEOlogs.com</em>: <a href="http://www.seologs.com/ip-domains.html">http://www.seologs.com/ip-domains.html</a>  (reverse-IP/domain lookup)  <br /><br /> The following example shows the result of a query to one of the above  reverse-IP services to 216.48.3.18, the IP address of www.owasp.org.  Three additional non-obvious symbolic names mapping to the same address  have been revealed. <br /><img src="images/179-1.png" alt="images/179-1.png" /> <br /><br /> <em>Googling</em><br /> Following information gathering from the previous techniques, testers  can rely on search engines to possibly refine and increment their  analysis. This may yield evidence of additional symbolic names belonging  to the target, or applications accessible via non-obvious URLs.  <br /><br /> For instance, considering the previous example regarding <em>www.owasp.org</em>,  the tester could query Google and other search engines looking for  information (hence, DNS names) related to the newly discovered domains  of <em>webgoat.org</em>, <em>webscarab.com</em>, and <em>webscarab.net</em>. <br /><br /> Googling techniques are explained in <a href="https://www.owasp.org/index.php/Testing:_Spiders,_Robots,_and_Crawlers_(OWASP-IG-001)">Testing: Spiders, Robots, and Crawlers</a>. <br /><br /> <br /><br /><h3>Gray Box Testing</h3><br />Not applicable. The methodology remains the same as listed in Black  Box testing no matter how much information the tester starts with. <br /><br /> <br /><br /><h2>Tools</h2><br />•  DNS lookup tools such as <em>nslookup</em>, <em>dig</em> and similar. <br />•  Search engines (Google, Bing and other major search engines). <br />•  Specialized DNS-related web-based search service: see text.<br />•  Nmap - <a href="http://www.insecure.org">http://www.insecure.org</a> <br />•  Nessus Vulnerability Scanner - <a href="http://www.nessus.org">http://www.nessus.org</a><br />•  Nikto - <a href="http://www.cirt.net/nikto2">http://www.cirt.net/nikto2</a><br /><br /> <br /><br /><h2>References</h2><br /><strong>Whitepapers</strong> [1] <a href="https://tools.ietf.org/html/rfc2616">RFC 2616</a> – Hypertext Transfer Protocol – HTTP 1.1 <br /></div></body></html>