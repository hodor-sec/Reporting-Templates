<!doctype html><html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>4.2.2 Fingerprint Web Server (OTG-INFO-002)  </title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles3.css" type="text/css" />
  
    <script type="text/javascript">
        function in_frame () { try { return window.self !== window.top; } catch (e) { return true; } }
        if (!in_frame()) {
            var page = location.pathname.substring(location.pathname.lastIndexOf("/") + 1);
            window.location = 'index.html#' + page;
        }
    </script>
</head>
<body><div class="page"><h1 class="title">4.2.2 Fingerprint Web Server (OTG-INFO-002)  </h1><br/><br /><h2>Summary</h2><br />Web server fingerprinting is a critical task for the penetration  tester. Knowing the version and type of a running web server allows  testers to determine known vulnerabilities and the appropriate exploits  to use during testing. <br /><br /> There are several different vendors and versions of web servers on the  market today. Knowing the type of web server that is being tested  significantly helps in the testing process and can also change the  course of the test. This information can be derived by sending the web  server specific commands and analyzing the output, as each version of  web server software may respond differently to these commands. By  knowing how each type of web server responds to specific commands and  keeping this information in a web server fingerprint database, a  penetration tester can send these commands to the web server, analyze  the response, and compare it to the database of known signatures. Please  note that it usually takes several different commands to accurately  identify the web server, as different versions may react similarly to  the same command. Rarely do different versions react the same to all  HTTP commands. So by sending several different commands, the tester can  increase the accuracy of their guess. <br /><br /> <br /><br /><h2>Test Objectives</h2><br />Find the version and type of a running web server to determine known  vulnerabilities and the appropriate exploits to use during testing. <br /><br /> <br /><br /><h2>How to Test</h2><br /><br /><h3>Black Box testing</h3><br />The simplest and most basic form of identifying a web server is to  look at the Server field in the HTTP response header. Netcat is used in  this experiment.  <br /><br /> Consider the following HTTP Request-Response:  <br />$ nc 202.41.76.251 80<br />HEAD / HTTP/1.0<br /><br />HTTP/1.1 200 OK<br />Date: Mon, 16 Jun 2003 02:53:29 GMT<br />Server: Apache/1.3.3 (Unix)  (Red Hat/Linux)<br />Last-Modified: Wed, 07 Oct 1998 11:18:14 GMT<br />ETag: "1813-49b-361b4df6"<br />Accept-Ranges: bytes<br />Content-Length: 1179<br />Connection: close<br />Content-Type: text/html<br /><br /> From the <em>Server</em> field, one can understand that the server is likely Apache, version 1.3.3, running on Linux operating system. <br />Four examples of the HTTP response headers are shown below. <br />From an <strong>Apache 1.3.23</strong> server:  <br />HTTP/1.1 200 OK <br />Date: Sun, 15 Jun 2003 17:10: 49 GMT <br />Server: Apache/1.3.23 <br />Last-Modified: Thu, 27 Feb 2003 03:48: 19 GMT <br />ETag: 32417-c4-3e5d8a83 <br />Accept-Ranges: bytes <br />Content-Length: 196 <br />Connection: close <br />Content-Type: text/HTML <br />From a <strong>Microsoft IIS 5.0</strong> server: <br />HTTP/1.1 200 OK <br />Server: Microsoft-IIS/5.0 <br />Expires: Yours, 17 Jun 2003 01:41: 33 GMT <br />Date: Mon, 16 Jun 2003 01:41: 33 GMT <br />Content-Type: text/HTML <br />Accept-Ranges: bytes <br />Last-Modified: Wed, 28 May 2003 15:32: 21 GMT <br />ETag: b0aac0542e25c31: 89d <br />Content-Length: 7369 <br />From a <strong>Netscape Enterprise 4.1</strong> server:  <br />HTTP/1.1 200 OK <br />Server: Netscape-Enterprise/4.1 <br />Date: Mon, 16 Jun 2003 06:19: 04 GMT <br />Content-type: text/HTML <br />Last-modified: Wed, 31 Jul 2002 15:37: 56 GMT <br />Content-length: 57 <br />Accept-ranges: bytes <br />Connection: close <br />From a <strong>SunONE 6.1</strong> server: <br />HTTP/1.1 200 OK<br />Server: Sun-ONE-Web-Server/6.1<br />Date: Tue, 16 Jan 2007 14:53:45 GMT<br />Content-length: 1186<br />Content-type: text/html<br />Date: Tue, 16 Jan 2007 14:50:31 GMT<br />Last-Modified: Wed, 10 Jan 2007 09:58:26 GMT<br />Accept-Ranges: bytes<br />Connection: close<br /><br /> However, this testing methodology is limited in accuracy. There are  several techniques that allow a web site to obfuscate or to modify the  server banner string. For example one could obtain the following answer: <br />403 HTTP/1.1 Forbidden <br />Date: Mon, 16 Jun 2003 02:41: 27 GMT <br />Server: Unknown-Webserver/1.0 <br />Connection: close <br />Content-Type: text/HTML; charset=iso-8859-1 <br /><br /> In this case, the server field of that response is obfuscated. The  tester cannot know what type of web server is running based on such  information. <br /><br /> <br /><br /><h3>Protocol Behavior</h3><br />More refined techniques take in consideration various characteristics  of the several web servers available on the market. Below is a list of  some methodologies that allow testers to deduce the type of web server  in use. <br /><strong>HTTP header field ordering</strong> <br />The first method consists of observing the ordering of the  several headers in the response. Every web server has an inner ordering  of the header. Consider the following answers as an example: <br />Response from <strong>Apache 1.3.23</strong>  <br />$ nc apache.example.com 80 <br />HEAD / HTTP/1.0 <br /><br />HTTP/1.1 200 OK <br />Date: Sun, 15 Jun 2003 17:10: 49 GMT <br />Server: Apache/1.3.23 <br />Last-Modified: Thu, 27 Feb 2003 03:48: 19 GMT <br />ETag: 32417-c4-3e5d8a83 <br />Accept-Ranges: bytes <br />Content-Length: 196 <br />Connection: close <br />Content-Type: text/HTML <br />Response from <strong>IIS 5.0</strong>  <br />$ nc iis.example.com 80 <br />HEAD / HTTP/1.0 <br /><br />HTTP/1.1 200 OK <br />Server: Microsoft-IIS/5.0 <br />Content-Location: http://iis.example.com/Default.htm <br />Date: Fri, 01 Jan 1999 20:13: 52 GMT <br />Content-Type: text/HTML <br />Accept-Ranges: bytes <br />Last-Modified: Fri, 01 Jan 1999 20:13: 52 GMT <br />ETag: W/e0d362a4c335be1: ae1 <br />Content-Length: 133 <br />Response from <strong>Netscape Enterprise 4.1</strong>  <br />$ nc netscape.example.com 80 <br />HEAD / HTTP/1.0 <br /><br />HTTP/1.1 200 OK <br />Server: Netscape-Enterprise/4.1 <br />Date: Mon, 16 Jun 2003 06:01: 40 GMT <br />Content-type: text/HTML <br />Last-modified: Wed, 31 Jul 2002 15:37: 56 GMT <br />Content-length: 57 <br />Accept-ranges: bytes <br />Connection: close <br />Response from a <strong>SunONE 6.1</strong> <br />$ nc sunone.example.com 80 <br />HEAD / HTTP/1.0<br /><br />HTTP/1.1 200 OK<br />Server: Sun-ONE-Web-Server/6.1<br />Date: Tue, 16 Jan 2007 15:23:37 GMT<br />Content-length: 0<br />Content-type: text/html<br />Date: Tue, 16 Jan 2007 15:20:26 GMT<br />Last-Modified: Wed, 10 Jan 2007 09:58:26 GMT<br />Connection: close<br />We can notice that the ordering of the <em>Date</em> field and the <em>Server</em> field differs between Apache, Netscape Enterprise, and IIS. <br /><br /> <strong>Malformed requests test</strong>  <br />Another useful test to execute involves sending malformed requests or requests of nonexistent pages to the server. Consider the following HTTP responses.  <br />Response from <strong>Apache 1.3.23</strong> <br />$ nc apache.example.com 80 <br />GET / HTTP/3.0 <br /><br />HTTP/1.1 400 Bad Request <br />Date: Sun, 15 Jun 2003 17:12: 37 GMT <br />Server: Apache/1.3.23 <br />Connection: close <br />Transfer: chunked <br />Content-Type: text/HTML; charset=iso-8859-1 <br />Response from <strong>IIS 5.0</strong>  <br />$ nc iis.example.com 80 <br />GET / HTTP/3.0 <br /><br />HTTP/1.1 200 OK <br />Server: Microsoft-IIS/5.0 <br />Content-Location: http://iis.example.com/Default.htm <br />Date: Fri, 01 Jan 1999 20:14: 02 GMT <br />Content-Type: text/HTML <br />Accept-Ranges: bytes <br />Last-Modified: Fri, 01 Jan 1999 20:14: 02 GMT <br />ETag: W/e0d362a4c335be1: ae1 <br />Content-Length: 133 <br />Response from <strong>Netscape Enterprise 4.1</strong>  <br />$ nc netscape.example.com 80 <br />GET / HTTP/3.0 <br /><br />HTTP/1.1 505 HTTP Version Not Supported <br />Server: Netscape-Enterprise/4.1 <br />Date: Mon, 16 Jun 2003 06:04: 04 GMT <br />Content-length: 140 <br />Content-type: text/HTML <br />Connection: close <br />Response from a <strong>SunONE 6.1</strong> <br />$ nc sunone.example.com 80 <br />GET / HTTP/3.0<br /><br />HTTP/1.1 400 Bad request<br />Server: Sun-ONE-Web-Server/6.1<br />Date: Tue, 16 Jan 2007 15:25:00 GMT<br />Content-length: 0<br />Content-type: text/html<br />Connection: close<br /><br /> We notice that every server answers in a different way. The answer also  differs in the version of the server. Similar observations can be done  we create requests with a non-existent HTTP method/verb. Consider the  following responses:  <br />Response from <strong>Apache 1.3.23</strong>  <br />$ nc apache.example.com 80 <br />GET / JUNK/1.0 <br /><br />HTTP/1.1 200 OK <br />Date: Sun, 15 Jun 2003 17:17: 47 GMT <br />Server: Apache/1.3.23 <br />Last-Modified: Thu, 27 Feb 2003 03:48: 19 GMT <br />ETag: 32417-c4-3e5d8a83 <br />Accept-Ranges: bytes <br />Content-Length: 196 <br />Connection: close <br />Content-Type: text/HTML <br />Response from <strong>IIS 5.0</strong>  <br />$ nc iis.example.com 80 <br />GET / JUNK/1.0 <br /><br />HTTP/1.1 400 Bad Request <br />Server: Microsoft-IIS/5.0 <br />Date: Fri, 01 Jan 1999 20:14: 34 GMT <br />Content-Type: text/HTML <br />Content-Length: 87 <br />Response from <strong>Netscape Enterprise 4.1</strong>  <br />$ nc netscape.example.com 80 <br />GET / JUNK/1.0 <br /><br />&lt;HTML&gt;&lt;HEAD&gt;&lt;TITLE&gt;Bad request&lt;/TITLE&gt;&lt;/HEAD&gt; <br />&lt;BODY&gt;&lt;H1&gt;Bad request&lt;/H1&gt; <br />Your browser sent to query this server could not understand. <br />&lt;/BODY&gt;&lt;/HTML&gt; <br />Response from a <strong>SunONE 6.1</strong> <br />$ nc sunone.example.com 80 <br />GET / JUNK/1.0<br /><br />&lt;HTML&gt;&lt;HEAD&gt;&lt;TITLE&gt;Bad request&lt;/TITLE&gt;&lt;/HEAD&gt;<br />&lt;BODY&gt;&lt;H1&gt;Bad request&lt;/H1&gt;<br />Your browser sent a query this server could not understand.<br />&lt;/BODY&gt;&lt;/HTML&gt;<br /><br /> <br /><br /><h2>Tools</h2><br />•  httprint - <a href="http://net-square.com/httprint.html">http://net-square.com/httprint.html</a><br />•  httprecon - <a href="http://www.computec.ch/projekte/httprecon/">http://www.computec.ch/projekte/httprecon/</a><br />•  Netcraft - <a href="http://www.netcraft.com">http://www.netcraft.com</a><br /><br /> <br /><br /><h3>Automated Testing</h3><br />Rather than rely on manual banner grabbing and analysis of the web  server headers, a tester can use automated tools to achieve the same  results. There are many tests to carry out in order to accurately  fingerprint a web server. Luckily, there are tools that automate these  tests. "<em>httprint</em>" is one of such tools. httprint uses a signature  dictionary that allows it to recognize the type and the version of the  web server in use.<br /> <br />An example of running httprint is shown below:<br /><br /> <br /><img src="images/177-1.png" alt="images/177-1.png" /> <br /><br /> <br /><br /><h3>Online Testing</h3><br />Online tools can be used if the tester wishes to test more stealthily  and doesn't wish to directly connect to the target website. An example  of an online tool that often delivers a lot of information about target  Web Servers, is <a href="http://www.netcraft.com">Netcraft</a>.  With this tool we can retrieve information about operating system, web  server used, Server Uptime, Netblock Owner, history of change related to  Web server and O.S.<br /> An example is shown below: <br /><br /> <br /><img src="images/177-2.png" alt="images/177-2.png" /> <br /><br /> <a href="https://www.owasp.org/index.php/OWASP_Unmaskme_Project">OWASP Unmaskme Project</a> is expected to become another online tool to do fingerprinting of any website with an overall interpretation of all the <a href="https://www.owasp.org/index.php/Web-metadata">Web-metadata</a>  extracted. The idea behind this project is that anyone in charge of a  website could test the metadata the site is showing to the world and  assess it from a security point of view. <br />While this project is still being developed, you can test a <a href="http://desenmascara.me/">Spanish Proof of Concept of this idea</a>. <br /><br /> <br /><br /><h2>References</h2><br /><strong>Whitepapers</strong><br /> <br />•  Saumil Shah: "An Introduction to HTTP fingerprinting" - <a href="http://www.net-square.com/httprint_paper.html">http://www.net-square.com/httprint_paper.html</a><br />•  Anant Shrivastava : "Web Application Finger Printing" - <a href="http://anantshri.info/articles/web_app_finger_printing.html">http://anantshri.info/articles/web_app_finger_printing.html</a><br /><br /> <br /><br /><h2>Remediation</h2><br />Protect the presentation layer web server behind a hardened reverse proxy. <br />Obfuscate the presentation layer web server headers. <br />•  Apache<br />•  IIS<br /></div></body></html>