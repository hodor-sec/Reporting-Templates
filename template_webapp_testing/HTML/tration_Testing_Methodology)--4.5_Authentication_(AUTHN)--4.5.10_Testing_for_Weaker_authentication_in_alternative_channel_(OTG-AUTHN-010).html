<!doctype html><html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>4.5.10 Testing for Weaker authentication in alternative channel (OTG-AUTHN-010)  </title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles3.css" type="text/css" />
  
    <script type="text/javascript">
        function in_frame () { try { return window.self !== window.top; } catch (e) { return true; } }
        if (!in_frame()) {
            var page = location.pathname.substring(location.pathname.lastIndexOf("/") + 1);
            window.location = 'index.html#' + page;
        }
    </script>
</head>
<body><div class="page"><h1 class="title">4.5.10 Testing for Weaker authentication in alternative channel (OTG-AUTHN-010)  </h1><br/><br /><h2>Summary</h2><br />Even if the primary authentication mechanisms do not include any  vulnerabilities, it may be that vulnerabilities exist in alternative  legitimate authentication user channels for the same user accounts.  Tests should be undertaken to identify alternative channels and, subject  to test scoping, identify vulnerabilities. <br /><br /> The alternative user interaction channels could be utilized to  circumvent the primary channel, or expose information that can then be  used to assist an attack against the primary channel. Some of these  channels may themselves be separate web applications using different  host names or paths. For example: <br />•  Standard website<br />•  Mobile, or specific device, optimized website<br />•  Accessibility optimized website<br />•  Alternative country and language websites<br />•  Parallel websites that utilize the same user accounts (e.g. another website offering different functionally of the same organization, a partner website with which user accounts are shared)<br />•  Development, test, UAT and staging versions of the standard website<br /><br /> But they could also be other types of application or business processes: <br />•  Mobile device app<br />•  Desktop application<br />•  Call center operators<br />•  Interactive voice response or phone tree systems<br /><br /> Note that the focus of this test is on alternative channels; some  authentication alternatives might appear as different content delivered  via the same website and would almost certainly be in scope for testing.  These are not discussed further here, and should have been identified  during information gathering and primary authentication testing. For  example: <br />•  Progressive enrichment and graceful degradation that change functionality<br />•  Site use without cookies<br />•  Site use without JavaScript<br />•  Site use without plugins such as for Flash and Java<br /><br /> Even if the scope of the test does not allow the alternative channels to  be tested, their existence should be documented. These may undermine  the degree of assurance in the authentication mechanisms and may be a  precursor to additional testing. <br /><br /> <br /><br /><h2>Example</h2><br />The primary website is: <br /><a href="http://www.example.com">http://www.example.com</a><br />and authentication functions always take place on pages using Transport Layer Security: <br /><a href="https://www.example.com/myaccount/">https://www.example.com/myaccount/</a><br />However, a separate mobile-optimized website exists that does not use  Transport Layer Security at all, and has a weaker password recovery  mechanism: <br /><a href="http://m.example.com/myaccount/">http://m.example.com/myaccount/</a><br /><br /> <br /><br /><h2>How to Test</h2><br /><br /><h3>Understand the primary mechanism</h3><br />Fully test the website's primary authentication functions. This  should identify how accounts are issued, created or changed and how  passwords are recovered, reset, or changed. Additionally knowledge of  any elevated privilege authentication and authentication protection  measures should be known. These precursors are necessary to be able to  compare with any alternative channels. <br /><br /> <br /><br /><h3>Identify other channels</h3><br />Other channels can be found by using the following methods: <br />•  Reading site content, especially the home page, contact us, help pages, support articles and FAQs, T&amp;Cs, privacy notices, the robots.txt file and any sitemap.xml files.<br />•  Searching HTTP proxy logs, recorded during previous information gathering and testing, for strings such as "mobile", "android", blackberry", "ipad", "iphone", "mobile app", "e-reader", "wireless", "auth", "sso", "single sign on" in URL paths and body content.<br />•  Use search engines to find different websites from the same organization, or using the same domain name, that have similar home page content or which also have authentication mechanisms.<br /><br /> For each possible channel confirm whether user accounts are shared  across these, or provide access to the same or similar functionality. <br /><br /> <br /><br /><h3>Enumerate authentication functionality</h3><br />For each alternative channel where user accounts or functionality are  shared, identify if all the authentication functions of the primary  channel are available, and if anything extra exists. It may be useful to  create a grid like the one below: <br /><table class="table"><col/><col/><col/><col/><tr><th>Primary</th><th>Mobile</th><th>Call Center</th><th>Partner Website</th></tr><tr><td> Register</td><td> Yes</td><td> -</td><td> -</td></tr><tr><td> Log in</td><td> Yes</td><td> Yes</td><td> Yes (SSO)</td></tr><tr><td> Log out</td><td> -</td><td> -</td><td> -</td></tr><tr><td> Password reset</td><td> Yes</td><td> Yes</td><td> -</td></tr><tr><td> -</td><td> Change password</td><td> -</td><td> -</td></tr></table><br /><br /> In this example, mobile has an extra function "change password" but does  not offer "log out". A limited number of tasks are also possible by  phoning the call center. Call centers can be interesting, because their  identity confirmation checks might be weaker than the website's,  allowing this channel to be used to aid an attack against a user's  account. <br /><br /> While enumerating these it is worth taking note of how session  management is undertaken, in case there is overlap across any channels  (e.g. cookies scoped to the same parent domain name, concurrent sessions  allowed across channels, but not on the same channel). <br /><br /> <br /><br /><h3>Review and test</h3><br />Alternative channels should be mentioned in the testing report, even  if they are marked as "information only" and/or "out of scope". In some  cases the test scope might include the alternative channel (e.g. because  it is just another path on the target host name), or may be added to  the scope after discussion with the owners of all the channels. If  testing is permitted and authorized, all the other authentication tests  in this guide should then be performed, and compared against the primary  channel. <br /><br /> <br /><br /><h2>Related Test Cases</h2><br />The test cases for all the other authentication tests should be utilized. <br /><br /> <br /><br /><h2>Remediation</h2><br />Ensure a consistent authentication policy is applied across all channels so that they are equally secure. <br /></div></body></html>