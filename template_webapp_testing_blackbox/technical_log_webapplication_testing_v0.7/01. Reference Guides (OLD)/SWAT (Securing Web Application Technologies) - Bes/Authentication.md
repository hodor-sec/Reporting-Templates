
| Best Practice | Description | CWE ID |
| --- | --- | --- |
| Don't Hardcode Credentials | Never allow credentials to be stored directly within the application code. While it can be convenient to test application code with hardcoded credentials during development this significantly increases risk and should be avoided.<br>Example: Hard coded passwords in networking devices https://www.us-cert.gov/control_systems/pdf/ICSA-12-243-01.pdf | cwe-798 |
| Develop a Strong Password Reset System | Password reset systems are often the weakest link in an application. These systems are often based on the user answering personal questions to establish their identity and in turn reset the password. The system needs to be based on questions that are both hard to guess and brute force. Additionally, any password reset option must not reveal whether or not an account is valid, preventing username harvesting.<br>Example: Sara Palin password hack (http://en.wikipedia.org/wiki/Sarah_Palin_email_hack) | cwe-640 |
| Implement a Strong Password Policy | A password policy should be created and implemented so that passwords meet specific strength criteria.<br>Example: http://www.pcworld.com/article/128823/study_weak_passwords_really_do_help_hackers.html | cwe-521 |
| Implement Account Lockout against Brute Force Attacks | Account lockout needs to be implemented to guard against brute forcing attacks against both the authentication and password reset functionality. After several tries on a specific user account, the account should be locked for a period of time or until manually unlocked. Additionally, it is best to continue the same failure message indicating that the credentials are incorrect or the account is locked to prevent an attacker from harvesting usernames. | cwe-307 |
| Don't Disclose Too Much Information in Error Messages | Messages for authentication errors must be clear and, at the same time, be written so that sensitive information about the system is not disclosed. For example, error messages which reveal that the userid is valid but that the corresponding password is incorrect confirms to an attacker that the account does exist on the system. |  |
| Store Database Credentials Securely | Modern web applications usually consist of multiple layers. The business logic tier (processing of information) often connects to the data tier (database). Connecting to the database, of course, requires authentication. The authentication credentials in the business logic tier must be stored in a centralized location that is locked down. Scattering credentials throughout the source code is not acceptable. Some development frameworksprovide a centralized secure location for storing credentials to the backend database. These encrypted stores should be leveraged when possible. | cwe-257 |
| Applications and Middleware Should Run with Minimal Privileges | If an application becomes compromised it is important that the application itself and any middleware services be configured to run with minimal privileges. For instance, while the application layer or business layer needs the ability to read and write data to the underlying database, administrative credentials that grant access to other databases or tables should not be provided. | cwe-250 |

