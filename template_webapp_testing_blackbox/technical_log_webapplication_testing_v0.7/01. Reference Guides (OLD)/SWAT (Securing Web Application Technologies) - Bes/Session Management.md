
| Best Practice | Description | CWE ID |
| --- | --- | --- |
| Ensure That Session Identifiers Are Sufficiently Random | Session tokens must be generated by secure random functions and must be of a sufficient length so as to withstand analysis and prediction. | cwe-6 |
| Regenerate Session Tokens | Session tokens should be regenerated when the user authenticates to theapplication and when the user privilege level changes. Additionally, shouldthe encryption status change, the session token should always be regenerated | cwe-384 |
| Implement an Idle Session Timeout | When a user is not active, the application should automatically log the user out. Be aware that Ajax applications may make recurring calls to the application effectively resetting the timeout counter automatically. | cwe-613 |
| Implement an Absolute Session Timeout | Users should be logged out after an extensive amount of time (e.g. 4-8 hours) has passed since they logged in. This helps mitigate the risk of an attacker using a hijacked session. | cwe-613 |
| Destroy Sessions at Any Sign of Tampering | Unless the application requires multiple simultaneous sessions for a single user, implement features to detect session cloning attempts. Should any sign of session cloning be detected, the session should be destroyed, forcing the real user to re-authenticate. |  |
| Invalidate the Session after Logout | When the user logs out of the application the session and corresponding data on the server must be destroyed. This ensures that the session can not be accidentally revived. | cwe-613 |
| Place a Logout Button on Every Page | The logout button or logout link should be easily accessible to the user on every page after they have authenticated. |  |
| Use Secure Cookie Attributes (i.e. HttpOnly and Secure Flags) | The session cookie should be set with both the HttpOnly and the Secure flags. This ensures that the session id will not be accessible to client-side scripts and it will only be transmitted over HTTPS, respectively. | cwe-79<br>cwe-614 |
| Set the Cookie Domain and Path Correctly | The cookie domain and path scope should be set to the most restrictive settings for your application. Any wildcard domain scoped cookie must have a good justification for its existence. |  |
| Set the Cookie Expiration Time | The session cookie should have a reasonable expiration time. Non-expiring session cookies should be avoided. |  |

