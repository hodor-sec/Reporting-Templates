<!doctype html><html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>Jumping shellcode techniques</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles3.css" type="text/css" />
  
    <script type="text/javascript">
        function in_frame () { try { return window.self !== window.top; } catch (e) { return true; } }
        if (!in_frame()) {
            var page = location.pathname.substring(location.pathname.lastIndexOf("/") + 1);
            window.location = 'index.html#' + page;
        }
    </script>
</head>
<body><div class="page"><h1 class="title">Jumping shellcode techniques</h1><br/><strong><h2>Issue</h2></strong><br />What happens if a register only points a relatively small portion of  our buffer with the shellcode located elsewhere? Or, what if the  register point close to, but not exactly at our buffer? Or, what if no  register points to our shellcode but we see an address on the stack that  does. In these cases, we have several options other than the standard  call/jmp instructions we’ve used so far. When it comes to jump code, I  like to think of the available options in the context of:<br /><br /><strong><h2>Possibilities</h2></strong><br /><br /><strong>SUB/ADD r32 + JMP r32</strong><br />• Manipulating the Registers• By adding to/subtracting from a register &amp; jumping to the modified address (add/sub [reg] + jmp)<br /><br /><strong>JMP [r32 + offset]</strong><br />• By finding an instruction that jumps to an offset of a register (jmp reg + offset)<br /><br /><strong>PUSH r32 + RET</strong><br />• Manipulating the stack• By pushing an address of our choosing to the stack and issuing a return (push + ret)<br /><br /><strong>POP r32 + RET / POPAD + RET</strong><br />• By popping a series of addresses from the stack and issuing a return (pop + ret or popad + ret)<br />• POPAD pushes 32 bytes, needs to be compensated by a filler<br /><br /><strong>JO/JNO</strong><br />• Using Unconditional and Conditional Jumps to hop to the shellcode<br /><br /></div></body></html>