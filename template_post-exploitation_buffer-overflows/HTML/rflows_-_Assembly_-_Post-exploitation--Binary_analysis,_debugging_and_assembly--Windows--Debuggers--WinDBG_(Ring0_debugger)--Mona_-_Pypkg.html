<!doctype html><html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>Mona / Pypkg</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles3.css" type="text/css" />
  
    <script type="text/javascript">
        function in_frame () { try { return window.self !== window.top; } catch (e) { return true; } }
        if (!in_frame()) {
            var page = location.pathname.substring(location.pathname.lastIndexOf("/") + 1);
            window.location = 'index.html#' + page;
        }
    </script>
</head>
<body><div class="page"><h1 class="title">Mona / Pypkg</h1><br/><br /><h2>Installation</h2><br />To get mona.py up and running under WinDBG, please follow these steps:<br /><br /><h3>Windows 7, 64bit</h3><br />1. Download pykd.zip from <a href="https://github.com/corelan/windbglib/raw/master/pykd/pykd.zip">https://github.com/corelan/windbglib/raw/master/pykd/pykd.zip</a> and save it to a temporary location on your computer<br /><br />2. Check the properties of the file and "Unblock" the file if necessary.<br /><br />3. Extract the archive. You should get 2 files: pykd.pyd and vcredist_x86.exe<br /><br />4. Run vcredist_x86.exe with administrator privileges and accept the default values.<br /><br />5. Copy pykd.pyd to <code>C:\Program Files (x86)\Windows Kits\8.0\Debuggers\x86\winext</code><br /><br />6. Open a command prompt with administrator privileges and run the following commands:<br /><code>c:<br />cd "C:\Program Files (x86)\Common Files\Microsoft Shared\VC"<br />regsvr32 msdia90.dll<br />(You should get a messagebox indicating that the dll was registered successfully)<br /></code><br />7. Download windbglib.py from <a href="https://github.com/corelan/windbglib/raw/master/windbglib.py">https://github.com/corelan/windbglib/raw/master/windbglib.py</a><br /><br />8. Save the file under <code>C:\Program Files (x86)\Windows Kits\8.0\Debuggers\x86</code>   ("Unblock" the file if necessary)<br /><br />9. Download mona.py from <a href="https://github.com/corelan/mona/raw/master/mona.py">https://github.com/corelan/mona/raw/master/mona.py</a><br /><br />10. Save the file under <code>C:\Program Files (x86)\Windows Kits\8.0\Debuggers\x86</code>   ("Unblock" the file if necessary)<br /><br /><br /><h3>Windows XP, 32bit</h3><br />1. Download pykd.zip from <a href="https://github.com/corelan/windbglib/raw/master/pykd/pykd.zip">https://github.com/corelan/windbglib/raw/master/pykd/pykd.zip</a> and save it to a temporary location on your computer<br /><br />2. Check the properties of the file and "Unblock" the file if necessary.<br /><br />3. Extract the archive. You should get 2 files: pykd.pyd and vcredist_x86.exe<br /><br />4. Run vcredist_x86.exe with administrator privileges and accept the default values.<br /><br />5. Copy pykd.pyd to <code>C:\Program Files\Debugging Tools for Windows (x86)\winext</code><br /><br />6. Open a command prompt with administrator privileges and run the following commands:<br /><code>c:<br />cd "C:\Program Files\Common Files\Microsoft Shared\VC"<br />regsvr32 msdia90.dll<br />(You should get a messagebox indicating that the dll was registered successfully)<br /></code><br />7. Download windbglib.py from <a href="https://github.com/corelan/windbglib/raw/master/windbglib.py">https://github.com/corelan/windbglib/raw/master/windbglib.py</a><br /><br />8. Save the file under <code>C:\Program Files\Debugging Tools for Windows (x86)</code>   ("Unblock" the file if necessary)<br /><br />9. Download mona.py from <a href="https://github.com/corelan/mona/raw/master/mona.py">https://github.com/corelan/mona/raw/master/mona.py</a><br /><br />10. Save the file under <code>C:\Program Files\Debugging Tools for Windows (x86)</code>   ("Unblock" the file if necessary)<br /><br /><br /><h2>Running</h2><br />Open Windbg and execute the following command: <code>.load pykd.pyd</code><br />mona commands can the be accessed by running <code>!py mona</code><br /><br /><h2>Notes</h2><br />1. Make sure your symbol path is set up correctly (if you don't know how to do ths, mona.py will do this for you the first time you run the script)<br />2. Make sure (at least) the symbols for ntdll.dll are downloaded/available on your system.If your machine is connected to the internet, windbg will do this automatically the first time you run mona.pyWhen the files are downloaded, you could disconnect the system from the internet if you would like to.<br /></div></body></html>