<!doctype html><html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>Packet analysis PCAP</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles3.css" type="text/css" />
  
    <script type="text/javascript">
        function in_frame () { try { return window.self !== window.top; } catch (e) { return true; } }
        if (!in_frame()) {
            var page = location.pathname.substring(location.pathname.lastIndexOf("/") + 1);
            window.location = 'index.html#' + page;
        }
    </script>
</head>
<body><div class="page"><h1 class="title">Packet analysis PCAP</h1><br/><strong><h2>Read Pcap File</h2></strong><br />Start scapy: <br />$ scapy<br />Welcome to Scapy (2.3.1)<br />&gt;&gt;&gt; <br />To read a pcap file, use the <code>rdpcap()</code> method and pass the absolute path to the pcap file: <br />&gt;&gt;&gt; a=rdpcap("/path/to/capture.pcap")<br />Now you should be able to see the number of packets: <br />&gt;&gt;&gt; len(a)<br />2055<br /><br /><strong><h2>Analyzing a Packet</h2></strong><br />Start by analyzing a single packet: <br />&gt;&gt;&gt; pkt = a[3]<br /><br /><h3>Packet Methods</h3><br />Getting an individual packet returns an object of type Dot11 (as in, an 802.11 wireless packet): <br />&gt;&gt;&gt; type(pkt)<br />&lt;class 'scapy.layers.dot11.Dot11'&gt;<br />Start by checking out what functions are available for an individual packet: <br />&gt;&gt;&gt; dir(pkt)<br />['__class__', '__contains__', '__delattr__', '__delitem__', '__dict__', '__div__', '__doc__', '__eq__', '__format__', '__getattr__', '__getattribute__', '__getitem__', '__gt__', '__hash__', '__init__', '__iter__', '__len__', '__lt__', '__metaclass__', '__module__', '__mul__', '__ne__', '__new__', '__nonzero__', '__rdiv__', '__reduce__', '__reduce_ex__', '__repr__', '__rmul__', '__rtruediv__', '__setattr__', '__setitem__', '__sizeof__', '__str__', '__subclasshook__', '__truediv__', '__weakref__', '_do_summary', 'add_payload', 'add_underlayer', 'aliastypes', 'answers', 'build', 'build_done', 'build_padding', 'build_ps', 'canvas_dump', 'clone_with', 'command', 'copy', 'decode_payload_as', 'default_fields', 'default_payload_class', 'delfieldval', 'display', 'dissect', 'dissection_done', 'do_build', 'do_build_payload', 'do_build_ps', 'do_dissect', 'do_dissect_payload', 'do_init_fields', 'explicit', 'extract_padding', 'fields', 'fields_desc', 'fieldtype', 'firstlayer', 'fragment', 'from_hexcap', 'get_field', 'getfield_and_val', 'getfieldval', 'getlayer', 'guess_payload_class', 'hashret', 'haslayer', 'hide_defaults', 'init_fields', 'initialized', 'lastlayer', 'libnet', 'lower_bonds', 'mysummary', 'name', 'original', 'overload_fields', 'overloaded_fields', 'packetfields', 'payload', 'payload_guess', 'pdfdump', 'post_build', 'post_dissect', 'post_dissection', 'post_transforms', 'pre_dissect', 'psdump', 'raw_packet_cache', 'remove_payload', 'remove_underlayer', 'route', 'self_build', 'sent_time', 'setfieldval', 'show', 'show2', 'show_indent', 'sprintf', 'summary', 'time', 'underlayer', 'unwep', 'upper_bonds']<br />&gt;&gt;&gt;<br /><br /><strong><h3>Printing a Packet</h3></strong><br /><br />A string dump of the packet is not very useful: <br /><br />&gt;&gt;&gt; str(pkt)<br />"\x80\x00\x00\x00\xff\xff\xff\xff\xff\xff\x8c\x04\xff\xed\xa9O\x8c\x04\xff\xed\xa9O\x80a\x84\xb18\x9bX\x00\x00\x00d\x00\x11\x04\x00\tHOME-A94F\x01\x08\x82\x84\x8b\x96$\xb0Hl\x03\x01\x01\x05\x04\x00\x01\x00\x00*\x01\x00/\x01\x000\x18\x01\x00\x00\x0f\xac\x02\x02\x00\x00\x0f\xac\x04\x00\x0f\xac\x02\x01\x00\x00\x0f\xac\x02\x0c\x002\x04\x8c\x12\x98`-\x1a\xbd\x18\x1b\xff\xff\xff\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00=\x16\x01\x08\x11\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xdd\x18\x00P\xf2\x04\x10J\x00\x01\x10\x10D\x00\x01\x02\x10I\x00\x06\x007*\x00\x01 \xdd\t\x00\x10\x18\x02\x00\x00\x1c\x00\x00\xdd\x1c\x00P\xf2\x01\x01\x00\x00P\xf2\x02\x02\x00\x00P\xf2\x04\x00P\xf2\x02\x01\x00\x00P\xf2\x02\x0c\x00\xdd\x18\x00P\xf2\x02\x01\x01\x80\x00\x03\xa4\x00\x00'\xa4\x00\x00BC^\x00b2/\x00"<br /><br />But a hex dump is starting to look a little bit better: <br /><br />&gt;&gt;&gt; hexdump(pkt)<br />0000   80 00 00 00 FF FF FF FF  FF FF 8C 04 FF ED A9 4F   ...............O<br />0010   8C 04 FF ED A9 4F 80 61  84 B1 38 9B 58 00 00 00   .....O.a..8.X...<br />0020   64 00 11 04 00 09 48 4F  4D 45 2D 41 39 34 46 01   d.....HOME-A94F.<br />0030   08 82 84 8B 96 24 B0 48  6C 03 01 01 05 04 00 01   .....$.Hl.......<br />0040   00 00 2A 01 00 2F 01 00  30 18 01 00 00 0F AC 02   ..*../..0.......<br />0050   02 00 00 0F AC 04 00 0F  AC 02 01 00 00 0F AC 02   ................<br />0060   0C 00 32 04 8C 12 98 60  2D 1A BD 18 1B FF FF FF   ..2....`-.......<br />0070   00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00   ................<br />0080   00 00 00 00 3D 16 01 08  11 00 00 00 00 00 00 00   ....=...........<br />0090   00 00 00 00 00 00 00 00  00 00 00 00 DD 18 00 50   ...............P<br />00a0   F2 04 10 4A 00 01 10 10  44 00 01 02 10 49 00 06   ...J....D....I..<br />00b0   00 37 2A 00 01 20 DD 09  00 10 18 02 00 00 1C 00   .7*.. ..........<br />00c0   00 DD 1C 00 50 F2 01 01  00 00 50 F2 02 02 00 00   ....P.....P.....<br />00d0   50 F2 04 00 50 F2 02 01  00 00 50 F2 02 0C 00 DD   P...P.....P.....<br />00e0   18 00 50 F2 02 01 01 80  00 03 A4 00 00 27 A4 00   ..P..........'..<br />00f0   00 42 43 5E 00 62 32 2F  00                        .BC^.b2/.<br />Each of these pieces of data represents a different part of the  packet header, which includes information about the source, destination,  timestamp, channel, and so on. Use the show method for an individual  packet to show the full description: <br />&gt;&gt;&gt; pkt.show()<br />###[ 802.11 ]###<br />  subtype= 8L<br />  type= Management<br />  proto= 0L<br />  FCfield=<br />  ID= 0<br />  addr1= ff:ff:ff:ff:ff:ff<br />  addr2= 3c:34:ff:43:a3:4d<br />  addr3= 3c:34:ff:43:a3:4d<br />  SC= 24960<br />  addr4= None<br />###[ 802.11 Beacon ]###<br />     timestamp= 380561305988<br />     beacon_interval= 100<br />     cap= short-slot+ESS+privacy<br />###[ 802.11 Information Element ]###<br />        ID= SSID<br />        len= 9<br />        info= 'HOME-A94F'<br />###[ 802.11 Information Element ]###<br />           ID= Rates<br />           len= 8<br />           info= '\x82\x84\x8b\x96$\xb0Hl'<br />###[ 802.11 Information Element ]###<br />              ID= DSset<br />              len= 1<br />              info= '\x01'<br />###[ 802.11 Information Element ]###<br />                 ID= TIM<br />                 len= 4<br />                 info= '\x00\x01\x00\x00'<br />###[ 802.11 Information Element ]###<br />                    ID= ERPinfo<br />                    len= 1<br />                    info= '\x00'<br />###[ 802.11 Information Element ]###<br />                       ID= ERPinfo<br />                       len= 1<br />                       info= '\x00'<br />###[ 802.11 Information Element ]###<br />                          ID= RSNinfo<br />                          len= 24<br />                          info= '\x01\x00\x00\x0f\xac\x02\x02\x00\x00\x0f\xac\x04\x00\x0f\xac\x02\x01\x00\x00\x0f\xac\x02\x0c\x00'<br />###[ 802.11 Information Element ]###<br />                             ID= ESRates<br />                             len= 4<br />                             info= '\x8c\x12\x98`'<br />###[ 802.11 Information Element ]###<br />                                ID= 45<br />                                len= 26<br />                                info= '\xbd\x18\x1b\xff\xff\xff\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00'<br />###[ 802.11 Information Element ]###<br />                                   ID= 61<br />                                   len= 22<br />                                   info= '\x01\x08\x11\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00'<br />###[ 802.11 Information Element ]###<br />                                      ID= vendor<br />                                      len= 24<br />                                      info= '\x00P\xf2\x04\x10J\x00\x01\x10\x10D\x00\x01\x02\x10I\x00\x06\x007*\x00\x01 '<br />###[ 802.11 Information Element ]###<br />                                         ID= vendor<br />                                         len= 9<br />                                         info= '\x00\x10\x18\x02\x00\x00\x1c\x00\x00'<br />###[ 802.11 Information Element ]###<br />                                            ID= vendor<br />                                            len= 28<br />                                            info= '\x00P\xf2\x01\x01\x00\x00P\xf2\x02\x02\x00\x00P\xf2\x04\x00P\xf2\x02\x01\x00\x00P\xf2\x02\x0c\x00'<br />###[ 802.11 Information Element ]###<br />                                               ID= vendor<br />                                               len= 24<br />                                               info= "\x00P\xf2\x02\x01\x01\x80\x00\x03\xa4\x00\x00'\xa4\x00\x00BC^\x00b2/\x00"<br /><br /><h2>Finding Packets by Type</h2><br />To get most of the information about a packet, you can use the fields  attribute, which is a dictionary containing key-value pairs. One of  these is "subtype" - which corresponds to the Frame Type/Subtype table  here: <br /><a href="http://www.willhackforsushi.com/papers/80211_Pocket_Reference_Guide.pdf">http://www.willhackforsushi.com/papers/80211_Pocket_Reference_Guide.pdf</a> <br />If you loop over each packet and print out its subtype, you'll see all the values are the values found in the table. <br />from scapy.all import *<br /><br />a = rdpcap("awesome-02.cap")<br /><br />#for i in range(len(a)):<br />for i in range(100):<br />    t = a[i].fields['subtype']<br />    print t<br />Checking the pocket reference, we can filter out and look at certain  types of packets. For example, searching for beacon packets is a quick  way to find access points in the nearby area. <br /><br /> <br /></div></body></html>