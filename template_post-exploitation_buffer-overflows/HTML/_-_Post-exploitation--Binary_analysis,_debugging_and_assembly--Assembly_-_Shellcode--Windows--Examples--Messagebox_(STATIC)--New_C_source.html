<!doctype html><html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>New C source</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles3.css" type="text/css" />
  
    <script type="text/javascript">
        function in_frame () { try { return window.self !== window.top; } catch (e) { return true; } }
        if (!in_frame()) {
            var page = location.pathname.substring(location.pathname.lastIndexOf("/") + 1);
            window.location = 'index.html#' + page;
        }
    </script>
</head>
<body><div class="page"><h1 class="title">New C source</h1><br/><div class="codebox"><div class="codebox"><span style="color:#7f0044;font-weight:700">#include&nbsp;&lt;windows.h&gt;</span><br /><br /><span style="color:#7f0044;font-weight:400">char</span>&nbsp;code[]&nbsp;=&nbsp;\<br /><span style="color:#3ad900;font-weight:400">"\x68\x65\x00\x00\x00"</span>	<span style="color:#0088ff;font-weight:400">//&nbsp;Pushes&nbsp;string&nbsp;"Hodorware"</span><br /><span style="color:#3ad900;font-weight:400">"\x68\x72\x77\x61\x72"</span>	<span style="color:#0088ff;font-weight:400">//</span><br /><span style="color:#3ad900;font-weight:400">"\x68\x48\x6f\x64\x6f"</span>	<span style="color:#0088ff;font-weight:400">//</span><br /><span style="color:#3ad900;font-weight:400">"\x8b\xdc"</span>				<span style="color:#0088ff;font-weight:400">//&nbsp;mov&nbsp;ebx,&nbsp;esp;&nbsp;pointer&nbsp;EBX&nbsp;to&nbsp;string</span><br /><br /><span style="color:#3ad900;font-weight:400">"\x6a\x00"</span>				<span style="color:#0088ff;font-weight:400">//&nbsp;push&nbsp;0x00</span><br /><span style="color:#3ad900;font-weight:400">"\x68\x4f\x44\x4f\x52"</span>	<span style="color:#0088ff;font-weight:400">//&nbsp;push&nbsp;0x524f444f</span><br /><span style="color:#3ad900;font-weight:400">"\x68\x44\x4f\x52\x48"</span>	<span style="color:#0088ff;font-weight:400">//&nbsp;push&nbsp;0x48524f44</span><br /><span style="color:#3ad900;font-weight:400">"\x68\x4f\x52\x48\x4f"</span>	<span style="color:#0088ff;font-weight:400">//&nbsp;push&nbsp;0x4f48524f</span><br /><span style="color:#3ad900;font-weight:400">"\x68\x52\x48\x4f\x44"</span>	<span style="color:#0088ff;font-weight:400">//&nbsp;push&nbsp;0x444f4852</span><br /><span style="color:#3ad900;font-weight:400">"\x68\x48\x4f\x44\x4f"</span>	<span style="color:#0088ff;font-weight:400">//&nbsp;push&nbsp;0x4f444f48</span><br /><br /><span style="color:#3ad900;font-weight:400">"\x8b\xcc"</span>				<span style="color:#0088ff;font-weight:400">//&nbsp;mov&nbsp;ecx,&nbsp;esp;&nbsp;pointer&nbsp;ECX&nbsp;to&nbsp;string</span><br /><br /><span style="color:#0088ff;font-weight:400">//&nbsp;Parameters&nbsp;on&nbsp;stack</span><br /><span style="color:#0088ff;font-weight:400">//&nbsp;Last&nbsp;param&nbsp;is&nbsp;hwnd&nbsp;=&nbsp;0</span><br /><span style="color:#0088ff;font-weight:400">//&nbsp;Clear&nbsp;EAX&nbsp;and&nbsp;push&nbsp;to&nbsp;stack</span><br /><span style="color:#3ad900;font-weight:400">"\x31\xc0"</span>				<span style="color:#0088ff;font-weight:400">//&nbsp;xor&nbsp;eax,&nbsp;eax</span><br /><span style="color:#3ad900;font-weight:400">"\x50"</span>					<span style="color:#0088ff;font-weight:400">//&nbsp;push&nbsp;eax</span><br /><span style="color:#0088ff;font-weight:400">//&nbsp;Second&nbsp;param&nbsp;is&nbsp;caption,&nbsp;PTR&nbsp;in&nbsp;EBX</span><br /><span style="color:#3ad900;font-weight:400">"\x53"</span>					<span style="color:#0088ff;font-weight:400">//&nbsp;push&nbsp;ebx</span><br /><span style="color:#0088ff;font-weight:400">//&nbsp;Next&nbsp;param&nbsp;is&nbsp;text,&nbsp;PTR&nbsp;in&nbsp;ECX</span><br /><span style="color:#3ad900;font-weight:400">"\x51"</span>					<span style="color:#0088ff;font-weight:400">//&nbsp;push&nbsp;ecx</span><br /><span style="color:#0088ff;font-weight:400">//&nbsp;Next&nbsp;param&nbsp;is&nbsp;button&nbsp;(OK&nbsp;=&nbsp;0).&nbsp;EAX&nbsp;still&nbsp;zero</span><br /><span style="color:#3ad900;font-weight:400">"\x50"</span>					<span style="color:#0088ff;font-weight:400">//&nbsp;push&nbsp;eax</span><br /><span style="color:#3ad900;font-weight:400">"\x50"</span>					<span style="color:#0088ff;font-weight:400">//&nbsp;push&nbsp;eax</span><br /><br /><span style="color:#0088ff;font-weight:400">//&nbsp;Call&nbsp;function</span><br /><span style="color:#3ad900;font-weight:400">"\xbe\x11\xea\xd6\x77"</span>		<span style="color:#0088ff;font-weight:400">//&nbsp;mov&nbsp;esi,&nbsp;0x77d6ea11,&nbsp;MessageBox&nbsp;in&nbsp;user32.dll</span><br /><span style="color:#3ad900;font-weight:400">"\xff\xe6"</span>					<span style="color:#0088ff;font-weight:400">//&nbsp;jmp&nbsp;esi&nbsp;=&nbsp;launch&nbsp;MessageBox</span><br /><br /><span style="color:#0088ff;font-weight:400">//&nbsp;Clean&nbsp;up&nbsp;and&nbsp;exit</span><br /><span style="color:#3ad900;font-weight:400">"\x31\xc0"</span>					<span style="color:#0088ff;font-weight:400">//&nbsp;xor&nbsp;eax,&nbsp;eax</span><br /><span style="color:#3ad900;font-weight:400">"\x50"</span>						<span style="color:#0088ff;font-weight:400">//&nbsp;push&nbsp;eax</span><br /><span style="color:#3ad900;font-weight:400">"\xb8\x4f\x21\xe3\x77"</span>		<span style="color:#0088ff;font-weight:400">//&nbsp;mov&nbsp;eax,&nbsp;0x77e3214f,&nbsp;ExitProcess&nbsp;in&nbsp;kernel32.dll</span><br /><span style="color:#3ad900;font-weight:400">"\xff\xe0"</span>;					<span style="color:#0088ff;font-weight:400">//&nbsp;jmp&nbsp;eax&nbsp;=&nbsp;launch&nbsp;ExitProcess()</span><br /><br /><span style="color:#7f0044;font-weight:400">int</span>&nbsp;main()<br />{<br />	<span style="color:#7f0044;font-weight:400">int</span>&nbsp;(*ret)()&nbsp;=&nbsp;(<span style="color:#7f0044;font-weight:400">int</span>(*)())code;<br />	ret();<br />}</div></div></div></body></html>