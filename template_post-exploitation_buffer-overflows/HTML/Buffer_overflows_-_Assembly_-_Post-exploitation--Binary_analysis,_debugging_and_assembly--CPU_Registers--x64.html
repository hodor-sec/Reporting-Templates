<!doctype html><html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>x64</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles3.css" type="text/css" />
  
    <script type="text/javascript">
        function in_frame () { try { return window.self !== window.top; } catch (e) { return true; } }
        if (!in_frame()) {
            var page = location.pathname.substring(location.pathname.lastIndexOf("/") + 1);
            window.location = 'index.html#' + page;
        }
    </script>
</head>
<body><div class="page"><h1 class="title">x64</h1><br/><h2> General Purpose Registers</h2><br /> <br /><table class="table"><col/><col/><col/><col/><col/><col/><tr><th> Monikers</th><th></th><th></th><th></th><th></th><th> Description</th></tr><tr><td> 64-bit</td><td> 32-bit</td><td> 16-bit</td><td> 8 high bits of lower 16 bits</td><td> 8-bit</td><td></td></tr><tr><td> RAX</td><td> EAX</td><td> AX</td><td> AH</td><td> AL</td><td> Accumulator</td></tr><tr><td> RBX</td><td> EBX</td><td> BX</td><td> BH</td><td> BL</td><td> Base</td></tr><tr><td> RCX</td><td> ECX</td><td> CX</td><td> CH</td><td> CL</td><td> Counter</td></tr><tr><td> RDX</td><td> EDX</td><td> DX</td><td> DH</td><td> DL</td><td> Data (commonly extends the A register)</td></tr><tr><td> RSI</td><td> ESI</td><td> SI</td><td> N/A</td><td> SIL</td><td> Source index for string operations</td></tr><tr><td> RDI</td><td> EDI</td><td> DI</td><td> N/A</td><td> DIL</td><td> Destination index for string operations</td></tr><tr><td> RSP</td><td> ESP</td><td> SP</td><td> N/A</td><td> SPL</td><td> Stack Pointer</td></tr><tr><td> RBP</td><td> EBP</td><td> BP</td><td> N/A</td><td> BPL</td><td> Base Pointer (meant for stack frames)</td></tr><tr><td> R8</td><td> R8D</td><td> R8W</td><td> N/A</td><td> R8B</td><td> General purpose</td></tr><tr><td> R9</td><td> R9D</td><td> R9W</td><td> N/A</td><td> R9B</td><td> General purpose</td></tr><tr><td> R10</td><td> R10D</td><td> R10W</td><td> N/A</td><td> R10B</td><td> General purpose</td></tr><tr><td> R11</td><td> R11D</td><td> R11W</td><td> N/A</td><td> R11B</td><td> General purpose</td></tr><tr><td> R12</td><td> R12D</td><td> R12W</td><td> N/A</td><td> R12B</td><td> General purpose</td></tr><tr><td> R13</td><td> R13D</td><td> R13W</td><td> N/A</td><td> R13B</td><td> General purpose</td></tr><tr><td> R14</td><td> R14D</td><td> R14W</td><td> N/A</td><td> R14B</td><td> General purpose</td></tr><tr><td> R15</td><td> R15D</td><td> R15W</td><td> N/A</td><td> R15B</td><td> General purpose</td></tr></table><br />Note: you cannot access <em>AH</em>, <em>BH</em>, <em>CH</em> and <em>DH</em> when using the REX.W instruction prefix. This prefix is added (automatically by assemblers) when an operand contains a 64-bit register. <br /><br /><br /><h2> Pointer Registers</h2><br /><table class="table"><col/><col/><col/><col/><tr><th> Monikers</th><th></th><th></th><th> Description</th></tr><tr><td> 64-bit</td><td> 32-bit</td><td> 16-bit</td><td></td></tr><tr><td> RIP</td><td> EIP</td><td> IP</td><td> Instruction Pointer</td></tr></table><br />Note: The instruction pointer can only be used in RIP-relative addressing, which was introduced with long mode. <br /><br /><h2> Segment Registers</h2><br />All these are 16 bits long. <br /><table class="table"><col/><col/><tr><th> Moniker</th><th> Description</th></tr><tr><td> CS</td><td> Code Segment</td></tr><tr><td> DS</td><td> Data Segment</td></tr><tr><td> SS</td><td> Stack Segment</td></tr><tr><td> ES</td><td> Extra Segment (used for string operations)</td></tr><tr><td> FS</td><td> General-purpose Segment</td></tr><tr><td> GS</td><td> General-purpose Segment</td></tr></table><br />Segments of <em>CS</em>, <em>DS</em>, <em>ES</em>, and <em>SS</em> are treated as if their base was 0 no matter what the segment descriptors in the GDT say. Exceptions are <em>FS</em> and <em>GS</em> which have MSRs to change their base. <br />Limit checks are disabled for all segments. <br /><br /><h2> RFLAGS Register</h2><br /><table class="table"><col/><col/><col/><tr><th> Bit(s)</th><th> Label</th><th> Description</th></tr><tr><td> 0</td><td> CF</td><td> Carry Flag</td></tr><tr><td> 1</td><td> 1</td><td> Reserved</td></tr><tr><td> 2</td><td> PF</td><td> Parity Flag</td></tr><tr><td> 3</td><td> 0</td><td> Reserved</td></tr><tr><td> 4</td><td> AF</td><td> Auxiliary Carry Flag</td></tr><tr><td> 5</td><td> 0</td><td> Reserved</td></tr><tr><td> 6</td><td> ZF</td><td> Zero Flag</td></tr><tr><td> 7</td><td> SF</td><td> Sign Flag</td></tr><tr><td> 8</td><td> TF</td><td> Trap Flag</td></tr><tr><td> 9</td><td> IF</td><td> Interrupt Enable Flag</td></tr><tr><td> 10</td><td> DF</td><td> Direction Flag</td></tr><tr><td> 11</td><td> OF</td><td> Overflow Flag</td></tr><tr><td> 12-13</td><td> IOPL</td><td> I/O Privilege Level</td></tr><tr><td> 14</td><td> NT</td><td> Nested Task</td></tr><tr><td> 15</td><td> 0</td><td> Reserved</td></tr><tr><td> 16</td><td> RF</td><td> Resume Flag</td></tr><tr><td> 17</td><td> VM</td><td> Virtual-8086 Mode</td></tr><tr><td> 18</td><td> AC</td><td> Alignment Check / Access Control</td></tr><tr><td> 19</td><td> VIF</td><td> Virtual Interrupt Flag</td></tr><tr><td> 20</td><td> VIP</td><td> Virtual Interrupt Pending</td></tr><tr><td> 21</td><td> ID</td><td> ID Flag</td></tr><tr><td> 22-63</td><td> 0</td><td> Reserved</td></tr></table><br /><br /><br /><h2> Control Registers</h2><br /><br /><h3> CR0</h3><br /><table class="table"><col/><col/><col/><tr><th> Bit(s)</th><th> Label</th><th> Description</th></tr><tr><td> 0</td><td> PE</td><td> Protected Mode Enable</td></tr><tr><td> 1</td><td> MP</td><td> Monitor Co-Processor</td></tr><tr><td> 2</td><td> EM</td><td> Emulation</td></tr><tr><td> 3</td><td> TS</td><td> Task Switched</td></tr><tr><td> 4</td><td> ET</td><td> Extension Type</td></tr><tr><td> 5</td><td> NE</td><td> Numeric Error</td></tr><tr><td> 6-15</td><td> 0</td><td> Reserved</td></tr><tr><td> 16</td><td> WP</td><td> Write Protect</td></tr><tr><td> 17</td><td> 0</td><td> Reserved</td></tr><tr><td> 18</td><td> AM</td><td> Alignment Mask</td></tr><tr><td> 19-28</td><td> 0</td><td> Reserved</td></tr><tr><td> 29</td><td> NW</td><td> Not-Write Through</td></tr><tr><td> 30</td><td> CD</td><td> Cache Disable</td></tr><tr><td> 31</td><td> PG</td><td> Paging</td></tr><tr><td> 32-63</td><td> 0</td><td> Reserved</td></tr></table><br />NOTE that this register is the only control register that can be  written and read via 2 ways unlike the other that can be accessed only  via the MOV instruction <br />;way 1:<br />;write:<br />mov cr0,reg32(64)<br />;read:<br />mov reg32(64),cr0 <br />;----------------------<br />;way 2:<br />;write:<br />lmsw reg16(32/64) ; the 'w' in lms(w) stands for word size (16 bit) but the instruction itself can modify the upper 48 bit of cr0 using instruction overrides.<br />Â <br />;read:<br />smsw reg16(32/64) ; SAME as above<br /><h3> CR2</h3><br />This control register contains the linear (virtual) address which  triggered a page fault, available in the page fault's interrupt handler. <br /><br /><h3> CR3</h3><br /><table class="table"><col/><col/><col/><col/><col/><tr><th> Bit(s)</th><th> Label</th><th> Description</th><th> Condition</th><th></th></tr><tr><td> 0-11</td><td> 0-2</td><td> 0</td><td> Reserved</td><td> CR4.PCIDE = 0</td></tr><tr><td></td><td> 3</td><td> PWT</td><td> Page-Level Write Through</td><td></td></tr><tr><td></td><td> 5</td><td> PCD</td><td> Page-Level Cache Disable</td><td></td></tr><tr><td></td><td> 5-11</td><td> 0</td><td> Reserved</td><td></td></tr><tr><td> 0-11</td><td> PCID</td><td> CR4.PCIDE = 1</td><td></td><td></td></tr><tr><td> 12-63</td><td> Physical Base Address of the PML4</td><td></td><td></td><td></td></tr></table><br />Note that this must be page aligned <br /><br /><h3> CR4</h3><br /><table class="table"><col/><col/><col/><tr><th> Bit(s)</th><th> Label</th><th> Description</th></tr><tr><td> 0</td><td> VME</td><td> Virtual-8086 Mode Extensions</td></tr><tr><td> 1</td><td> PVI</td><td> Protected Mode Virtual Interrupts</td></tr><tr><td> 2</td><td> TSD</td><td> Time Stamp enabled only in ring 0</td></tr><tr><td> 3</td><td> DE</td><td> Debugging Extensions</td></tr><tr><td> 4</td><td> PSE</td><td> Page Size Extension</td></tr><tr><td> 5</td><td> PAE</td><td> Physical Address Extension</td></tr><tr><td> 6</td><td> MCE</td><td> Machine Check Exception</td></tr><tr><td> 7</td><td> PGE</td><td> Page Global Enable</td></tr><tr><td> 8</td><td> PCE</td><td> Performance Monitoring Counter Enable</td></tr><tr><td> 9</td><td> OSFXSR</td><td> OS support for fxsave and fxrstor instructions</td></tr><tr><td> 10</td><td> OSXMMEXCPT</td><td> OS Support for unmasked simd floating point exceptions</td></tr><tr><td> 11</td><td> UMIP</td><td> User-Mode Instruction Prevention (SGDT, SIDT, SLDT, SMSW, and STR are disabled in user mode)</td></tr><tr><td> 12</td><td> 0</td><td> Reserved</td></tr><tr><td> 13</td><td> VMXE</td><td> Virtual Machine Extensions Enable</td></tr><tr><td> 14</td><td> SMXE</td><td> Safer Mode Extensions Enable</td></tr><tr><td> 15</td><td> 0</td><td> Reserved</td></tr><tr><td> 17</td><td> PCIDE</td><td> PCID Enable</td></tr><tr><td> 18</td><td> OSXSAVE</td><td> XSAVE And Processor Extended States Enable</td></tr><tr><td> 19</td><td> 0</td><td> Reserved</td></tr><tr><td> 20</td><td> SMEP</td><td> Supervisor Mode Executions Protection Enable</td></tr><tr><td> 21</td><td> SMAP</td><td> Supervisor Mode Access Protection Enable</td></tr><tr><td> 22-63</td><td> 0</td><td> Reserved</td></tr></table><br /><br /><h3> CR8</h3><br />CR8 is a new register accessible in 64-bit mode using the REX prefix. CR8 is used to prioritize external <a href="https://wiki.osdev.org/Interrupts">interrupts</a> and is referred to as the task-priority register (TPR). <br />The AMD64 architecture allows software to define up to 15  external interrupt-priority classes. Priority classes are numbered from 1  to 15, with priority-class 1 being the lowest and priority-class 15 the  highest. CR8 uses the four low-order bits for specifying a task  priority and the remaining 60 bits are reserved and must be written with  zeros. <br />System software can use the TPR register to temporarily block  low-priority interrupts from interrupting a high-priority task. This is  accomplished by loading TPR with a value corresponding to the  highest-priority interrupt that is to be blocked. For example, loading  TPR with a value of 9 (1001b) blocks all interrupts with a priority  class of 9 or less, while allowing all interrupts with a priority class  of 10 or more to be recognized. Loading TPR with 0 enables all external  interrupts. Loading TPR with 15 (1111b) disables all external  interrupts. <br />The TPR is cleared to 0 on reset. <br /><table class="table"><col/><col/><tr><th>Bit</th><th>Purpose</th></tr><tr><td>0-3</td><td>Priority</td></tr><tr><td>4-63</td><td>Reserved</td></tr></table><br /><br /><h3> CR1, CR5-7, CR9-15</h3><br />Reserved, the cpu will throw a #ud exeption when trying to access them. <br /><br /><br /><br /><h2> MSRs</h2><br /><br /><h3> IA32_EFER</h3><br />Extended Feature Enable Register (EFER) is a <a href="https://wiki.osdev.org/MSR">model-specific register</a> added in the AMD K6 processor, to allow enabling the SYSCALL/SYSRET instruction, and later for entering and exiting <a href="https://wiki.osdev.org/X86-64">long mode</a>. This register becomes architectural in <a href="https://wiki.osdev.org/AMD64">AMD64</a> and has been adopted by Intel. Its MSR number is 0xC0000080. <br /><table class="table"><col/><col/><col/><tr><th> Bit(s)</th><th> Label</th><th> Description</th></tr><tr><td> 0</td><td> SCE</td><td> System Call Extensions</td></tr><tr><td> 1-7</td><td> 0</td><td> Reserved</td></tr><tr><td> 8</td><td> LME</td><td> Long Mode Enable</td></tr><tr><td> 10</td><td> LMA</td><td> Long Mode Active</td></tr><tr><td> 11</td><td> NXE</td><td> No-Execute Enable</td></tr><tr><td> 12</td><td> SVME</td><td> Secure Virtual Machine Enable</td></tr><tr><td> 13</td><td> LMSLE</td><td> Long Mode Segment Limit Enable</td></tr><tr><td> 14</td><td> FFXSR</td><td> Fast FXSAVE/FXRSTOR</td></tr><tr><td> 15</td><td> TCE</td><td> Translation Cache Extension</td></tr><tr><td> 16-63</td><td> 0</td><td> Reserved</td></tr></table><br /><br /><br /><br /><h2> Debug Registers</h2><br /><br /><h3> DR0 - DR3</h3><br />Contain linear addresses of up to 4 breakpoints. If paging is enabled, they are translated to physical addresses. <br /><br /><h3> DR6</h3><br />It permits the debugger to determine which debug conditions have  occured. When an enabled debug exception is enabled, low order bits 0-3  are set before entering debug exception handler. <br /><br /><h3> DR7</h3><br /><table class="table"><col/><col/><tr><th> Bit</th><th> Description</th></tr><tr><td> 0</td><td> Local DR0 Breakpoint</td></tr><tr><td> 1</td><td> Global DR0 Breakpoint</td></tr><tr><td> 2</td><td> Local DR1 Breakpoint</td></tr><tr><td> 3</td><td> Global DR1 Breakpoint</td></tr><tr><td> 4</td><td> Local DR2 Breakpoint</td></tr><tr><td> 5</td><td> Global DR2 Breakpoint</td></tr><tr><td> 6</td><td> Local DR3 Breakpoint</td></tr><tr><td> 7</td><td> Global DR3 Breakpoint</td></tr><tr><td> 16-17</td><td> Conditions for DR0</td></tr><tr><td> 18-19</td><td> Size of DR0 Breakpoint</td></tr><tr><td> 20-21</td><td> Conditions for DR1</td></tr><tr><td> 22-23</td><td> Size of DR1 Breakpoint</td></tr><tr><td> 24-25</td><td> Conditions for DR2</td></tr><tr><td> 26-27</td><td> Size of DR2 Breakpoint</td></tr><tr><td> 28-29</td><td> Conditions for DR3</td></tr><tr><td> 30-31</td><td> Size of DR3 Breakpoint</td></tr></table><br />A local breakpoint bit deactivates on hardware task switches, while a global does not.<br /> 00b condition means execution break, 01b means a write watchpoint, and  11b means an R/W watchpoint. 10b is reserved for I/O R/W (unsupported). <br /><br /><h2> </h2><br /><br /></div></body></html>