<!doctype html><html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>OLD: pvefindaddr.py</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles3.css" type="text/css" />
  
    <script type="text/javascript">
        function in_frame () { try { return window.self !== window.top; } catch (e) { return true; } }
        if (!in_frame()) {
            var page = location.pathname.substring(location.pathname.lastIndexOf("/") + 1);
            window.location = 'index.html#' + page;
        }
    </script>
</head>
<body><div class="page"><h1 class="title">OLD: pvefindaddr.py</h1><br/><div class="codebox"><div class="codebox"><span style="color:#0088ff;font-weight:400">#!/usr/bin/env&nbsp;python</span><br /><span style="color:#3ad900;font-weight:400">"""<br />(c)&nbsp;Peter&nbsp;Van&nbsp;Eeckhoutte&nbsp;2009-2010<br />U{Peter&nbsp;Van&nbsp;Eeckhoutte&nbsp;-&nbsp;corelan.&lt;http://www.corelan.be:8800&gt;}<br /><br />peter.ve@corelan.be<br />corelanc0d3r<br /><br />$Date:&nbsp;2011-01-11&nbsp;12:20:33&nbsp;+0100&nbsp;(di,&nbsp;11&nbsp;jan&nbsp;2011)&nbsp;$&nbsp;<br />$Revision:&nbsp;61&nbsp;$<br /><br />"""</span><br />__VERSION__&nbsp;=&nbsp;<span style="color:#3ad900;font-weight:400">'2.0.13'</span><br />__DBG__&nbsp;=&nbsp;<span style="color:#3ad900;font-weight:400">'Immunity&nbsp;Debugger&nbsp;v1.73'</span><br /><span style="color:#333333;font-weight:400">import</span>&nbsp;immlib<br /><span style="color:#333333;font-weight:400">import</span>&nbsp;getopt<br /><span style="color:#333333;font-weight:400">import</span>&nbsp;immutils<br /><span style="color:#333333;font-weight:400">from</span>&nbsp;immutils&nbsp;<span style="color:#333333;font-weight:400">import</span>&nbsp;*<br /><span style="color:#333333;font-weight:400">import</span>&nbsp;struct<br /><span style="color:#333333;font-weight:400">import</span>&nbsp;binascii,&nbsp;re<br /><span style="color:#333333;font-weight:400">from</span>&nbsp;libstackanalyze&nbsp;<span style="color:#333333;font-weight:400">import</span>&nbsp;*<br /><span style="color:#333333;font-weight:400">import</span>&nbsp;urllib<br /><span style="color:#333333;font-weight:400">import</span>&nbsp;shutil<br /><span style="color:#333333;font-weight:400">import</span>&nbsp;sys<br /><span style="color:#333333;font-weight:400">import</span>&nbsp;time<br /><span style="color:#333333;font-weight:400">import</span>&nbsp;datetime<br /><br />DESC&nbsp;=&nbsp;<span style="color:#3ad900;font-weight:400">"corelanc0d3r's&nbsp;toolkit&nbsp;for&nbsp;exploit&nbsp;development.&nbsp;Warning&nbsp;:&nbsp;This&nbsp;is&nbsp;just&nbsp;a&nbsp;tool.&nbsp;It&nbsp;requires&nbsp;brains&nbsp;and&nbsp;creativity&nbsp;!"</span><br /><br /><span style="color:#3ad900;font-weight:400">"""<br />Global&nbsp;stuff<br />"""</span><br />g_modules=[]<br />g_mods=[]<br />g_naslrlist=[]<br /><br /><span style="color:#ff9d00;font-weight:700">def</span>&nbsp;usage(imm):<br />	imm.log(<span style="color:#3ad900;font-weight:400">""</span>)<br />	imm.log(<span style="color:#3ad900;font-weight:400">""</span>)<br />	imm.log(<span style="color:#3ad900;font-weight:400">"="</span>&nbsp;*&nbsp;<span style="color:#ff0044;font-weight:400">145</span>)<br />	imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;!pvefindaddr&nbsp;-&nbsp;PyCommand&nbsp;for&nbsp;%s&nbsp;-&nbsp;Current&nbsp;plugin&nbsp;version&nbsp;:&nbsp;%s&nbsp;"</span>&nbsp;%&nbsp;(__DBG__,__VERSION__))<br />	imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Written&nbsp;by&nbsp;Peter&nbsp;Van&nbsp;Eeckhoutte&nbsp;&nbsp;(aka&nbsp;corelanc0d3r)&nbsp;-&nbsp;http://www.corelan.be:8800"</span>)<br />	imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;http://redmine.corelan.be:8800&nbsp;-&nbsp;peter.ve@corelan.be"</span>)<br />	imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;&nbsp;&nbsp;&nbsp;|------------------------------------------------------------------|"</span>,highlight=<span style="color:#ff0044;font-weight:400">1</span>)<br />	imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;__&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;__&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|"</span>,highlight=<span style="color:#ff0044;font-weight:400">1</span>)<br />	imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;_________&nbsp;&nbsp;________&nbsp;&nbsp;/&nbsp;/___&nbsp;_____&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/&nbsp;/____&nbsp;&nbsp;____&nbsp;_____&nbsp;___&nbsp;&nbsp;|"</span>,highlight=<span style="color:#ff0044;font-weight:400">1</span>)<br />	imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;/&nbsp;___/&nbsp;__&nbsp;\/&nbsp;___/&nbsp;_&nbsp;\/&nbsp;/&nbsp;__&nbsp;`/&nbsp;__&nbsp;\&nbsp;&nbsp;&nbsp;/&nbsp;__/&nbsp;_&nbsp;\/&nbsp;__&nbsp;`/&nbsp;__&nbsp;`__&nbsp;\&nbsp;|"</span>,highlight=<span style="color:#ff0044;font-weight:400">1</span>)<br />	imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;/&nbsp;/__/&nbsp;/_/&nbsp;/&nbsp;/&nbsp;&nbsp;/&nbsp;&nbsp;__/&nbsp;/&nbsp;/_/&nbsp;/&nbsp;/&nbsp;/&nbsp;/&nbsp;&nbsp;/&nbsp;/_/&nbsp;&nbsp;__/&nbsp;/_/&nbsp;/&nbsp;/&nbsp;/&nbsp;/&nbsp;/&nbsp;/&nbsp;|"</span>,highlight=<span style="color:#ff0044;font-weight:400">1</span>)<br />	imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;\___/\____/_/&nbsp;&nbsp;&nbsp;\___/_/\__,_/_/&nbsp;/_/&nbsp;&nbsp;&nbsp;\__/\___/\__,_/_/&nbsp;/_/&nbsp;/_/&nbsp;&nbsp;|"</span>,highlight=<span style="color:#ff0044;font-weight:400">1</span>)<br />	imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|"</span>,highlight=<span style="color:#ff0044;font-weight:400">1</span>)<br />	imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;&nbsp;&nbsp;&nbsp;|------------------------------------------------------------------|"</span>,highlight=<span style="color:#ff0044;font-weight:400">1</span>)<br />	imm.log(<span style="color:#3ad900;font-weight:400">""</span>)<br />	imm.log(<span style="color:#3ad900;font-weight:400">"!pvefindaddr&nbsp;Usage"</span>)<br />	imm.log(<span style="color:#3ad900;font-weight:400">"------------------"</span>)<br />	imm.log(<span style="color:#3ad900;font-weight:400">""</span>)<br />	imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;&nbsp;&nbsp;!pvefindaddr&nbsp;&lt;operation&gt;&nbsp;[&lt;options&gt;]"</span>)<br />	imm.log(<span style="color:#3ad900;font-weight:400">""</span>)<br />	imm.log(<span style="color:#3ad900;font-weight:400">"Valid&nbsp;operations:"</span>)<br />	imm.log(<span style="color:#3ad900;font-weight:400">""</span>)<br />	imm.log(<span style="color:#3ad900;font-weight:400">"*&nbsp;update&nbsp;[get]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(Checks&nbsp;if&nbsp;an&nbsp;updated&nbsp;version&nbsp;of&nbsp;this&nbsp;plugin&nbsp;is&nbsp;available&nbsp;for&nbsp;download)"</span>)<br />	imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;If&nbsp;you&nbsp;specify&nbsp;the&nbsp;optional&nbsp;get&nbsp;parameter,&nbsp;the&nbsp;plugin&nbsp;will&nbsp;update&nbsp;itself"</span>)<br />	imm.log(<span style="color:#3ad900;font-weight:400">"*&nbsp;selfupdate&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(Does&nbsp;the&nbsp;same&nbsp;as&nbsp;'update&nbsp;get')"</span>)<br />	imm.log(<span style="color:#3ad900;font-weight:400">"*&nbsp;find&nbsp;bytes&nbsp;[-a&nbsp;access]&nbsp;[-l&nbsp;startaddress]&nbsp;[-t&nbsp;endaddress]&nbsp;[-m&nbsp;&lt;module&gt;]&nbsp;[-c]"</span>)<br />	imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(Finds&nbsp;all&nbsp;instances&nbsp;of&nbsp;a&nbsp;sequence&nbsp;of&nbsp;bytes&nbsp;in&nbsp;memory"</span>)<br />	imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;and&nbsp;shows&nbsp;some&nbsp;information&nbsp;about&nbsp;each&nbsp;location"</span>)<br />	imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;bytes&nbsp;to&nbsp;search&nbsp;for&nbsp;should&nbsp;be&nbsp;2&nbsp;char&nbsp;aligned,&nbsp;no&nbsp;spaces,&nbsp;no&nbsp;0x&nbsp;or&nbsp;\\x"</span>)<br />	imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;You&nbsp;can&nbsp;optionally&nbsp;filter&nbsp;on&nbsp;the&nbsp;access&nbsp;level&nbsp;for&nbsp;each&nbsp;location&nbsp;:"</span>)<br />	imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;r&nbsp;(read),&nbsp;w&nbsp;(write),&nbsp;x&nbsp;(executable)"</span>)<br />	imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rw&nbsp;(read&nbsp;and&nbsp;write),&nbsp;rx&nbsp;(read&nbsp;and&nbsp;executable),&nbsp;rwx&nbsp;and&nbsp;wx"</span>)<br />	imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Option&nbsp;-m&nbsp;takes&nbsp;precedence&nbsp;over&nbsp;-l&nbsp;and&nbsp;-t"</span>)<br />	imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Option&nbsp;-c&nbsp;:&nbsp;skip&nbsp;consecutive&nbsp;pointers"</span>)<br />	imm.log(<span style="color:#3ad900;font-weight:400">"*&nbsp;a&nbsp;[-m&nbsp;&lt;module&gt;]&nbsp;[-n]&nbsp;[-o]&nbsp;&nbsp;&nbsp;&nbsp;(look&nbsp;for&nbsp;add&nbsp;esp&nbsp;8/ret&nbsp;(pop&nbsp;pop&nbsp;ret&nbsp;alternative))&nbsp;-&nbsp;optionally&nbsp;specify&nbsp;module&nbsp;to&nbsp;filter&nbsp;on"</span>)<br />	imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Only&nbsp;addresses&nbsp;from&nbsp;non-safeseh&nbsp;and&nbsp;non-aslr&nbsp;modules&nbsp;will&nbsp;be&nbsp;listed"</span>)<br />	imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Option&nbsp;-n&nbsp;:&nbsp;don't&nbsp;show&nbsp;pointers&nbsp;that&nbsp;contain&nbsp;null&nbsp;bytes"</span>)<br />	imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Option&nbsp;-o&nbsp;:&nbsp;don't&nbsp;show&nbsp;pointers&nbsp;from&nbsp;modules&nbsp;in&nbsp;the&nbsp;Windows&nbsp;folder"</span>)<br />	imm.log(<span style="color:#3ad900;font-weight:400">"*&nbsp;p&nbsp;[-m&nbsp;&lt;module&gt;]&nbsp;[-r&nbsp;&lt;reg&gt;]&nbsp;[-n]&nbsp;[-o]"</span>)<br />	imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(look&nbsp;for&nbsp;pop&nbsp;pop&nbsp;ret)&nbsp;-&nbsp;optionally&nbsp;specify&nbsp;reg&nbsp;and&nbsp;module&nbsp;to&nbsp;filter&nbsp;on"</span>)<br />	imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Only&nbsp;addresses&nbsp;from&nbsp;non-safeseh&nbsp;protected&nbsp;modules/binaries&nbsp;will&nbsp;be&nbsp;listed"</span>)<br />	imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Unless&nbsp;you&nbsp;have&nbsp;specified&nbsp;a&nbsp;reg&nbsp;and&nbsp;module"</span>)<br />	imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Option&nbsp;-n&nbsp;:&nbsp;don't&nbsp;show&nbsp;pointers&nbsp;that&nbsp;contain&nbsp;null&nbsp;bytes"</span>)<br />	imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Option&nbsp;-o&nbsp;:&nbsp;don't&nbsp;show&nbsp;pointers&nbsp;from&nbsp;modules&nbsp;in&nbsp;the&nbsp;Windows&nbsp;folder"</span>)<br />	imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Output&nbsp;is&nbsp;written&nbsp;to&nbsp;file&nbsp;ppr.txt"</span>)<br />	imm.log(<span style="color:#3ad900;font-weight:400">"*&nbsp;p1&nbsp;[-m&nbsp;&lt;module&gt;]&nbsp;[-r&nbsp;&lt;reg&gt;]&nbsp;[-n]&nbsp;[-o]"</span>)<br />	imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(look&nbsp;for&nbsp;pop&nbsp;pop&nbsp;ret)&nbsp;-&nbsp;optionally&nbsp;specify&nbsp;reg&nbsp;and&nbsp;module&nbsp;to&nbsp;filter&nbsp;on"</span>)<br />	imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Only&nbsp;addresses&nbsp;from&nbsp;non-safeseh&nbsp;protected&nbsp;and&nbsp;non-aslr/non-fixup&nbsp;modules/binaries&nbsp;will&nbsp;be&nbsp;listed"</span>)<br />	imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Unless&nbsp;you&nbsp;have&nbsp;specified&nbsp;a&nbsp;reg&nbsp;and&nbsp;module"</span>)<br />	imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Option&nbsp;-n&nbsp;:&nbsp;don't&nbsp;show&nbsp;pointers&nbsp;that&nbsp;contain&nbsp;null&nbsp;bytes"</span>)<br />	imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Option&nbsp;-o&nbsp;:&nbsp;don't&nbsp;show&nbsp;pointers&nbsp;from&nbsp;modules&nbsp;in&nbsp;the&nbsp;Windows&nbsp;folder"</span>)<br />	imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Output&nbsp;is&nbsp;written&nbsp;to&nbsp;file&nbsp;ppr1.txt"</span>)<br />	imm.log(<span style="color:#3ad900;font-weight:400">"*&nbsp;p2&nbsp;[-m&nbsp;&lt;module&gt;]&nbsp;[-r&nbsp;&lt;reg&gt;]&nbsp;[-n]&nbsp;[-o]"</span>)<br />	imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(look&nbsp;for&nbsp;pop&nbsp;pop&nbsp;ret)&nbsp;-&nbsp;optionally&nbsp;specify&nbsp;reg&nbsp;and&nbsp;module&nbsp;to&nbsp;filter&nbsp;on"</span>)<br />	imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;This&nbsp;will&nbsp;perform&nbsp;a&nbsp;normal&nbsp;search&nbsp;for&nbsp;pop&nbsp;pop&nbsp;ret&nbsp;addresses&nbsp;(also&nbsp;in&nbsp;safeseh&nbsp;compiled&nbsp;modules"</span>)<br />	imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Option&nbsp;-n&nbsp;:&nbsp;don't&nbsp;show&nbsp;pointers&nbsp;that&nbsp;contain&nbsp;null&nbsp;bytes"</span>)<br />	imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Option&nbsp;-o&nbsp;:&nbsp;don't&nbsp;show&nbsp;pointers&nbsp;from&nbsp;modules&nbsp;in&nbsp;the&nbsp;Windows&nbsp;folder"</span>)<br />	imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Output&nbsp;is&nbsp;written&nbsp;to&nbsp;file&nbsp;ppr2.txt"</span>)<br />	imm.log(<span style="color:#3ad900;font-weight:400">"*&nbsp;xp&nbsp;[-m&nbsp;&lt;module&gt;]&nbsp;[-r&nbsp;&lt;reg&gt;]&nbsp;[-n]&nbsp;[-o]"</span>)<br />	imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(look&nbsp;for&nbsp;xor&nbsp;pop&nbsp;pop&nbsp;ret)&nbsp;-&nbsp;optionally&nbsp;specify&nbsp;reg&nbsp;and&nbsp;module&nbsp;to&nbsp;filter&nbsp;on"</span>)<br />	imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Only&nbsp;addresses&nbsp;from&nbsp;non-safeseh&nbsp;protected&nbsp;modules/binaries&nbsp;will&nbsp;be&nbsp;listed"</span>)<br />	imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Unless&nbsp;you&nbsp;have&nbsp;specified&nbsp;a&nbsp;reg&nbsp;and&nbsp;module"</span>)<br />	imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Option&nbsp;-n&nbsp;:&nbsp;don't&nbsp;show&nbsp;pointers&nbsp;that&nbsp;contain&nbsp;null&nbsp;bytes"</span>)<br />	imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Option&nbsp;-o&nbsp;:&nbsp;don't&nbsp;show&nbsp;pointers&nbsp;from&nbsp;modules&nbsp;in&nbsp;the&nbsp;Windows&nbsp;folder"</span>)<br />	imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Output&nbsp;is&nbsp;written&nbsp;to&nbsp;file&nbsp;xppr.txt"</span>)<br />	imm.log(<span style="color:#3ad900;font-weight:400">"*&nbsp;xp1&nbsp;[-m&nbsp;&lt;module&gt;]&nbsp;[-r&nbsp;&lt;reg&gt;]&nbsp;[-n]&nbsp;[-o]"</span>)<br />	imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(look&nbsp;for&nbsp;xor&nbsp;pop&nbsp;pop&nbsp;ret)&nbsp;-&nbsp;optionally&nbsp;specify&nbsp;reg&nbsp;and&nbsp;module&nbsp;to&nbsp;filter&nbsp;on"</span>)<br />	imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Only&nbsp;addresses&nbsp;from&nbsp;non-safeseh&nbsp;protected&nbsp;and&nbsp;non-aslr/non-fixup&nbsp;modules/binaries&nbsp;will&nbsp;be&nbsp;listed"</span>)<br />	imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Unless&nbsp;you&nbsp;have&nbsp;specified&nbsp;a&nbsp;reg&nbsp;and&nbsp;module"</span>)<br />	imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Option&nbsp;-n&nbsp;:&nbsp;don't&nbsp;show&nbsp;pointers&nbsp;that&nbsp;contain&nbsp;null&nbsp;bytes"</span>)<br />	imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Option&nbsp;-o&nbsp;:&nbsp;don't&nbsp;show&nbsp;pointers&nbsp;from&nbsp;modules&nbsp;in&nbsp;the&nbsp;Windows&nbsp;folder"</span>)<br />	imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Output&nbsp;is&nbsp;written&nbsp;to&nbsp;file&nbsp;xppr1.txt"</span>)<br />	imm.log(<span style="color:#3ad900;font-weight:400">"*&nbsp;xp2&nbsp;[-m&nbsp;&lt;module&gt;]&nbsp;[-r&nbsp;&lt;reg&gt;]&nbsp;[-n]&nbsp;[-o]"</span>)<br />	imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(look&nbsp;for&nbsp;xor&nbsp;pop&nbsp;pop&nbsp;ret)&nbsp;-&nbsp;optionally&nbsp;specify&nbsp;reg&nbsp;and&nbsp;module&nbsp;to&nbsp;filter&nbsp;on"</span>)<br />	imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;This&nbsp;will&nbsp;perform&nbsp;a&nbsp;normal&nbsp;search&nbsp;for&nbsp;pop&nbsp;pop&nbsp;ret&nbsp;addresses&nbsp;(also&nbsp;in&nbsp;safeseh&nbsp;compiled&nbsp;modules"</span>)<br />	imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Option&nbsp;-n&nbsp;:&nbsp;don't&nbsp;show&nbsp;pointers&nbsp;that&nbsp;contain&nbsp;null&nbsp;bytes"</span>)<br />	imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Option&nbsp;-o&nbsp;:&nbsp;don't&nbsp;show&nbsp;pointers&nbsp;from&nbsp;modules&nbsp;in&nbsp;the&nbsp;Windows&nbsp;folder"</span>)<br />	imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Output&nbsp;is&nbsp;written&nbsp;to&nbsp;file&nbsp;xppr2.txt"</span>)<br />	imm.log(<span style="color:#3ad900;font-weight:400">"*&nbsp;jseh&nbsp;[all]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(look&nbsp;for&nbsp;jmp/call&nbsp;dword&nbsp;ptr[ebp/esp+nn&nbsp;and&nbsp;ebp-nn]&nbsp;+&nbsp;add&nbsp;esp,8+ret)"</span>)<br />	imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Only&nbsp;addresses&nbsp;outside&nbsp;address&nbsp;range&nbsp;of&nbsp;modules&nbsp;will&nbsp;be&nbsp;listed"</span>)<br />	imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;unless&nbsp;parameter&nbsp;'all'&nbsp;is&nbsp;given.&nbsp;In&nbsp;that&nbsp;case,&nbsp;all&nbsp;addresses&nbsp;will&nbsp;be&nbsp;listed.&nbsp;TRY&nbsp;THIS&nbsp;ONE&nbsp;!"</span>)<br />	imm.log(<span style="color:#3ad900;font-weight:400">"*&nbsp;j&nbsp;-r&nbsp;&lt;reg&gt;&nbsp;[-m&nbsp;&lt;module&gt;]&nbsp;[-n]&nbsp;[-o]"</span>)<br />	imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(look&nbsp;for&nbsp;jmp&nbsp;&lt;reg&gt;,&nbsp;call&nbsp;&lt;reg&gt;,&nbsp;push&nbsp;&lt;reg&gt;+ret)&nbsp;(optionally&nbsp;filter&nbsp;on&nbsp;module)"</span>)<br />	imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;When&nbsp;option&nbsp;-r&nbsp;reg&nbsp;is&nbsp;not&nbsp;provide,&nbsp;the&nbsp;tool&nbsp;will&nbsp;search&nbsp;for&nbsp;jumps&nbsp;to&nbsp;ESP&nbsp;by&nbsp;default"</span>)<br />	imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Option&nbsp;-n&nbsp;:&nbsp;don't&nbsp;show&nbsp;pointers&nbsp;that&nbsp;contain&nbsp;null&nbsp;bytes"</span>)<br />	imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Option&nbsp;-o&nbsp;:&nbsp;don't&nbsp;show&nbsp;pointers&nbsp;from&nbsp;modules&nbsp;in&nbsp;the&nbsp;Windows&nbsp;folder"</span>)<br />	imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Output&nbsp;is&nbsp;written&nbsp;to&nbsp;log&nbsp;and&nbsp;to&nbsp;file&nbsp;j.txt"</span>)<br />	imm.log(<span style="color:#3ad900;font-weight:400">"*&nbsp;jp&nbsp;-r&nbsp;&lt;reg&gt;&nbsp;[-m&nbsp;&lt;module&gt;]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(look&nbsp;for&nbsp;jmp&nbsp;&lt;reg&gt;,&nbsp;call&nbsp;&lt;reg&gt;,&nbsp;push&nbsp;&lt;reg&gt;+ret)&nbsp;(optionally&nbsp;filter&nbsp;on&nbsp;module),"</span>)<br />	imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;and&nbsp;then&nbsp;looks&nbsp;for&nbsp;pointers&nbsp;to&nbsp;those&nbsp;addresses"</span>)<br />	imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Output&nbsp;is&nbsp;written&nbsp;to&nbsp;log&nbsp;and&nbsp;to&nbsp;file&nbsp;jp.txt.&nbsp;Note&nbsp;:&nbsp;this&nbsp;one&nbsp;can&nbsp;take&nbsp;a&nbsp;long&nbsp;time&nbsp;!"</span>)<br />	imm.log(<span style="color:#3ad900;font-weight:400">"*&nbsp;jo&nbsp;-r&nbsp;&lt;reg&gt;&nbsp;-l&nbsp;minoffset&nbsp;-t&nbsp;maxoffset&nbsp;[-m&nbsp;&lt;module&gt;]&nbsp;[-n]&nbsp;[-o]"</span>)<br />	imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(look&nbsp;for&nbsp;an&nbsp;address&nbsp;that&nbsp;will&nbsp;lead&nbsp;to&nbsp;jump&nbsp;to&nbsp;a&nbsp;register&nbsp;-&nbsp;or&nbsp;+&nbsp;offset&nbsp;)"</span>)<br />	imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Output&nbsp;is&nbsp;written&nbsp;to&nbsp;log&nbsp;and&nbsp;to&nbsp;file&nbsp;jo.txt"</span>);<br />	imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Option&nbsp;-n&nbsp;:&nbsp;don't&nbsp;show&nbsp;pointers&nbsp;that&nbsp;contain&nbsp;null&nbsp;bytes"</span>)<br />	imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Option&nbsp;-o&nbsp;:&nbsp;don't&nbsp;show&nbsp;pointers&nbsp;from&nbsp;modules&nbsp;in&nbsp;the&nbsp;Windows&nbsp;folder"</span>)<br />	imm.log(<span style="color:#3ad900;font-weight:400">"*&nbsp;fa&nbsp;[byte&nbsp;pattern]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(Find&nbsp;all&nbsp;locations&nbsp;that&nbsp;point&nbsp;to&nbsp;AAAA&nbsp;and&nbsp;then&nbsp;look&nbsp;for&nbsp;locations&nbsp;that&nbsp;point&nbsp;to&nbsp;these&nbsp;pointers)"</span>)<br />	imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;You&nbsp;can&nbsp;optionally&nbsp;specify&nbsp;your&nbsp;own&nbsp;search&nbsp;pattern&nbsp;(2&nbsp;or&nbsp;4&nbsp;bytes,&nbsp;each&nbsp;byte&nbsp;separated&nbsp;with&nbsp;spaces)"</span>)<br />	imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Output&nbsp;is&nbsp;written&nbsp;to&nbsp;log&nbsp;and&nbsp;to&nbsp;file&nbsp;fa.txt"</span>)<br />	imm.log(<span style="color:#3ad900;font-weight:400">"*&nbsp;fd&nbsp;[allownull]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Find&nbsp;readable&nbsp;memory&nbsp;address&nbsp;which,&nbsp;when&nbsp;multiplied&nbsp;by&nbsp;2,&nbsp;still&nbsp;points"</span>)<br />	imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;to&nbsp;a&nbsp;readable&nbsp;address.&nbsp;If&nbsp;parameter&nbsp;'allownull'&nbsp;is&nbsp;specified,&nbsp;addresses"</span>)<br />	imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;containing&nbsp;null&nbsp;bytes&nbsp;will&nbsp;be&nbsp;listed&nbsp;as&nbsp;well)"</span>)<br />	imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Warning&nbsp;:&nbsp;it&nbsp;might&nbsp;take&nbsp;a&nbsp;few&nbsp;days&nbsp;before&nbsp;this&nbsp;script&nbsp;completes&nbsp;the&nbsp;job&nbsp;!"</span>)<br />	imm.log(<span style="color:#3ad900;font-weight:400">"*&nbsp;pdep&nbsp;[-r&nbsp;&lt;reg&gt;]&nbsp;[-m&nbsp;&lt;module&gt;]&nbsp;[-n]&nbsp;[-o]"</span>)<br />	imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(look&nbsp;for&nbsp;dep&nbsp;bypass&nbsp;instructions&nbsp;such&nbsp;as&nbsp;pop&nbsp;pop&nbsp;pop&nbsp;esp&nbsp;ret)"</span>)<br />	imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;You&nbsp;can&nbsp;optionally&nbsp;specify&nbsp;reg&nbsp;and&nbsp;module&nbsp;to&nbsp;filter&nbsp;on"</span>)<br />	imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Option&nbsp;-n&nbsp;:&nbsp;don't&nbsp;show&nbsp;pointers&nbsp;that&nbsp;contain&nbsp;null&nbsp;bytes"</span>)<br />	imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Option&nbsp;-o&nbsp;:&nbsp;don't&nbsp;show&nbsp;pointers&nbsp;from&nbsp;modules&nbsp;in&nbsp;the&nbsp;Windows&nbsp;folder"</span>)<br />	imm.log(<span style="color:#3ad900;font-weight:400">"*&nbsp;depxp&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(List&nbsp;addresses&nbsp;that&nbsp;can&nbsp;be&nbsp;used&nbsp;to&nbsp;set&nbsp;up&nbsp;stack&nbsp;in&nbsp;order&nbsp;to&nbsp;disable&nbsp;DEP&nbsp;-&nbsp;until&nbsp;XP&nbsp;SP3"</span>)<br />	imm.log(<span style="color:#3ad900;font-weight:400">"*&nbsp;depwin2k3&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(List&nbsp;addresses&nbsp;that&nbsp;can&nbsp;be&nbsp;used&nbsp;to&nbsp;set&nbsp;up&nbsp;stack&nbsp;in&nbsp;order&nbsp;to&nbsp;disable&nbsp;DEP&nbsp;-&nbsp;Win2k3&nbsp;SP2"</span>)<br />	imm.log(<span style="color:#3ad900;font-weight:400">"*&nbsp;nosafeseh&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(List&nbsp;all&nbsp;modules&nbsp;that&nbsp;are&nbsp;not&nbsp;safeseh&nbsp;protected)"</span>)<br />	imm.log(<span style="color:#3ad900;font-weight:400">"*&nbsp;nosafesehaslr&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(List&nbsp;all&nbsp;modules&nbsp;that&nbsp;are&nbsp;not&nbsp;safeseh&nbsp;and&nbsp;not&nbsp;aslr&nbsp;protected)"</span>)<br />	imm.log(<span style="color:#3ad900;font-weight:400">"*&nbsp;noaslr&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(List&nbsp;all&nbsp;modules&nbsp;that&nbsp;are&nbsp;not&nbsp;aslr&nbsp;protected)"</span>)<br />	imm.log(<span style="color:#3ad900;font-weight:400">"*&nbsp;rop&nbsp;[-m&nbsp;&lt;module&gt;]&nbsp;[-f&nbsp;&lt;filter&gt;]&nbsp;[-n]&nbsp;[-o]&nbsp;[-i]&nbsp;[-r&nbsp;max_ret_value]&nbsp;[-s]&nbsp;[-d]&nbsp;[-c&nbsp;&lt;instruction&gt;]"</span>)<br />	imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(List&nbsp;possible&nbsp;ROP&nbsp;gadgets&nbsp;from&nbsp;non-ASLR&nbsp;protected&nbsp;modules.&nbsp;You&nbsp;can&nbsp;optionally&nbsp;filter)"</span>)<br />	imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Option&nbsp;-n&nbsp;:&nbsp;don't&nbsp;show&nbsp;pointers&nbsp;that&nbsp;contain&nbsp;null&nbsp;bytes"</span>)<br />	imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Option&nbsp;-o&nbsp;:&nbsp;don't&nbsp;show&nbsp;pointers&nbsp;from&nbsp;modules&nbsp;in&nbsp;the&nbsp;Windows&nbsp;folder"</span>)<br />	imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Option&nbsp;-i&nbsp;:&nbsp;don't&nbsp;show&nbsp;pointers&nbsp;from&nbsp;modules&nbsp;that&nbsp;have&nbsp;the&nbsp;Fixup&nbsp;flag&nbsp;set"</span>)<br />	imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Parameter&nbsp;-r&nbsp;allows&nbsp;you&nbsp;to&nbsp;specify&nbsp;the&nbsp;maximum&nbsp;RET&nbsp;offset&nbsp;to&nbsp;look&nbsp;for.&nbsp;Default&nbsp;value&nbsp;:&nbsp;32"</span>)<br />	imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Warning&nbsp;:&nbsp;if&nbsp;you&nbsp;don't&nbsp;specify&nbsp;a&nbsp;module&nbsp;and/or&nbsp;a&nbsp;lower&nbsp;RET&nbsp;offset,&nbsp;the&nbsp;process&nbsp;can&nbsp;take&nbsp;a&nbsp;very&nbsp;long&nbsp;time&nbsp;to&nbsp;complete"</span>)<br />	imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;-s&nbsp;option&nbsp;will&nbsp;split&nbsp;the&nbsp;rop&nbsp;output&nbsp;into&nbsp;a&nbsp;dedicated&nbsp;file&nbsp;per&nbsp;module.&nbsp;The&nbsp;filenames&nbsp;will&nbsp;include"</span>)<br />	imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;modulename,&nbsp;version,&nbsp;OS&nbsp;type&nbsp;and&nbsp;OS&nbsp;version"</span>)<br />	imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Option&nbsp;-d&nbsp;will&nbsp;search&nbsp;deeper&nbsp;(longer)&nbsp;and&nbsp;might&nbsp;find&nbsp;possibly&nbsp;interesting&nbsp;gadgets"</span>)<br />	imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Option&nbsp;-c&nbsp;+&nbsp;instruction&nbsp;(no&nbsp;quotes,&nbsp;spaces&nbsp;are&nbsp;allowed)&nbsp;will&nbsp;allow&nbsp;you&nbsp;to&nbsp;look&nbsp;for&nbsp;gadgets&nbsp;ending&nbsp;with&nbsp;this&nbsp;instruction"</span>)<br />	imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;as&nbsp;opposed	to&nbsp;looking&nbsp;for&nbsp;gadgets&nbsp;ending&nbsp;with&nbsp;RET"</span>)<br />	imm.log(<span style="color:#3ad900;font-weight:400">"*&nbsp;jrop&nbsp;[-m&nbsp;&lt;module&gt;]&nbsp;[-n]&nbsp;[-o]&nbsp;(List&nbsp;possible&nbsp;jumpboards&nbsp;to&nbsp;your&nbsp;ROP&nbsp;chain&nbsp;at&nbsp;ESP,&nbsp;from&nbsp;non-ASLR&nbsp;protected&nbsp;modules.&nbsp;You&nbsp;can&nbsp;optionally&nbsp;filter)"</span>)<br />	imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;on&nbsp;a&nbsp;specific&nbsp;module.&nbsp;Output&nbsp;will&nbsp;be&nbsp;written&nbsp;to&nbsp;jrop.txt"</span>)<br />	imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Obviously,&nbsp;you&nbsp;can&nbsp;just&nbsp;use&nbsp;a&nbsp;RET&nbsp;or&nbsp;directly&nbsp;jump&nbsp;to&nbsp;a&nbsp;ROP&nbsp;gadget&nbsp;as&nbsp;well"</span>)<br />	imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Option&nbsp;-n&nbsp;:&nbsp;don't&nbsp;show&nbsp;pointers&nbsp;that&nbsp;contain&nbsp;null&nbsp;bytes"</span>)<br />	imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Option&nbsp;-o&nbsp;:&nbsp;don't&nbsp;show&nbsp;pointers&nbsp;from&nbsp;modules&nbsp;in&nbsp;the&nbsp;Windows&nbsp;folder"</span>)<br />	imm.log(<span style="color:#3ad900;font-weight:400">"*&nbsp;ropcall&nbsp;[-m&nbsp;&lt;module&gt;]&nbsp;[-n]&nbsp;&nbsp;&nbsp;(Find&nbsp;all&nbsp;'call'&nbsp;to&nbsp;DEP&nbsp;bypass&nbsp;functions&nbsp;in&nbsp;loaded&nbsp;non-ASLR&nbsp;modules)"</span>)<br />	imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Option&nbsp;-m&nbsp;&lt;modulename&gt;&nbsp;will&nbsp;allow&nbsp;you&nbsp;to&nbsp;filter&nbsp;on&nbsp;modulename"</span>)<br />	imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Option&nbsp;-n&nbsp;will&nbsp;ignore&nbsp;all&nbsp;pointers&nbsp;that&nbsp;have&nbsp;null&nbsp;bytes"</span>)<br />	imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Output&nbsp;will&nbsp;be&nbsp;written&nbsp;to&nbsp;ropcall.txt"</span>)<br />	imm.log(<span style="color:#3ad900;font-weight:400">"*&nbsp;findmsp&nbsp;[pat]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(Find&nbsp;metasploit&nbsp;pattern&nbsp;offset&nbsp;in&nbsp;registers&nbsp;and/or&nbsp;sehchain&nbsp;records"</span>)<br />	imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;[pat]&nbsp;is&nbsp;specified&nbsp;(4&nbsp;ascii&nbsp;characters&nbsp;or&nbsp;10&nbsp;byte&nbsp;address&nbsp;(0xDEADBEEF)),&nbsp;then&nbsp;only&nbsp;offset&nbsp;search&nbsp;is&nbsp;performed"</span>)<br />	imm.log(<span style="color:#3ad900;font-weight:400">"*&nbsp;pattern_create&nbsp;size&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(Create&nbsp;Metasploit&nbsp;pattern&nbsp;of&nbsp;&lt;size&gt;&nbsp;characters)"</span>)<br />	imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pattern&nbsp;is&nbsp;displayed&nbsp;in&nbsp;log&nbsp;window&nbsp;and&nbsp;written&nbsp;to&nbsp;file&nbsp;mspattern.txt"</span>)<br />	imm.log(<span style="color:#3ad900;font-weight:400">"*&nbsp;pattern_offset&nbsp;bytes&nbsp;[size]&nbsp;&nbsp;(Find&nbsp;bytes&nbsp;(4&nbsp;ascii&nbsp;characters&nbsp;or&nbsp;10&nbsp;byte&nbsp;address&nbsp;(0xDEADBEEF)&nbsp;in&nbsp;Metasploit&nbsp;pattern&nbsp;with&nbsp;length&nbsp;&lt;size&gt;)"</span>)<br />	imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;If&nbsp;no&nbsp;size&nbsp;is&nbsp;given,&nbsp;a&nbsp;default&nbsp;pattern&nbsp;of&nbsp;8000&nbsp;characters&nbsp;is&nbsp;used"</span>)<br />	imm.log(<span style="color:#3ad900;font-weight:400">"*&nbsp;suggest&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(Suggest&nbsp;a&nbsp;payload&nbsp;based&nbsp;on&nbsp;metasploit&nbsp;offset&nbsp;and&nbsp;whether&nbsp;this&nbsp;is&nbsp;direct&nbsp;RET&nbsp;or&nbsp;SEH&nbsp;overwrite)"</span>)<br />	imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Note&nbsp;:&nbsp;this&nbsp;is&nbsp;just&nbsp;a&nbsp;suggestion&nbsp;and&nbsp;may&nbsp;not&nbsp;work&nbsp;-&nbsp;you&nbsp;need&nbsp;to&nbsp;look&nbsp;at&nbsp;registers&nbsp;yourself"</span>)<br />	imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;you&nbsp;want&nbsp;to&nbsp;be&nbsp;sure.&nbsp;Also,&nbsp;it&nbsp;will&nbsp;not&nbsp;suggest&nbsp;anything&nbsp;useful&nbsp;when&nbsp;HW&nbsp;DEP/NX&nbsp;is&nbsp;enabled"</span>)<br />	imm.log(<span style="color:#3ad900;font-weight:400">"*&nbsp;compare&nbsp;file&nbsp;[address]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(Compares&nbsp;memory&nbsp;contents&nbsp;with&nbsp;bytes&nbsp;in&nbsp;a&nbsp;given&nbsp;file.&nbsp;If&nbsp;no&nbsp;address&nbsp;is&nbsp;given,&nbsp;"</span>)<br />	imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;the&nbsp;script&nbsp;will&nbsp;try&nbsp;to&nbsp;locate&nbsp;the&nbsp;bytes&nbsp;in&nbsp;memory&nbsp;by&nbsp;looking&nbsp;at&nbsp;the&nbsp;first&nbsp;8&nbsp;bytes"</span>)<br />	imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;All&nbsp;output&nbsp;will&nbsp;be&nbsp;written&nbsp;to&nbsp;file&nbsp;compare.txt"</span>)<br />	imm.log(<span style="color:#3ad900;font-weight:400">"*&nbsp;assemble&nbsp;&lt;instructions&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(Convert&nbsp;instructions&nbsp;to&nbsp;opcode.&nbsp;Separate&nbsp;multiple&nbsp;instructions&nbsp;with&nbsp;#"</span>)<br />	imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;You&nbsp;can&nbsp;automatically&nbsp;invoke&nbsp;the&nbsp;encoder&nbsp;on&nbsp;the&nbsp;produced&nbsp;opcodes&nbsp;by&nbsp;adding&nbsp;the&nbsp;"</span>)<br />	imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;encode&nbsp;ascii&nbsp;&nbsp;(or&nbsp;encode&nbsp;alphanum)&nbsp;statement&nbsp;after&nbsp;the&nbsp;instructions"</span>)<br />	imm.log(<span style="color:#3ad900;font-weight:400">"*&nbsp;offset&nbsp;addr1&nbsp;addr2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(Calculates&nbsp;number&nbsp;of&nbsp;bytes&nbsp;between&nbsp;two&nbsp;addresses&nbsp;(use&nbsp;this&nbsp;if&nbsp;you&nbsp;are&nbsp;too&nbsp;lazy&nbsp;to&nbsp;use&nbsp;calc)"</span>)<br />	imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Note&nbsp;:&nbsp;you&nbsp;can&nbsp;also&nbsp;replace&nbsp;one&nbsp;(or&nbsp;both)&nbsp;addresses&nbsp;with&nbsp;a&nbsp;register"</span>)<br />	imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Finally,&nbsp;you&nbsp;can&nbsp;also&nbsp;specify&nbsp;8&nbsp;bytes&nbsp;as&nbsp;addr2.&nbsp;The&nbsp;tool&nbsp;will&nbsp;then&nbsp;search&nbsp;for&nbsp;these&nbsp;8&nbsp;bytes"</span>)<br />	imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;and&nbsp;calculate&nbsp;the&nbsp;offset&nbsp;between&nbsp;addr1&nbsp;and&nbsp;the&nbsp;memory&nbsp;location&nbsp;of&nbsp;these&nbsp;8&nbsp;bytes"</span>)<br />	imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Format&nbsp;to&nbsp;specify&nbsp;these&nbsp;8&nbsp;bytes&nbsp;:&nbsp;use&nbsp;16&nbsp;characters,&nbsp;no&nbsp;spaces,&nbsp;and&nbsp;don't&nbsp;start&nbsp;with&nbsp;0x"</span>)<br />	imm.log(<span style="color:#3ad900;font-weight:400">"*&nbsp;encode&nbsp;type&nbsp;bytes&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(Custom&nbsp;encoder)"</span>);<br />	imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Valid&nbsp;type(s)&nbsp;are&nbsp;:&nbsp;ascii&nbsp;and&nbsp;alphanum"</span>)<br />	imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Format&nbsp;to&nbsp;specify&nbsp;the&nbsp;bytes&nbsp;:&nbsp;just&nbsp;type&nbsp;the&nbsp;bytes&nbsp;(2&nbsp;byte&nbsp;aligned)&nbsp;right&nbsp;after&nbsp;each&nbsp;other"</span>)<br />	imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Example&nbsp;:&nbsp;!pvefindaddr&nbsp;encode&nbsp;ascii&nbsp;81C253040000FFE2"</span>)<br />	imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Alternatively,&nbsp;you&nbsp;can&nbsp;also&nbsp;specify&nbsp;the&nbsp;filename&nbsp;that&nbsp;contains&nbsp;the&nbsp;bytes&nbsp;to&nbsp;be&nbsp;encoded"</span>)<br />	imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Example&nbsp;:&nbsp;!pvefindaddr&nbsp;encode&nbsp;c:\\tmp\\original.bin"</span>)<br />	imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;You&nbsp;can&nbsp;also&nbsp;specify&nbsp;the&nbsp;address&nbsp;in&nbsp;memory&nbsp;that&nbsp;contains&nbsp;the&nbsp;bytes&nbsp;to&nbsp;be&nbsp;encoded"</span>)<br />	imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(start	with&nbsp;-b)&nbsp;followed&nbsp;by&nbsp;the&nbsp;number&nbsp;of&nbsp;bytes,&nbsp;optionally&nbsp;followed&nbsp;by&nbsp;bad&nbsp;chars"</span>)<br />	imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Example&nbsp;:&nbsp;!pvefindaddr&nbsp;encode&nbsp;-b0012FC01&nbsp;78"</span>)<br />	imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Finally,&nbsp;you&nbsp;can&nbsp;put&nbsp;a&nbsp;list&nbsp;of&nbsp;badchars&nbsp;(same&nbsp;format&nbsp;as&nbsp;bytes)&nbsp;after&nbsp;the&nbsp;bytecode,&nbsp;filename"</span>)<br />	imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;or&nbsp;size&nbsp;(if&nbsp;memory&nbsp;address&nbsp;is&nbsp;used)"</span>)<br />	imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;All&nbsp;output&nbsp;will&nbsp;be&nbsp;written&nbsp;to&nbsp;file&nbsp;encoded.txt"</span>)<br />	imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;*&nbsp;info&nbsp;address&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(Will&nbsp;show&nbsp;some&nbsp;information&nbsp;about&nbsp;a&nbsp;given&nbsp;address&nbsp;within&nbsp;the&nbsp;context&nbsp;of&nbsp;the&nbsp;loaded&nbsp;application)"</span>)<br />	imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;*&nbsp;modules&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(Will&nbsp;show&nbsp;table&nbsp;with&nbsp;all&nbsp;loaded&nbsp;modules&nbsp;+&nbsp;some&nbsp;additional&nbsp;info&nbsp;(safeseh,&nbsp;aslr,&nbsp;etc))"</span>)<br />	imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;*&nbsp;functions&nbsp;[ALL]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(Will&nbsp;output&nbsp;pointers&nbsp;to&nbsp;all&nbsp;functions&nbsp;in&nbsp;the&nbsp;application.)&nbsp;If&nbsp;you&nbsp;specify&nbsp;ALL&nbsp;(optional&nbsp;parameter)"</span>)<br />	imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;then&nbsp;functions&nbsp;from&nbsp;loaded&nbsp;os&nbsp;dll's&nbsp;will&nbsp;be&nbsp;shown&nbsp;as&nbsp;well.&nbsp;Output&nbsp;is&nbsp;written&nbsp;to&nbsp;functions.txt"</span>)<br />	imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;*&nbsp;omelet&nbsp;-f&nbsp;shellcodefile&nbsp;[-s&nbsp;size]&nbsp;[-t&nbsp;tag]"</span>)<br />	imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(Will&nbsp;create&nbsp;eggs-to-omelet&nbsp;hunter&nbsp;and&nbsp;egg&nbsp;blocks&nbsp;based&nbsp;on&nbsp;raw&nbsp;shellcode&nbsp;written&nbsp;to&nbsp;file&nbsp;shellcodefile"</span>)<br />	imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;You&nbsp;can&nbsp;optionally&nbsp;set&nbsp;the&nbsp;size&nbsp;per&nbsp;block&nbsp;(max&nbsp;123&nbsp;bytes,&nbsp;default&nbsp;value)&nbsp;and&nbsp;change&nbsp;the&nbsp;tag,"</span>)<br />	imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;which&nbsp;is&nbsp;set&nbsp;to&nbsp;303077&nbsp;by&nbsp;default.&nbsp;If&nbsp;you&nbsp;want&nbsp;to&nbsp;specify&nbsp;your&nbsp;own,&nbsp;make&nbsp;sure&nbsp;it's&nbsp;6&nbsp;chars"</span>)<br />	imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;*&nbsp;filecompare&nbsp;-f&nbsp;\"file1,file2,...filen\""</span>)<br />	imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(Will&nbsp;compare&nbsp;the&nbsp;output&nbsp;of&nbsp;files&nbsp;created&nbsp;with&nbsp;pvefindaddr&nbsp;and&nbsp;display&nbsp;the&nbsp;pointers&nbsp;that&nbsp;have&nbsp;been&nbsp;found"</span>)<br />	imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;in&nbsp;all&nbsp;of&nbsp;the&nbsp;files.)&nbsp;Make&nbsp;sure&nbsp;to&nbsp;use&nbsp;files&nbsp;that&nbsp;are&nbsp;created&nbsp;with&nbsp;the&nbsp;same&nbsp;version&nbsp;of&nbsp;pvefindaddr"</span>)<br />	imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;and&nbsp;contain&nbsp;the&nbsp;output&nbsp;of&nbsp;the&nbsp;same&nbsp;pvefindaddr&nbsp;command"</span>)<br />	imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Put&nbsp;all&nbsp;filenames&nbsp;between&nbsp;one&nbsp;set&nbsp;of&nbsp;double&nbsp;quotes,&nbsp;and&nbsp;separate&nbsp;files&nbsp;with&nbsp;comma's&nbsp;!"</span>)<br />	imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Output&nbsp;will&nbsp;be&nbsp;written&nbsp;to&nbsp;filecompare.txt"</span>)<br />	imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;*&nbsp;retslide&nbsp;[-r&nbsp;&lt;value&gt;]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(Will&nbsp;search&nbsp;for&nbsp;ret&nbsp;slides&nbsp;-&nbsp;pointers&nbsp;that&nbsp;consist&nbsp;of&nbsp;4&nbsp;times&nbsp;the&nbsp;same&nbsp;bytes&nbsp;(or&nbsp;2&nbsp;time&nbsp;2)&nbsp;and&nbsp;point&nbsp;to&nbsp;RET)"</span>)<br />	imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;option&nbsp;-r&nbsp;can&nbsp;be&nbsp;used&nbsp;to&nbsp;override&nbsp;the&nbsp;default&nbsp;value&nbsp;of&nbsp;32&nbsp;as&nbsp;maximum&nbsp;offset&nbsp;for&nbsp;RET&nbsp;instruction&nbsp;to&nbsp;search&nbsp;for"</span>)<br />	imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;*&nbsp;dump&nbsp;-f&nbsp;&lt;filename&gt;&nbsp;-s&nbsp;&lt;startaddress&gt;&nbsp;-e&nbsp;&lt;endaddress&gt;&nbsp;|&nbsp;-l&nbsp;&lt;nr&nbsp;of&nbsp;bytes&gt;"</span>)<br />	imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(Will&nbsp;dump&nbsp;&lt;nr_of_bytes&gt;&nbsp;(decimal&nbsp;integer)&nbsp;from&nbsp;a&nbsp;given&nbsp;memory&nbsp;address&nbsp;(at&nbsp;&lt;startaddress&gt;)&nbsp;to&nbsp;file&nbsp;&lt;filename&gt;"</span>)<br />	imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Alternatively&nbsp;you&nbsp;can&nbsp;specify&nbsp;an&nbsp;endaddress&nbsp;(-e)&nbsp;instead&nbsp;of&nbsp;specifying&nbsp;the&nbsp;nr&nbsp;of&nbsp;bytes"</span>)	<br />	imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Example&nbsp;:&nbsp;!pvefindaddr&nbsp;dump&nbsp;c:\\temp\\process.bin&nbsp;0012FA83&nbsp;120"</span>)<br />	imm.log(<span style="color:#3ad900;font-weight:400">""</span>)<br />	imm.log(<span style="color:#3ad900;font-weight:400">"="</span>&nbsp;*&nbsp;<span style="color:#ff0044;font-weight:400">145</span>)<br />	imm.log(<span style="color:#3ad900;font-weight:400">""</span>)<br />	imm.log(<span style="color:#3ad900;font-weight:400">""</span>)<br /><br /><br /><span style="color:#3ad900;font-weight:400">"""<br />Function&nbsp;to&nbsp;check&nbsp;if&nbsp;updated&nbsp;version&nbsp;of&nbsp;pvefindaddr&nbsp;is&nbsp;available<br />"""</span><br /><span style="color:#ff9d00;font-weight:700">def</span>&nbsp;findupdate(imm):<br />	versionurl=<span style="color:#3ad900;font-weight:400">"http://redmine.corelan.be:8800/projects/pvefindaddr/repository/raw/release/version.txt"</span><br />	filename=<span style="color:#3ad900;font-weight:400">"pvefindaddrlatest.txt"</span><br />	imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;----------------------------------------------------------------------------------------"</span>)<br />	imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;Current&nbsp;version&nbsp;:&nbsp;%s&nbsp;"</span>&nbsp;%&nbsp;__VERSION__)<br />	newversion=__VERSION__<br />	<span style="color:#ff9d00;font-weight:700">try</span>:<br />		imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;Downloading&nbsp;version&nbsp;information,&nbsp;please&nbsp;wait..."</span>)<br />		imm.updateLog()<br />		u&nbsp;=&nbsp;urllib.urlretrieve(versionurl)<br />		imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;&nbsp;&nbsp;-&gt;&nbsp;Download&nbsp;complete&nbsp;-&nbsp;now&nbsp;comparing&nbsp;version&nbsp;information"</span>)<br />		imm.updateLog()<br />		shutil.move(u[<span style="color:#ff0044;font-weight:400">0</span>],filename)<br />		<span style="color:#ff9d00;font-weight:700">try</span>:<br />			fd&nbsp;=&nbsp;<span style="color:#ff9d00;font-weight:700">open</span>(filename,<span style="color:#3ad900;font-weight:400">"rb"</span>)<br />			content&nbsp;=&nbsp;fd.readlines()<br />			fd.close()<br />			<span style="color:#ff9d00;font-weight:700">for</span>&nbsp;eachLine&nbsp;<span style="color:#ff9d00;font-weight:700">in</span>&nbsp;content:<br />				newversion=eachLine<br />				newversion=newversion.replace(<span style="color:#3ad900;font-weight:400">'\n'</span>,<span style="color:#3ad900;font-weight:400">''</span>)<br />				<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;(newversion&nbsp;!=&nbsp;__VERSION__):<br />					imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;[!]&nbsp;Latest&nbsp;published&nbsp;(stable)&nbsp;version&nbsp;of&nbsp;this&nbsp;PyCommand&nbsp;is&nbsp;:&nbsp;v%s"</span>&nbsp;%&nbsp;newversion,highlight=<span style="color:#ff0044;font-weight:400">1</span>)<br />					<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;(__VERSION__.find(<span style="color:#3ad900;font-weight:400">"dev"</span>)&nbsp;&gt;&nbsp;-<span style="color:#ff0044;font-weight:400">1</span>):<br />						imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;**&nbsp;You&nbsp;are&nbsp;running&nbsp;a&nbsp;svn/development&nbsp;version&nbsp;of&nbsp;pvefindaddr&nbsp;**&nbsp;"</span>)<br />						imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Use&nbsp;&nbsp;'svn&nbsp;co&nbsp;http://svn.corelan.be:8800/svn/pvefindaddr'&nbsp;"</span>)<br />						imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(or&nbsp;use&nbsp;a&nbsp;GUI&nbsp;client&nbsp;such&nbsp;as&nbsp;TortoiseSVN)"</span>)<br />						imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;to&nbsp;update&nbsp;this&nbsp;version"</span>)<br />					<span style="color:#ff9d00;font-weight:700">else</span>:<br />						imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Go&nbsp;to&nbsp;http://redmine.corelan.be:8800/projects/pvefindaddr"</span>)<br />						imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;to&nbsp;download&nbsp;the&nbsp;latest&nbsp;version&nbsp;of&nbsp;this&nbsp;script"</span>)<br />						imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;[!]&nbsp;You&nbsp;can&nbsp;also&nbsp;run&nbsp;'!pvefindaddr&nbsp;update&nbsp;get'&nbsp;&nbsp;to&nbsp;download&nbsp;the&nbsp;updated&nbsp;version&nbsp;"</span>)<br />				<span style="color:#ff9d00;font-weight:700">else</span>:<br />					imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;&nbsp;&nbsp;-&gt;&nbsp;You&nbsp;are&nbsp;running&nbsp;the&nbsp;latest&nbsp;version&nbsp;!"</span>)<br />		<span style="color:#ff9d00;font-weight:700">except</span>:<br />			imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;***&nbsp;Unable&nbsp;to&nbsp;verify&nbsp;latest&nbsp;version&nbsp;***"</span>)<br />	<span style="color:#ff9d00;font-weight:700">except</span>:<br />		imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;***&nbsp;Unable&nbsp;to&nbsp;download&nbsp;version&nbsp;information,&nbsp;try&nbsp;again&nbsp;later&nbsp;***"</span>)<br />	imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;----------------------------------------------------------------------------------------"</span>)<br /><br /><br /><span style="color:#ff9d00;font-weight:700">def</span>&nbsp;getupdate(imm,<span style="color:#ff9d00;font-weight:700">type</span>):<br />	versionurl&nbsp;=&nbsp;<span style="color:#3ad900;font-weight:400">"http://redmine.corelan.be:8800/projects/pvefindaddr/repository/raw/release/version.txt"</span><br />	filename&nbsp;=&nbsp;<span style="color:#3ad900;font-weight:400">"pvefindaddrlatest.txt"</span><br />	fversion&nbsp;=&nbsp;<span style="color:#3ad900;font-weight:400">"v1.73"</span><br />	<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;__DBG__.find(<span style="color:#3ad900;font-weight:400">"1.8"</span>)&nbsp;&gt;&nbsp;-<span style="color:#ff0044;font-weight:400">1</span>:<br />		fversion&nbsp;=&nbsp;<span style="color:#3ad900;font-weight:400">"v1.8"</span>&nbsp;<br />	appurl=<span style="color:#3ad900;font-weight:400">"http://redmine.corelan.be:8800/projects/pvefindaddr/repository/raw/"</span>&nbsp;+&nbsp;<span style="color:#ff9d00;font-weight:700">type</span>&nbsp;+&nbsp;<span style="color:#3ad900;font-weight:400">"/"</span>&nbsp;+&nbsp;fversion&nbsp;+&nbsp;<span style="color:#3ad900;font-weight:400">"/pvefindaddr.py"</span><br />	appfilename=<span style="color:#3ad900;font-weight:400">"pvefindaddr.tmp"</span><br />	imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;----------------------------------------------------------------------------------------"</span>)<br />	imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;Current&nbsp;version&nbsp;:&nbsp;%s&nbsp;(%s)&nbsp;"</span>&nbsp;%&nbsp;(__VERSION__,<span style="color:#ff9d00;font-weight:700">type</span>))<br />	newversion=__VERSION__<br />	<span style="color:#ff9d00;font-weight:700">try</span>:<br />		imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;Downloading&nbsp;version&nbsp;information,&nbsp;please&nbsp;wait..."</span>)<br />		imm.updateLog()<br />		u&nbsp;=&nbsp;urllib.urlretrieve(versionurl)<br />		imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;&nbsp;&nbsp;-&gt;&nbsp;Download&nbsp;complete&nbsp;-&nbsp;now&nbsp;comparing&nbsp;version&nbsp;information"</span>)<br />		imm.updateLog()<br />		shutil.move(u[<span style="color:#ff0044;font-weight:400">0</span>],filename)<br />		<span style="color:#ff9d00;font-weight:700">try</span>:<br />			fd&nbsp;=&nbsp;<span style="color:#ff9d00;font-weight:700">open</span>(filename,<span style="color:#3ad900;font-weight:400">"rb"</span>)<br />			content&nbsp;=&nbsp;fd.readlines()<br />			fd.close()<br />			<span style="color:#ff9d00;font-weight:700">for</span>&nbsp;eachLine&nbsp;<span style="color:#ff9d00;font-weight:700">in</span>&nbsp;content:<br />				&nbsp;newversion=eachLine<br />			newversion=newversion.replace(<span style="color:#3ad900;font-weight:400">'\n'</span>,<span style="color:#3ad900;font-weight:400">''</span>)<br />			<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;(newversion&nbsp;!=&nbsp;__VERSION__)&nbsp;<span style="color:#ff9d00;font-weight:700">and</span>&nbsp;(__VERSION__.find(<span style="color:#3ad900;font-weight:400">"dev"</span>)&nbsp;==&nbsp;-<span style="color:#ff0044;font-weight:400">1</span>):<br />				imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;&nbsp;&nbsp;-&gt;&nbsp;Downloading&nbsp;version&nbsp;%s"</span>&nbsp;%&nbsp;newversion)<br />				imm.updateLog()<br />				<span style="color:#ff9d00;font-weight:700">try</span>:<br />					u&nbsp;=&nbsp;urllib.urlretrieve(appurl)<br />					shutil.move(u[<span style="color:#ff0044;font-weight:400">0</span>],appfilename)<br />					fd&nbsp;=&nbsp;<span style="color:#ff9d00;font-weight:700">open</span>(appfilename,<span style="color:#3ad900;font-weight:400">"rb"</span>)<br />					content&nbsp;=&nbsp;fd.readlines()<br />					fd.close()<br />					linecnt=<span style="color:#ff0044;font-weight:400">0</span><br />					<span style="color:#ff9d00;font-weight:700">for</span>&nbsp;eachLine&nbsp;<span style="color:#ff9d00;font-weight:700">in</span>&nbsp;content:<br />						&nbsp;linecnt=linecnt+<span style="color:#ff0044;font-weight:400">1</span><br />					imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;&nbsp;&nbsp;-&gt;&nbsp;Download&nbsp;complete,&nbsp;read&nbsp;%d&nbsp;lines"</span>&nbsp;%&nbsp;linecnt)<br />					<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;linecnt&nbsp;&gt;&nbsp;<span style="color:#ff0044;font-weight:400">1000</span>:<br />						imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;&nbsp;&nbsp;-&gt;&nbsp;Putting&nbsp;updated&nbsp;file&nbsp;in&nbsp;place"</span>)<br />						apptargetfile=<span style="color:#3ad900;font-weight:400">".\\PyCommands\\pvefindaddr.py"</span><br />						FILE=<span style="color:#ff9d00;font-weight:700">open</span>(apptargetfile,<span style="color:#3ad900;font-weight:400">"w"</span>)<br />						<span style="color:#ff9d00;font-weight:700">for</span>&nbsp;eachLine&nbsp;<span style="color:#ff9d00;font-weight:700">in</span>&nbsp;content:<br />							FILE.write(eachLine)<br />						FILE.close()<br />						imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;&nbsp;&nbsp;-&gt;&nbsp;Update&nbsp;complete"</span>)<br />					<span style="color:#ff9d00;font-weight:700">else</span>:<br />						imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;&nbsp;&nbsp;**&nbsp;Downloaded&nbsp;file&nbsp;is&nbsp;smaller&nbsp;than&nbsp;expected&nbsp;-&nbsp;skipping&nbsp;update&nbsp;for&nbsp;now"</span>,highlight=<span style="color:#ff0044;font-weight:400">1</span>)<br />				<span style="color:#ff9d00;font-weight:700">except</span>:<br />					imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;***&nbsp;Unable&nbsp;to&nbsp;update&nbsp;to&nbsp;version&nbsp;%s"</span>&nbsp;%&nbsp;newversion)<br />			<span style="color:#ff9d00;font-weight:700">else</span>:<br />				<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;(__VERSION__.find(<span style="color:#3ad900;font-weight:400">"dev"</span>)==-<span style="color:#ff0044;font-weight:400">1</span>):<br />					imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;&nbsp;&nbsp;-&gt;&nbsp;You&nbsp;are&nbsp;running&nbsp;the&nbsp;latest&nbsp;version&nbsp;!"</span>)<br />				<span style="color:#ff9d00;font-weight:700">else</span>:<br />					imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;&nbsp;&nbsp;-&gt;&nbsp;Downloading&nbsp;svn&nbsp;(development&nbsp;version)"</span>)<br />					imm.updateLog()<br />					<span style="color:#ff9d00;font-weight:700">try</span>:<br />					&nbsp;&nbsp;u&nbsp;=&nbsp;urllib.urlretrieve(appurl)<br />					&nbsp;&nbsp;shutil.move(u[<span style="color:#ff0044;font-weight:400">0</span>],appfilename)<br />					&nbsp;&nbsp;fd&nbsp;=&nbsp;<span style="color:#ff9d00;font-weight:700">open</span>(appfilename,<span style="color:#3ad900;font-weight:400">"rb"</span>)<br />					&nbsp;&nbsp;content&nbsp;=&nbsp;fd.readlines()<br />					&nbsp;&nbsp;fd.close()<br />					&nbsp;&nbsp;linecnt=<span style="color:#ff0044;font-weight:400">0</span><br />					&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">for</span>&nbsp;eachLine&nbsp;<span style="color:#ff9d00;font-weight:700">in</span>&nbsp;content:<br />						&nbsp;linecnt=linecnt+<span style="color:#ff0044;font-weight:400">1</span><br />					&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;&nbsp;&nbsp;-&gt;&nbsp;Download&nbsp;complete,&nbsp;read&nbsp;%d&nbsp;lines"</span>&nbsp;%&nbsp;linecnt)<br />					&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;linecnt&nbsp;&gt;&nbsp;<span style="color:#ff0044;font-weight:400">1000</span>:<br />						imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;&nbsp;&nbsp;-&gt;&nbsp;Putting&nbsp;updated&nbsp;file&nbsp;in&nbsp;place"</span>)<br />						apptargetfile=<span style="color:#3ad900;font-weight:400">".\\PyCommands\\pvefindaddr.py"</span><br />						FILE=<span style="color:#ff9d00;font-weight:700">open</span>(apptargetfile,<span style="color:#3ad900;font-weight:400">"w"</span>)<br />						<span style="color:#ff9d00;font-weight:700">for</span>&nbsp;eachLine&nbsp;<span style="color:#ff9d00;font-weight:700">in</span>&nbsp;content:<br />							FILE.write(eachLine)<br />						FILE.close()<br />						imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;&nbsp;&nbsp;-&gt;&nbsp;Update&nbsp;complete"</span>)<br />					&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">else</span>:<br />						imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;&nbsp;&nbsp;**&nbsp;Downloaded&nbsp;file&nbsp;is&nbsp;smaller&nbsp;than&nbsp;expected&nbsp;-&nbsp;skipping&nbsp;update&nbsp;for&nbsp;now&nbsp;**&nbsp;"</span>,highlight=<span style="color:#ff0044;font-weight:400">1</span>)						<br />					<span style="color:#ff9d00;font-weight:700">except</span>:<br />					&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;***&nbsp;Unable&nbsp;to&nbsp;update&nbsp;development&nbsp;version"</span>)<br />		<span style="color:#ff9d00;font-weight:700">except</span>:<br />			imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;***&nbsp;Unable&nbsp;to&nbsp;verify&nbsp;latest&nbsp;version&nbsp;***"</span>)<br />	<span style="color:#ff9d00;font-weight:700">except</span>:<br />		imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;***&nbsp;Unable&nbsp;to&nbsp;download&nbsp;version&nbsp;information,&nbsp;try&nbsp;again&nbsp;later&nbsp;***"</span>)<br />	imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;----------------------------------------------------------------------------------------"</span>)<br /><br />	<br /><span style="color:#3ad900;font-weight:400">"""<br />Function&nbsp;to&nbsp;dump&nbsp;stuff&nbsp;from&nbsp;memory&nbsp;to&nbsp;file<br />"""</span><br />		<br /><span style="color:#ff9d00;font-weight:700">def</span>&nbsp;dodump(args):<br />	imm&nbsp;=&nbsp;immlib.Debugger()<br />	cnt=<span style="color:#ff0044;font-weight:400">1</span><br />	filename=<span style="color:#3ad900;font-weight:400">""</span><br />	startaddress=<span style="color:#3ad900;font-weight:400">""</span><br />	endaddress=<span style="color:#3ad900;font-weight:400">""</span><br />	startloc=<span style="color:#ff0044;font-weight:400">0</span><br />	endloc=<span style="color:#ff0044;font-weight:400">0</span><br />	nrofbytes=<span style="color:#ff0044;font-weight:400">0</span><br />	<span style="color:#ff9d00;font-weight:700">while</span>&nbsp;cnt&nbsp;&lt;&nbsp;<span style="color:#ff9d00;font-weight:700">len</span>(args):<br />		<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;args[cnt]==<span style="color:#3ad900;font-weight:400">'-f'</span>:<br />			<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;cnt&nbsp;&lt;&nbsp;(<span style="color:#ff9d00;font-weight:700">len</span>(args)-<span style="color:#ff0044;font-weight:400">1</span>):<br />				filename=args[cnt+<span style="color:#ff0044;font-weight:400">1</span>]<br />		<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;args[cnt]==<span style="color:#3ad900;font-weight:400">'-s'</span>:<br />			<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;cnt&nbsp;&lt;&nbsp;(<span style="color:#ff9d00;font-weight:700">len</span>(args)-<span style="color:#ff0044;font-weight:400">1</span>):<br />				startaddress=args[cnt+<span style="color:#ff0044;font-weight:400">1</span>]<br />		<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;args[cnt]==<span style="color:#3ad900;font-weight:400">'-l'</span>:<br />			<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;cnt&nbsp;&lt;&nbsp;(<span style="color:#ff9d00;font-weight:700">len</span>(args)-<span style="color:#ff0044;font-weight:400">1</span>):<br />				nrofbytes=<span style="color:#ff9d00;font-weight:700">int</span>(args[cnt+<span style="color:#ff0044;font-weight:400">1</span>])<br />		<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;args[cnt]==<span style="color:#3ad900;font-weight:400">'-e'</span>:<br />			<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;cnt&nbsp;&lt;&nbsp;(<span style="color:#ff9d00;font-weight:700">len</span>(args)-<span style="color:#ff0044;font-weight:400">1</span>):<br />				endaddress&nbsp;=&nbsp;args[cnt+<span style="color:#ff0044;font-weight:400">1</span>]<br />		cnt=cnt+<span style="color:#ff0044;font-weight:400">1</span><br />	<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;(filename==<span style="color:#3ad900;font-weight:400">""</span>&nbsp;<span style="color:#ff9d00;font-weight:700">or</span>&nbsp;startaddress==<span style="color:#3ad900;font-weight:400">""</span>&nbsp;<span style="color:#ff9d00;font-weight:700">or</span>&nbsp;(nrofbytes==<span style="color:#ff0044;font-weight:400">0</span>&nbsp;<span style="color:#ff9d00;font-weight:700">and</span>&nbsp;endaddress==<span style="color:#3ad900;font-weight:400">""</span>)):<br />		imm.log(<span style="color:#3ad900;font-weight:400">"Invalid&nbsp;arguments"</span>)<br />		<span style="color:#ff9d00;font-weight:700">return</span>&nbsp;<span style="color:#3ad900;font-weight:400">"Invalid&nbsp;arguments"</span><br />	imm.updateLog()<br />	startaddress=startaddress.replace(<span style="color:#3ad900;font-weight:400">'0x'</span>,<span style="color:#3ad900;font-weight:400">''</span>)<br />	startaddress=startaddress.replace(<span style="color:#3ad900;font-weight:400">'0X'</span>,<span style="color:#3ad900;font-weight:400">''</span>)<br />	startloc=addresstoint(startaddress)<br />	endaddress=endaddress.replace(<span style="color:#3ad900;font-weight:400">'0x'</span>,<span style="color:#3ad900;font-weight:400">''</span>)<br />	endaddress=endaddress.replace(<span style="color:#3ad900;font-weight:400">'0X'</span>,<span style="color:#3ad900;font-weight:400">''</span>)<br />	<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;endaddress&nbsp;!=&nbsp;<span style="color:#3ad900;font-weight:400">""</span>:<br />		endloc=addresstoint(endaddress)<br />	<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;endloc&nbsp;==&nbsp;<span style="color:#ff0044;font-weight:400">0</span>:<br />		endloc&nbsp;=&nbsp;startloc&nbsp;+&nbsp;nrofbytes<br />		endaddress&nbsp;=&nbsp;tohex(endloc)<br />	<span style="color:#ff9d00;font-weight:700">else</span>:<br />		nrofbytes&nbsp;=&nbsp;endloc&nbsp;-&nbsp;startloc<br />	imm.log(<span style="color:#3ad900;font-weight:400">"Reading&nbsp;%d&nbsp;bytes&nbsp;(from&nbsp;%s&nbsp;to&nbsp;%s)..."</span>&nbsp;%&nbsp;(nrofbytes,startaddress,endaddress))		<br />	bytes=<span style="color:#3ad900;font-weight:400">""</span><br />	cnt=<span style="color:#ff0044;font-weight:400">0</span><br />	<span style="color:#ff9d00;font-weight:700">while</span>&nbsp;cnt&lt;nrofbytes:<br />		<span style="color:#ff9d00;font-weight:700">try</span>:<br />			memchar&nbsp;=&nbsp;imm.readMemory(startloc+cnt,<span style="color:#ff0044;font-weight:400">1</span>)<br />			bytes=bytes+memchar<br />			cnt=cnt+<span style="color:#ff0044;font-weight:400">1</span><br />		<span style="color:#ff9d00;font-weight:700">except</span>:<br />			cnt=cnt+<span style="color:#ff0044;font-weight:400">1</span><br />			<span style="color:#ff9d00;font-weight:700">pass</span><br />	imm.log(<span style="color:#3ad900;font-weight:400">"Writing&nbsp;bytes&nbsp;to&nbsp;file&nbsp;%s"</span>&nbsp;%&nbsp;(filename))<br />	<span style="color:#ff9d00;font-weight:700">try</span>:<br />		FILE=<span style="color:#ff9d00;font-weight:700">open</span>(filename,<span style="color:#3ad900;font-weight:400">"wb"</span>)<br />		FILE.write(bytes)<br />		FILE.close()<br />		imm.log(<span style="color:#3ad900;font-weight:400">"Done"</span>)<br />	<span style="color:#ff9d00;font-weight:700">except</span>:<br />		imm.log(<span style="color:#3ad900;font-weight:400">"Unable&nbsp;to&nbsp;write&nbsp;bytes&nbsp;to&nbsp;file"</span>)<br />	<span style="color:#ff9d00;font-weight:700">return</span>&nbsp;<span style="color:#3ad900;font-weight:400">"Done"</span><br /><br /><br /><br /><span style="color:#3ad900;font-weight:400">"""<br />Function&nbsp;to&nbsp;guess&nbsp;start&nbsp;of&nbsp;a&nbsp;long&nbsp;string&nbsp;(AAAA&nbsp;or&nbsp;something&nbsp;like&nbsp;that)<br />"""</span><br /><span style="color:#ff9d00;font-weight:700">def</span>&nbsp;guessstart(asciivalue,<span style="color:#ff9d00;font-weight:700">type</span>):<br />	imm&nbsp;=&nbsp;immlib.Debugger()<br />	<span style="color:#0088ff;font-weight:400">#did&nbsp;we&nbsp;overwrite&nbsp;EIP&nbsp;or&nbsp;seh&nbsp;chain&nbsp;?</span><br />	<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;<span style="color:#ff9d00;font-weight:700">type</span>==<span style="color:#ff0044;font-weight:400">1</span>:<br />		<span style="color:#0088ff;font-weight:400">#EIP&nbsp;overwritten</span><br />		regs&nbsp;=&nbsp;imm.getRegs()<br />		<span style="color:#ff9d00;font-weight:700">for</span>&nbsp;reg&nbsp;<span style="color:#ff9d00;font-weight:700">in</span>&nbsp;regs:<br />			<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;reg.upper()&nbsp;==&nbsp;<span style="color:#3ad900;font-weight:400">"EIP"</span>:<br />				<span style="color:#0088ff;font-weight:400">#in&nbsp;most&nbsp;cases,&nbsp;ESP&nbsp;now&nbsp;points&nbsp;at&nbsp;location&nbsp;right&nbsp;after&nbsp;direct&nbsp;RET&nbsp;was&nbsp;overwritten</span><br />				startloc=regs[<span style="color:#3ad900;font-weight:400">"ESP"</span>]<br />				imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;&nbsp;&nbsp;Trying&nbsp;to&nbsp;guess&nbsp;the&nbsp;startlocation&nbsp;of&nbsp;the&nbsp;buffer&nbsp;with&nbsp;%s's&nbsp;"</span>&nbsp;%&nbsp;asciivalue)<br />				imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;&nbsp;&nbsp;Please&nbsp;wait,&nbsp;this&nbsp;may&nbsp;take&nbsp;a&nbsp;long&nbsp;time..."</span>)<br />				imm.updateLog()<br />				counter=<span style="color:#ff0044;font-weight:400">8</span><br />				found=<span style="color:#ff0044;font-weight:400">0</span><br />				matchnull=<span style="color:#ff0044;font-weight:400">0</span><br />				<span style="color:#ff9d00;font-weight:700">try</span>:<br />					<span style="color:#ff9d00;font-weight:700">while</span>&nbsp;found&nbsp;==&nbsp;<span style="color:#ff0044;font-weight:400">0</span>:<br />						memchar&nbsp;=&nbsp;imm.readMemory(startloc-counter,<span style="color:#ff0044;font-weight:400">4</span>)<br />						<span style="color:#0088ff;font-weight:400">#only&nbsp;react&nbsp;if&nbsp;2&nbsp;out&nbsp;of&nbsp;4&nbsp;bytes&nbsp;don't&nbsp;match&nbsp;and&nbsp;ignore&nbsp;(but&nbsp;count)&nbsp;null&nbsp;bytes</span><br />						match=<span style="color:#ff0044;font-weight:400">0</span><br />						bytecnt=<span style="color:#ff0044;font-weight:400">0</span><br />						<span style="color:#ff9d00;font-weight:700">for</span>&nbsp;mybyte&nbsp;<span style="color:#ff9d00;font-weight:700">in</span>&nbsp;memchar:<br />							<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;(mybyte&nbsp;==&nbsp;asciivalue[bytecnt]&nbsp;<span style="color:#ff9d00;font-weight:700">or</span>&nbsp;<span style="color:#ff9d00;font-weight:700">hex</span>(<span style="color:#ff9d00;font-weight:700">ord</span>(mybyte))==<span style="color:#3ad900;font-weight:400">"0x0"</span>):<br />								match=match+<span style="color:#ff0044;font-weight:400">1</span><br />								<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;<span style="color:#ff9d00;font-weight:700">hex</span>(<span style="color:#ff9d00;font-weight:700">ord</span>(mybyte))&nbsp;==&nbsp;<span style="color:#3ad900;font-weight:400">"0x0"</span>:<br />									matchnull=matchnull+<span style="color:#ff0044;font-weight:400">1</span><br />							bytecnt=bytecnt+<span style="color:#ff0044;font-weight:400">1</span><br />						<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;(match&nbsp;&lt;&nbsp;<span style="color:#ff0044;font-weight:400">3</span>):<br />							found=<span style="color:#ff0044;font-weight:400">1</span><br />							imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;&nbsp;&nbsp;Start&nbsp;of&nbsp;string&nbsp;may&nbsp;have&nbsp;be&nbsp;found&nbsp;at&nbsp;%s&nbsp;"</span>&nbsp;%&nbsp;tohex(startloc-counter+match),address=startloc-counter+match,highlight=<span style="color:#ff0044;font-weight:400">1</span>)<br />							curloc=startloc-counter<br />							offs=startloc-curloc-<span style="color:#ff0044;font-weight:400">8</span>-match<br />							imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;&nbsp;&nbsp;That&nbsp;means&nbsp;that&nbsp;EIP&nbsp;may&nbsp;have&nbsp;been&nbsp;overwritten&nbsp;after&nbsp;about&nbsp;%d&nbsp;bytes&nbsp;(more&nbsp;or&nbsp;less&nbsp;-&nbsp;I&nbsp;could&nbsp;be&nbsp;wrong&nbsp;!)"</span>&nbsp;%&nbsp;offs)<br />							imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;&nbsp;&nbsp;(including&nbsp;%d&nbsp;null&nbsp;bytes)"</span>&nbsp;%&nbsp;matchnull)<br />							imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;&nbsp;&nbsp;Again,&nbsp;this&nbsp;is&nbsp;just&nbsp;a&nbsp;guess&nbsp;-&nbsp;try&nbsp;using&nbsp;a&nbsp;Metasploit&nbsp;pattern&nbsp;instead&nbsp;of&nbsp;%s"</span>&nbsp;%&nbsp;asciivalue)<br />						counter=counter+<span style="color:#ff0044;font-weight:400">4</span><br />				<span style="color:#ff9d00;font-weight:700">except</span>:<br />					imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;&nbsp;&nbsp;Quit&nbsp;searching&nbsp;(access&nbsp;violation&nbsp;at&nbsp;%s)"</span>&nbsp;%&nbsp;tohex(startloc))<br />	<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;<span style="color:#ff9d00;font-weight:700">type</span>==<span style="color:#ff0044;font-weight:400">2</span>:<br />		imm.updateLog()<br />		thissehchain=imm.getSehChain()<br />		nrofentries=<span style="color:#ff0044;font-weight:400">0</span><br />		<span style="color:#ff9d00;font-weight:700">for</span>&nbsp;chainentry&nbsp;<span style="color:#ff9d00;font-weight:700">in</span>&nbsp;thissehchain:<br />			imm.updateLog()<br />			sehvalue=tohex(chainentry[<span style="color:#ff0044;font-weight:400">1</span>])<br />			hex1=sehvalue[<span style="color:#ff0044;font-weight:400">6</span>]+sehvalue[<span style="color:#ff0044;font-weight:400">7</span>]<br />			hex2=sehvalue[<span style="color:#ff0044;font-weight:400">4</span>]+sehvalue[<span style="color:#ff0044;font-weight:400">5</span>]<br />			hex3=sehvalue[<span style="color:#ff0044;font-weight:400">2</span>]+sehvalue[<span style="color:#ff0044;font-weight:400">3</span>]<br />			hex4=sehvalue[<span style="color:#ff0044;font-weight:400">0</span>]+sehvalue[<span style="color:#ff0044;font-weight:400">1</span>]<br />			sehasciivalue=toascii(imm,hex1)+toascii(imm,hex2)+toascii(imm,hex3)+toascii(imm,hex4)<br />			<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;(sehasciivalue&nbsp;==&nbsp;asciivalue):<br />				startloc=chainentry[<span style="color:#ff0044;font-weight:400">0</span>]<br />				imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;&nbsp;&nbsp;Trying&nbsp;to&nbsp;guess&nbsp;the&nbsp;startlocation&nbsp;of&nbsp;the&nbsp;buffer&nbsp;with&nbsp;%s's&nbsp;"</span>&nbsp;%&nbsp;asciivalue)<br />				imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;&nbsp;&nbsp;Please&nbsp;wait,&nbsp;this&nbsp;may&nbsp;take&nbsp;a&nbsp;long&nbsp;time..."</span>)<br />				imm.updateLog()<br />				counter=<span style="color:#ff0044;font-weight:400">8</span><br />				found=<span style="color:#ff0044;font-weight:400">0</span><br />				matchnull=<span style="color:#ff0044;font-weight:400">0</span><br />				<span style="color:#ff9d00;font-weight:700">try</span>:<br />					<span style="color:#ff9d00;font-weight:700">while</span>&nbsp;found&nbsp;==&nbsp;<span style="color:#ff0044;font-weight:400">0</span>:<br />						memchar&nbsp;=&nbsp;imm.readMemory(startloc-counter,<span style="color:#ff0044;font-weight:400">4</span>)<br />						<span style="color:#0088ff;font-weight:400">#only&nbsp;react&nbsp;if&nbsp;2&nbsp;out&nbsp;of&nbsp;4&nbsp;bytes&nbsp;don't&nbsp;match&nbsp;and&nbsp;ignore&nbsp;(but&nbsp;count)&nbsp;null&nbsp;bytes</span><br />						match=<span style="color:#ff0044;font-weight:400">0</span><br />						bytecnt=<span style="color:#ff0044;font-weight:400">0</span><br />						<span style="color:#ff9d00;font-weight:700">for</span>&nbsp;mybyte&nbsp;<span style="color:#ff9d00;font-weight:700">in</span>&nbsp;memchar:<br />							&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;(mybyte&nbsp;==&nbsp;asciivalue[bytecnt]&nbsp;<span style="color:#ff9d00;font-weight:700">or</span>&nbsp;<span style="color:#ff9d00;font-weight:700">hex</span>(<span style="color:#ff9d00;font-weight:700">ord</span>(mybyte))==<span style="color:#3ad900;font-weight:400">"0x0"</span>):<br />								match=match+<span style="color:#ff0044;font-weight:400">1</span><br />								<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;<span style="color:#ff9d00;font-weight:700">hex</span>(<span style="color:#ff9d00;font-weight:700">ord</span>(mybyte))&nbsp;==&nbsp;<span style="color:#3ad900;font-weight:400">"0x0"</span>:<br />										matchnull=matchnull+<span style="color:#ff0044;font-weight:400">1</span><br />							&nbsp;bytecnt=bytecnt+<span style="color:#ff0044;font-weight:400">1</span><br />						<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;(match&nbsp;&lt;&nbsp;<span style="color:#ff0044;font-weight:400">3</span>):<br />							found=<span style="color:#ff0044;font-weight:400">1</span><br />							imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;&nbsp;&nbsp;Start&nbsp;of&nbsp;string&nbsp;may&nbsp;have&nbsp;be&nbsp;found&nbsp;at&nbsp;%s&nbsp;"</span>&nbsp;%&nbsp;tohex(startloc-counter+match+<span style="color:#ff0044;font-weight:400">8</span>),address=startloc-counter+match+<span style="color:#ff0044;font-weight:400">8</span>,highlight=<span style="color:#ff0044;font-weight:400">1</span>)<br />							curloc=startloc-counter+<span style="color:#ff0044;font-weight:400">8</span><br />							offs=startloc-curloc-match<br />							imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;&nbsp;&nbsp;That&nbsp;means&nbsp;that&nbsp;SEH&nbsp;may&nbsp;have&nbsp;been&nbsp;overwritten&nbsp;after&nbsp;about&nbsp;%d&nbsp;bytes&nbsp;(more&nbsp;or&nbsp;less&nbsp;-&nbsp;I&nbsp;could&nbsp;be&nbsp;wrong&nbsp;!)"</span>&nbsp;%&nbsp;offs)<br />							imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;&nbsp;&nbsp;(including&nbsp;%d&nbsp;null&nbsp;bytes...&nbsp;)"</span>&nbsp;%&nbsp;matchnull)<br />							imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;&nbsp;&nbsp;Again,&nbsp;this&nbsp;is&nbsp;just&nbsp;a&nbsp;guess&nbsp;-&nbsp;try&nbsp;using&nbsp;a&nbsp;Metasploit&nbsp;pattern&nbsp;instead&nbsp;of&nbsp;%s"</span>&nbsp;%&nbsp;asciivalue)<br />						counter=counter+<span style="color:#ff0044;font-weight:400">4</span><br />				<span style="color:#ff9d00;font-weight:700">except</span>:<br />					imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;&nbsp;&nbsp;Quit&nbsp;searching&nbsp;(access&nbsp;violation&nbsp;at&nbsp;%s)"</span>&nbsp;%&nbsp;tohex(startloc))<br /><br /><span style="color:#3ad900;font-weight:400">"""<br />Function&nbsp;to&nbsp;build&nbsp;table&nbsp;with&nbsp;all&nbsp;modules&nbsp;and&nbsp;safeseh&nbsp;/&nbsp;aslr&nbsp;/&nbsp;...&nbsp;info<br />"""</span><br /><span style="color:#ff9d00;font-weight:700">def</span>&nbsp;moduleinfo():<br />	imm&nbsp;=&nbsp;immlib.Debugger()<br />	imm.log(<span style="color:#3ad900;font-weight:400">"**&nbsp;[+]&nbsp;Gathering&nbsp;executable&nbsp;/&nbsp;loaded&nbsp;module&nbsp;info,&nbsp;please&nbsp;wait..."</span>)<br />	<span style="color:#ff9d00;font-weight:700">global</span>&nbsp;g_modules<br />	g_modules=[]<br />	allmodules=imm.getAllModules()<br />	<span style="color:#ff9d00;font-weight:700">global</span>&nbsp;g_mods<br />	g_mods=allmodules<br />	<span style="color:#ff9d00;font-weight:700">global</span>&nbsp;g_nsafelist<br />	g_nsafelist=[]<br />	<span style="color:#ff9d00;font-weight:700">for</span>&nbsp;key&nbsp;<span style="color:#ff9d00;font-weight:700">in</span>&nbsp;allmodules.keys():<br />		issafeseh=<span style="color:#ff0044;font-weight:400">1</span><br />		isaslr=<span style="color:#ff0044;font-weight:400">1</span><br />		isnx=<span style="color:#ff0044;font-weight:400">1</span><br />		rebased=<span style="color:#ff0044;font-weight:400">0</span><br />		mod=imm.getModule(key)<br />		mzbase=mod.getBaseAddress()<br />		mzrebase=mod.getFixupbase()<br />		mzsize=mod.getSize()<br />		mversion=mod.getVersion()<br />		mversion=mversion.replace(<span style="color:#3ad900;font-weight:400">",&nbsp;"</span>,<span style="color:#3ad900;font-weight:400">"."</span>)<br />		mversionfields=mversion.split(<span style="color:#3ad900;font-weight:400">'('</span>)<br />		mversion=mversionfields[<span style="color:#ff0044;font-weight:400">0</span>].replace(<span style="color:#3ad900;font-weight:400">"&nbsp;"</span>,<span style="color:#3ad900;font-weight:400">""</span>)<br />		<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;mversion==<span style="color:#3ad900;font-weight:400">""</span>:<br />			mversion=<span style="color:#3ad900;font-weight:400">"-1.0-"</span><br />		path=mod.getPath()<br />		osmod=mod.getIssystemdll()<br />		<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;osmod==<span style="color:#ff0044;font-weight:400">0</span>:<br />			<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;path.upper().find(<span style="color:#3ad900;font-weight:400">"WINDOWS"</span>)&nbsp;&gt;&nbsp;-<span style="color:#ff0044;font-weight:400">1</span>:<br />				osmod=<span style="color:#ff0044;font-weight:400">1</span><br />		mztop=mzbase+mzsize<br />		<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;mzbase&nbsp;&gt;&nbsp;<span style="color:#ff0044;font-weight:400">0</span>:<br />			peoffset=struct.unpack(<span style="color:#3ad900;font-weight:400">'&lt;L'</span>,imm.readMemory(mzbase+<span style="color:#ff0044;font-weight:400">0x3c</span>,<span style="color:#ff0044;font-weight:400">4</span>))[<span style="color:#ff0044;font-weight:400">0</span>]<br />			pebase=mzbase+peoffset<br />			flags=struct.unpack(<span style="color:#3ad900;font-weight:400">'&lt;H'</span>,imm.readMemory(pebase+<span style="color:#ff0044;font-weight:400">0x5e</span>,<span style="color:#ff0044;font-weight:400">2</span>))[<span style="color:#ff0044;font-weight:400">0</span>]<br />			numberofentries=struct.unpack(<span style="color:#3ad900;font-weight:400">'&lt;L'</span>,imm.readMemory(pebase+<span style="color:#ff0044;font-weight:400">0x74</span>,<span style="color:#ff0044;font-weight:400">4</span>))[<span style="color:#ff0044;font-weight:400">0</span>]<br />			<span style="color:#0088ff;font-weight:400">#safeseh&nbsp;?</span><br />			<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;(flags&amp;<span style="color:#ff0044;font-weight:400">0x400</span>)!=<span style="color:#ff0044;font-weight:400">0</span>:<br />				issafeseh=<span style="color:#ff0044;font-weight:400">1</span><br />			<span style="color:#ff9d00;font-weight:700">else</span>:<br />				<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;numberofentries&gt;<span style="color:#ff0044;font-weight:400">10</span>:<br />					sectionaddress,sectionsize=struct.unpack(<span style="color:#3ad900;font-weight:400">'&lt;LL'</span>,imm.readMemory(pebase+<span style="color:#ff0044;font-weight:400">0x78</span>+<span style="color:#ff0044;font-weight:400">8</span>*<span style="color:#ff0044;font-weight:400">10</span>,<span style="color:#ff0044;font-weight:400">8</span>))<br />					sectionaddress+=mzbase<br />					data=struct.unpack(<span style="color:#3ad900;font-weight:400">'&lt;L'</span>,imm.readMemory(sectionaddress,<span style="color:#ff0044;font-weight:400">4</span>))[<span style="color:#ff0044;font-weight:400">0</span>]<br />					condition=(sectionsize!=<span style="color:#ff0044;font-weight:400">0</span>)&nbsp;<span style="color:#ff9d00;font-weight:700">and</span>&nbsp;((sectionsize==<span style="color:#ff0044;font-weight:400">0x40</span>)&nbsp;<span style="color:#ff9d00;font-weight:700">or</span>&nbsp;(sectionsize==data))<br />					<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;condition==<span style="color:#ff0044;font-weight:400">False</span>:<br />						issafeseh=<span style="color:#ff0044;font-weight:400">0</span><br />						g_nsafelist.append(key)<br />					<span style="color:#ff9d00;font-weight:700">else</span>:<br />						sehlistaddress,sehlistsize=struct.unpack(<span style="color:#3ad900;font-weight:400">'&lt;LL'</span>,imm.readMemory(sectionaddress+<span style="color:#ff0044;font-weight:400">0x40</span>,<span style="color:#ff0044;font-weight:400">8</span>))<br />						<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;sehlistaddress!=<span style="color:#ff0044;font-weight:400">0</span>&nbsp;<span style="color:#ff9d00;font-weight:700">and</span>&nbsp;sehlistsize!=<span style="color:#ff0044;font-weight:400">0</span>:<br />							issafeseh=<span style="color:#ff0044;font-weight:400">1</span><br />			<span style="color:#0088ff;font-weight:400">#aslr</span><br />			<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;(flags&amp;<span style="color:#ff0044;font-weight:400">0x0040</span>)==<span style="color:#ff0044;font-weight:400">0</span>:&nbsp;&nbsp;<span style="color:#0088ff;font-weight:400">#&nbsp;'IMAGE_DLL_CHARACTERISTICS_DYNAMIC_BASE</span><br />				isaslr=<span style="color:#ff0044;font-weight:400">0</span><br />			<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;(flags&amp;<span style="color:#ff0044;font-weight:400">0x0100</span>)==<span style="color:#ff0044;font-weight:400">0</span>:<br />				isnx=<span style="color:#ff0044;font-weight:400">0</span><br />			<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;mzrebase&nbsp;&lt;&gt;&nbsp;mzbase:<br />				rebased=<span style="color:#ff0044;font-weight:400">1</span><br />			<span style="color:#0088ff;font-weight:400">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;3&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;4&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;5&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;6&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;7&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;8&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;9&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;10</span><br />			curmod=key+<span style="color:#3ad900;font-weight:400">'\t'</span>+path+<span style="color:#3ad900;font-weight:400">'\t'</span>+<span style="color:#ff9d00;font-weight:700">str</span>(mzbase)+<span style="color:#3ad900;font-weight:400">'\t'</span>+<span style="color:#ff9d00;font-weight:700">str</span>(mzsize)+<span style="color:#3ad900;font-weight:400">'\t'</span>+<span style="color:#ff9d00;font-weight:700">str</span>(mztop)+<span style="color:#3ad900;font-weight:400">'\t'</span>+<span style="color:#ff9d00;font-weight:700">str</span>(issafeseh)+<span style="color:#3ad900;font-weight:400">'\t'</span>+<span style="color:#ff9d00;font-weight:700">str</span>(isaslr)+<span style="color:#3ad900;font-weight:400">'\t'</span>+<span style="color:#ff9d00;font-weight:700">str</span>(isnx)+<span style="color:#3ad900;font-weight:400">'\t'</span>+<span style="color:#ff9d00;font-weight:700">str</span>(rebased)+<span style="color:#3ad900;font-weight:400">'\t'</span>+<span style="color:#ff9d00;font-weight:700">str</span>(mversion)+<span style="color:#3ad900;font-weight:400">'\t'</span>+<span style="color:#ff9d00;font-weight:700">str</span>(osmod)<br />			g_modules.append(curmod)<br />		imm.updateLog()<br />	imm.log(<span style="color:#3ad900;font-weight:400">"**&nbsp;[+]&nbsp;Finished&nbsp;task,&nbsp;%d&nbsp;modules&nbsp;found"</span>&nbsp;%&nbsp;<span style="color:#ff9d00;font-weight:700">len</span>(g_modules))<br />	imm.updateLog()<br /><br /><br /><span style="color:#ff9d00;font-weight:700">def</span>&nbsp;getropfilename(modname):<br />	imm&nbsp;=&nbsp;immlib.Debugger()<br />	<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;<span style="color:#ff9d00;font-weight:700">len</span>(g_modules)==<span style="color:#ff0044;font-weight:400">0</span>:<br />		moduleinfo()<br />	mfound=<span style="color:#ff0044;font-weight:400">0</span><br />	strfilename=<span style="color:#3ad900;font-weight:400">""</span><br />	<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;modname&nbsp;&lt;&gt;&nbsp;<span style="color:#3ad900;font-weight:400">""</span>:<br />		<span style="color:#ff9d00;font-weight:700">for</span>&nbsp;mname&nbsp;<span style="color:#ff9d00;font-weight:700">in</span>&nbsp;g_modules:<br />				mnamentry=mname.split(<span style="color:#3ad900;font-weight:400">'\t'</span>)<br />				<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;mnamentry[<span style="color:#ff0044;font-weight:400">0</span>].lower().startswith(modname.lower()):<br />					mfound=<span style="color:#ff0044;font-weight:400">1</span><br />					modname=mnamentry[<span style="color:#ff0044;font-weight:400">0</span>]<br />					mversion=mnamentry[<span style="color:#ff0044;font-weight:400">9</span>]<br />					<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;mversion&nbsp;&lt;&gt;&nbsp;<span style="color:#3ad900;font-weight:400">""</span>:<br />						mversion=<span style="color:#3ad900;font-weight:400">"_v"</span>+mversion<br />	<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;mfound==<span style="color:#ff0044;font-weight:400">1</span>:<br />		osver=imm.getOsVersion()<br />		osrel=imm.getOsRelease()<br />		strfilename=<span style="color:#3ad900;font-weight:400">"rop_"</span>&nbsp;+&nbsp;modname.lower()+mversion+<span style="color:#3ad900;font-weight:400">"_"</span>+osver+<span style="color:#3ad900;font-weight:400">"_"</span>+osrel+<span style="color:#3ad900;font-weight:400">".txt"</span><br />	<span style="color:#ff9d00;font-weight:700">return</span>&nbsp;strfilename<br /><br /><br /><br /><span style="color:#ff9d00;font-weight:700">def</span>&nbsp;isosmodule(modname):<br />	<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;<span style="color:#ff9d00;font-weight:700">len</span>(g_modules)==<span style="color:#ff0044;font-weight:400">0</span>:<br />		moduleinfo()<br />	osmodule=<span style="color:#ff0044;font-weight:400">0</span><br />	mpath=<span style="color:#3ad900;font-weight:400">""</span><br />	msystem=<span style="color:#3ad900;font-weight:400">""</span><br />	mfound=<span style="color:#ff0044;font-weight:400">0</span><br />	<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;modname&nbsp;&lt;&gt;&nbsp;<span style="color:#3ad900;font-weight:400">""</span>:<br />		<span style="color:#ff9d00;font-weight:700">for</span>&nbsp;mname&nbsp;<span style="color:#ff9d00;font-weight:700">in</span>&nbsp;g_modules:<br />			mnamentry=mname.split(<span style="color:#3ad900;font-weight:400">'\t'</span>)<br />			<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;mnamentry[<span style="color:#ff0044;font-weight:400">0</span>].lower().startswith(modname.lower()):<br />				mfound=<span style="color:#ff0044;font-weight:400">1</span><br />				mpath=mnamentry[<span style="color:#ff0044;font-weight:400">1</span>]<br />				msystem=mnamentry[<span style="color:#ff0044;font-weight:400">10</span>]<br />	<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;mfound==<span style="color:#ff0044;font-weight:400">1</span>:<br />		<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;<span style="color:#ff9d00;font-weight:700">int</span>(msystem)&nbsp;==&nbsp;<span style="color:#ff0044;font-weight:400">1</span>:<br />			osmodule=<span style="color:#ff0044;font-weight:400">1</span><br />		<span style="color:#ff9d00;font-weight:700">else</span>:<br />			<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;mpath.upper().find(<span style="color:#3ad900;font-weight:400">"WINDOWS"</span>)&nbsp;&gt;&nbsp;-<span style="color:#ff0044;font-weight:400">1</span>:<br />				osmodule=<span style="color:#ff0044;font-weight:400">1</span><br />	<span style="color:#ff9d00;font-weight:700">return</span>&nbsp;osmodule<br /><br /><span style="color:#ff9d00;font-weight:700">def</span>&nbsp;getmodnamefromptr(thisptr):<br />	<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;<span style="color:#ff9d00;font-weight:700">len</span>(g_modules)==<span style="color:#ff0044;font-weight:400">0</span>:<br />		moduleinfo()<br />	modname=<span style="color:#3ad900;font-weight:400">""</span><br />	<span style="color:#ff9d00;font-weight:700">for</span>&nbsp;thismname&nbsp;<span style="color:#ff9d00;font-weight:700">in</span>&nbsp;g_modules:<br />		mnamentry=thismname.split(<span style="color:#3ad900;font-weight:400">'\t'</span>)<br />		thisbase=<span style="color:#ff9d00;font-weight:700">int</span>(mnamentry[<span style="color:#ff0044;font-weight:400">2</span>])<br />		thistop=<span style="color:#ff9d00;font-weight:700">int</span>(mnamentry[<span style="color:#ff0044;font-weight:400">4</span>])<br />		<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;(thisptr&nbsp;&gt;=&nbsp;thisbase)&nbsp;<span style="color:#ff9d00;font-weight:700">and</span>&nbsp;(thisptr&nbsp;&lt;=&nbsp;thistop):<br />			modname=mnamentry[<span style="color:#ff0044;font-weight:400">0</span>]<br />	<span style="color:#ff9d00;font-weight:700">return</span>&nbsp;modname<br />	<br /><span style="color:#ff9d00;font-weight:700">def</span>&nbsp;getmodnamefromname(searchname):<br />	<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;<span style="color:#ff9d00;font-weight:700">len</span>(g_modules)==<span style="color:#ff0044;font-weight:400">0</span>:<br />		moduleinfo()<br />	modname=<span style="color:#3ad900;font-weight:400">""</span><br />	searchname&nbsp;=&nbsp;searchname.strip().lower()<br />	foundname&nbsp;=&nbsp;<span style="color:#3ad900;font-weight:400">""</span><br />	<span style="color:#ff9d00;font-weight:700">for</span>&nbsp;thismname&nbsp;<span style="color:#ff9d00;font-weight:700">in</span>&nbsp;g_modules:<br />		mnamentry=thismname.split(<span style="color:#3ad900;font-weight:400">'\t'</span>)<br />		modname=mnamentry[<span style="color:#ff0044;font-weight:400">0</span>].strip().lower()<br />		<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;searchname&nbsp;==&nbsp;modname:<br />			foundname&nbsp;=&nbsp;mnamentry[<span style="color:#ff0044;font-weight:400">0</span>]<br />		<span style="color:#ff9d00;font-weight:700">else</span>:<br />			l&nbsp;=&nbsp;<span style="color:#ff9d00;font-weight:700">len</span>(searchname)<br />			<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;l&nbsp;&lt;=&nbsp;<span style="color:#ff9d00;font-weight:700">len</span>(modname):<br />				<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;modname[<span style="color:#ff0044;font-weight:400">0</span>:l]&nbsp;==&nbsp;searchname:<br />					foundname&nbsp;=&nbsp;mnamentry[<span style="color:#ff0044;font-weight:400">0</span>]<br />	<span style="color:#ff9d00;font-weight:700">return</span>&nbsp;foundname<br /><br /><span style="color:#ff9d00;font-weight:700">def</span>&nbsp;getRet(imm,&nbsp;allocaddr,&nbsp;max_opcodes&nbsp;=&nbsp;<span style="color:#ff0044;font-weight:400">500</span>):<br />	addr&nbsp;=&nbsp;allocaddr<br />	<span style="color:#ff9d00;font-weight:700">for</span>&nbsp;a&nbsp;<span style="color:#ff9d00;font-weight:700">in</span>&nbsp;<span style="color:#ff9d00;font-weight:700">range</span>(<span style="color:#ff0044;font-weight:400">0</span>,&nbsp;max_opcodes):<br />		op&nbsp;=&nbsp;imm.DisasmForward(&nbsp;addr&nbsp;)<br />		<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;op.isRet():<br />			<span style="color:#ff9d00;font-weight:700">return</span>&nbsp;op.getAddress()<br />		addr&nbsp;=&nbsp;op.getAddress()<br />	<span style="color:#ff9d00;font-weight:700">return</span>&nbsp;<span style="color:#ff0044;font-weight:400">0x0</span><br /><br /><span style="color:#ff9d00;font-weight:700">def</span>&nbsp;getmoduleprop(modname,parameter):<br />	imm&nbsp;=&nbsp;immlib.Debugger()<br />	modname=modname.strip()<br />	parameter=parameter.lower()<br />	modname=modname.lower()<br />	valtoreturn=<span style="color:#3ad900;font-weight:400">""</span><br />	<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;parameter==<span style="color:#3ad900;font-weight:400">"path"</span>:<br />		field=<span style="color:#ff0044;font-weight:400">1</span><br />	<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;parameter==<span style="color:#3ad900;font-weight:400">"base"</span>:<br />		field=<span style="color:#ff0044;font-weight:400">2</span><br />	<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;parameter==<span style="color:#3ad900;font-weight:400">"size"</span>:<br />		field=<span style="color:#ff0044;font-weight:400">3</span><br />	<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;parameter==<span style="color:#3ad900;font-weight:400">"top"</span>:<br />		field=<span style="color:#ff0044;font-weight:400">4</span><br />	<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;parameter==<span style="color:#3ad900;font-weight:400">"safeseh"</span>:<br />		field=<span style="color:#ff0044;font-weight:400">5</span><br />	<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;parameter==<span style="color:#3ad900;font-weight:400">"aslr"</span>:<br />		field=<span style="color:#ff0044;font-weight:400">6</span><br />	<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;parameter==<span style="color:#3ad900;font-weight:400">"nx"</span>:<br />		field=<span style="color:#ff0044;font-weight:400">7</span><br />	<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;parameter==<span style="color:#3ad900;font-weight:400">"fixup"</span>:<br />		field=<span style="color:#ff0044;font-weight:400">8</span><br />	<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;parameter==<span style="color:#3ad900;font-weight:400">"version"</span>:<br />		field=<span style="color:#ff0044;font-weight:400">9</span><br />	<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;parameter==<span style="color:#3ad900;font-weight:400">"systemdll"</span>:<br />		field=<span style="color:#ff0044;font-weight:400">10</span><br />	<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;<span style="color:#ff9d00;font-weight:700">len</span>(g_modules)==<span style="color:#ff0044;font-weight:400">0</span>:<br />		moduleinfo()<br />	<span style="color:#ff9d00;font-weight:700">for</span>&nbsp;mod&nbsp;<span style="color:#ff9d00;font-weight:700">in</span>&nbsp;g_modules:<br />		modrecord=mod.split(<span style="color:#3ad900;font-weight:400">'\t'</span>)<br />		<span style="color:#ff9d00;font-weight:700">try</span>:<br />			<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;modname==modrecord[<span style="color:#ff0044;font-weight:400">0</span>].lower().strip():<br />				&nbsp;valtoreturn=modrecord[field]<br />		<span style="color:#ff9d00;font-weight:700">except</span>:<br />			valtoreturn=<span style="color:#3ad900;font-weight:400">""</span><br />	<span style="color:#ff9d00;font-weight:700">return</span>&nbsp;valtoreturn<br /><br />&nbsp;<br /><span style="color:#3ad900;font-weight:400">"""<br />Function&nbsp;to&nbsp;list&nbsp;all&nbsp;modules&nbsp;that&nbsp;are&nbsp;not&nbsp;safeseh&nbsp;protected<br />"""</span><br /><br /><span style="color:#ff9d00;font-weight:700">def</span>&nbsp;getnosafeseh(imm):<br />	nosafesehmod=[]<br />	<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;<span style="color:#ff9d00;font-weight:700">len</span>(g_modules)==<span style="color:#ff0044;font-weight:400">0</span>:<br />		moduleinfo()<br />	<span style="color:#ff9d00;font-weight:700">for</span>&nbsp;mods&nbsp;<span style="color:#ff9d00;font-weight:700">in</span>&nbsp;g_modules:<br />		modrecord=mods.split(<span style="color:#3ad900;font-weight:400">'\t'</span>)<br />		<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;modrecord[<span style="color:#ff0044;font-weight:400">5</span>]==<span style="color:#3ad900;font-weight:400">"0"</span>:<br />				nosafesehmod.append(modrecord[<span style="color:#ff0044;font-weight:400">0</span>])<br />	<span style="color:#ff9d00;font-weight:700">return</span>&nbsp;nosafesehmod<br /><br /><span style="color:#3ad900;font-weight:400">"""<br />Function&nbsp;to&nbsp;get&nbsp;the&nbsp;address&nbsp;of&nbsp;a&nbsp;function&nbsp;from&nbsp;a&nbsp;given&nbsp;module<br />"""</span><br /><span style="color:#ff9d00;font-weight:700">def</span>&nbsp;getfuncaddress(module,function):<br />	function=function.lower()<br />	module=module.lower()<br />	imm&nbsp;=&nbsp;immlib.Debugger()<br />	<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;<span style="color:#ff9d00;font-weight:700">len</span>(g_modules)==<span style="color:#ff0044;font-weight:400">0</span>:<br />		moduleinfo()<br />	baseloc=<span style="color:#ff0044;font-weight:400">0</span><br />	ret=<span style="color:#ff0044;font-weight:400">0</span><br />	modfound=<span style="color:#ff0044;font-weight:400">0</span><br />	<span style="color:#ff9d00;font-weight:700">for</span>&nbsp;mods&nbsp;<span style="color:#ff9d00;font-weight:700">in</span>&nbsp;g_modules:<br />		modrecord=mods.split(<span style="color:#3ad900;font-weight:400">'\t'</span>)<br />		<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;modrecord[<span style="color:#ff0044;font-weight:400">0</span>].lower()==module:<br />			baseloc=modrecord[<span style="color:#ff0044;font-weight:400">2</span>]<br />			modfound=<span style="color:#ff0044;font-weight:400">1</span><br />	<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;modfound==<span style="color:#ff0044;font-weight:400">0</span>:<br />		<span style="color:#0088ff;font-weight:400">#load&nbsp;module</span><br />		<span style="color:#ff9d00;font-weight:700">try</span>:<br />			imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;**&nbsp;Attempting&nbsp;to&nbsp;load&nbsp;module&nbsp;%s"</span>&nbsp;%&nbsp;(module),highlight=<span style="color:#ff0044;font-weight:400">1</span>)<br />			imm.inject_dll(<span style="color:#3ad900;font-weight:400">"c:\\windows\\system32\\"</span>+module)<br />		<span style="color:#ff9d00;font-weight:700">except</span>:<br />			<span style="color:#ff9d00;font-weight:700">pass</span><br />		moduleinfo()<br />		baseloc=<span style="color:#ff0044;font-weight:400">0</span><br />		modfound=<span style="color:#ff0044;font-weight:400">0</span><br />		<span style="color:#ff9d00;font-weight:700">for</span>&nbsp;mods&nbsp;<span style="color:#ff9d00;font-weight:700">in</span>&nbsp;g_modules:<br />			modrecord=mods.split(<span style="color:#3ad900;font-weight:400">'\t'</span>)<br />			<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;modrecord[<span style="color:#ff0044;font-weight:400">0</span>].lower()==module:<br />				baseloc=<span style="color:#ff9d00;font-weight:700">int</span>(modrecord[<span style="color:#ff0044;font-weight:400">2</span>])<br />				modfound=<span style="color:#ff0044;font-weight:400">1</span><br />	<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;baseloc&nbsp;&gt;&nbsp;<span style="color:#ff0044;font-weight:400">0</span>:<br />		<span style="color:#0088ff;font-weight:400">#load&nbsp;module</span><br />		mod=imm.getModule(module)<br />		mzbase=mod.getBaseAddress()<br />		<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;imm.isAnalysed(mzbase)&nbsp;&lt;&gt;&nbsp;<span style="color:#ff0044;font-weight:400">1</span>:<br />			imm.analyseCode(&nbsp;mzbase&nbsp;)<br />		imm.updateLog()<br />		allfuncs=[]<br />		allfuncs=imm.getAllFunctions(mzbase)<br />		<span style="color:#ff9d00;font-weight:700">for</span>&nbsp;thisfunc&nbsp;<span style="color:#ff9d00;font-weight:700">in</span>&nbsp;allfuncs:<br />			<span style="color:#0088ff;font-weight:400">#Get&nbsp;function&nbsp;name&nbsp;at&nbsp;this&nbsp;address</span><br />			funcloc&nbsp;=&nbsp;imm.getFunction(&nbsp;thisfunc&nbsp;)<br />			ffullname&nbsp;=&nbsp;imm.decodeAddress(&nbsp;thisfunc&nbsp;)<br />			fname=ffullname.split(<span style="color:#3ad900;font-weight:400">'.'</span>)<br />			<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;<span style="color:#ff9d00;font-weight:700">len</span>(fname)&nbsp;&gt;&nbsp;<span style="color:#ff0044;font-weight:400">0</span>:<br />				<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;fname[<span style="color:#ff0044;font-weight:400">1</span>].lower()==function:<br />					ret=thisfunc<br />	<span style="color:#ff9d00;font-weight:700">return</span>&nbsp;ret<br /><br /><span style="color:#3ad900;font-weight:400">"""<br />Function&nbsp;to&nbsp;list&nbsp;all&nbsp;modules&nbsp;that&nbsp;are&nbsp;not&nbsp;aslr&nbsp;aware&nbsp;and&nbsp;not&nbsp;compiled&nbsp;with&nbsp;safeseh&nbsp;either<br />"""</span><br /><span style="color:#ff9d00;font-weight:700">def</span>&nbsp;getnosafesehaslr(imm,mode):<br />	nrfound=<span style="color:#ff0044;font-weight:400">0</span><br />	<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;<span style="color:#ff9d00;font-weight:700">len</span>(g_modules)==<span style="color:#ff0044;font-weight:400">0</span>:<br />		moduleinfo()<br />	<span style="color:#ff9d00;font-weight:700">for</span>&nbsp;mods&nbsp;<span style="color:#ff9d00;font-weight:700">in</span>&nbsp;g_modules:<br />		modrecord=mods.split(<span style="color:#3ad900;font-weight:400">'\t'</span>)<br />		mzbase=<span style="color:#ff9d00;font-weight:700">int</span>(modrecord[<span style="color:#ff0044;font-weight:400">2</span>])<br />		mztop=<span style="color:#ff9d00;font-weight:700">int</span>(modrecord[<span style="color:#ff0044;font-weight:400">4</span>])<br />		path=modrecord[<span style="color:#ff0044;font-weight:400">1</span>]<br />		key=modrecord[<span style="color:#ff0044;font-weight:400">0</span>]<br />		extra=<span style="color:#3ad900;font-weight:400">""</span><br />		<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;(modrecord[<span style="color:#ff0044;font-weight:400">8</span>]==<span style="color:#3ad900;font-weight:400">"1"</span>):<br />				extra=<span style="color:#3ad900;font-weight:400">"&nbsp;-&nbsp;!BaseFixup!"</span><br />		<span style="color:#ff9d00;font-weight:700">else</span>:<br />				extra=<span style="color:#3ad900;font-weight:400">""</span><br />		<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;modrecord[<span style="color:#ff0044;font-weight:400">6</span>]==<span style="color:#3ad900;font-weight:400">"0"</span>:	&nbsp;&nbsp;<span style="color:#0088ff;font-weight:400">#</span><br />				<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;modrecord[<span style="color:#ff0044;font-weight:400">5</span>]==<span style="color:#3ad900;font-weight:400">"0"</span>:<br />					imm.log(<span style="color:#3ad900;font-weight:400">"*[+]&nbsp;0x%08x&nbsp;-&nbsp;0x%08x&nbsp;:&nbsp;%s&nbsp;%s&nbsp;(***&nbsp;No&nbsp;ASLR,&nbsp;No&nbsp;Safeseh&nbsp;***)&nbsp;-&nbsp;%s"</span>&nbsp;%&nbsp;(mzbase,mztop,key,extra,path),highlight=<span style="color:#ff0044;font-weight:400">1</span>)<br />					nrfound=nrfound+<span style="color:#ff0044;font-weight:400">1</span><br />				<span style="color:#ff9d00;font-weight:700">else</span>:<br />					<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;(mode&nbsp;==&nbsp;<span style="color:#ff0044;font-weight:400">0</span>):<br />						imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;[-]&nbsp;0x%08x&nbsp;-&nbsp;0x%08x&nbsp;:&nbsp;%s&nbsp;%s&nbsp;(No&nbsp;ASLR,&nbsp;but&nbsp;Safeseh&nbsp;protected)&nbsp;-&nbsp;%s"</span>&nbsp;%&nbsp;(mzbase,mztop,key,extra,path))<br />	imm.log(<span style="color:#3ad900;font-weight:400">"Number&nbsp;of&nbsp;non-protected&nbsp;modules&nbsp;found&nbsp;:&nbsp;%d"</span>&nbsp;%&nbsp;nrfound)<br />	imm.log(<span style="color:#3ad900;font-weight:400">""</span>)<br /><br /><br /><br /><span style="color:#3ad900;font-weight:400">"""<br />Function&nbsp;to&nbsp;see&nbsp;if&nbsp;a&nbsp;given&nbsp;module&nbsp;is&nbsp;safeseh&nbsp;protected&nbsp;or&nbsp;not<br />"""</span><br /><span style="color:#ff9d00;font-weight:700">def</span>&nbsp;ismodulenosafeseh(modulename):<br />	found=<span style="color:#ff0044;font-weight:400">0</span><br />	modulename=modulename.lower().strip()<br />	<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;<span style="color:#ff9d00;font-weight:700">len</span>(g_modules)==<span style="color:#ff0044;font-weight:400">0</span>:<br />		moduleinfo()<br />	<span style="color:#ff9d00;font-weight:700">for</span>&nbsp;mods&nbsp;<span style="color:#ff9d00;font-weight:700">in</span>&nbsp;g_modules:<br />		modrecord=mods.split(<span style="color:#3ad900;font-weight:400">'\t'</span>)<br />		<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;((modrecord[<span style="color:#ff0044;font-weight:400">0</span>].lower().strip()==modulename)&nbsp;<span style="color:#ff9d00;font-weight:700">and</span>&nbsp;(modrecord[<span style="color:#ff0044;font-weight:400">5</span>]==<span style="color:#3ad900;font-weight:400">"0"</span>)):<br />				found=<span style="color:#ff0044;font-weight:400">1</span><br />	<span style="color:#ff9d00;font-weight:700">return</span>&nbsp;found<br /><br /><span style="color:#3ad900;font-weight:400">"""<br />Function&nbsp;to&nbsp;see&nbsp;if&nbsp;a&nbsp;given&nbsp;module&nbsp;is&nbsp;aslr&nbsp;protected&nbsp;or&nbsp;not<br />"""</span><br /><span style="color:#ff9d00;font-weight:700">def</span>&nbsp;ismodulenoaslr(modulename):<br />	found=<span style="color:#ff0044;font-weight:400">0</span><br />	modulename=modulename.lower().strip()<br />	<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;<span style="color:#ff9d00;font-weight:700">len</span>(g_modules)==<span style="color:#ff0044;font-weight:400">0</span>:<br />		moduleinfo()<br />	<span style="color:#ff9d00;font-weight:700">for</span>&nbsp;mods&nbsp;<span style="color:#ff9d00;font-weight:700">in</span>&nbsp;g_modules:<br />		modrecord=mods.split(<span style="color:#3ad900;font-weight:400">'\t'</span>)<br />		<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;((modrecord[<span style="color:#ff0044;font-weight:400">0</span>].lower().strip()==modulename)&nbsp;<span style="color:#ff9d00;font-weight:700">and</span>&nbsp;(modrecord[<span style="color:#ff0044;font-weight:400">6</span>]==<span style="color:#3ad900;font-weight:400">"0"</span>)):<br />			found=<span style="color:#ff0044;font-weight:400">1</span><br />	<span style="color:#ff9d00;font-weight:700">return</span>&nbsp;found<br /><br /><span style="color:#ff9d00;font-weight:700">def</span>&nbsp;shownosafeseh():<br />	imm&nbsp;=&nbsp;immlib.Debugger()<br />	cnt=<span style="color:#ff0044;font-weight:400">0</span><br />	<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;<span style="color:#ff9d00;font-weight:700">len</span>(g_modules)==<span style="color:#ff0044;font-weight:400">0</span>:<br />		moduleinfo()<br />	imm.log(<span style="color:#3ad900;font-weight:400">"Safeseh&nbsp;unprotected&nbsp;modules&nbsp;:&nbsp;"</span>)<br />	<span style="color:#ff9d00;font-weight:700">for</span>&nbsp;mods&nbsp;<span style="color:#ff9d00;font-weight:700">in</span>&nbsp;g_modules:<br />		modrecord=mods.split(<span style="color:#3ad900;font-weight:400">'\t'</span>)<br />		<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;(modrecord[<span style="color:#ff0044;font-weight:400">5</span>]==<span style="color:#3ad900;font-weight:400">"0"</span>):<br />			found=<span style="color:#ff0044;font-weight:400">1</span><br />			mzbase=<span style="color:#ff9d00;font-weight:700">int</span>(modrecord[<span style="color:#ff0044;font-weight:400">2</span>])<br />			mztop=<span style="color:#ff9d00;font-weight:700">int</span>(modrecord[<span style="color:#ff0044;font-weight:400">4</span>])<br />			path=modrecord[<span style="color:#ff0044;font-weight:400">1</span>]<br />			np=modrecord[<span style="color:#ff0044;font-weight:400">0</span>]<br />			imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;*&nbsp;0x%08x&nbsp;-&nbsp;0x%08x&nbsp;:&nbsp;%s&nbsp;(%s)"</span>&nbsp;%&nbsp;(mzbase,mztop,np,path),highlight=<span style="color:#ff0044;font-weight:400">1</span>)<br />			imm.updateLog()<br />			cnt=cnt+<span style="color:#ff0044;font-weight:400">1</span><br />	<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;cnt&gt;<span style="color:#ff0044;font-weight:400">0</span>:<br />		imm.log(<span style="color:#3ad900;font-weight:400">"%d&nbsp;out&nbsp;of&nbsp;%d&nbsp;modules&nbsp;are&nbsp;not&nbsp;safeseh&nbsp;protected"</span>&nbsp;%&nbsp;(cnt,<span style="color:#ff9d00;font-weight:700">len</span>(g_modules)))<br />	<span style="color:#ff9d00;font-weight:700">else</span>:<br />		imm.log(<span style="color:#3ad900;font-weight:400">"All&nbsp;modules&nbsp;are&nbsp;safeseh&nbsp;compiled&nbsp;-&nbsp;good&nbsp;luck&nbsp;!"</span>)<br />	imm.log(<span style="color:#3ad900;font-weight:400">"--------------------------------------------------------------"</span>)<br />	imm.updateLog()<br />	<br />	<br /><span style="color:#ff9d00;font-weight:700">def</span>&nbsp;dofind(imm,args,modulefilter):<br />		filename=<span style="color:#3ad900;font-weight:400">"find.txt"</span><br />		resetfile(filename)<br />		startaddress=<span style="color:#ff0044;font-weight:400">0</span><br />		endaddress=<span style="color:#ff0044;font-weight:400">2147483647</span><br />		skipconsec=<span style="color:#ff0044;font-weight:400">0</span><br />		cnt=<span style="color:#ff0044;font-weight:400">0</span><br />		mask=<span style="color:#3ad900;font-weight:400">""</span><br />		<span style="color:#ff9d00;font-weight:700">while</span>&nbsp;cnt&nbsp;&lt;&nbsp;<span style="color:#ff9d00;font-weight:700">len</span>(args):<br />			<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;args[cnt]==<span style="color:#3ad900;font-weight:400">'-l'</span>:<br />				<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;cnt&nbsp;&lt;&nbsp;(<span style="color:#ff9d00;font-weight:700">len</span>(args)-<span style="color:#ff0044;font-weight:400">1</span>):<br />					startaddress=<span style="color:#ff9d00;font-weight:700">str</span>(args[cnt+<span style="color:#ff0044;font-weight:400">1</span>])<br />					startaddress=startaddress.lower().replace(<span style="color:#3ad900;font-weight:400">"0x"</span>,<span style="color:#3ad900;font-weight:400">""</span>)<br />					startaddress=<span style="color:#3ad900;font-weight:400">"0x"</span>&nbsp;+&nbsp;startaddress<br />					startaddress=<span style="color:#ff9d00;font-weight:700">int</span>(startaddress,<span style="color:#ff0044;font-weight:400">16</span>)<br />			<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;args[cnt]==<span style="color:#3ad900;font-weight:400">'-t'</span>:<br />				<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;cnt&nbsp;&lt;&nbsp;(<span style="color:#ff9d00;font-weight:700">len</span>(args)-<span style="color:#ff0044;font-weight:400">1</span>):<br />					endaddress=<span style="color:#ff9d00;font-weight:700">str</span>(args[cnt+<span style="color:#ff0044;font-weight:400">1</span>])<br />					endaddress=endaddress.lower().replace(<span style="color:#3ad900;font-weight:400">"0x"</span>,<span style="color:#3ad900;font-weight:400">""</span>)<br />					endaddress=<span style="color:#3ad900;font-weight:400">"0x"</span>&nbsp;+&nbsp;endaddress<br />					endaddress=<span style="color:#ff9d00;font-weight:700">int</span>(endaddress,<span style="color:#ff0044;font-weight:400">16</span>)<br />			<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;args[cnt]==<span style="color:#3ad900;font-weight:400">'-a'</span>:<br />				<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;cnt&nbsp;&lt;&nbsp;(<span style="color:#ff9d00;font-weight:700">len</span>(args)-<span style="color:#ff0044;font-weight:400">1</span>):<br />					mask=<span style="color:#ff9d00;font-weight:700">str</span>(args[cnt+<span style="color:#ff0044;font-weight:400">1</span>])<br />			<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;args[cnt]==<span style="color:#3ad900;font-weight:400">'-c'</span>:<br />					skipconsec=<span style="color:#ff0044;font-weight:400">1</span><br />			cnt=cnt+<span style="color:#ff0044;font-weight:400">1</span><br />		<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;<span style="color:#ff9d00;font-weight:700">len</span>(args)&nbsp;&gt;&nbsp;<span style="color:#ff0044;font-weight:400">1</span>:<br />			<span style="color:#0088ff;font-weight:400">#convert&nbsp;bytes&nbsp;to&nbsp;bytecode</span><br />			cnt=<span style="color:#ff0044;font-weight:400">0</span><br />			nrfound=<span style="color:#ff0044;font-weight:400">0</span><br />			nrdone=<span style="color:#ff0044;font-weight:400">0</span><br />			strb=<span style="color:#3ad900;font-weight:400">""</span><br />			inp=args[<span style="color:#ff0044;font-weight:400">1</span>]<br />			<span style="color:#ff9d00;font-weight:700">while</span>&nbsp;cnt&nbsp;&lt;&nbsp;<span style="color:#ff9d00;font-weight:700">len</span>(inp):<br />				&nbsp;<span style="color:#ff9d00;font-weight:700">try</span>:<br />					strb=strb+binascii.a2b_hex(inp[cnt]+inp[cnt+<span style="color:#ff0044;font-weight:400">1</span>])<br />					cnt=cnt+<span style="color:#ff0044;font-weight:400">2</span><br />				&nbsp;<span style="color:#ff9d00;font-weight:700">except</span>:<br />					imm.log(<span style="color:#3ad900;font-weight:400">"You&nbsp;may&nbsp;have&nbsp;provided&nbsp;an&nbsp;odd&nbsp;length&nbsp;byte&nbsp;string"</span>)<br />					<span style="color:#ff9d00;font-weight:700">pass</span><br />					cnt=cnt+<span style="color:#ff0044;font-weight:400">2</span><br />			imm.log(<span style="color:#3ad900;font-weight:400">"Searching&nbsp;for&nbsp;%s,&nbsp;please&nbsp;wait&nbsp;..."</span>&nbsp;%&nbsp;inp)<br />			imm.updateLog()<br />			addys=imm.search(&nbsp;strb&nbsp;)<br />			imm.log(<span style="color:#3ad900;font-weight:400">"Search&nbsp;complete"</span>)<br />			imm.updateLog()<br />			results&nbsp;=&nbsp;[]<br />			results&nbsp;+=&nbsp;addys<br />			<span style="color:#ff9d00;font-weight:700">for</span>&nbsp;<span style="color:#ff9d00;font-weight:700">all</span>&nbsp;<span style="color:#ff9d00;font-weight:700">in</span>&nbsp;results:<br />				nrfound&nbsp;+=&nbsp;<span style="color:#ff0044;font-weight:400">1</span><br />			imm.log(<span style="color:#3ad900;font-weight:400">"Total&nbsp;number&nbsp;of&nbsp;addresses&nbsp;found&nbsp;(before&nbsp;filtering)&nbsp;:&nbsp;%d,&nbsp;now&nbsp;filtering&nbsp;addresses"</span>&nbsp;%&nbsp;nrfound)<br />			tofile(<span style="color:#3ad900;font-weight:400">"Found&nbsp;"</span>+<span style="color:#ff9d00;font-weight:700">str</span>(nrfound)+<span style="color:#3ad900;font-weight:400">"&nbsp;addresses&nbsp;pointing&nbsp;to&nbsp;"</span>+inp,filename)<br />			imm.updateLog()<br />			<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;results:<br />				<span style="color:#0088ff;font-weight:400">#sort&nbsp;array</span><br />				results.sort()<br />				<span style="color:#0088ff;font-weight:400">#List&nbsp;all&nbsp;addresses</span><br />				maskfilt=<span style="color:#3ad900;font-weight:400">"&nbsp;"</span><br />				cnt=<span style="color:#ff0044;font-weight:400">0</span><br />				<span style="color:#0088ff;font-weight:400">#did&nbsp;we&nbsp;specify&nbsp;a&nbsp;module&nbsp;?</span><br />				<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;modulefilter&nbsp;!=&nbsp;<span style="color:#3ad900;font-weight:400">""</span>:<br />					modulename&nbsp;=&nbsp;getmodnamefromname(modulefilter)<br />					startaddress=<span style="color:#ff9d00;font-weight:700">int</span>(getmoduleprop(modulename,<span style="color:#3ad900;font-weight:400">"base"</span>))<br />					endaddress=<span style="color:#ff9d00;font-weight:700">int</span>(getmoduleprop(modulename,<span style="color:#3ad900;font-weight:400">"top"</span>))<br />				imm.log(<span style="color:#3ad900;font-weight:400">"Filtering&nbsp;pointers,&nbsp;only&nbsp;showing&nbsp;the&nbsp;ones&nbsp;between&nbsp;0x%s&nbsp;and&nbsp;0x%s"</span>&nbsp;%&nbsp;(tohex(startaddress),tohex(endaddress)))<br />				prevptr=<span style="color:#ff0044;font-weight:400">0</span><br />				info&nbsp;=&nbsp;<span style="color:#3ad900;font-weight:400">""</span><br />				<span style="color:#ff9d00;font-weight:700">for</span>&nbsp;<span style="color:#ff9d00;font-weight:700">all</span>&nbsp;<span style="color:#ff9d00;font-weight:700">in</span>&nbsp;results:<br />					<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;(mask==<span style="color:#3ad900;font-weight:400">"r"</span>):<br />						maskfilt=<span style="color:#3ad900;font-weight:400">"PAGE_READONLY"</span><br />					<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;(mask==<span style="color:#3ad900;font-weight:400">"rw"</span>):<br />						maskfilt=<span style="color:#3ad900;font-weight:400">"PAGE_READWRITE"</span><br />					<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;(mask==<span style="color:#3ad900;font-weight:400">"rx"</span>):<br />						maskfilt=<span style="color:#3ad900;font-weight:400">"PAGE_EXECUTE_READ"</span><br />					<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;(mask==<span style="color:#3ad900;font-weight:400">"rwx"</span>):<br />						maskfilt=<span style="color:#3ad900;font-weight:400">"PAGE_EXECUTE_READWRITE"</span><br />					<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;(mask==<span style="color:#3ad900;font-weight:400">"w"</span>):<br />						maskfilt=<span style="color:#3ad900;font-weight:400">"PAGE_WRITECOPY"</span><br />					<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;(mask==<span style="color:#3ad900;font-weight:400">"wx"</span>):<br />						maskfilt=<span style="color:#3ad900;font-weight:400">"PAGE_EXECUTE_WRITECOPY"</span><br />					<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;(mask==<span style="color:#3ad900;font-weight:400">"x"</span>):<br />						maskfilt=<span style="color:#3ad900;font-weight:400">"PAGE_EXECUTE"</span><br />					<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;(<span style="color:#ff9d00;font-weight:700">all</span>&nbsp;&gt;=&nbsp;startaddress&nbsp;<span style="color:#ff9d00;font-weight:700">and</span>&nbsp;<span style="color:#ff9d00;font-weight:700">all</span>&nbsp;&lt;=&nbsp;endaddress):<br />						info=addressinfo(<span style="color:#ff9d00;font-weight:700">all</span>)<br />					<span style="color:#ff9d00;font-weight:700">else</span>:<br />						info=<span style="color:#3ad900;font-weight:400">"-"</span><br />					<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;info.upper().find(maskfilt.upper())&nbsp;&gt;&nbsp;<span style="color:#ff0044;font-weight:400">0</span>:<br />						&nbsp;<span style="color:#0088ff;font-weight:400">#consecutive&nbsp;?</span><br />						<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;(skipconsec==<span style="color:#ff0044;font-weight:400">0</span>)&nbsp;<span style="color:#ff9d00;font-weight:700">or</span>&nbsp;(<span style="color:#ff9d00;font-weight:700">all</span>&nbsp;!=&nbsp;prevptr+<span style="color:#ff0044;font-weight:400">4</span>):<br />							imm.log(<span style="color:#3ad900;font-weight:400">"Address&nbsp;:&nbsp;0x%s&nbsp;:&nbsp;%s"</span>&nbsp;%&nbsp;(tohex(<span style="color:#ff9d00;font-weight:700">all</span>),info))<br />							tofile(<span style="color:#3ad900;font-weight:400">"Location&nbsp;:&nbsp;0x"</span>+tohex(<span style="color:#ff9d00;font-weight:700">all</span>)+<span style="color:#3ad900;font-weight:400">"&nbsp;"</span>,filename,<span style="color:#ff9d00;font-weight:700">all</span>)<br />							imm.updateLog()<br />						nrdone&nbsp;+=&nbsp;<span style="color:#ff0044;font-weight:400">1</span><br />					prevptr=<span style="color:#ff9d00;font-weight:700">all</span><br />				imm.log(<span style="color:#3ad900;font-weight:400">"Done.&nbsp;(Found&nbsp;%d&nbsp;addresses,&nbsp;out&nbsp;of&nbsp;which&nbsp;%d&nbsp;matched&nbsp;specified&nbsp;access&nbsp;mask&nbsp;(%s)&nbsp;and&nbsp;address&nbsp;range)"</span>&nbsp;%&nbsp;(nrfound,nrdone,mask))<br />		<span style="color:#ff9d00;font-weight:700">else</span>:<br />			imm.log(<span style="color:#3ad900;font-weight:400">"It&nbsp;looks&nbsp;like&nbsp;you&nbsp;forgot&nbsp;to&nbsp;specify&nbsp;the&nbsp;bytes&nbsp;to&nbsp;search&nbsp;for"</span>)<br /><br /><br /><span style="color:#ff9d00;font-weight:700">def</span>&nbsp;writemodinfo(filename):<br />&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;filename==<span style="color:#3ad900;font-weight:400">""</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;cnt=<span style="color:#ff0044;font-weight:400">0</span><br />&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;<span style="color:#ff9d00;font-weight:700">len</span>(g_modules)==<span style="color:#ff0044;font-weight:400">0</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;moduleinfo()<br />&nbsp;&nbsp;&nbsp;&nbsp;imm&nbsp;=&nbsp;immlib.Debugger()<br />&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"----------------------------------------------------------------------------------------------------------------------------------"</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;Loaded&nbsp;modules"</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"----------------------------------------------------------------------------------------------------------------------------------"</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;&nbsp;Fixup&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;Base&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;Top&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;Size&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;SafeSEH&nbsp;|&nbsp;ASLR&nbsp;&nbsp;|&nbsp;NXCompat&nbsp;|&nbsp;OS&nbsp;Dll&nbsp;|&nbsp;Version,&nbsp;Modulename&nbsp;&amp;&nbsp;Path"</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"----------------------------------------------------------------------------------------------------------------------------------"</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;safeseh=<span style="color:#3ad900;font-weight:400">"NO&nbsp;"</span><br />&nbsp;&nbsp;&nbsp;&nbsp;aslr=<span style="color:#3ad900;font-weight:400">"NO&nbsp;"</span><br />&nbsp;&nbsp;&nbsp;&nbsp;nx=<span style="color:#3ad900;font-weight:400">"NO&nbsp;"</span><br />&nbsp;&nbsp;&nbsp;&nbsp;rebased=<span style="color:#3ad900;font-weight:400">"NO&nbsp;"</span><br />&nbsp;&nbsp;&nbsp;&nbsp;osdll=<span style="color:#3ad900;font-weight:400">"NO&nbsp;"</span><br />&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">for</span>&nbsp;mods&nbsp;<span style="color:#ff9d00;font-weight:700">in</span>&nbsp;g_modules:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;modrecord=mods.split(<span style="color:#3ad900;font-weight:400">'\t'</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;modrecord[<span style="color:#ff0044;font-weight:400">8</span>]==<span style="color:#3ad900;font-weight:400">"1"</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rebased=<span style="color:#3ad900;font-weight:400">"yes"</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">else</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rebased=<span style="color:#3ad900;font-weight:400">"NO&nbsp;"</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;modrecord[<span style="color:#ff0044;font-weight:400">5</span>]==<span style="color:#3ad900;font-weight:400">"1"</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;safeseh=<span style="color:#3ad900;font-weight:400">"yes"</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">else</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;safeseh=<span style="color:#3ad900;font-weight:400">"NO&nbsp;"</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;modrecord[<span style="color:#ff0044;font-weight:400">6</span>]==<span style="color:#3ad900;font-weight:400">"1"</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;aslr=<span style="color:#3ad900;font-weight:400">"yes"</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">else</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;aslr=<span style="color:#3ad900;font-weight:400">"NO&nbsp;"</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;modrecord[<span style="color:#ff0044;font-weight:400">7</span>]==<span style="color:#3ad900;font-weight:400">"1"</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;nx=<span style="color:#3ad900;font-weight:400">"yes"</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">else</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;nx=<span style="color:#3ad900;font-weight:400">"NO&nbsp;"</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;modrecord[<span style="color:#ff0044;font-weight:400">10</span>]==<span style="color:#3ad900;font-weight:400">"1"</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;osdll=<span style="color:#3ad900;font-weight:400">"yes"</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">else</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;osdll=<span style="color:#3ad900;font-weight:400">"NO&nbsp;"</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;&nbsp;&nbsp;"</span>+rebased+<span style="color:#3ad900;font-weight:400">"&nbsp;&nbsp;&nbsp;|&nbsp;0x"</span>+tohex(<span style="color:#ff9d00;font-weight:700">int</span>(modrecord[<span style="color:#ff0044;font-weight:400">2</span>]))+<span style="color:#3ad900;font-weight:400">"&nbsp;|&nbsp;0x"</span>+tohex(<span style="color:#ff9d00;font-weight:700">int</span>(modrecord[<span style="color:#ff0044;font-weight:400">4</span>]))+<span style="color:#3ad900;font-weight:400">"&nbsp;|&nbsp;0x"</span>+tohex(<span style="color:#ff9d00;font-weight:700">int</span>(modrecord[<span style="color:#ff0044;font-weight:400">3</span>]))+<span style="color:#3ad900;font-weight:400">"&nbsp;|&nbsp;&nbsp;&nbsp;"</span>+safeseh+<span style="color:#3ad900;font-weight:400">"&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;"</span>+aslr+<span style="color:#3ad900;font-weight:400">"&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;"</span>+nx+<span style="color:#3ad900;font-weight:400">"&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;"</span>+osdll+<span style="color:#3ad900;font-weight:400">"&nbsp;&nbsp;|&nbsp;"</span>+modrecord[<span style="color:#ff0044;font-weight:400">9</span>]+<span style="color:#3ad900;font-weight:400">"&nbsp;-&nbsp;"</span>+modrecord[<span style="color:#ff0044;font-weight:400">0</span>]+<span style="color:#3ad900;font-weight:400">"&nbsp;:&nbsp;"</span>+modrecord[<span style="color:#ff0044;font-weight:400">1</span>])<br />&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"----------------------------------------------------------------------------------------------------------------------------------"</span>)<br />&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">else</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;cnt=<span style="color:#ff0044;font-weight:400">0</span><br />&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;<span style="color:#ff9d00;font-weight:700">len</span>(g_modules)==<span style="color:#ff0044;font-weight:400">0</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;moduleinfo()<br />&nbsp;&nbsp;&nbsp;&nbsp;tofile(<span style="color:#3ad900;font-weight:400">"----------------------------------------------------------------------------------------------------------------------------------"</span>,filename)<br />&nbsp;&nbsp;&nbsp;&nbsp;tofile(<span style="color:#3ad900;font-weight:400">"&nbsp;Loaded&nbsp;modules"</span>,filename)<br />&nbsp;&nbsp;&nbsp;&nbsp;tofile(<span style="color:#3ad900;font-weight:400">"----------------------------------------------------------------------------------------------------------------------------------"</span>,filename)<br />&nbsp;&nbsp;&nbsp;&nbsp;tofile(<span style="color:#3ad900;font-weight:400">"&nbsp;&nbsp;Fixup&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;Base&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;Top&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;Size&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;SafeSEH&nbsp;|&nbsp;ASLR&nbsp;&nbsp;|&nbsp;NXCompat&nbsp;|&nbsp;OS&nbsp;Dll&nbsp;|&nbsp;Version,&nbsp;Modulename&nbsp;&amp;&nbsp;Path"</span>,filename)<br />&nbsp;&nbsp;&nbsp;&nbsp;tofile(<span style="color:#3ad900;font-weight:400">"----------------------------------------------------------------------------------------------------------------------------------"</span>,filename)<br />&nbsp;&nbsp;&nbsp;&nbsp;safeseh=<span style="color:#3ad900;font-weight:400">"NO&nbsp;"</span><br />&nbsp;&nbsp;&nbsp;&nbsp;aslr=<span style="color:#3ad900;font-weight:400">"NO&nbsp;"</span><br />&nbsp;&nbsp;&nbsp;&nbsp;nx=<span style="color:#3ad900;font-weight:400">"NO&nbsp;"</span><br />&nbsp;&nbsp;&nbsp;&nbsp;rebased=<span style="color:#3ad900;font-weight:400">"NO&nbsp;"</span><br />&nbsp;&nbsp;&nbsp;&nbsp;osdll=<span style="color:#3ad900;font-weight:400">"NO&nbsp;"</span><br />&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">for</span>&nbsp;mods&nbsp;<span style="color:#ff9d00;font-weight:700">in</span>&nbsp;g_modules:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;modrecord=mods.split(<span style="color:#3ad900;font-weight:400">'\t'</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;modrecord[<span style="color:#ff0044;font-weight:400">8</span>]==<span style="color:#3ad900;font-weight:400">"1"</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rebased=<span style="color:#3ad900;font-weight:400">"yes"</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">else</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rebased=<span style="color:#3ad900;font-weight:400">"NO&nbsp;"</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;modrecord[<span style="color:#ff0044;font-weight:400">5</span>]==<span style="color:#3ad900;font-weight:400">"1"</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;safeseh=<span style="color:#3ad900;font-weight:400">"yes"</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">else</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;safeseh=<span style="color:#3ad900;font-weight:400">"NO&nbsp;"</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;modrecord[<span style="color:#ff0044;font-weight:400">6</span>]==<span style="color:#3ad900;font-weight:400">"1"</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;aslr=<span style="color:#3ad900;font-weight:400">"yes"</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">else</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;aslr=<span style="color:#3ad900;font-weight:400">"NO&nbsp;"</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;modrecord[<span style="color:#ff0044;font-weight:400">7</span>]==<span style="color:#3ad900;font-weight:400">"1"</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;nx=<span style="color:#3ad900;font-weight:400">"yes"</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">else</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;nx=<span style="color:#3ad900;font-weight:400">"NO&nbsp;"</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;modrecord[<span style="color:#ff0044;font-weight:400">10</span>]==<span style="color:#3ad900;font-weight:400">"1"</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;osdll=<span style="color:#3ad900;font-weight:400">"yes"</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">else</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;osdll=<span style="color:#3ad900;font-weight:400">"NO&nbsp;"</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tofile(<span style="color:#3ad900;font-weight:400">"&nbsp;&nbsp;&nbsp;"</span>+rebased+<span style="color:#3ad900;font-weight:400">"&nbsp;&nbsp;&nbsp;|&nbsp;0x"</span>+tohex(<span style="color:#ff9d00;font-weight:700">int</span>(modrecord[<span style="color:#ff0044;font-weight:400">2</span>]))+<span style="color:#3ad900;font-weight:400">"&nbsp;|&nbsp;0x"</span>+tohex(<span style="color:#ff9d00;font-weight:700">int</span>(modrecord[<span style="color:#ff0044;font-weight:400">4</span>]))+<span style="color:#3ad900;font-weight:400">"&nbsp;|&nbsp;0x"</span>+tohex(<span style="color:#ff9d00;font-weight:700">int</span>(modrecord[<span style="color:#ff0044;font-weight:400">3</span>]))+<span style="color:#3ad900;font-weight:400">"&nbsp;|&nbsp;&nbsp;&nbsp;"</span>+safeseh+<span style="color:#3ad900;font-weight:400">"&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;"</span>+aslr+<span style="color:#3ad900;font-weight:400">"&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;"</span>+nx+<span style="color:#3ad900;font-weight:400">"&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;"</span>+osdll+<span style="color:#3ad900;font-weight:400">"&nbsp;&nbsp;|&nbsp;"</span>+modrecord[<span style="color:#ff0044;font-weight:400">9</span>]+<span style="color:#3ad900;font-weight:400">"&nbsp;-&nbsp;"</span>+modrecord[<span style="color:#ff0044;font-weight:400">0</span>]+<span style="color:#3ad900;font-weight:400">"&nbsp;:&nbsp;"</span>+modrecord[<span style="color:#ff0044;font-weight:400">1</span>],filename)<br />&nbsp;&nbsp;&nbsp;&nbsp;tofile(<span style="color:#3ad900;font-weight:400">"-------------------------------------------------------------------------------------------------------------------"</span>,filename)<br />&nbsp;&nbsp;&nbsp;&nbsp;tofile(<span style="color:#3ad900;font-weight:400">""</span>,filename)<br /><br /><span style="color:#3ad900;font-weight:400">"""<br />Various&nbsp;functions<br />"""</span><br /><br /><span style="color:#ff9d00;font-weight:700">def</span>&nbsp;tohex(n):<br />&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">return</span>&nbsp;<span style="color:#3ad900;font-weight:400">"%08X"</span>&nbsp;%&nbsp;n<br /><br /><span style="color:#ff9d00;font-weight:700">def</span>&nbsp;toascii(imm,n):<br />&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">try</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;asciiequival=binascii.a2b_hex(n)<br />&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">except</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;asciiequival=<span style="color:#3ad900;font-weight:400">"&nbsp;"</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#0088ff;font-weight:400">#print&nbsp;sys.exc_info()[0]</span><br />&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">return</span>&nbsp;asciiequival<br /><br /><span style="color:#ff9d00;font-weight:700">def</span>&nbsp;hex2signed(s):<br />&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">return</span>&nbsp;struct.unpack(<span style="color:#3ad900;font-weight:400">'!i'</span>,&nbsp;binascii.unhexlify(s))[<span style="color:#ff0044;font-weight:400">0</span>]<br /><br /><span style="color:#ff9d00;font-weight:700">def</span>&nbsp;hex2long(s):<br />&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">return</span>&nbsp;s.atol(<span style="color:#3ad900;font-weight:400">'FFFFFFFF'</span>,<span style="color:#ff0044;font-weight:400">16</span>)<br /><br /><span style="color:#ff9d00;font-weight:700">def</span>&nbsp;addresstoint(s):<br />&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">return</span>&nbsp;<span style="color:#ff9d00;font-weight:700">int</span>(s,&nbsp;<span style="color:#ff0044;font-weight:400">16</span>)<br /><br /><span style="color:#ff9d00;font-weight:700">def</span>&nbsp;tohexbyte(n):<br />&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">return</span>&nbsp;<span style="color:#3ad900;font-weight:400">"%02X"</span>&nbsp;%&nbsp;n<br /><br /><span style="color:#ff9d00;font-weight:700">def</span>&nbsp;u2(x):<br />&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;x&nbsp;&amp;&nbsp;<span style="color:#ff0044;font-weight:400">0x80</span>:&nbsp;<span style="color:#0088ff;font-weight:400">#&nbsp;MSB&nbsp;set&nbsp;-&gt;&nbsp;neg.</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">return</span>&nbsp;-((~x&nbsp;&amp;&nbsp;<span style="color:#ff0044;font-weight:400">0xff</span>)&nbsp;+&nbsp;<span style="color:#ff0044;font-weight:400">1</span>)<br />&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">else</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">return</span>&nbsp;x<br /><br /><span style="color:#ff9d00;font-weight:700">def</span>&nbsp;isarray(a):<br />&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">try</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sh&nbsp;=&nbsp;<span style="color:#ff9d00;font-weight:700">list</span>(a.shape)<br />&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">except</span>&nbsp;<span style="color:#7f0044;font-weight:400">AttributeError</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">return</span>&nbsp;<span style="color:#ff0044;font-weight:400">0</span><br />&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">try</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sh[<span style="color:#ff0044;font-weight:400">0</span>]&nbsp;=&nbsp;sh[<span style="color:#ff0044;font-weight:400">0</span>]+<span style="color:#ff0044;font-weight:400">1</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;a.shape&nbsp;=&nbsp;sh<br />&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">except</span>&nbsp;<span style="color:#7f0044;font-weight:400">ValueError</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">return</span>&nbsp;<span style="color:#ff0044;font-weight:400">1</span><br />&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">except</span>&nbsp;<span style="color:#7f0044;font-weight:400">IndexError</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">return</span>&nbsp;<span style="color:#ff0044;font-weight:400">1</span>&nbsp;<span style="color:#0088ff;font-weight:400">#&nbsp;?&nbsp;this&nbsp;is&nbsp;a&nbsp;scalar&nbsp;array</span><br />&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">return</span>&nbsp;<span style="color:#ff0044;font-weight:400">0</span><br /><br /><span style="color:#3ad900;font-weight:400">"""<br />Encoding<br />"""</span><br /><br /><span style="color:#ff9d00;font-weight:700">def</span>&nbsp;doencode(args):<br />&nbsp;&nbsp;&nbsp;&nbsp;imm=&nbsp;&nbsp;immlib.Debugger();<br />&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;<span style="color:#ff9d00;font-weight:700">len</span>(args)&nbsp;&gt;=&nbsp;<span style="color:#ff0044;font-weight:400">3</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#0088ff;font-weight:400">#args[1]&nbsp;=&nbsp;mode</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#0088ff;font-weight:400">#args[2]&nbsp;=&nbsp;opcode&nbsp;to&nbsp;encode</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#0088ff;font-weight:400">#args[3]&nbsp;=&nbsp;badchars&nbsp;(optional)</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#0088ff;font-weight:400">#&nbsp;or</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#0088ff;font-weight:400">#args[1]&nbsp;=&nbsp;mode</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#0088ff;font-weight:400">#args[2]&nbsp;=&nbsp;baseaddress&nbsp;of&nbsp;opcode&nbsp;to&nbsp;encode&nbsp;(starts&nbsp;with&nbsp;-b)</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#0088ff;font-weight:400">#args[3]&nbsp;=&nbsp;size</span><br />	&nbsp;&nbsp;&nbsp;<span style="color:#0088ff;font-weight:400">#args[4]&nbsp;=&nbsp;badchars&nbsp;(optional)</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;badchars=[]<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;btoencode=args[<span style="color:#ff0044;font-weight:400">2</span>]<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#0088ff;font-weight:400">#add&nbsp;bad&nbsp;chars&nbsp;provided&nbsp;at&nbsp;command&nbsp;line,&nbsp;if&nbsp;applicable</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;(args[<span style="color:#ff0044;font-weight:400">2</span>].lower().startswith(<span style="color:#3ad900;font-weight:400">"-b"</span>)):<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#0088ff;font-weight:400">#there&nbsp;must&nbsp;be&nbsp;4th&nbsp;parameter&nbsp;specifying&nbsp;size</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;<span style="color:#ff9d00;font-weight:700">len</span>(args)&nbsp;&gt;=&nbsp;<span style="color:#ff0044;font-weight:400">4</span>&nbsp;<span style="color:#ff9d00;font-weight:700">and</span>&nbsp;<span style="color:#ff9d00;font-weight:700">len</span>(args[<span style="color:#ff0044;font-weight:400">2</span>])&nbsp;&gt;&nbsp;<span style="color:#ff0044;font-weight:400">4</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#0088ff;font-weight:400">#read&nbsp;data</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;startaddr=args[<span style="color:#ff0044;font-weight:400">2</span>]<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;startaddr=startaddr[<span style="color:#ff0044;font-weight:400">2</span>:<span style="color:#ff9d00;font-weight:700">len</span>(args[<span style="color:#ff0044;font-weight:400">2</span>])]<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;startaddr=startaddr.replace(<span style="color:#3ad900;font-weight:400">'0x'</span>,<span style="color:#3ad900;font-weight:400">''</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;startaddr=startaddr.replace(<span style="color:#3ad900;font-weight:400">'0X'</span>,<span style="color:#3ad900;font-weight:400">''</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;startloc=addresstoint(startaddr)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;bytes=<span style="color:#3ad900;font-weight:400">""</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">max</span>=<span style="color:#ff9d00;font-weight:700">int</span>(args[<span style="color:#ff0044;font-weight:400">3</span>])<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cnt=<span style="color:#ff0044;font-weight:400">0</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"Reading&nbsp;%d&nbsp;bytes&nbsp;from&nbsp;0x%s..."</span>&nbsp;%&nbsp;(<span style="color:#ff9d00;font-weight:700">max</span>,startaddr))<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.updateLog()<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">while</span>&nbsp;cnt&lt;<span style="color:#ff9d00;font-weight:700">max</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">try</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;memchar&nbsp;=&nbsp;imm.readMemory(startloc+cnt,<span style="color:#ff0044;font-weight:400">1</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;<span style="color:#ff9d00;font-weight:700">len</span>((<span style="color:#ff9d00;font-weight:700">hex</span>(<span style="color:#ff9d00;font-weight:700">ord</span>(memchar))).replace(<span style="color:#3ad900;font-weight:400">'0x'</span>,<span style="color:#3ad900;font-weight:400">''</span>))==<span style="color:#ff0044;font-weight:400">1</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;memchar2&nbsp;=&nbsp;<span style="color:#ff9d00;font-weight:700">hex</span>(<span style="color:#ff9d00;font-weight:700">ord</span>(memchar)).replace(<span style="color:#3ad900;font-weight:400">'0x'</span>,<span style="color:#3ad900;font-weight:400">'0'</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">else</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;memchar2&nbsp;=&nbsp;<span style="color:#ff9d00;font-weight:700">hex</span>(<span style="color:#ff9d00;font-weight:700">ord</span>(memchar)).replace(<span style="color:#3ad900;font-weight:400">'0x'</span>,<span style="color:#3ad900;font-weight:400">''</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;bytes=bytes+memchar2<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cnt=cnt+<span style="color:#ff0044;font-weight:400">1</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">except</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cnt=cnt+<span style="color:#ff0044;font-weight:400">1</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">pass</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;btoencode=bytes<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#0088ff;font-weight:400">#bad&nbsp;chars&nbsp;specified&nbsp;?</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;<span style="color:#ff9d00;font-weight:700">len</span>(args)&gt;=<span style="color:#ff0044;font-weight:400">5</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;srcdata=args[<span style="color:#ff0044;font-weight:400">4</span>]<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;maxcnt=<span style="color:#ff9d00;font-weight:700">len</span>(srcdata)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cnt=<span style="color:#ff0044;font-weight:400">0</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">while</span>&nbsp;(cnt&nbsp;&lt;&nbsp;maxcnt-<span style="color:#ff0044;font-weight:400">1</span>):<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;thischar=srcdata[cnt]+srcdata[cnt+<span style="color:#ff0044;font-weight:400">1</span>]<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;badchars.append(addresstoint(thischar))<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cnt=cnt+<span style="color:#ff0044;font-weight:400">2</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"Done&nbsp;-&nbsp;ready&nbsp;for&nbsp;encoding..."</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">else</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"You&nbsp;have&nbsp;specified&nbsp;a&nbsp;baseaddress,&nbsp;but&nbsp;forgot&nbsp;to&nbsp;mention&nbsp;the&nbsp;size&nbsp;parameter"</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">return</span><br /><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">else</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;<span style="color:#ff9d00;font-weight:700">len</span>(args)&gt;=<span style="color:#ff0044;font-weight:400">4</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;srcdata=args[<span style="color:#ff0044;font-weight:400">3</span>]<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#0088ff;font-weight:400">#imm.log("Bad&nbsp;chars&nbsp;specified&nbsp;at&nbsp;command&nbsp;line&nbsp;:&nbsp;%d"&nbsp;%&nbsp;len(srcdata))</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;maxcnt=<span style="color:#ff9d00;font-weight:700">len</span>(srcdata)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cnt=<span style="color:#ff0044;font-weight:400">0</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">while</span>&nbsp;(cnt&nbsp;&lt;&nbsp;maxcnt-<span style="color:#ff0044;font-weight:400">1</span>):<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;thischar=srcdata[cnt]+srcdata[cnt+<span style="color:#ff0044;font-weight:400">1</span>]<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;badchars.append(addresstoint(thischar))<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#0088ff;font-weight:400">#imm.log("Added&nbsp;to&nbsp;bad&nbsp;char&nbsp;list&nbsp;:&nbsp;%d"&nbsp;%&nbsp;addresstoint(thischar))</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cnt=cnt+<span style="color:#ff0044;font-weight:400">2</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;args[<span style="color:#ff0044;font-weight:400">1</span>].lower()==<span style="color:#3ad900;font-weight:400">"ascii"</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ib=<span style="color:#ff0044;font-weight:400">0</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">while</span>&nbsp;ib&lt;<span style="color:#ff0044;font-weight:400">32</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;badchars.append(ib)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ib=ib+<span style="color:#ff0044;font-weight:400">1</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ib=<span style="color:#ff0044;font-weight:400">127</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">while</span>&nbsp;ib&nbsp;&lt;=&nbsp;<span style="color:#ff0044;font-weight:400">255</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;badchars.append(ib)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ib=ib+<span style="color:#ff0044;font-weight:400">1</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pveencode(args[<span style="color:#ff0044;font-weight:400">1</span>],btoencode,badchars)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;args[<span style="color:#ff0044;font-weight:400">1</span>].lower()==<span style="color:#3ad900;font-weight:400">"alphanum"</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ib=<span style="color:#ff0044;font-weight:400">0</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">while</span>&nbsp;ib&nbsp;&lt;&nbsp;<span style="color:#ff0044;font-weight:400">32</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;badchars.append(ib)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ib=ib+<span style="color:#ff0044;font-weight:400">1</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ib=<span style="color:#ff0044;font-weight:400">33</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">while</span>&nbsp;ib&nbsp;&lt;=&nbsp;<span style="color:#ff0044;font-weight:400">47</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;badchars.append(ib)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ib=ib+<span style="color:#ff0044;font-weight:400">1</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ib=<span style="color:#ff0044;font-weight:400">58</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">while</span>&nbsp;ib&nbsp;&lt;=&nbsp;<span style="color:#ff0044;font-weight:400">64</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;badchars.append(ib)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ib=ib+<span style="color:#ff0044;font-weight:400">1</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ib=<span style="color:#ff0044;font-weight:400">91</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">while</span>&nbsp;ib&nbsp;&lt;=&nbsp;<span style="color:#ff0044;font-weight:400">96</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;badchars.append(ib)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ib=ib+<span style="color:#ff0044;font-weight:400">1</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ib=<span style="color:#ff0044;font-weight:400">123</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">while</span>&nbsp;ib&nbsp;&lt;=&nbsp;<span style="color:#ff0044;font-weight:400">255</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;badchars.append(ib)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ib=ib+<span style="color:#ff0044;font-weight:400">1</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pveencode(args[<span style="color:#ff0044;font-weight:400">1</span>],btoencode,badchars)<br />&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">else</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"Encode&nbsp;:&nbsp;Missing&nbsp;parameters,&nbsp;check&nbsp;syntax&nbsp;!"</span>)<br /><br /><br /><span style="color:#ff9d00;font-weight:700">def</span>&nbsp;pveencode(<span style="color:#ff9d00;font-weight:700">type</span>,source,badchars):<br />&nbsp;&nbsp;filename=<span style="color:#3ad900;font-weight:400">"encoded.txt"</span><br />&nbsp;&nbsp;resetfile(filename)<br />&nbsp;&nbsp;imm&nbsp;=&nbsp;immlib.Debugger()<br />&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;<span style="color:#ff9d00;font-weight:700">type</span>==<span style="color:#3ad900;font-weight:400">"ascii"</span>&nbsp;<span style="color:#ff9d00;font-weight:700">or</span>&nbsp;<span style="color:#ff9d00;font-weight:700">type</span>==<span style="color:#3ad900;font-weight:400">"alphanum"</span>:<br />&nbsp;&nbsp;&nbsp;<span style="color:#0088ff;font-weight:400">#see&nbsp;if&nbsp;source&nbsp;is&nbsp;a&nbsp;filename</span><br />&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;os.path.isfile(source):<br />	&nbsp;&nbsp;&nbsp;<span style="color:#0088ff;font-weight:400">#read&nbsp;into&nbsp;variable</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"Reading&nbsp;file&nbsp;%s..."</span>&nbsp;%&nbsp;source)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;srcdata=[]<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;srcfile&nbsp;=&nbsp;<span style="color:#ff9d00;font-weight:700">open</span>(source,<span style="color:#3ad900;font-weight:400">"rb"</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;content&nbsp;=&nbsp;srcfile.readlines()<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;srcfile.close()<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">for</span>&nbsp;eachLine&nbsp;<span style="color:#ff9d00;font-weight:700">in</span>&nbsp;content:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;srcdata&nbsp;+=&nbsp;eachLine<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;Read&nbsp;%d&nbsp;bytes&nbsp;from&nbsp;file"</span>&nbsp;%&nbsp;<span style="color:#ff9d00;font-weight:700">len</span>(srcdata))<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cnt=<span style="color:#ff0044;font-weight:400">0</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;maxcnt=<span style="color:#ff9d00;font-weight:700">len</span>(srcdata)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;source=<span style="color:#3ad900;font-weight:400">""</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;hexchar=<span style="color:#3ad900;font-weight:400">""</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">while</span>&nbsp;(cnt&nbsp;&lt;&nbsp;maxcnt):<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">try</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;<span style="color:#ff9d00;font-weight:700">len</span>((<span style="color:#ff9d00;font-weight:700">hex</span>(<span style="color:#ff9d00;font-weight:700">ord</span>(srcdata[cnt]))).replace(<span style="color:#3ad900;font-weight:400">'0x'</span>,<span style="color:#3ad900;font-weight:400">''</span>))==<span style="color:#ff0044;font-weight:400">1</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;hexchar=<span style="color:#ff9d00;font-weight:700">hex</span>(<span style="color:#ff9d00;font-weight:700">ord</span>(srcdata[cnt])).replace(<span style="color:#3ad900;font-weight:400">'0x'</span>,&nbsp;<span style="color:#3ad900;font-weight:400">'0'</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">else</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;hexchar&nbsp;=&nbsp;<span style="color:#ff9d00;font-weight:700">hex</span>(<span style="color:#ff9d00;font-weight:700">ord</span>(srcdata[cnt])).replace(<span style="color:#3ad900;font-weight:400">'0x'</span>,&nbsp;<span style="color:#3ad900;font-weight:400">''</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;source&nbsp;+=&nbsp;hexchar<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cnt=cnt+<span style="color:#ff0044;font-weight:400">1</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">except</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"Unable&nbsp;to&nbsp;process&nbsp;byte&nbsp;%d&nbsp;"</span>&nbsp;%&nbsp;cnt)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cnt=cnt+<span style="color:#ff0044;font-weight:400">1</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"Bytes&nbsp;read&nbsp;from&nbsp;file&nbsp;:&nbsp;%s&nbsp;"</span>&nbsp;%&nbsp;source)<br />	<span style="color:#0088ff;font-weight:400">#parameter&nbsp;are&nbsp;now&nbsp;bytes</span><br />&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#0088ff;font-weight:400">#make&nbsp;sure&nbsp;total&nbsp;number&nbsp;multiple&nbsp;of&nbsp;8</span><br />&nbsp;&nbsp;&nbsp;&nbsp;opack=<span style="color:#ff9d00;font-weight:700">len</span>(source)/<span style="color:#ff0044;font-weight:400">8</span><br />&nbsp;&nbsp;&nbsp;&nbsp;npack=opack*<span style="color:#ff0044;font-weight:400">8</span><br />&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;npack&nbsp;!=&nbsp;<span style="color:#ff9d00;font-weight:700">len</span>(source):<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;target=((<span style="color:#ff9d00;font-weight:700">len</span>(source)/<span style="color:#ff0044;font-weight:400">8</span>)+<span style="color:#ff0044;font-weight:400">1</span>)*<span style="color:#ff0044;font-weight:400">8</span><br />&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">else</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;target=<span style="color:#ff9d00;font-weight:700">len</span>(source)<br />&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">while</span>&nbsp;<span style="color:#ff9d00;font-weight:700">len</span>(source)&nbsp;&lt;&nbsp;target:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#0088ff;font-weight:400">#add&nbsp;null&nbsp;bytes</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;source=source+<span style="color:#3ad900;font-weight:400">"0"</span><br />&nbsp;&nbsp;&nbsp;&nbsp;nrblocks=<span style="color:#ff9d00;font-weight:700">len</span>(source)/<span style="color:#ff0044;font-weight:400">8</span><br />&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"ASCII&nbsp;encoder"</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"-------------"</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"4&nbsp;byte&nbsp;aligned&nbsp;opcode&nbsp;to&nbsp;encode&nbsp;:&nbsp;%s"</span>&nbsp;%&nbsp;source)<br />&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"Number&nbsp;of&nbsp;bytes&nbsp;to&nbsp;encode&nbsp;:&nbsp;%d"</span>&nbsp;%&nbsp;((<span style="color:#ff9d00;font-weight:700">len</span>(source))/<span style="color:#ff0044;font-weight:400">2</span>))<br />&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"Number&nbsp;of&nbsp;encoding&nbsp;blocks&nbsp;:&nbsp;%d&nbsp;(4&nbsp;byte&nbsp;each)"</span>&nbsp;%&nbsp;nrblocks)<br />&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">""</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;imm.updateLog()<br />&nbsp;&nbsp;&nbsp;&nbsp;blockcnt=nrblocks<br />&nbsp;&nbsp;&nbsp;&nbsp;encoded=[]<br />&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">while</span>&nbsp;blockcnt&nbsp;&gt;&nbsp;<span style="color:#ff0044;font-weight:400">0</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;opcodes=[]<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;startpos=(blockcnt*<span style="color:#ff0044;font-weight:400">8</span>)-<span style="color:#ff0044;font-weight:400">1</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;origbytes=source[startpos-<span style="color:#ff0044;font-weight:400">7</span>]+source[startpos-<span style="color:#ff0044;font-weight:400">6</span>]+source[startpos-<span style="color:#ff0044;font-weight:400">5</span>]+source[startpos-<span style="color:#ff0044;font-weight:400">4</span>]+source[startpos-<span style="color:#ff0044;font-weight:400">3</span>]+source[startpos-<span style="color:#ff0044;font-weight:400">2</span>]+source[startpos-<span style="color:#ff0044;font-weight:400">1</span>]+source[startpos]<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;reversebytes=origbytes[<span style="color:#ff0044;font-weight:400">6</span>]+origbytes[<span style="color:#ff0044;font-weight:400">7</span>]+origbytes[<span style="color:#ff0044;font-weight:400">4</span>]+origbytes[<span style="color:#ff0044;font-weight:400">5</span>]+origbytes[<span style="color:#ff0044;font-weight:400">2</span>]+origbytes[<span style="color:#ff0044;font-weight:400">3</span>]+origbytes[<span style="color:#ff0044;font-weight:400">0</span>]+origbytes[<span style="color:#ff0044;font-weight:400">1</span>]<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;revval=addresstoint(reversebytes)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;twoval=<span style="color:#ff0044;font-weight:400">4294967296</span>-revval<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;twobytes=tohex(twoval)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"Block&nbsp;%d"</span>&nbsp;%&nbsp;(nrblocks-blockcnt+<span style="color:#ff0044;font-weight:400">1</span>))<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"---------"</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"Opcode&nbsp;to&nbsp;produce&nbsp;:&nbsp;%s%s&nbsp;%s%s&nbsp;%s%s&nbsp;%s%s"</span>&nbsp;%&nbsp;(origbytes[<span style="color:#ff0044;font-weight:400">0</span>],origbytes[<span style="color:#ff0044;font-weight:400">1</span>],origbytes[<span style="color:#ff0044;font-weight:400">2</span>],origbytes[<span style="color:#ff0044;font-weight:400">3</span>],origbytes[<span style="color:#ff0044;font-weight:400">4</span>],origbytes[<span style="color:#ff0044;font-weight:400">5</span>],origbytes[<span style="color:#ff0044;font-weight:400">6</span>],origbytes[<span style="color:#ff0044;font-weight:400">7</span>]))<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;reversed&nbsp;:&nbsp;%s%s&nbsp;%s%s&nbsp;%s%s&nbsp;%s%s"</span>&nbsp;%&nbsp;(reversebytes[<span style="color:#ff0044;font-weight:400">0</span>],reversebytes[<span style="color:#ff0044;font-weight:400">1</span>],reversebytes[<span style="color:#ff0044;font-weight:400">2</span>],reversebytes[<span style="color:#ff0044;font-weight:400">3</span>],reversebytes[<span style="color:#ff0044;font-weight:400">4</span>],reversebytes[<span style="color:#ff0044;font-weight:400">5</span>],reversebytes[<span style="color:#ff0044;font-weight:400">6</span>],reversebytes[<span style="color:#ff0044;font-weight:400">7</span>]))<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-----------"</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;&nbsp;&nbsp;2's&nbsp;complement&nbsp;:&nbsp;%s%s&nbsp;%s%s&nbsp;%s%s&nbsp;%s%s"</span>&nbsp;%&nbsp;(twobytes[<span style="color:#ff0044;font-weight:400">0</span>],twobytes[<span style="color:#ff0044;font-weight:400">1</span>],twobytes[<span style="color:#ff0044;font-weight:400">2</span>],twobytes[<span style="color:#ff0044;font-weight:400">3</span>],twobytes[<span style="color:#ff0044;font-weight:400">4</span>],twobytes[<span style="color:#ff0044;font-weight:400">5</span>],twobytes[<span style="color:#ff0044;font-weight:400">6</span>],twobytes[<span style="color:#ff0044;font-weight:400">7</span>]))<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.updateLog()<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#0088ff;font-weight:400">#for&nbsp;each&nbsp;byte,&nbsp;start&nbsp;with&nbsp;last&nbsp;one&nbsp;first</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;bcnt=<span style="color:#ff0044;font-weight:400">3</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;overflow=<span style="color:#ff0044;font-weight:400">0</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">while</span>&nbsp;bcnt&nbsp;&gt;=&nbsp;<span style="color:#ff0044;font-weight:400">0</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;currbyte=twobytes[(bcnt*<span style="color:#ff0044;font-weight:400">2</span>)]+twobytes[(bcnt*<span style="color:#ff0044;font-weight:400">2</span>)+<span style="color:#ff0044;font-weight:400">1</span>]<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;currval=addresstoint(currbyte)-overflow<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;testval=currval/<span style="color:#ff0044;font-weight:400">3</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;testval&nbsp;&lt;&nbsp;<span style="color:#ff0044;font-weight:400">32</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#0088ff;font-weight:400">#put&nbsp;1&nbsp;in&nbsp;front&nbsp;of&nbsp;byte</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;currbyte=<span style="color:#3ad900;font-weight:400">"1"</span>+currbyte<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;currval=addresstoint(currbyte)-overflow<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;overflow=<span style="color:#ff0044;font-weight:400">1</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">else</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;overflow=<span style="color:#ff0044;font-weight:400">0</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;val1=currval/<span style="color:#ff0044;font-weight:400">3</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;val2=currval/<span style="color:#ff0044;font-weight:400">3</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;val3=currval/<span style="color:#ff0044;font-weight:400">3</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sumval=val1+val2+val3<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;sumval&nbsp;&lt;&nbsp;currval:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;val3=val3+(currval-sumval)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#0088ff;font-weight:400">#validate&nbsp;/&nbsp;fix&nbsp;badchars</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fixvals=validatebadchars(val1,val2,val3,badchars)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;val1=fixvals[<span style="color:#ff0044;font-weight:400">0</span>]<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;val2=fixvals[<span style="color:#ff0044;font-weight:400">1</span>]<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;val3=fixvals[<span style="color:#ff0044;font-weight:400">2</span>]<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;opcodes.append(tohexbyte(val1))<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;opcodes.append(tohexbyte(val2))<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;opcodes.append(tohexbyte(val3))<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;bcnt=bcnt-<span style="color:#ff0044;font-weight:400">1</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-----------"</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;%s&nbsp;%s&nbsp;%s&nbsp;%s"</span>&nbsp;%&nbsp;(opcodes[<span style="color:#ff0044;font-weight:400">9</span>],opcodes[<span style="color:#ff0044;font-weight:400">6</span>],opcodes[<span style="color:#ff0044;font-weight:400">3</span>],opcodes[<span style="color:#ff0044;font-weight:400">0</span>]))<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;%s&nbsp;%s&nbsp;%s&nbsp;%s"</span>&nbsp;%&nbsp;(opcodes[<span style="color:#ff0044;font-weight:400">10</span>],opcodes[<span style="color:#ff0044;font-weight:400">7</span>],opcodes[<span style="color:#ff0044;font-weight:400">4</span>],opcodes[<span style="color:#ff0044;font-weight:400">1</span>]))<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;%s&nbsp;%s&nbsp;%s&nbsp;%s"</span>&nbsp;%&nbsp;(opcodes[<span style="color:#ff0044;font-weight:400">11</span>],opcodes[<span style="color:#ff0044;font-weight:400">8</span>],opcodes[<span style="color:#ff0044;font-weight:400">5</span>],opcodes[<span style="color:#ff0044;font-weight:400">2</span>]))<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#0088ff;font-weight:400">#zero&nbsp;eax</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;encoded.append(<span style="color:#3ad900;font-weight:400">"25"</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;encoded.append(<span style="color:#3ad900;font-weight:400">"4A"</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;encoded.append(<span style="color:#3ad900;font-weight:400">"4D"</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;encoded.append(<span style="color:#3ad900;font-weight:400">"4E"</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;encoded.append(<span style="color:#3ad900;font-weight:400">"55"</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;encoded.append(<span style="color:#3ad900;font-weight:400">"25"</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;encoded.append(<span style="color:#3ad900;font-weight:400">"35"</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;encoded.append(<span style="color:#3ad900;font-weight:400">"32"</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;encoded.append(<span style="color:#3ad900;font-weight:400">"31"</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;encoded.append(<span style="color:#3ad900;font-weight:400">"2A"</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#0088ff;font-weight:400">#SUB&nbsp;EAX&nbsp;instructions</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;encoded.append(<span style="color:#3ad900;font-weight:400">"2D"</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;encoded.append(opcodes[<span style="color:#ff0044;font-weight:400">0</span>])<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;encoded.append(opcodes[<span style="color:#ff0044;font-weight:400">3</span>])<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;encoded.append(opcodes[<span style="color:#ff0044;font-weight:400">6</span>])<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;encoded.append(opcodes[<span style="color:#ff0044;font-weight:400">9</span>])<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;encoded.append(<span style="color:#3ad900;font-weight:400">"2D"</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;encoded.append(opcodes[<span style="color:#ff0044;font-weight:400">1</span>])<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;encoded.append(opcodes[<span style="color:#ff0044;font-weight:400">4</span>])<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;encoded.append(opcodes[<span style="color:#ff0044;font-weight:400">7</span>])<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;encoded.append(opcodes[<span style="color:#ff0044;font-weight:400">10</span>])<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;encoded.append(<span style="color:#3ad900;font-weight:400">"2D"</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;encoded.append(opcodes[<span style="color:#ff0044;font-weight:400">2</span>])<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;encoded.append(opcodes[<span style="color:#ff0044;font-weight:400">5</span>])<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;encoded.append(opcodes[<span style="color:#ff0044;font-weight:400">8</span>])<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;encoded.append(opcodes[<span style="color:#ff0044;font-weight:400">11</span>])<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#0088ff;font-weight:400">#push&nbsp;eax</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;encoded.append(<span style="color:#3ad900;font-weight:400">"50"</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;blockcnt=blockcnt-<span style="color:#ff0044;font-weight:400">1</span><br />&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">""</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"Decoder&nbsp;:&nbsp;%d&nbsp;bytes"</span>&nbsp;%&nbsp;<span style="color:#ff9d00;font-weight:700">len</span>(encoded))<br />&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"-------------------"</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"[+]&nbsp;#Perl&nbsp;code&nbsp;-&nbsp;bytes"</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;tofile(<span style="color:#3ad900;font-weight:400">"#&nbsp;Original&nbsp;bytes&nbsp;to&nbsp;decode&nbsp;:&nbsp;"</span>&nbsp;+&nbsp;source,filename)<br />&nbsp;&nbsp;&nbsp;&nbsp;tofile(<span style="color:#3ad900;font-weight:400">"#&nbsp;Original&nbsp;size&nbsp;:&nbsp;"</span>&nbsp;+&nbsp;<span style="color:#ff9d00;font-weight:700">str</span>(<span style="color:#ff9d00;font-weight:700">len</span>(source))+<span style="color:#3ad900;font-weight:400">"&nbsp;bytes"</span>,filename)<br />&nbsp;&nbsp;&nbsp;&nbsp;tofile(<span style="color:#3ad900;font-weight:400">"#&nbsp;Encoded&nbsp;size&nbsp;:&nbsp;"</span>&nbsp;+&nbsp;<span style="color:#ff9d00;font-weight:700">str</span>(<span style="color:#ff9d00;font-weight:700">len</span>(encoded))+<span style="color:#3ad900;font-weight:400">"&nbsp;bytes"</span>,filename)<br />&nbsp;&nbsp;&nbsp;&nbsp;tofile(<span style="color:#3ad900;font-weight:400">"#&nbsp;Perl&nbsp;code"</span>,filename)<br />&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"my&nbsp;$decoder="</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;tofile(<span style="color:#3ad900;font-weight:400">"my&nbsp;$decoder="</span>,filename)<br />&nbsp;&nbsp;&nbsp;&nbsp;dcnt=<span style="color:#ff0044;font-weight:400">0</span><br />&nbsp;&nbsp;&nbsp;&nbsp;blockcnt=<span style="color:#ff0044;font-weight:400">0</span><br />&nbsp;&nbsp;&nbsp;&nbsp;decoderstring=<span style="color:#3ad900;font-weight:400">""</span><br />&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#0088ff;font-weight:400">#26&nbsp;bytes&nbsp;per&nbsp;block</span><br />&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">while</span>&nbsp;dcnt&nbsp;&lt;&nbsp;<span style="color:#ff9d00;font-weight:700">len</span>(encoded):<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;bcnt=<span style="color:#ff0044;font-weight:400">0</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;thisline=<span style="color:#3ad900;font-weight:400">'"'</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;blockcnt&nbsp;&gt;=&nbsp;<span style="color:#ff0044;font-weight:400">26</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;blockcnt=<span style="color:#ff0044;font-weight:400">0</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">while</span>&nbsp;(bcnt&nbsp;&lt;&nbsp;<span style="color:#ff0044;font-weight:400">5</span>)&nbsp;<span style="color:#ff9d00;font-weight:700">and</span>&nbsp;(dcnt&nbsp;&lt;&nbsp;<span style="color:#ff9d00;font-weight:700">len</span>(encoded))&nbsp;<span style="color:#ff9d00;font-weight:700">and</span>&nbsp;(blockcnt&nbsp;&lt;&nbsp;<span style="color:#ff0044;font-weight:400">26</span>):<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;thisline=thisline+<span style="color:#3ad900;font-weight:400">"\\x"</span>+encoded[dcnt]<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;bcnt=bcnt+<span style="color:#ff0044;font-weight:400">1</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dcnt=dcnt+<span style="color:#ff0044;font-weight:400">1</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;blockcnt=blockcnt+<span style="color:#ff0044;font-weight:400">1</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;dcnt&nbsp;&lt;&nbsp;<span style="color:#ff9d00;font-weight:700">len</span>(encoded):<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;thisline=thisline+<span style="color:#3ad900;font-weight:400">'".'</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">else</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;thisline=thisline+<span style="color:#3ad900;font-weight:400">'";'</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"%s"</span>&nbsp;%&nbsp;thisline)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tofile(thisline,filename)<br />&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">""</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"[+]&nbsp;#Perl&nbsp;code&nbsp;-&nbsp;ascii&nbsp;characters"</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;tofile(<span style="color:#3ad900;font-weight:400">""</span>,filename)<br />&nbsp;&nbsp;&nbsp;&nbsp;tofile(<span style="color:#3ad900;font-weight:400">"#&nbsp;Perl&nbsp;code&nbsp;-&nbsp;ascii&nbsp;characters"</span>,filename)<br />&nbsp;&nbsp;&nbsp;&nbsp;dcnt=<span style="color:#ff0044;font-weight:400">0</span><br />&nbsp;&nbsp;&nbsp;&nbsp;decoderstring=<span style="color:#3ad900;font-weight:400">""</span><br />&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">while</span>&nbsp;dcnt&nbsp;&lt;&nbsp;<span style="color:#ff9d00;font-weight:700">len</span>(encoded):<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;thisbyte=toascii(imm,encoded[dcnt])<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;decoderstring=decoderstring+thisbyte<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dcnt=dcnt+<span style="color:#ff0044;font-weight:400">1</span><br />&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"my&nbsp;$decoder=\"%s\";"</span>&nbsp;%&nbsp;decoderstring)<br />&nbsp;&nbsp;&nbsp;&nbsp;tofile(<span style="color:#3ad900;font-weight:400">"my&nbsp;$decoder=\""</span>&nbsp;+&nbsp;decoderstring&nbsp;+&nbsp;<span style="color:#3ad900;font-weight:400">"\";"</span>,filename)<br />&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">""</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"Output&nbsp;written&nbsp;to&nbsp;encoded.txt"</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">""</span>)<br /><br /><br /><br /><span style="color:#ff9d00;font-weight:700">def</span>&nbsp;validatebadchars(val1,val2,val3,badchars):<br />&nbsp;&nbsp;&nbsp;&nbsp;newvals=[]<br />&nbsp;&nbsp;&nbsp;&nbsp;imm&nbsp;=&nbsp;immlib.Debugger()<br />&nbsp;&nbsp;&nbsp;&nbsp;allok=<span style="color:#ff0044;font-weight:400">0</span><br />&nbsp;&nbsp;&nbsp;&nbsp;giveup=<span style="color:#ff0044;font-weight:400">0</span><br />&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">type</span>=<span style="color:#ff0044;font-weight:400">0</span><br />&nbsp;&nbsp;&nbsp;&nbsp;origval1=val1<br />&nbsp;&nbsp;&nbsp;&nbsp;origval2=val2<br />&nbsp;&nbsp;&nbsp;&nbsp;origval3=val3<br />&nbsp;&nbsp;&nbsp;&nbsp;d1=<span style="color:#ff0044;font-weight:400">0</span><br />&nbsp;&nbsp;&nbsp;&nbsp;d2=<span style="color:#ff0044;font-weight:400">0</span><br />&nbsp;&nbsp;&nbsp;&nbsp;d3=<span style="color:#ff0044;font-weight:400">0</span><br />&nbsp;&nbsp;&nbsp;&nbsp;lastd1=<span style="color:#ff0044;font-weight:400">0</span><br />&nbsp;&nbsp;&nbsp;&nbsp;lastd2=<span style="color:#ff0044;font-weight:400">0</span><br />&nbsp;&nbsp;&nbsp;&nbsp;lastd3=<span style="color:#ff0044;font-weight:400">0</span><br />&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">while</span>&nbsp;allok==<span style="color:#ff0044;font-weight:400">0</span>&nbsp;<span style="color:#ff9d00;font-weight:700">and</span>&nbsp;giveup==<span style="color:#ff0044;font-weight:400">0</span>:<br />	<span style="color:#0088ff;font-weight:400">#check&nbsp;if&nbsp;there&nbsp;are&nbsp;bad&nbsp;chars&nbsp;left</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;charcnt=<span style="color:#ff0044;font-weight:400">0</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;val1ok=<span style="color:#ff0044;font-weight:400">1</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;val2ok=<span style="color:#ff0044;font-weight:400">1</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;val3ok=<span style="color:#ff0044;font-weight:400">1</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">while</span>&nbsp;charcnt&nbsp;&lt;&nbsp;<span style="color:#ff9d00;font-weight:700">len</span>(badchars):<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;(val1&nbsp;==&nbsp;badchars[charcnt]):<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;val1ok=<span style="color:#ff0044;font-weight:400">0</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;(val2&nbsp;==&nbsp;badchars[charcnt]):<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;val2ok=<span style="color:#ff0044;font-weight:400">0</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;(val3&nbsp;==&nbsp;badchars[charcnt]):<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;val3ok=<span style="color:#ff0044;font-weight:400">0</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;charcnt=charcnt+<span style="color:#ff0044;font-weight:400">1</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;(val1ok==<span style="color:#ff0044;font-weight:400">0</span>)&nbsp;<span style="color:#ff9d00;font-weight:700">or</span>&nbsp;(val2ok==<span style="color:#ff0044;font-weight:400">0</span>)&nbsp;<span style="color:#ff9d00;font-weight:700">or</span>&nbsp;(val3ok==<span style="color:#ff0044;font-weight:400">0</span>):<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;allok=<span style="color:#ff0044;font-weight:400">0</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">else</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;allok=<span style="color:#ff0044;font-weight:400">1</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;allok==<span style="color:#ff0044;font-weight:400">0</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#0088ff;font-weight:400">#try&nbsp;first&nbsp;by&nbsp;sub&nbsp;1&nbsp;from&nbsp;val1&nbsp;and&nbsp;val2,&nbsp;and&nbsp;add&nbsp;more&nbsp;to&nbsp;val3</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;<span style="color:#ff9d00;font-weight:700">type</span>==<span style="color:#ff0044;font-weight:400">0</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;val1=val1-<span style="color:#ff0044;font-weight:400">1</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;val2=val2-<span style="color:#ff0044;font-weight:400">1</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;val3=val3+<span style="color:#ff0044;font-weight:400">2</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;(val1&lt;<span style="color:#ff0044;font-weight:400">1</span>)&nbsp;<span style="color:#ff9d00;font-weight:700">or</span>&nbsp;(val2==<span style="color:#ff0044;font-weight:400">0</span>)&nbsp;<span style="color:#ff9d00;font-weight:700">or</span>&nbsp;(val3&nbsp;&gt;&nbsp;<span style="color:#ff0044;font-weight:400">126</span>):<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;val1=origval1<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;val2=origval2<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;val3=origval3<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">type</span>=<span style="color:#ff0044;font-weight:400">1</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;<span style="color:#ff9d00;font-weight:700">type</span>==<span style="color:#ff0044;font-weight:400">1</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#0088ff;font-weight:400">#then&nbsp;try&nbsp;by&nbsp;add&nbsp;1&nbsp;to&nbsp;val1&nbsp;and&nbsp;val2,&nbsp;and&nbsp;sub&nbsp;more&nbsp;from&nbsp;val3</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;val1=val1+<span style="color:#ff0044;font-weight:400">1</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;val2=val2+<span style="color:#ff0044;font-weight:400">1</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;val3=val3-<span style="color:#ff0044;font-weight:400">2</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;(val1&gt;<span style="color:#ff0044;font-weight:400">126</span>)&nbsp;<span style="color:#ff9d00;font-weight:700">or</span>&nbsp;(val2&gt;<span style="color:#ff0044;font-weight:400">126</span>)&nbsp;<span style="color:#ff9d00;font-weight:700">or</span>&nbsp;(val3&nbsp;&lt;&nbsp;<span style="color:#ff0044;font-weight:400">1</span>):<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;val1=origval1<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;val2=origval2<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;val3=origval3<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">type</span>=<span style="color:#ff0044;font-weight:400">2</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;<span style="color:#ff9d00;font-weight:700">type</span>==<span style="color:#ff0044;font-weight:400">2</span>:<br />&nbsp;&nbsp;		&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#0088ff;font-weight:400">#try&nbsp;by&nbsp;sub&nbsp;2&nbsp;from&nbsp;val1,&nbsp;and&nbsp;add&nbsp;1&nbsp;to&nbsp;val2&nbsp;and&nbsp;val3</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;val1=val1-<span style="color:#ff0044;font-weight:400">2</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;val2=val2+<span style="color:#ff0044;font-weight:400">1</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;val3=val3+<span style="color:#ff0044;font-weight:400">1</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;(val1&lt;<span style="color:#ff0044;font-weight:400">1</span>)&nbsp;<span style="color:#ff9d00;font-weight:700">or</span>&nbsp;(val2&gt;<span style="color:#ff0044;font-weight:400">126</span>)&nbsp;<span style="color:#ff9d00;font-weight:700">or</span>&nbsp;(val3&nbsp;&gt;&nbsp;<span style="color:#ff0044;font-weight:400">126</span>):<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;val1=origval1<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;val2=origval2<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;val3=origval3<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">type</span>=<span style="color:#ff0044;font-weight:400">3</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;<span style="color:#ff9d00;font-weight:700">type</span>==<span style="color:#ff0044;font-weight:400">3</span>:<br />	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#0088ff;font-weight:400">#try&nbsp;by&nbsp;add&nbsp;2&nbsp;to&nbsp;val1,&nbsp;and&nbsp;sub&nbsp;1&nbsp;from&nbsp;val2&nbsp;and&nbsp;val3</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;val1=val1+<span style="color:#ff0044;font-weight:400">2</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;val2=val2-<span style="color:#ff0044;font-weight:400">1</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;val3=val3-<span style="color:#ff0044;font-weight:400">1</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;(val1&nbsp;&gt;&nbsp;<span style="color:#ff0044;font-weight:400">126</span>)&nbsp;<span style="color:#ff9d00;font-weight:700">or</span>&nbsp;(val2&nbsp;&lt;&nbsp;<span style="color:#ff0044;font-weight:400">1</span>)&nbsp;<span style="color:#ff9d00;font-weight:700">or</span>&nbsp;(val3&nbsp;&lt;&nbsp;<span style="color:#ff0044;font-weight:400">1</span>):<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;val1=origval1<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;val2=origval2<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;val3=origval3<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">type</span>=<span style="color:#ff0044;font-weight:400">4</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;<span style="color:#ff9d00;font-weight:700">type</span>==<span style="color:#ff0044;font-weight:400">4</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;(val1ok==<span style="color:#ff0044;font-weight:400">0</span>):<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;val1=val1-<span style="color:#ff0044;font-weight:400">1</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;d1=d1+<span style="color:#ff0044;font-weight:400">1</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">else</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#0088ff;font-weight:400">#now&nbsp;spread&nbsp;delta&nbsp;over&nbsp;other&nbsp;2&nbsp;values</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;(d1&nbsp;&gt;&nbsp;<span style="color:#ff0044;font-weight:400">0</span>):<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;val2=val2+<span style="color:#ff0044;font-weight:400">1</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;val3=origval3+d1-<span style="color:#ff0044;font-weight:400">1</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;d1=d1-<span style="color:#ff0044;font-weight:400">1</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">else</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;val1=<span style="color:#ff0044;font-weight:400">0</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;(val1&nbsp;&lt;&nbsp;<span style="color:#ff0044;font-weight:400">1</span>)&nbsp;<span style="color:#ff9d00;font-weight:700">or</span>&nbsp;(val2&nbsp;&gt;&nbsp;<span style="color:#ff0044;font-weight:400">126</span>)&nbsp;<span style="color:#ff9d00;font-weight:700">or</span>&nbsp;(val3&nbsp;&gt;&nbsp;<span style="color:#ff0044;font-weight:400">126</span>):<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;val1=origval1<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;val2=origval2<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;val3=origval3<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;d1=<span style="color:#ff0044;font-weight:400">0</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">type</span>=<span style="color:#ff0044;font-weight:400">5</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;<span style="color:#ff9d00;font-weight:700">type</span>==<span style="color:#ff0044;font-weight:400">5</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;(val1ok==<span style="color:#ff0044;font-weight:400">0</span>):<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;val1=val1+<span style="color:#ff0044;font-weight:400">1</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;d1=d1+<span style="color:#ff0044;font-weight:400">1</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">else</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#0088ff;font-weight:400">#now&nbsp;spread&nbsp;delta&nbsp;over&nbsp;other&nbsp;2&nbsp;values</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;(d1&nbsp;&gt;&nbsp;<span style="color:#ff0044;font-weight:400">0</span>):<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;val2=val2-<span style="color:#ff0044;font-weight:400">1</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;val3=origval3-d1+<span style="color:#ff0044;font-weight:400">1</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;d1=d1-<span style="color:#ff0044;font-weight:400">1</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">else</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;val1=<span style="color:#ff0044;font-weight:400">255</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;(val1&gt;<span style="color:#ff0044;font-weight:400">126</span>)&nbsp;<span style="color:#ff9d00;font-weight:700">or</span>&nbsp;(val2&nbsp;&lt;&nbsp;<span style="color:#ff0044;font-weight:400">1</span>)&nbsp;<span style="color:#ff9d00;font-weight:700">or</span>&nbsp;(val3&nbsp;&lt;&nbsp;<span style="color:#ff0044;font-weight:400">1</span>):<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;val1=origval1<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;val2=origval2<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;val3=origval3<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;val1ok=<span style="color:#ff0044;font-weight:400">0</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;val2ok=<span style="color:#ff0044;font-weight:400">0</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;val3ok=<span style="color:#ff0044;font-weight:400">0</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;d1=<span style="color:#ff0044;font-weight:400">0</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;d2=<span style="color:#ff0044;font-weight:400">0</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;d3=<span style="color:#ff0044;font-weight:400">0</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">type</span>=<span style="color:#ff0044;font-weight:400">6</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;<span style="color:#ff9d00;font-weight:700">type</span>==<span style="color:#ff0044;font-weight:400">6</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;(val1ok==<span style="color:#ff0044;font-weight:400">0</span>):<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;val1=val1-<span style="color:#ff0044;font-weight:400">1</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#0088ff;font-weight:400">#d1=d1+1</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;(val2ok==<span style="color:#ff0044;font-weight:400">0</span>):<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;val2=val2+<span style="color:#ff0044;font-weight:400">1</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#0088ff;font-weight:400">#d2=d2+1</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;d3=origval1-val1+origval2-val2<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;val3=origval3+d3<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#0088ff;font-weight:400">#imm.log("%d&nbsp;-&gt;&nbsp;%d&nbsp;--&nbsp;%d&nbsp;-&gt;&nbsp;%d&nbsp;--&nbsp;%d&nbsp;-&gt;&nbsp;%d&nbsp;(delta&nbsp;%d)"&nbsp;%&nbsp;(origval1,val1,origval2,val2,origval3,val3,d3))</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;(lastd3==d3)&nbsp;<span style="color:#ff9d00;font-weight:700">and</span>&nbsp;(d3&nbsp;&gt;&nbsp;<span style="color:#ff0044;font-weight:400">0</span>):<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;val1=origval1<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;val2=origval2<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;val3=origval3<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;giveup=<span style="color:#ff0044;font-weight:400">1</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">else</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lastd3=d3<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;(val1&lt;<span style="color:#ff0044;font-weight:400">1</span>)&nbsp;<span style="color:#ff9d00;font-weight:700">or</span>&nbsp;(val2&nbsp;&lt;&nbsp;<span style="color:#ff0044;font-weight:400">1</span>)&nbsp;<span style="color:#ff9d00;font-weight:700">or</span>&nbsp;(val3&nbsp;&gt;&nbsp;<span style="color:#ff0044;font-weight:400">126</span>):<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;val1=origval1<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;val2=origval2<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;val3=origval3<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;giveup=<span style="color:#ff0044;font-weight:400">1</span><br />&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#0088ff;font-weight:400">#check&nbsp;results</span><br />	charcnt=<span style="color:#ff0044;font-weight:400">0</span><br />&nbsp;&nbsp;&nbsp;&nbsp;val1ok=<span style="color:#ff0044;font-weight:400">1</span><br />&nbsp;&nbsp;&nbsp;&nbsp;val2ok=<span style="color:#ff0044;font-weight:400">1</span><br />&nbsp;&nbsp;&nbsp;&nbsp;val3ok=<span style="color:#ff0044;font-weight:400">1</span><br />&nbsp;&nbsp;&nbsp;&nbsp;val1text=<span style="color:#3ad900;font-weight:400">"OK"</span><br />&nbsp;&nbsp;&nbsp;&nbsp;val2text=<span style="color:#3ad900;font-weight:400">"OK"</span><br />&nbsp;&nbsp;&nbsp;&nbsp;val3text=<span style="color:#3ad900;font-weight:400">"OK"</span><br />&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">while</span>&nbsp;charcnt&nbsp;&lt;&nbsp;<span style="color:#ff9d00;font-weight:700">len</span>(badchars):<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;(val1&nbsp;==&nbsp;badchars[charcnt]):<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;val1ok=<span style="color:#ff0044;font-weight:400">0</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;val1text=<span style="color:#3ad900;font-weight:400">"NOK"</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;(val2&nbsp;==&nbsp;badchars[charcnt]):<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;val2ok=<span style="color:#ff0044;font-weight:400">0</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;val2text=<span style="color:#3ad900;font-weight:400">"NOK"</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;(val3&nbsp;==&nbsp;badchars[charcnt]):<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;val3ok=<span style="color:#ff0044;font-weight:400">0</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;val3text=<span style="color:#3ad900;font-weight:400">"NOK"</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;charcnt=charcnt+<span style="color:#ff0044;font-weight:400">1</span><br /><br />&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;(val1ok==<span style="color:#ff0044;font-weight:400">0</span>)&nbsp;<span style="color:#ff9d00;font-weight:700">or</span>&nbsp;(val2ok==<span style="color:#ff0044;font-weight:400">0</span>)&nbsp;<span style="color:#ff9d00;font-weight:700">or</span>&nbsp;(val3ok==<span style="color:#ff0044;font-weight:400">0</span>):<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;&nbsp;**&nbsp;Unable&nbsp;to&nbsp;fix&nbsp;bad&nbsp;char&nbsp;issue&nbsp;!"</span>,highlight=<span style="color:#ff0044;font-weight:400">1</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&gt;&nbsp;Values&nbsp;to&nbsp;check&nbsp;:&nbsp;%s(%s)&nbsp;%s(%s)&nbsp;%s(%s)&nbsp;"</span>&nbsp;%&nbsp;(tohexbyte(origval1),val1text,tohexbyte(origval2),val2text,tohexbyte(origval3),val3text),highlight=<span style="color:#ff0044;font-weight:400">1</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;val1=origval1<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;val2=origval2<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;val3=origval3<br />&nbsp;&nbsp;&nbsp;&nbsp;newvals.append(val1)<br />&nbsp;&nbsp;&nbsp;&nbsp;newvals.append(val2)<br />&nbsp;&nbsp;&nbsp;&nbsp;newvals.append(val3)<br />&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">return</span>&nbsp;newvals<br /><br /><span style="color:#3ad900;font-weight:400">"""<br />Function&nbsp;to&nbsp;get&nbsp;info&nbsp;about&nbsp;a&nbsp;given&nbsp;address<br />"""</span><br /><span style="color:#ff9d00;font-weight:700">def</span>&nbsp;addressinfo(address):<br />&nbsp;&nbsp;&nbsp;&nbsp;imm&nbsp;=&nbsp;immlib.Debugger()<br />&nbsp;&nbsp;&nbsp;&nbsp;module&nbsp;=&nbsp;getmodnamefromptr(address)<br />&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;<span style="color:#ff9d00;font-weight:700">len</span>(g_modules)==<span style="color:#ff0044;font-weight:400">0</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;moduleinfo()<br />&nbsp;&nbsp;&nbsp;&nbsp;allmodules=g_mods<br />&nbsp;&nbsp;&nbsp;&nbsp;tagstr=<span style="color:#3ad900;font-weight:400">"[Module&nbsp;:&nbsp;"</span><br />&nbsp;&nbsp;&nbsp;&nbsp;modpath=<span style="color:#3ad900;font-weight:400">""</span><br />&nbsp;&nbsp;&nbsp;&nbsp;osmodule=<span style="color:#3ad900;font-weight:400">""</span><br />&nbsp;&nbsp;&nbsp;&nbsp;extrastring=<span style="color:#3ad900;font-weight:400">""</span><br />&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;module:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;module&nbsp;==&nbsp;<span style="color:#3ad900;font-weight:400">""</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tagstr=tagstr+<span style="color:#3ad900;font-weight:400">"none]"</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">else</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;modpath=<span style="color:#3ad900;font-weight:400">"&nbsp;-&nbsp;"</span>&nbsp;+&nbsp;getmoduleprop(module,<span style="color:#3ad900;font-weight:400">"path"</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;osmodule=<span style="color:#3ad900;font-weight:400">"&nbsp;*&nbsp;System&nbsp;dll&nbsp;:&nbsp;"</span>&nbsp;+&nbsp;getmoduleprop(module,<span style="color:#3ad900;font-weight:400">"systemdll"</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mversion=getmoduleprop(module,<span style="color:#3ad900;font-weight:400">"version"</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tagstr=tagstr+module+<span style="color:#3ad900;font-weight:400">"]"</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;mversion&nbsp;!=&nbsp;<span style="color:#3ad900;font-weight:400">""</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tagstr=tagstr+<span style="color:#3ad900;font-weight:400">"&nbsp;v"</span>+mversion<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;getmoduleprop(module,<span style="color:#3ad900;font-weight:400">"fixup"</span>)==<span style="color:#3ad900;font-weight:400">"1"</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tagstr=tagstr+<span style="color:#3ad900;font-weight:400">"&nbsp;[Fixup:&nbsp;Yes]&nbsp;"</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">else</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tagstr=tagstr+<span style="color:#3ad900;font-weight:400">"&nbsp;[Fixup:&nbsp;**&nbsp;NO&nbsp;**]&nbsp;"</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;ismodulenosafeseh(module)&nbsp;==&nbsp;<span style="color:#ff0044;font-weight:400">1</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tagstr=tagstr+<span style="color:#3ad900;font-weight:400">"&nbsp;[SafeSEH:&nbsp;**&nbsp;NO&nbsp;**&nbsp;-&nbsp;"</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">else</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tagstr=tagstr+<span style="color:#3ad900;font-weight:400">"&nbsp;[SafeSEH:&nbsp;Yes&nbsp;-&nbsp;"</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;ismodulenoaslr(module)&nbsp;==&nbsp;<span style="color:#ff0044;font-weight:400">1</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tagstr=tagstr+<span style="color:#3ad900;font-weight:400">"ASLR:&nbsp;**&nbsp;No&nbsp;(Probably&nbsp;not)&nbsp;**]"</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">else</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tagstr=tagstr+<span style="color:#3ad900;font-weight:400">"ASLR&nbsp;:&nbsp;Yes]"</span><br />&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">else</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tagstr=tagstr+<span style="color:#3ad900;font-weight:400">"none]"</span><br />&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">try</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;page&nbsp;&nbsp;&nbsp;=&nbsp;imm.getMemoryPagebyAddress(&nbsp;address&nbsp;)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;access&nbsp;=&nbsp;page.getAccess(&nbsp;human&nbsp;=&nbsp;<span style="color:#ff0044;font-weight:400">True</span>&nbsp;)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;extrastring=<span style="color:#3ad900;font-weight:400">"&nbsp;{"</span>+access+<span style="color:#3ad900;font-weight:400">"}"</span>+modpath<br />&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">except</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">pass</span><br />&nbsp;&nbsp;&nbsp;&nbsp;memTypestr&nbsp;=&nbsp;imm.vmQuery(address)<br />&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;<span style="color:#ff9d00;font-weight:700">not</span>&nbsp;memTypestr:<br />		memType&nbsp;=&nbsp;<span style="color:#3ad900;font-weight:400">"0x00000000"</span><br />&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">else</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;memType&nbsp;=&nbsp;<span style="color:#3ad900;font-weight:400">"0x%08x"</span>&nbsp;%&nbsp;memTypestr[<span style="color:#ff0044;font-weight:400">4</span>]<br />&nbsp;&nbsp;&nbsp;&nbsp;memType=getMemType(memType)<br />&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">return</span>&nbsp;tagstr+<span style="color:#3ad900;font-weight:400">"]"</span>+extrastring&nbsp;+&nbsp;<span style="color:#3ad900;font-weight:400">"&nbsp;[Memory&nbsp;Type&nbsp;:&nbsp;"</span>&nbsp;+&nbsp;memType&nbsp;+&nbsp;<span style="color:#3ad900;font-weight:400">"]"</span>&nbsp;+&nbsp;osmodule<br /><br /><span style="color:#ff9d00;font-weight:700">def</span>&nbsp;getMemType(mtype):<br />&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;mtype.upper()==<span style="color:#3ad900;font-weight:400">"0X01000000"</span>&nbsp;:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">return</span>&nbsp;<span style="color:#3ad900;font-weight:400">"Image"</span><br />&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">elif</span>&nbsp;mtype.upper()==<span style="color:#3ad900;font-weight:400">"0X00040000"</span>&nbsp;:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">return</span>&nbsp;<span style="color:#3ad900;font-weight:400">"Mapped"</span><br />&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">elif</span>&nbsp;mtype.upper()==<span style="color:#3ad900;font-weight:400">"0X00020000"</span>&nbsp;:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">return</span>&nbsp;<span style="color:#3ad900;font-weight:400">"Private"</span><br />&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">elif</span>&nbsp;mtype.upper()==<span style="color:#3ad900;font-weight:400">"0X00010000"</span>&nbsp;:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">return</span>&nbsp;<span style="color:#3ad900;font-weight:400">"Free"</span><br />&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">elif</span>&nbsp;mtype.upper()==<span style="color:#3ad900;font-weight:400">"0X00002000"</span>&nbsp;:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">return</span>&nbsp;<span style="color:#3ad900;font-weight:400">"Reserved"</span><br />&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">elif</span>&nbsp;mtype.upper()==<span style="color:#3ad900;font-weight:400">"0X00001000"</span>&nbsp;:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">return</span>&nbsp;<span style="color:#3ad900;font-weight:400">"Committed"</span><br />&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">else</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">return</span>&nbsp;<span style="color:#3ad900;font-weight:400">"Unknown"</span><br /><span style="color:#3ad900;font-weight:400">"""<br /><br />"""</span><br /><span style="color:#ff9d00;font-weight:700">def</span>&nbsp;addressspec(hexaddr):<br />&nbsp;&nbsp;&nbsp;&nbsp;extrastring=<span style="color:#3ad900;font-weight:400">""</span><br />&nbsp;&nbsp;&nbsp;&nbsp;nbstring=<span style="color:#3ad900;font-weight:400">"&nbsp;**&nbsp;"</span><br />&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;(hexaddr[<span style="color:#ff0044;font-weight:400">0</span>]==<span style="color:#3ad900;font-weight:400">"0"</span>&nbsp;<span style="color:#ff9d00;font-weight:700">and</span>&nbsp;hexaddr[<span style="color:#ff0044;font-weight:400">1</span>]==<span style="color:#3ad900;font-weight:400">"0"</span>)&nbsp;<span style="color:#ff9d00;font-weight:700">or</span>&nbsp;(hexaddr[<span style="color:#ff0044;font-weight:400">2</span>]==<span style="color:#3ad900;font-weight:400">"0"</span>&nbsp;<span style="color:#ff9d00;font-weight:700">and</span>&nbsp;hexaddr[<span style="color:#ff0044;font-weight:400">3</span>]==<span style="color:#3ad900;font-weight:400">"0"</span>)&nbsp;<span style="color:#ff9d00;font-weight:700">or</span>&nbsp;(hexaddr[<span style="color:#ff0044;font-weight:400">4</span>]==<span style="color:#3ad900;font-weight:400">"0"</span>&nbsp;<span style="color:#ff9d00;font-weight:700">and</span>&nbsp;hexaddr[<span style="color:#ff0044;font-weight:400">5</span>]==<span style="color:#3ad900;font-weight:400">"0"</span>)&nbsp;<span style="color:#ff9d00;font-weight:700">or</span>&nbsp;(hexaddr[<span style="color:#ff0044;font-weight:400">6</span>]==<span style="color:#3ad900;font-weight:400">"0"</span>&nbsp;<span style="color:#ff9d00;font-weight:700">and</span>&nbsp;hexaddr[<span style="color:#ff0044;font-weight:400">7</span>]==<span style="color:#3ad900;font-weight:400">"0"</span>)&nbsp;:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;nbstring=<span style="color:#3ad900;font-weight:400">"&nbsp;**&nbsp;Null&nbsp;byte&nbsp;**"</span><br />&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;(hexaddr[<span style="color:#ff0044;font-weight:400">0</span>]==<span style="color:#3ad900;font-weight:400">"0"</span>&nbsp;<span style="color:#ff9d00;font-weight:700">and</span>&nbsp;hexaddr[<span style="color:#ff0044;font-weight:400">1</span>]==<span style="color:#3ad900;font-weight:400">"0"</span>&nbsp;<span style="color:#ff9d00;font-weight:700">and</span>&nbsp;hexaddr[<span style="color:#ff0044;font-weight:400">4</span>]==<span style="color:#3ad900;font-weight:400">"0"</span>&nbsp;<span style="color:#ff9d00;font-weight:700">and</span>&nbsp;hexaddr[<span style="color:#ff0044;font-weight:400">5</span>]==<span style="color:#3ad900;font-weight:400">"0"</span>):<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;extrastring=<span style="color:#3ad900;font-weight:400">"&nbsp;**&nbsp;Unicode&nbsp;compatible&nbsp;**&nbsp;"</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;nbstring=<span style="color:#3ad900;font-weight:400">"&nbsp;**&nbsp;Null&nbsp;byte&nbsp;**"</span><br />&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">else</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;(hexaddr[<span style="color:#ff0044;font-weight:400">0</span>]==<span style="color:#3ad900;font-weight:400">"0"</span>&nbsp;<span style="color:#ff9d00;font-weight:700">and</span>&nbsp;hexaddr[<span style="color:#ff0044;font-weight:400">1</span>]==<span style="color:#3ad900;font-weight:400">"0"</span>&nbsp;<span style="color:#ff9d00;font-weight:700">and</span>&nbsp;hexaddr[<span style="color:#ff0044;font-weight:400">4</span>]==<span style="color:#3ad900;font-weight:400">"0"</span>&nbsp;<span style="color:#ff9d00;font-weight:700">and</span>&nbsp;hexaddr[<span style="color:#ff0044;font-weight:400">5</span>]==<span style="color:#3ad900;font-weight:400">"1"</span>):<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;extrastring=<span style="color:#3ad900;font-weight:400">"&nbsp;**&nbsp;Maybe&nbsp;Unicode&nbsp;compatible&nbsp;**"</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;nbstring=<span style="color:#3ad900;font-weight:400">"&nbsp;**&nbsp;Null&nbsp;byte&nbsp;**"</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">else</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#0088ff;font-weight:400">#unicode&nbsp;conversion&nbsp;table&nbsp;-&nbsp;ansi</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;(hexaddr[<span style="color:#ff0044;font-weight:400">0</span>]==<span style="color:#3ad900;font-weight:400">"0"</span>&nbsp;<span style="color:#ff9d00;font-weight:700">and</span>&nbsp;hexaddr[<span style="color:#ff0044;font-weight:400">1</span>]==<span style="color:#3ad900;font-weight:400">"0"</span>):<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;nbstring=<span style="color:#3ad900;font-weight:400">"&nbsp;**&nbsp;Null&nbsp;byte&nbsp;**"</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;transform=<span style="color:#ff0044;font-weight:400">0</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;almosttransform=<span style="color:#ff0044;font-weight:400">0</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;twostr=hexaddr[<span style="color:#ff0044;font-weight:400">2</span>]+hexaddr[<span style="color:#ff0044;font-weight:400">3</span>]<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;threestr=hexaddr[<span style="color:#ff0044;font-weight:400">4</span>]+hexaddr[<span style="color:#ff0044;font-weight:400">5</span>]+hexaddr[<span style="color:#ff0044;font-weight:400">6</span>]<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fourstr=hexaddr[<span style="color:#ff0044;font-weight:400">4</span>]+hexaddr[<span style="color:#ff0044;font-weight:400">5</span>]+hexaddr[<span style="color:#ff0044;font-weight:400">6</span>]+hexaddr[<span style="color:#ff0044;font-weight:400">7</span>]<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;threestr=threestr.upper()<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fourstr=fourstr.upper()<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;uniansiconv&nbsp;=&nbsp;[&nbsp;&nbsp;[<span style="color:#3ad900;font-weight:400">"20AC"</span>,<span style="color:#3ad900;font-weight:400">"80"</span>],&nbsp;[<span style="color:#3ad900;font-weight:400">"201A"</span>,<span style="color:#3ad900;font-weight:400">"82"</span>],<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[<span style="color:#3ad900;font-weight:400">"0192"</span>,<span style="color:#3ad900;font-weight:400">"83"</span>],&nbsp;[<span style="color:#3ad900;font-weight:400">"201E"</span>,<span style="color:#3ad900;font-weight:400">"84"</span>],&nbsp;[<span style="color:#3ad900;font-weight:400">"2026"</span>,<span style="color:#3ad900;font-weight:400">"85"</span>],<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[<span style="color:#3ad900;font-weight:400">"2020"</span>,<span style="color:#3ad900;font-weight:400">"86"</span>],&nbsp;[<span style="color:#3ad900;font-weight:400">"2021"</span>,<span style="color:#3ad900;font-weight:400">"87"</span>],&nbsp;[<span style="color:#3ad900;font-weight:400">"02C6"</span>,<span style="color:#3ad900;font-weight:400">"88"</span>],<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[<span style="color:#3ad900;font-weight:400">"2030"</span>,<span style="color:#3ad900;font-weight:400">"89"</span>],&nbsp;[<span style="color:#3ad900;font-weight:400">"0106"</span>,<span style="color:#3ad900;font-weight:400">"8A"</span>],&nbsp;[<span style="color:#3ad900;font-weight:400">"2039"</span>,<span style="color:#3ad900;font-weight:400">"8B"</span>],<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[<span style="color:#3ad900;font-weight:400">"0152"</span>,<span style="color:#3ad900;font-weight:400">"8C"</span>],&nbsp;[<span style="color:#3ad900;font-weight:400">"017D"</span>,<span style="color:#3ad900;font-weight:400">"8E"</span>],&nbsp;[<span style="color:#3ad900;font-weight:400">"2018"</span>,<span style="color:#3ad900;font-weight:400">"91"</span>],<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[<span style="color:#3ad900;font-weight:400">"2019"</span>,<span style="color:#3ad900;font-weight:400">"92"</span>],&nbsp;[<span style="color:#3ad900;font-weight:400">"201C"</span>,<span style="color:#3ad900;font-weight:400">"93"</span>],&nbsp;[<span style="color:#3ad900;font-weight:400">"201D"</span>,<span style="color:#3ad900;font-weight:400">"94"</span>],<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[<span style="color:#3ad900;font-weight:400">"2022"</span>,<span style="color:#3ad900;font-weight:400">"95"</span>],&nbsp;[<span style="color:#3ad900;font-weight:400">"2013"</span>,<span style="color:#3ad900;font-weight:400">"96"</span>],&nbsp;[<span style="color:#3ad900;font-weight:400">"2014"</span>,<span style="color:#3ad900;font-weight:400">"97"</span>],<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[<span style="color:#3ad900;font-weight:400">"02DC"</span>,<span style="color:#3ad900;font-weight:400">"98"</span>],&nbsp;[<span style="color:#3ad900;font-weight:400">"2122"</span>,<span style="color:#3ad900;font-weight:400">"99"</span>],&nbsp;[<span style="color:#3ad900;font-weight:400">"0161"</span>,<span style="color:#3ad900;font-weight:400">"9A"</span>],<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[<span style="color:#3ad900;font-weight:400">"203A"</span>,<span style="color:#3ad900;font-weight:400">"9B"</span>],&nbsp;[<span style="color:#3ad900;font-weight:400">"0153"</span>,<span style="color:#3ad900;font-weight:400">"9C"</span>],&nbsp;[<span style="color:#3ad900;font-weight:400">"017E"</span>,<span style="color:#3ad900;font-weight:400">"9E"</span>],<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[<span style="color:#3ad900;font-weight:400">"0178"</span>,<span style="color:#3ad900;font-weight:400">"9F"</span>]<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;]<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;convbyte=<span style="color:#3ad900;font-weight:400">""</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;transbyte=<span style="color:#3ad900;font-weight:400">""</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ansibytes=<span style="color:#3ad900;font-weight:400">""</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">for</span>&nbsp;ansirec&nbsp;<span style="color:#ff9d00;font-weight:700">in</span>&nbsp;uniansiconv:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;transform==<span style="color:#ff0044;font-weight:400">0</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;ansirec[<span style="color:#ff0044;font-weight:400">0</span>]==fourstr:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;convbyte=ansirec[<span style="color:#ff0044;font-weight:400">1</span>]<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;transbyte=ansirec[<span style="color:#ff0044;font-weight:400">1</span>]<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;transform=<span style="color:#ff0044;font-weight:400">1</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;transform==<span style="color:#ff0044;font-weight:400">1</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;extrastring=<span style="color:#3ad900;font-weight:400">"&nbsp;**&nbsp;Unicode&nbsp;ANSI&nbsp;transformed&nbsp;:&nbsp;00"</span>+twostr+<span style="color:#3ad900;font-weight:400">"00"</span>+convbyte<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#0088ff;font-weight:400">#possibly&nbsp;close</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ansistring=<span style="color:#3ad900;font-weight:400">""</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">for</span>&nbsp;ansirec&nbsp;<span style="color:#ff9d00;font-weight:700">in</span>&nbsp;uniansiconv:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;ansirec[<span style="color:#ff0044;font-weight:400">0</span>][:<span style="color:#ff0044;font-weight:400">3</span>]==threestr:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;(transform==<span style="color:#ff0044;font-weight:400">0</span>)&nbsp;<span style="color:#ff9d00;font-weight:700">or</span>&nbsp;(transform==<span style="color:#ff0044;font-weight:400">1</span>&nbsp;<span style="color:#ff9d00;font-weight:700">and</span>&nbsp;ansirec[<span style="color:#ff0044;font-weight:400">1</span>]&nbsp;&lt;&gt;&nbsp;transbyte):<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;convbyte=ansirec[<span style="color:#ff0044;font-weight:400">1</span>]<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ansibytes=ansirec[<span style="color:#ff0044;font-weight:400">0</span>]<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ansistring=ansistring+<span style="color:#3ad900;font-weight:400">"00"</span>+twostr+<span style="color:#3ad900;font-weight:400">"00"</span>+convbyte+<span style="color:#3ad900;font-weight:400">"-&gt;00"</span>+twostr+ansibytes+<span style="color:#3ad900;font-weight:400">"&nbsp;/&nbsp;"</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;almosttransform=<span style="color:#ff0044;font-weight:400">1</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;almosttransform==<span style="color:#ff0044;font-weight:400">1</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;transform==<span style="color:#ff0044;font-weight:400">0</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;extrastring=<span style="color:#3ad900;font-weight:400">"&nbsp;**&nbsp;Unicode&nbsp;Possible&nbsp;ANSI&nbsp;transformation(s)&nbsp;:&nbsp;"</span>&nbsp;+&nbsp;ansistring<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">else</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;extrastring=extrastring&nbsp;+&nbsp;<span style="color:#3ad900;font-weight:400">"&nbsp;/&nbsp;Alternatives&nbsp;(close&nbsp;pointers)&nbsp;:&nbsp;"</span>&nbsp;+&nbsp;ansistring<br />&nbsp;&nbsp;&nbsp;&nbsp;extrastring=extrastring+nbstring<br />	<span style="color:#0088ff;font-weight:400">#see&nbsp;if&nbsp;address&nbsp;only&nbsp;contains&nbsp;limited&nbsp;ascii&nbsp;numbers/chars</span><br />&nbsp;&nbsp;&nbsp;&nbsp;b1=hexaddr[<span style="color:#ff0044;font-weight:400">0</span>]+hexaddr[<span style="color:#ff0044;font-weight:400">1</span>]<br />&nbsp;&nbsp;&nbsp;&nbsp;b2=hexaddr[<span style="color:#ff0044;font-weight:400">2</span>]+hexaddr[<span style="color:#ff0044;font-weight:400">3</span>]<br />&nbsp;&nbsp;&nbsp;&nbsp;b3=hexaddr[<span style="color:#ff0044;font-weight:400">4</span>]+hexaddr[<span style="color:#ff0044;font-weight:400">5</span>]<br />&nbsp;&nbsp;&nbsp;&nbsp;b4=hexaddr[<span style="color:#ff0044;font-weight:400">6</span>]+hexaddr[<span style="color:#ff0044;font-weight:400">7</span>]<br />&nbsp;&nbsp;&nbsp;&nbsp;bi1=addresstoint(b1)<br />&nbsp;&nbsp;&nbsp;&nbsp;bi2=addresstoint(b2)<br />&nbsp;&nbsp;&nbsp;&nbsp;bi3=addresstoint(b3)<br />&nbsp;&nbsp;&nbsp;&nbsp;bi4=addresstoint(b4)<br />	<span style="color:#0088ff;font-weight:400">#numbers&nbsp;:&nbsp;between&nbsp;48&nbsp;and&nbsp;57</span><br />	<span style="color:#0088ff;font-weight:400">#chars&nbsp;:&nbsp;between&nbsp;65&nbsp;and&nbsp;90,&nbsp;and&nbsp;between&nbsp;97&nbsp;and&nbsp;122</span><br />	<span style="color:#0088ff;font-weight:400">#just&nbsp;ascii&nbsp;friendly&nbsp;?</span><br />	<span style="color:#0088ff;font-weight:400">#between&nbsp;20&nbsp;and&nbsp;126</span><br />&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;(bi1&nbsp;&gt;=&nbsp;<span style="color:#ff0044;font-weight:400">32</span>&nbsp;<span style="color:#ff9d00;font-weight:700">and</span>&nbsp;bi1&nbsp;&lt;=&nbsp;<span style="color:#ff0044;font-weight:400">126</span>)&nbsp;<span style="color:#ff9d00;font-weight:700">and</span>&nbsp;(bi2&nbsp;&gt;=&nbsp;<span style="color:#ff0044;font-weight:400">32</span>&nbsp;<span style="color:#ff9d00;font-weight:700">and</span>&nbsp;bi2&nbsp;&lt;=&nbsp;<span style="color:#ff0044;font-weight:400">126</span>)&nbsp;<span style="color:#ff9d00;font-weight:700">and</span>&nbsp;(bi3&nbsp;&gt;=&nbsp;<span style="color:#ff0044;font-weight:400">32</span>&nbsp;<span style="color:#ff9d00;font-weight:700">and</span>&nbsp;bi3&nbsp;&lt;=&nbsp;<span style="color:#ff0044;font-weight:400">126</span>)&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">and</span>&nbsp;(bi4&nbsp;&gt;=&nbsp;<span style="color:#ff0044;font-weight:400">32</span>&nbsp;<span style="color:#ff9d00;font-weight:700">and</span>&nbsp;bi4&nbsp;&lt;=&nbsp;<span style="color:#ff0044;font-weight:400">126</span>):<br />	&nbsp;&nbsp;&nbsp;&nbsp;extrastring&nbsp;=&nbsp;extrastring&nbsp;+&nbsp;<span style="color:#3ad900;font-weight:400">"&nbsp;-&nbsp;[Ascii&nbsp;printable]"</span><br />&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;(bi1&nbsp;&gt;=&nbsp;<span style="color:#ff0044;font-weight:400">48</span>&nbsp;<span style="color:#ff9d00;font-weight:700">and</span>&nbsp;bi1&nbsp;&lt;=&nbsp;<span style="color:#ff0044;font-weight:400">57</span>)&nbsp;<span style="color:#ff9d00;font-weight:700">or</span>&nbsp;(bi1&nbsp;&gt;=&nbsp;<span style="color:#ff0044;font-weight:400">65</span>&nbsp;<span style="color:#ff9d00;font-weight:700">and</span>&nbsp;bi1&nbsp;&lt;=&nbsp;<span style="color:#ff0044;font-weight:400">90</span>)&nbsp;<span style="color:#ff9d00;font-weight:700">or</span>&nbsp;(bi1&nbsp;&gt;=&nbsp;<span style="color:#ff0044;font-weight:400">97</span>&nbsp;<span style="color:#ff9d00;font-weight:700">and</span>&nbsp;bi1&nbsp;&lt;=&nbsp;<span style="color:#ff0044;font-weight:400">122</span>):<br />	&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;(bi2&nbsp;&gt;=&nbsp;<span style="color:#ff0044;font-weight:400">48</span>&nbsp;<span style="color:#ff9d00;font-weight:700">and</span>&nbsp;bi2&nbsp;&lt;=&nbsp;<span style="color:#ff0044;font-weight:400">57</span>)&nbsp;<span style="color:#ff9d00;font-weight:700">or</span>&nbsp;(bi2&nbsp;&gt;=&nbsp;<span style="color:#ff0044;font-weight:400">65</span>&nbsp;<span style="color:#ff9d00;font-weight:700">and</span>&nbsp;bi2&nbsp;&lt;=&nbsp;<span style="color:#ff0044;font-weight:400">90</span>)&nbsp;<span style="color:#ff9d00;font-weight:700">or</span>&nbsp;(bi2&nbsp;&gt;=&nbsp;<span style="color:#ff0044;font-weight:400">97</span>&nbsp;<span style="color:#ff9d00;font-weight:700">and</span>&nbsp;bi2&nbsp;&lt;=&nbsp;<span style="color:#ff0044;font-weight:400">122</span>):<br />	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;(bi3&nbsp;&gt;=&nbsp;<span style="color:#ff0044;font-weight:400">48</span>&nbsp;<span style="color:#ff9d00;font-weight:700">and</span>&nbsp;bi3&nbsp;&lt;=&nbsp;<span style="color:#ff0044;font-weight:400">57</span>)&nbsp;<span style="color:#ff9d00;font-weight:700">or</span>&nbsp;(bi3&nbsp;&gt;=&nbsp;<span style="color:#ff0044;font-weight:400">65</span>&nbsp;<span style="color:#ff9d00;font-weight:700">and</span>&nbsp;bi3&nbsp;&lt;=&nbsp;<span style="color:#ff0044;font-weight:400">90</span>)&nbsp;<span style="color:#ff9d00;font-weight:700">or</span>&nbsp;(bi3&nbsp;&gt;=&nbsp;<span style="color:#ff0044;font-weight:400">97</span>&nbsp;<span style="color:#ff9d00;font-weight:700">and</span>&nbsp;bi3&nbsp;&lt;=&nbsp;<span style="color:#ff0044;font-weight:400">122</span>):<br />		&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;(bi4&nbsp;&gt;=&nbsp;<span style="color:#ff0044;font-weight:400">48</span>&nbsp;<span style="color:#ff9d00;font-weight:700">and</span>&nbsp;bi4&nbsp;&lt;=&nbsp;<span style="color:#ff0044;font-weight:400">57</span>)&nbsp;<span style="color:#ff9d00;font-weight:700">or</span>&nbsp;(bi4&nbsp;&gt;=&nbsp;<span style="color:#ff0044;font-weight:400">65</span>&nbsp;<span style="color:#ff9d00;font-weight:700">and</span>&nbsp;bi4&nbsp;&lt;=&nbsp;<span style="color:#ff0044;font-weight:400">90</span>)&nbsp;<span style="color:#ff9d00;font-weight:700">or</span>&nbsp;(bi4&nbsp;&gt;=&nbsp;<span style="color:#ff0044;font-weight:400">97</span>&nbsp;<span style="color:#ff9d00;font-weight:700">and</span>&nbsp;bi4&nbsp;&lt;=&nbsp;<span style="color:#ff0044;font-weight:400">122</span>):<br />				&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;extrastring=extrastring&nbsp;+&nbsp;<span style="color:#3ad900;font-weight:400">"&nbsp;&nbsp;-&nbsp;[Num&amp;Alphabet&nbsp;Chars&nbsp;only&nbsp;!]"</span><br />&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;(bi1==<span style="color:#ff0044;font-weight:400">0</span>)&nbsp;<span style="color:#ff9d00;font-weight:700">and</span>&nbsp;(bi2&nbsp;&gt;=&nbsp;<span style="color:#ff0044;font-weight:400">32</span>&nbsp;<span style="color:#ff9d00;font-weight:700">and</span>&nbsp;bi2&nbsp;&lt;=&nbsp;<span style="color:#ff0044;font-weight:400">126</span>)&nbsp;<span style="color:#ff9d00;font-weight:700">and</span>&nbsp;(bi3&nbsp;==&nbsp;<span style="color:#ff0044;font-weight:400">0</span>)&nbsp;<span style="color:#ff9d00;font-weight:700">and</span>&nbsp;(bi4&nbsp;&gt;=&nbsp;<span style="color:#ff0044;font-weight:400">32</span>&nbsp;<span style="color:#ff9d00;font-weight:700">and</span>&nbsp;bi4&nbsp;&lt;=&nbsp;<span style="color:#ff0044;font-weight:400">126</span>):<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;extrastring&nbsp;=&nbsp;extrastring&nbsp;+&nbsp;<span style="color:#3ad900;font-weight:400">"&nbsp;-&nbsp;[&nbsp;Ascii&nbsp;printable]"</span><br />&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;(bi1==<span style="color:#ff0044;font-weight:400">0</span>)&nbsp;<span style="color:#ff9d00;font-weight:700">and</span>&nbsp;(bi2&nbsp;&gt;=&nbsp;<span style="color:#ff0044;font-weight:400">32</span>&nbsp;<span style="color:#ff9d00;font-weight:700">and</span>&nbsp;bi2&nbsp;&lt;=&nbsp;<span style="color:#ff0044;font-weight:400">126</span>)&nbsp;<span style="color:#ff9d00;font-weight:700">and</span>&nbsp;(bi3&nbsp;&gt;=&nbsp;<span style="color:#ff0044;font-weight:400">32</span>&nbsp;<span style="color:#ff9d00;font-weight:700">and</span>&nbsp;bi3&nbsp;&lt;=&nbsp;<span style="color:#ff0044;font-weight:400">126</span>)&nbsp;<span style="color:#ff9d00;font-weight:700">and</span>&nbsp;(bi4&nbsp;&gt;=&nbsp;<span style="color:#ff0044;font-weight:400">32</span>&nbsp;<span style="color:#ff9d00;font-weight:700">and</span>&nbsp;bi4&nbsp;&lt;=&nbsp;<span style="color:#ff0044;font-weight:400">126</span>):<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;extrastring&nbsp;=&nbsp;extrastring&nbsp;+&nbsp;<span style="color:#3ad900;font-weight:400">"&nbsp;-&nbsp;[&nbsp;Ascii&nbsp;printable&nbsp;-&nbsp;null&nbsp;byte]"</span><br />	<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;(bi1==<span style="color:#ff0044;font-weight:400">0</span>)&nbsp;<span style="color:#ff9d00;font-weight:700">and</span>&nbsp;(bi3==<span style="color:#ff0044;font-weight:400">0</span>):<br />	&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;(bi2&nbsp;&gt;=&nbsp;<span style="color:#ff0044;font-weight:400">48</span>&nbsp;<span style="color:#ff9d00;font-weight:700">and</span>&nbsp;bi2&nbsp;&lt;=&nbsp;<span style="color:#ff0044;font-weight:400">57</span>)&nbsp;<span style="color:#ff9d00;font-weight:700">or</span>&nbsp;(bi2&nbsp;&gt;=&nbsp;<span style="color:#ff0044;font-weight:400">65</span>&nbsp;<span style="color:#ff9d00;font-weight:700">and</span>&nbsp;bi2&nbsp;&lt;=&nbsp;<span style="color:#ff0044;font-weight:400">90</span>)&nbsp;<span style="color:#ff9d00;font-weight:700">or</span>&nbsp;(bi2&nbsp;&gt;=&nbsp;<span style="color:#ff0044;font-weight:400">97</span>&nbsp;<span style="color:#ff9d00;font-weight:700">and</span>&nbsp;bi2&nbsp;&lt;=&nbsp;<span style="color:#ff0044;font-weight:400">122</span>):<br />		&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;(bi4&nbsp;&gt;=&nbsp;<span style="color:#ff0044;font-weight:400">48</span>&nbsp;<span style="color:#ff9d00;font-weight:700">and</span>&nbsp;bi4&nbsp;&lt;=&nbsp;<span style="color:#ff0044;font-weight:400">57</span>)&nbsp;<span style="color:#ff9d00;font-weight:700">or</span>&nbsp;(bi4&nbsp;&gt;=&nbsp;<span style="color:#ff0044;font-weight:400">65</span>&nbsp;<span style="color:#ff9d00;font-weight:700">and</span>&nbsp;bi4&nbsp;&lt;=&nbsp;<span style="color:#ff0044;font-weight:400">90</span>)&nbsp;<span style="color:#ff9d00;font-weight:700">or</span>&nbsp;(bi4&nbsp;&gt;=&nbsp;<span style="color:#ff0044;font-weight:400">97</span>&nbsp;<span style="color:#ff9d00;font-weight:700">and</span>&nbsp;bi4&nbsp;&lt;=&nbsp;<span style="color:#ff0044;font-weight:400">122</span>):<br />				&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;extrastring=extrastring&nbsp;+&nbsp;<span style="color:#3ad900;font-weight:400">"&nbsp;&nbsp;-&nbsp;[Num&amp;Alphabet&nbsp;Chars&nbsp;only&nbsp;!]"</span><br />&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">return</span>&nbsp;extrastring<br /><br /><span style="color:#3ad900;font-weight:400">"""<br />Function&nbsp;to&nbsp;write&nbsp;2&nbsp;logfile<br />"""</span><br /><span style="color:#ff9d00;font-weight:700">def</span>&nbsp;tofile(info,file1,address=<span style="color:#ff0044;font-weight:400">0</span>):<br />&nbsp;&nbsp;&nbsp;&nbsp;extrastring=<span style="color:#3ad900;font-weight:400">""</span><br />&nbsp;&nbsp;&nbsp;&nbsp;tagstr=<span style="color:#3ad900;font-weight:400">""</span><br />&nbsp;&nbsp;&nbsp;&nbsp;modpath=<span style="color:#3ad900;font-weight:400">""</span><br />&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;address&nbsp;&gt;&nbsp;<span style="color:#ff0044;font-weight:400">0</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;hexaddr=tohex(address)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm&nbsp;=&nbsp;immlib.Debugger()<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;<span style="color:#ff9d00;font-weight:700">len</span>(g_modules)==<span style="color:#ff0044;font-weight:400">0</span>:<br />	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;moduleinfo()<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;extrastring=addressspec(hexaddr)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;info=info.replace(<span style="color:#3ad900;font-weight:400">'\n'</span>,<span style="color:#3ad900;font-weight:400">'&nbsp;-&nbsp;'</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#0088ff;font-weight:400">#&nbsp;safeseh/aslr&nbsp;marker&nbsp;if&nbsp;we&nbsp;have&nbsp;a&nbsp;module</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;module&nbsp;=&nbsp;getmodnamefromptr(address)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;module:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;module&nbsp;==&nbsp;<span style="color:#3ad900;font-weight:400">""</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tagstr=tagstr+<span style="color:#3ad900;font-weight:400">"none]"</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">else</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mp=getmoduleprop(module,<span style="color:#3ad900;font-weight:400">"path"</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;modpath=<span style="color:#3ad900;font-weight:400">"&nbsp;-&nbsp;"</span>&nbsp;+mp<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;ismodulenosafeseh(module)&nbsp;==&nbsp;<span style="color:#ff0044;font-weight:400">1</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tagstr=<span style="color:#3ad900;font-weight:400">"&nbsp;[SafeSEH:&nbsp;**&nbsp;NO&nbsp;**&nbsp;-&nbsp;"</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">else</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tagstr=<span style="color:#3ad900;font-weight:400">"&nbsp;[SafeSEH:&nbsp;Yes&nbsp;-&nbsp;"</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">try</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;ismodulenoaslr(module)&nbsp;==&nbsp;<span style="color:#ff0044;font-weight:400">1</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tagstr=tagstr+<span style="color:#3ad900;font-weight:400">"ASLR:&nbsp;**&nbsp;No&nbsp;(Probably&nbsp;not)&nbsp;**]"</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">else</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tagstr=tagstr+<span style="color:#3ad900;font-weight:400">"ASLR&nbsp;:&nbsp;Yes]"</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">except</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tagstr=tagstr+<span style="color:#3ad900;font-weight:400">"ASLR&nbsp;:&nbsp;Unable&nbsp;to&nbsp;determine]"</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;getmoduleprop(module,<span style="color:#3ad900;font-weight:400">"fixup"</span>)==<span style="color:#3ad900;font-weight:400">"1"</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tagstr=tagstr+<span style="color:#3ad900;font-weight:400">"&nbsp;[Fixup:&nbsp;Yes]&nbsp;"</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">else</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tagstr=tagstr+<span style="color:#3ad900;font-weight:400">"&nbsp;[Fixup:&nbsp;**&nbsp;NO&nbsp;**]&nbsp;"</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">try</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;page&nbsp;&nbsp;&nbsp;=&nbsp;imm.getMemoryPagebyAddress(&nbsp;address&nbsp;)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;access&nbsp;=&nbsp;page.getAccess(&nbsp;human&nbsp;=&nbsp;<span style="color:#ff0044;font-weight:400">True</span>&nbsp;)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;extrastring=extrastring&nbsp;+&nbsp;<span style="color:#3ad900;font-weight:400">"&nbsp;{"</span>+access+<span style="color:#3ad900;font-weight:400">"}"</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">except</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">pass</span><br />&nbsp;&nbsp;&nbsp;&nbsp;FILE=<span style="color:#ff9d00;font-weight:700">open</span>(file1,<span style="color:#3ad900;font-weight:400">"a"</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;FILE.write(info+extrastring+tagstr+modpath+<span style="color:#3ad900;font-weight:400">"\n"</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;FILE.close()<br />&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">return</span>&nbsp;<span style="color:#3ad900;font-weight:400">""</span><br /><br /><span style="color:#ff9d00;font-weight:700">def</span>&nbsp;resetfile(file1):<br />&nbsp;&nbsp;&nbsp;&nbsp;imm&nbsp;=&nbsp;immlib.Debugger()<br />&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">try</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;os.path.exists(file1):<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">try</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;os.delete(file1+<span style="color:#3ad900;font-weight:400">".old"</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">except</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">pass</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">try</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;os.rename(file1,file1+<span style="color:#3ad900;font-weight:400">".old"</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">except</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">try</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;os.rename(file1,file1+<span style="color:#3ad900;font-weight:400">".old2"</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">except</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">pass</span><br />&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">except</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">pass</span><br />&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">try</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FILE=<span style="color:#ff9d00;font-weight:700">open</span>(file1,<span style="color:#3ad900;font-weight:400">"w"</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FILE.write(<span style="color:#3ad900;font-weight:400">"="</span>&nbsp;*&nbsp;<span style="color:#ff0044;font-weight:400">80</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FILE.write(<span style="color:#3ad900;font-weight:400">"\n&nbsp;&nbsp;Output&nbsp;generated&nbsp;by&nbsp;pvefindaddr&nbsp;v"</span>+__VERSION__+<span style="color:#3ad900;font-weight:400">"\n"</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FILE.write(<span style="color:#3ad900;font-weight:400">"&nbsp;&nbsp;corelanc0d3r&nbsp;-&nbsp;http://www.corelan.be:8800\n"</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FILE.write(<span style="color:#3ad900;font-weight:400">"="</span>&nbsp;*&nbsp;<span style="color:#ff0044;font-weight:400">80</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;osver=imm.getOsVersion()<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;osrel=imm.getOsRelease()<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FILE.write(<span style="color:#3ad900;font-weight:400">"\n&nbsp;&nbsp;OS&nbsp;:&nbsp;"</span>&nbsp;+&nbsp;osver&nbsp;+&nbsp;<span style="color:#3ad900;font-weight:400">",&nbsp;release&nbsp;"</span>&nbsp;+&nbsp;osrel+<span style="color:#3ad900;font-weight:400">"\n"</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FILE.write(<span style="color:#3ad900;font-weight:400">"="</span>&nbsp;*&nbsp;<span style="color:#ff0044;font-weight:400">80</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FILE.write(<span style="color:#3ad900;font-weight:400">"\n&nbsp;&nbsp;"</span>&nbsp;+&nbsp;datetime.datetime.now().strftime(<span style="color:#3ad900;font-weight:400">"%Y-%m-%d&nbsp;%I:%M:%S"</span>)&nbsp;+&nbsp;<span style="color:#3ad900;font-weight:400">"\n"</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FILE.write(<span style="color:#3ad900;font-weight:400">"="</span>&nbsp;*&nbsp;<span style="color:#ff0044;font-weight:400">80</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FILE.write(<span style="color:#3ad900;font-weight:400">"\n"</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FILE.close()<br />&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">except</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">pass</span><br />&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">return</span>&nbsp;<span style="color:#3ad900;font-weight:400">""</span><br /><br /><span style="color:#ff9d00;font-weight:700">def</span>&nbsp;IsNumber(value):<br />&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">return</span>&nbsp;<span style="color:#ff9d00;font-weight:700">str</span>(value).replace(<span style="color:#3ad900;font-weight:400">"."</span>,&nbsp;<span style="color:#3ad900;font-weight:400">""</span>).replace(<span style="color:#3ad900;font-weight:400">"-"</span>,&nbsp;<span style="color:#3ad900;font-weight:400">""</span>).replace(<span style="color:#3ad900;font-weight:400">","</span>,<span style="color:#3ad900;font-weight:400">""</span>).isdigit()<br /><br /><span style="color:#3ad900;font-weight:400">"""<br />Metasploit-compatible&nbsp;pattern<br />"""</span><br /><span style="color:#ff9d00;font-weight:700">def</span>&nbsp;pattern_create(size):<br />&nbsp;&nbsp;&nbsp;&nbsp;char1=<span style="color:#3ad900;font-weight:400">"ABCDEFGHIJKLMNOPQRSTUVWXYZ"</span><br />&nbsp;&nbsp;&nbsp;&nbsp;char2=<span style="color:#3ad900;font-weight:400">"abcdefghijklmnopqrstuvwxyz"</span><br />&nbsp;&nbsp;&nbsp;&nbsp;char3=<span style="color:#3ad900;font-weight:400">"0123456789"</span><br />&nbsp;&nbsp;&nbsp;&nbsp;charcnt=<span style="color:#ff0044;font-weight:400">0</span><br />&nbsp;&nbsp;&nbsp;&nbsp;pattern=<span style="color:#3ad900;font-weight:400">""</span><br />&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">max</span>=<span style="color:#ff9d00;font-weight:700">int</span>(size)<br />&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">for</span>&nbsp;ch1&nbsp;<span style="color:#ff9d00;font-weight:700">in</span>&nbsp;char1:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">for</span>&nbsp;ch2&nbsp;<span style="color:#ff9d00;font-weight:700">in</span>&nbsp;char2:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">for</span>&nbsp;ch3&nbsp;<span style="color:#ff9d00;font-weight:700">in</span>&nbsp;char3:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;charcnt&lt;<span style="color:#ff9d00;font-weight:700">max</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pattern=pattern+ch1<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;charcnt=charcnt+<span style="color:#ff0044;font-weight:400">1</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;charcnt&lt;<span style="color:#ff9d00;font-weight:700">max</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pattern=pattern+ch2<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;charcnt=charcnt+<span style="color:#ff0044;font-weight:400">1</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;charcnt&lt;<span style="color:#ff9d00;font-weight:700">max</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pattern=pattern+ch3<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;charcnt=charcnt+<span style="color:#ff0044;font-weight:400">1</span><br />&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">return</span>&nbsp;pattern<br /><br /><span style="color:#3ad900;font-weight:400">"""<br />Calculate&nbsp;offset&nbsp;in&nbsp;Metasploit&nbsp;compatible&nbsp;pattern<br />"""</span><br /><span style="color:#ff9d00;font-weight:700">def</span>&nbsp;pattern_offset(searchpat,size,imm):<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mspattern=<span style="color:#3ad900;font-weight:400">""</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;patsize=<span style="color:#ff9d00;font-weight:700">int</span>(size)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mspattern=pattern_create(size)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;<span style="color:#ff9d00;font-weight:700">len</span>(searchpat)==<span style="color:#ff0044;font-weight:400">4</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ascipat2=searchpat<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"Looking&nbsp;for&nbsp;%s&nbsp;in&nbsp;pattern&nbsp;of&nbsp;%d&nbsp;bytes"</span>&nbsp;%&nbsp;(ascipat2,patsize))<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;ascipat2&nbsp;<span style="color:#ff9d00;font-weight:700">in</span>&nbsp;mspattern:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;patpos&nbsp;=&nbsp;mspattern.find(ascipat2)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;-&nbsp;Pattern&nbsp;%s&nbsp;found&nbsp;in&nbsp;Metasploit&nbsp;pattern&nbsp;at&nbsp;position&nbsp;%d"</span>&nbsp;%&nbsp;(ascipat2,patpos),highlight=<span style="color:#ff0044;font-weight:400">1</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">else</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;-&nbsp;Pattern&nbsp;%s&nbsp;not&nbsp;found&nbsp;in&nbsp;Metasploit&nbsp;pattern"</span>&nbsp;%&nbsp;ascipat2)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;<span style="color:#ff9d00;font-weight:700">len</span>(searchpat)==<span style="color:#ff0044;font-weight:400">8</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;searchpat=<span style="color:#3ad900;font-weight:400">"0x"</span>+searchpat<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;<span style="color:#ff9d00;font-weight:700">len</span>(searchpat)==<span style="color:#ff0044;font-weight:400">10</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;hexpat=searchpat<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ascipat3=toascii(imm,hexpat[<span style="color:#ff0044;font-weight:400">8</span>]+hexpat[<span style="color:#ff0044;font-weight:400">9</span>])+toascii(imm,hexpat[<span style="color:#ff0044;font-weight:400">6</span>]+hexpat[<span style="color:#ff0044;font-weight:400">7</span>])+toascii(imm,hexpat[<span style="color:#ff0044;font-weight:400">4</span>]+hexpat[<span style="color:#ff0044;font-weight:400">5</span>])+toascii(imm,hexpat[<span style="color:#ff0044;font-weight:400">2</span>]+hexpat[<span style="color:#ff0044;font-weight:400">3</span>])<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"Looking&nbsp;for&nbsp;%s&nbsp;in&nbsp;pattern&nbsp;of&nbsp;%d&nbsp;bytes"</span>&nbsp;%&nbsp;(ascipat3,patsize))<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;ascipat3&nbsp;<span style="color:#ff9d00;font-weight:700">in</span>&nbsp;mspattern:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;patpos&nbsp;=&nbsp;mspattern.find(ascipat3)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;-&nbsp;Pattern&nbsp;%s&nbsp;(%s)&nbsp;found&nbsp;in&nbsp;Metasploit&nbsp;pattern&nbsp;at&nbsp;position&nbsp;%d"</span>&nbsp;%&nbsp;(ascipat3,hexpat,patpos),highlight=<span style="color:#ff0044;font-weight:400">1</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">else</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#0088ff;font-weight:400">#maybe&nbsp;it's&nbsp;reversed</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ascipat4=toascii(imm,hexpat[<span style="color:#ff0044;font-weight:400">2</span>]+hexpat[<span style="color:#ff0044;font-weight:400">3</span>])+toascii(imm,hexpat[<span style="color:#ff0044;font-weight:400">4</span>]+hexpat[<span style="color:#ff0044;font-weight:400">5</span>])+toascii(imm,hexpat[<span style="color:#ff0044;font-weight:400">6</span>]+hexpat[<span style="color:#ff0044;font-weight:400">7</span>])+toascii(imm,hexpat[<span style="color:#ff0044;font-weight:400">8</span>]+hexpat[<span style="color:#ff0044;font-weight:400">9</span>])<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"Looking&nbsp;for&nbsp;%s&nbsp;in&nbsp;pattern&nbsp;of&nbsp;%d&nbsp;bytes"</span>&nbsp;%&nbsp;(ascipat4,patsize))<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;ascipat4&nbsp;<span style="color:#ff9d00;font-weight:700">in</span>&nbsp;mspattern:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;patpos&nbsp;=&nbsp;mspattern.find(ascipat4)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;-&nbsp;Pattern&nbsp;%s&nbsp;(%s&nbsp;reversed)&nbsp;found&nbsp;in&nbsp;Metasploit&nbsp;pattern&nbsp;at&nbsp;position&nbsp;%d"</span>&nbsp;%&nbsp;(ascipat4,hexpat,patpos),highlight=<span style="color:#ff0044;font-weight:400">1</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">else</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;-&nbsp;Pattern&nbsp;%s&nbsp;not&nbsp;found&nbsp;in&nbsp;Metasploit&nbsp;pattern"</span>&nbsp;%&nbsp;ascipat4)<br /><br /><span style="color:#3ad900;font-weight:400">"""<br />Compare&nbsp;shellcode&nbsp;in&nbsp;memory&nbsp;with&nbsp;data&nbsp;from&nbsp;a&nbsp;file<br />"""</span><br /><span style="color:#ff9d00;font-weight:700">def</span>&nbsp;memcompare(imm,location,srcdata,comparetable,sctype):<br />&nbsp;&nbsp;&nbsp;&nbsp;filename=<span style="color:#3ad900;font-weight:400">"compare.txt"</span><br />&nbsp;&nbsp;&nbsp;&nbsp;loc&nbsp;=&nbsp;location.replace(<span style="color:#3ad900;font-weight:400">"0x"</span>,<span style="color:#3ad900;font-weight:400">""</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;loc&nbsp;=&nbsp;loc.replace(<span style="color:#3ad900;font-weight:400">"0X"</span>,<span style="color:#3ad900;font-weight:400">""</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;&nbsp;&nbsp;*&nbsp;Reading&nbsp;memory&nbsp;at&nbsp;location&nbsp;:&nbsp;0x%s&nbsp;"</span>&nbsp;%&nbsp;location,address=addresstoint(location),highlight=<span style="color:#ff0044;font-weight:400">1</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;tofile(<span style="color:#3ad900;font-weight:400">"*&nbsp;Reading&nbsp;memory&nbsp;at&nbsp;location&nbsp;0x"</span>&nbsp;+&nbsp;location,filename)<br />&nbsp;&nbsp;&nbsp;&nbsp;imm.updateLog()<br />&nbsp;&nbsp;&nbsp;&nbsp;memloc=addresstoint(loc)<br />	<span style="color:#0088ff;font-weight:400">#read&nbsp;memory&nbsp;at&nbsp;that&nbsp;location&nbsp;and&nbsp;compare&nbsp;with&nbsp;bytes&nbsp;in&nbsp;array</span><br />&nbsp;&nbsp;&nbsp;&nbsp;maxcnt=<span style="color:#ff9d00;font-weight:700">len</span>(srcdata)<br />&nbsp;&nbsp;&nbsp;&nbsp;brokenbytes=[]<br />&nbsp;&nbsp;&nbsp;&nbsp;filelines=[]<br />&nbsp;&nbsp;&nbsp;&nbsp;memlines=[]<br />&nbsp;&nbsp;&nbsp;&nbsp;nrokbytes=<span style="color:#ff0044;font-weight:400">0</span><br />&nbsp;&nbsp;&nbsp;&nbsp;nrbrokenbytes=<span style="color:#ff0044;font-weight:400">0</span><br />&nbsp;&nbsp;&nbsp;&nbsp;cnt=<span style="color:#ff0044;font-weight:400">0</span><br />&nbsp;&nbsp;&nbsp;&nbsp;linecount=<span style="color:#ff0044;font-weight:400">0</span><br />&nbsp;&nbsp;&nbsp;&nbsp;firstcorruption=<span style="color:#ff0044;font-weight:400">0</span><br />&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">while</span>&nbsp;(cnt&nbsp;&lt;&nbsp;maxcnt):<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#0088ff;font-weight:400">#group&nbsp;per&nbsp;8&nbsp;bytes&nbsp;for&nbsp;display&nbsp;purposes</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;btcnt=<span style="color:#ff0044;font-weight:400">0</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;hexstr=<span style="color:#3ad900;font-weight:400">""</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;thislinemem=<span style="color:#3ad900;font-weight:400">""</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;thislinefile=<span style="color:#3ad900;font-weight:400">""</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">while</span>&nbsp;((btcnt&nbsp;&lt;&nbsp;<span style="color:#ff0044;font-weight:400">8</span>)&nbsp;<span style="color:#ff9d00;font-weight:700">and</span>&nbsp;(cnt&nbsp;&lt;&nbsp;maxcnt)):<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">try</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;<span style="color:#ff9d00;font-weight:700">len</span>((<span style="color:#ff9d00;font-weight:700">hex</span>(<span style="color:#ff9d00;font-weight:700">ord</span>(srcdata[cnt]))).replace(<span style="color:#3ad900;font-weight:400">'0x'</span>,<span style="color:#3ad900;font-weight:400">''</span>))==<span style="color:#ff0044;font-weight:400">1</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;thischar=<span style="color:#ff9d00;font-weight:700">hex</span>(<span style="color:#ff9d00;font-weight:700">ord</span>(srcdata[cnt])).replace(<span style="color:#3ad900;font-weight:400">'0x'</span>,<span style="color:#3ad900;font-weight:400">'0'</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;hexchar=<span style="color:#ff9d00;font-weight:700">hex</span>(<span style="color:#ff9d00;font-weight:700">ord</span>(srcdata[cnt])).replace(<span style="color:#3ad900;font-weight:400">'0x'</span>,&nbsp;<span style="color:#3ad900;font-weight:400">'\\x0'</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">else</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;thischar=<span style="color:#ff9d00;font-weight:700">hex</span>(<span style="color:#ff9d00;font-weight:700">ord</span>(srcdata[cnt])).replace(<span style="color:#3ad900;font-weight:400">'0x'</span>,<span style="color:#3ad900;font-weight:400">''</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;hexchar&nbsp;=&nbsp;<span style="color:#ff9d00;font-weight:700">hex</span>(<span style="color:#ff9d00;font-weight:700">ord</span>(srcdata[cnt])).replace(<span style="color:#3ad900;font-weight:400">'0x'</span>,&nbsp;<span style="color:#3ad900;font-weight:400">'\\x'</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#0088ff;font-weight:400">#thischar&nbsp;=&nbsp;hex(ord(srcdata[cnt])).replace('0x','')</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#0088ff;font-weight:400">#hexchar&nbsp;=&nbsp;hex(ord(srcdata[cnt])).replace('0x',&nbsp;'\\x')</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;hexstr&nbsp;+=&nbsp;hexchar<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;memchar&nbsp;=&nbsp;imm.readMemory(memloc+cnt,<span style="color:#ff0044;font-weight:400">1</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#0088ff;font-weight:400">#compare&nbsp;byte&nbsp;in&nbsp;memory&nbsp;with&nbsp;byte&nbsp;in&nbsp;file</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;<span style="color:#ff9d00;font-weight:700">len</span>((<span style="color:#ff9d00;font-weight:700">hex</span>(<span style="color:#ff9d00;font-weight:700">ord</span>(memchar))).replace(<span style="color:#3ad900;font-weight:400">'0x'</span>,<span style="color:#3ad900;font-weight:400">''</span>))==<span style="color:#ff0044;font-weight:400">1</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;memchar2&nbsp;=&nbsp;<span style="color:#ff9d00;font-weight:700">hex</span>(<span style="color:#ff9d00;font-weight:700">ord</span>(memchar)).replace(<span style="color:#3ad900;font-weight:400">'0x'</span>,<span style="color:#3ad900;font-weight:400">'0'</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">else</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;memchar2&nbsp;=&nbsp;<span style="color:#ff9d00;font-weight:700">hex</span>(<span style="color:#ff9d00;font-weight:700">ord</span>(memchar)).replace(<span style="color:#3ad900;font-weight:400">'0x'</span>,<span style="color:#3ad900;font-weight:400">''</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;thislinefile=thislinefile+thischar<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;(memchar2&nbsp;==&nbsp;thischar):<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;nrokbytes=nrokbytes+<span style="color:#ff0044;font-weight:400">1</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;thislinemem=thislinemem+thischar<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">else</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;nrbrokenbytes=nrbrokenbytes+<span style="color:#ff0044;font-weight:400">1</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;thislinemem=thislinemem+<span style="color:#3ad900;font-weight:400">"--"</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;(firstcorruption==<span style="color:#ff0044;font-weight:400">0</span>):<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;firstcorruption=cnt<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Corruption&nbsp;at&nbsp;position&nbsp;%d&nbsp;:&nbsp;Original&nbsp;byte&nbsp;:&nbsp;%s&nbsp;-&nbsp;Byte&nbsp;in&nbsp;memory&nbsp;:&nbsp;%s"</span>&nbsp;%&nbsp;(cnt,thischar,memchar2))<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tofile(<span style="color:#3ad900;font-weight:400">"&nbsp;&nbsp;&nbsp;Corruption&nbsp;at&nbsp;position&nbsp;"</span>&nbsp;+<span style="color:#ff9d00;font-weight:700">str</span>(cnt)+<span style="color:#3ad900;font-weight:400">"&nbsp;:&nbsp;Original&nbsp;byte&nbsp;:&nbsp;"</span>&nbsp;+&nbsp;thischar&nbsp;+&nbsp;<span style="color:#3ad900;font-weight:400">"&nbsp;-&nbsp;Byte&nbsp;in&nbsp;memory&nbsp;:&nbsp;"</span>&nbsp;+&nbsp;memchar2,filename)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;btcnt=btcnt+<span style="color:#ff0044;font-weight:400">1</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cnt=cnt+<span style="color:#ff0044;font-weight:400">1</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">except</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;&nbsp;&nbsp;*******&nbsp;Error&nbsp;processing&nbsp;byte&nbsp;%s&nbsp;"</span>&nbsp;%&nbsp;cnt)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tofile(<span style="color:#3ad900;font-weight:400">"&nbsp;&nbsp;&nbsp;*******&nbsp;Error&nbsp;processing&nbsp;byte&nbsp;"</span>&nbsp;+&nbsp;<span style="color:#ff9d00;font-weight:700">str</span>(cnt),filename)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.updateLog()<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cnt=cnt+<span style="color:#ff0044;font-weight:400">1</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;btcnt=btcnt+<span style="color:#ff0044;font-weight:400">1</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">continue</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;filelines&nbsp;+=&nbsp;thislinefile<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;memlines&nbsp;+=&nbsp;thislinemem<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;(nrokbytes&nbsp;==&nbsp;maxcnt):<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&gt;&nbsp;Hooray,&nbsp;%s&nbsp;shellcode&nbsp;unmodified"</span>&nbsp;%&nbsp;sctype,focus=<span style="color:#ff0044;font-weight:400">1</span>,&nbsp;highlight=<span style="color:#ff0044;font-weight:400">1</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tofile(<span style="color:#3ad900;font-weight:400">"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&gt;&nbsp;Hooray,&nbsp;"</span>&nbsp;+&nbsp;sctype&nbsp;+&nbsp;<span style="color:#3ad900;font-weight:400">"&nbsp;shellcode&nbsp;unmodified"</span>,filename)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;comparetable.add(<span style="color:#ff0044;font-weight:400">0</span>,[<span style="color:#3ad900;font-weight:400">"0x%s"</span>%(location),<span style="color:#3ad900;font-weight:400">'Unmodified'</span>,sctype])<br />&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">else</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&gt;&nbsp;Only&nbsp;%d&nbsp;original&nbsp;bytes&nbsp;of&nbsp;%s&nbsp;code&nbsp;found&nbsp;!"</span>&nbsp;%&nbsp;(nrokbytes,sctype))<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tofile(<span style="color:#3ad900;font-weight:400">"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&gt;&nbsp;Only&nbsp;"</span>&nbsp;+&nbsp;<span style="color:#ff9d00;font-weight:700">str</span>(nrokbytes)+<span style="color:#3ad900;font-weight:400">"&nbsp;original&nbsp;bytes&nbsp;found"</span>,filename)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;comparetable.add(<span style="color:#ff0044;font-weight:400">0</span>,[<span style="color:#3ad900;font-weight:400">'0x%s'</span>%(location),<span style="color:#3ad900;font-weight:400">'Corruption&nbsp;after&nbsp;%d&nbsp;bytes'</span>%(firstcorruption),sctype])<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lcnt=<span style="color:#ff0044;font-weight:400">0</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lmax&nbsp;=&nbsp;<span style="color:#ff9d00;font-weight:700">len</span>(filelines)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+-----------------------+-----------------------+"</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tofile(<span style="color:#3ad900;font-weight:400">"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+-----------------------+-----------------------+"</span>,filename)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;FILE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;MEMORY&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|"</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tofile(<span style="color:#3ad900;font-weight:400">"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;FILE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;MEMORY&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|"</span>,filename)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+-----------------------+-----------------------+"</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tofile(<span style="color:#3ad900;font-weight:400">"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+-----------------------+-----------------------+"</span>,filename)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">while</span>&nbsp;(lcnt&nbsp;&lt;&nbsp;lmax):<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#0088ff;font-weight:400">#read&nbsp;in&nbsp;pairs&nbsp;of&nbsp;8&nbsp;bytes</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;bytecnt=<span style="color:#ff0044;font-weight:400">0</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;logline1=<span style="color:#3ad900;font-weight:400">"|"</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;logline2=<span style="color:#3ad900;font-weight:400">""</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">while</span>&nbsp;((lcnt&nbsp;&lt;&nbsp;lmax)&nbsp;<span style="color:#ff9d00;font-weight:700">and</span>&nbsp;(bytecnt&nbsp;&lt;&nbsp;<span style="color:#ff0044;font-weight:400">16</span>)):<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pair=<span style="color:#ff0044;font-weight:400">0</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">while</span>&nbsp;((lcnt&nbsp;&lt;&nbsp;lmax)&nbsp;<span style="color:#ff9d00;font-weight:700">and</span>&nbsp;(pair&nbsp;&lt;&nbsp;<span style="color:#ff0044;font-weight:400">2</span>)):<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;logline1=logline1+filelines[lcnt]<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;logline2=logline2+memlines[lcnt]<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pair=pair+<span style="color:#ff0044;font-weight:400">1</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lcnt=lcnt+<span style="color:#ff0044;font-weight:400">1</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;bytecnt=bytecnt+<span style="color:#ff0044;font-weight:400">1</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;logline1=logline1+<span style="color:#3ad900;font-weight:400">"|"</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;logline2=logline2+<span style="color:#3ad900;font-weight:400">"|"</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;(bytecnt&nbsp;&lt;&nbsp;<span style="color:#ff0044;font-weight:400">16</span>):<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">while</span>&nbsp;(bytecnt&nbsp;&lt;&nbsp;<span style="color:#ff0044;font-weight:400">16</span>):<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;logline1=logline1+<span style="color:#3ad900;font-weight:400">"&nbsp;"</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;logline2=logline2+<span style="color:#3ad900;font-weight:400">"&nbsp;"</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;bytecnt=bytecnt+<span style="color:#ff0044;font-weight:400">1</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;logline1=logline1+<span style="color:#3ad900;font-weight:400">"|"</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;logline2=logline2+<span style="color:#3ad900;font-weight:400">"|"</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;%s%s"</span>&nbsp;%&nbsp;(logline1,logline2))<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tofile(<span style="color:#3ad900;font-weight:400">"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"</span>+logline1+logline2,filename)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+-----------------------+-----------------------+"</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tofile(<span style="color:#3ad900;font-weight:400">"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+-----------------------+-----------------------+"</span>,filename)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">""</span>)<br /><br /><span style="color:#ff9d00;font-weight:700">def</span>&nbsp;tocontent(memcontent):<br />&nbsp;&nbsp;&nbsp;&nbsp;mycontent=<span style="color:#3ad900;font-weight:400">""</span><br />&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">for</span>&nbsp;membyte&nbsp;<span style="color:#ff9d00;font-weight:700">in</span>&nbsp;memcontent:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;newbyte=<span style="color:#ff9d00;font-weight:700">hex</span>(<span style="color:#ff9d00;font-weight:700">ord</span>(membyte)).replace(<span style="color:#3ad900;font-weight:400">'0x'</span>,<span style="color:#3ad900;font-weight:400">''</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>(<span style="color:#ff9d00;font-weight:700">len</span>(newbyte)==<span style="color:#ff0044;font-weight:400">1</span>):<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mycontent=mycontent+<span style="color:#3ad900;font-weight:400">"0"</span>+newbyte<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">else</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mycontent=mycontent+newbyte<br />&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;(<span style="color:#ff9d00;font-weight:700">len</span>(mycontent)==<span style="color:#ff0044;font-weight:400">8</span>):<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;newcontent=mycontent[<span style="color:#ff0044;font-weight:400">6</span>]+mycontent[<span style="color:#ff0044;font-weight:400">7</span>]+mycontent[<span style="color:#ff0044;font-weight:400">4</span>]+mycontent[<span style="color:#ff0044;font-weight:400">5</span>]+mycontent[<span style="color:#ff0044;font-weight:400">2</span>]+mycontent[<span style="color:#ff0044;font-weight:400">3</span>]+mycontent[<span style="color:#ff0044;font-weight:400">0</span>]+mycontent[<span style="color:#ff0044;font-weight:400">1</span>]<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;	mycontent=newcontent<br />&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">return</span>&nbsp;mycontent<br /><br /><span style="color:#3ad900;font-weight:400">"""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""<br />&nbsp;&nbsp;MAIN&nbsp;APPLICATION<br />"""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""</span><br /><span style="color:#ff9d00;font-weight:700">def</span>&nbsp;main(args):<br />&nbsp;&nbsp;&nbsp;&nbsp;imm&nbsp;=&nbsp;immlib.Debugger()<br />&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;<span style="color:#ff9d00;font-weight:700">len</span>(args)&nbsp;==&nbsp;<span style="color:#ff0044;font-weight:400">0</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;usage(imm)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">return</span>&nbsp;<span style="color:#3ad900;font-weight:400">"Error:&nbsp;No&nbsp;arguments&nbsp;-&nbsp;read&nbsp;the&nbsp;usage&nbsp;text&nbsp;for&nbsp;more&nbsp;info"</span><br />&nbsp;&nbsp;&nbsp;&nbsp;results&nbsp;=&nbsp;[]<br />&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">filter</span>=<span style="color:#3ad900;font-weight:400">""</span><br />&nbsp;&nbsp;&nbsp;&nbsp;nrfound=<span style="color:#ff0044;font-weight:400">0</span><br />&nbsp;&nbsp;&nbsp;&nbsp;g_typeofsploit=<span style="color:#ff0044;font-weight:400">0</span><br />&nbsp;&nbsp;&nbsp;&nbsp;g_jumpreg=<span style="color:#3ad900;font-weight:400">""</span><br />&nbsp;&nbsp;&nbsp;&nbsp;g_address=<span style="color:#3ad900;font-weight:400">""</span><br />&nbsp;&nbsp;&nbsp;&nbsp;g_offset=<span style="color:#ff0044;font-weight:400">0</span><br />&nbsp;&nbsp;&nbsp;&nbsp;g_regpos=<span style="color:#ff0044;font-weight:400">0</span><br />&nbsp;&nbsp;&nbsp;&nbsp;g_regoff=<span style="color:#3ad900;font-weight:400">""</span><br />&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">""</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;imm.updateLog()<br />&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">""</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">""</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;imm.updateLog()<br />&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#3ad900;font-weight:400">"""<br />&nbsp;&nbsp;&nbsp;&nbsp;Parse&nbsp;generic&nbsp;arguments<br />&nbsp;&nbsp;&nbsp;&nbsp;"""</span><br />&nbsp;&nbsp;&nbsp;&nbsp;nonull=<span style="color:#ff0044;font-weight:400">0</span><br />&nbsp;&nbsp;&nbsp;&nbsp;noos=<span style="color:#ff0044;font-weight:400">0</span><br />&nbsp;&nbsp;&nbsp;&nbsp;modulefilter=<span style="color:#3ad900;font-weight:400">""</span><br />&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;<span style="color:#ff9d00;font-weight:700">len</span>(args)&nbsp;&gt;&nbsp;<span style="color:#ff0044;font-weight:400">1</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cnt=<span style="color:#ff0044;font-weight:400">1</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">while</span>&nbsp;cnt&nbsp;&lt;&nbsp;<span style="color:#ff9d00;font-weight:700">len</span>(args):<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;args[cnt]==<span style="color:#3ad900;font-weight:400">'-m'</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;cnt&nbsp;&lt;&nbsp;(<span style="color:#ff9d00;font-weight:700">len</span>(args)-<span style="color:#ff0044;font-weight:400">1</span>):<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;modulefilter=args[cnt+<span style="color:#ff0044;font-weight:400">1</span>]<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;args[cnt]==<span style="color:#3ad900;font-weight:400">'-n'</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;nonull=<span style="color:#ff0044;font-weight:400">1</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;args[cnt]==<span style="color:#3ad900;font-weight:400">'-o'</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;noos=<span style="color:#ff0044;font-weight:400">1</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cnt=cnt+<span style="color:#ff0044;font-weight:400">1</span><br /><br />&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#3ad900;font-weight:400">"""<br />	List&nbsp;all&nbsp;modules&nbsp;that&nbsp;are&nbsp;not&nbsp;safeseh&nbsp;protected<br />	"""</span><br />&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;(args[<span style="color:#ff0044;font-weight:400">0</span>]&nbsp;==&nbsp;<span style="color:#3ad900;font-weight:400">"nosafeseh"</span>&nbsp;<span style="color:#ff9d00;font-weight:700">or</span>&nbsp;args[<span style="color:#ff0044;font-weight:400">0</span>]&nbsp;==&nbsp;<span style="color:#3ad900;font-weight:400">"safeseh"</span>):<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;found=<span style="color:#ff0044;font-weight:400">0</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;<span style="color:#ff9d00;font-weight:700">len</span>(g_modules)==<span style="color:#ff0044;font-weight:400">0</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;moduleinfo()<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"Safeseh&nbsp;unprotected&nbsp;modules&nbsp;:&nbsp;"</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">for</span>&nbsp;mods&nbsp;<span style="color:#ff9d00;font-weight:700">in</span>&nbsp;g_modules:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;modrecord=mods.split(<span style="color:#3ad900;font-weight:400">'\t'</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;(modrecord[<span style="color:#ff0044;font-weight:400">5</span>]==<span style="color:#3ad900;font-weight:400">"0"</span>):<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;found=<span style="color:#ff0044;font-weight:400">1</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mzbase=<span style="color:#ff9d00;font-weight:700">int</span>(modrecord[<span style="color:#ff0044;font-weight:400">2</span>])<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mztop=<span style="color:#ff9d00;font-weight:700">int</span>(modrecord[<span style="color:#ff0044;font-weight:400">4</span>])<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;path=modrecord[<span style="color:#ff0044;font-weight:400">1</span>]<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;np=modrecord[<span style="color:#ff0044;font-weight:400">0</span>]<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;extra=<span style="color:#3ad900;font-weight:400">""</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;(modrecord[<span style="color:#ff0044;font-weight:400">8</span>]==<span style="color:#3ad900;font-weight:400">"1"</span>):<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;extra=<span style="color:#3ad900;font-weight:400">"&nbsp;-&nbsp;!BaseFixup!"</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">else</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;extra=<span style="color:#3ad900;font-weight:400">""</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;*&nbsp;0x%08x&nbsp;-&nbsp;0x%08x&nbsp;:&nbsp;%s&nbsp;%s&nbsp;(%s)"</span>&nbsp;%&nbsp;(mzbase,mztop,np,extra,path),highlight=<span style="color:#ff0044;font-weight:400">1</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">""</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;found==<span style="color:#ff0044;font-weight:400">0</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"All&nbsp;loaded&nbsp;modules&nbsp;are&nbsp;safeseh&nbsp;protected&nbsp;-&nbsp;good&nbsp;luck"</span>,highlight=<span style="color:#ff0044;font-weight:400">1</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">""</span>)<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#3ad900;font-weight:400">"""<br />&nbsp;&nbsp;&nbsp;&nbsp;List&nbsp;all&nbsp;modules&nbsp;that&nbsp;are&nbsp;not&nbsp;safeseh&nbsp;or&nbsp;asrl&nbsp;aware<br />&nbsp;&nbsp;&nbsp;&nbsp;"""</span><br />&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;args[<span style="color:#ff0044;font-weight:400">0</span>]&nbsp;==&nbsp;<span style="color:#3ad900;font-weight:400">"nosafesehaslr"</span>&nbsp;<span style="color:#ff9d00;font-weight:700">or</span>&nbsp;args[<span style="color:#ff0044;font-weight:400">0</span>]&nbsp;==&nbsp;<span style="color:#3ad900;font-weight:400">"safesehaslr"</span>:<br />		getnosafesehaslr(imm,<span style="color:#ff0044;font-weight:400">0</span>)<br /><br /><br /><br />&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#3ad900;font-weight:400">"""<br />&nbsp;&nbsp;&nbsp;&nbsp;List&nbsp;all&nbsp;modules&nbsp;that&nbsp;are&nbsp;not&nbsp;aslr&nbsp;aware<br />&nbsp;&nbsp;&nbsp;&nbsp;"""</span><br />&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;(args[<span style="color:#ff0044;font-weight:400">0</span>]&nbsp;==&nbsp;<span style="color:#3ad900;font-weight:400">"noaslr"</span>&nbsp;<span style="color:#ff9d00;font-weight:700">or</span>&nbsp;args[<span style="color:#ff0044;font-weight:400">0</span>]&nbsp;==&nbsp;<span style="color:#3ad900;font-weight:400">"aslr"</span>):<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;found=<span style="color:#ff0044;font-weight:400">0</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;<span style="color:#ff9d00;font-weight:700">len</span>(g_modules)==<span style="color:#ff0044;font-weight:400">0</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;moduleinfo()<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"Loaded&nbsp;modules&nbsp;-&nbsp;ASLR&nbsp;protection&nbsp;status&nbsp;:&nbsp;"</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"-----------------------------------------"</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">for</span>&nbsp;mods&nbsp;<span style="color:#ff9d00;font-weight:700">in</span>&nbsp;g_modules:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;modrecord=mods.split(<span style="color:#3ad900;font-weight:400">'\t'</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;extra=<span style="color:#3ad900;font-weight:400">""</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;(modrecord[<span style="color:#ff0044;font-weight:400">8</span>]==<span style="color:#3ad900;font-weight:400">"1"</span>):<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;extra=<span style="color:#3ad900;font-weight:400">"&nbsp;-&nbsp;!BaseFixup!"</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">else</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;extra=<span style="color:#3ad900;font-weight:400">""</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;(modrecord[<span style="color:#ff0044;font-weight:400">6</span>]==<span style="color:#3ad900;font-weight:400">"0"</span>):<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;found=<span style="color:#ff0044;font-weight:400">1</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mzbase=<span style="color:#ff9d00;font-weight:700">int</span>(modrecord[<span style="color:#ff0044;font-weight:400">2</span>])<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mztop=<span style="color:#ff9d00;font-weight:700">int</span>(modrecord[<span style="color:#ff0044;font-weight:400">4</span>])<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;path=modrecord[<span style="color:#ff0044;font-weight:400">1</span>]<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;np=modrecord[<span style="color:#ff0044;font-weight:400">0</span>]<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;*&nbsp;0x%08x&nbsp;-&nbsp;0x%08x&nbsp;:&nbsp;%s&nbsp;%s&nbsp;(%s)&nbsp;:&nbsp;NO&nbsp;ASLR"</span>&nbsp;%&nbsp;(mzbase,mztop,np,extra,path),highlight=<span style="color:#ff0044;font-weight:400">1</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.updateLog()<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">else</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mzbase=<span style="color:#ff9d00;font-weight:700">int</span>(modrecord[<span style="color:#ff0044;font-weight:400">2</span>])<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mztop=<span style="color:#ff9d00;font-weight:700">int</span>(modrecord[<span style="color:#ff0044;font-weight:400">4</span>])<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;path=modrecord[<span style="color:#ff0044;font-weight:400">1</span>]<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;np=modrecord[<span style="color:#ff0044;font-weight:400">0</span>]<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;*&nbsp;0x%08x&nbsp;-&nbsp;0x%08x&nbsp;:&nbsp;%s&nbsp;%s&nbsp;(%s)&nbsp;:&nbsp;ASLR&nbsp;ENABLED"</span>&nbsp;%&nbsp;(mzbase,mztop,np,extra,path))<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.updateLog()<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">""</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;found==<span style="color:#ff0044;font-weight:400">0</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"All&nbsp;loaded&nbsp;modules&nbsp;are&nbsp;aslr&nbsp;aware&nbsp;-&nbsp;good&nbsp;luck"</span>,highlight=<span style="color:#ff0044;font-weight:400">1</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">""</span>)<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#3ad900;font-weight:400">"""<br />&nbsp;&nbsp;&nbsp;&nbsp;Search&nbsp;for&nbsp;pop&nbsp;pop&nbsp;ret&nbsp;(mostly&nbsp;used&nbsp;in&nbsp;SEH&nbsp;based&nbsp;overflows.&nbsp;Only&nbsp;addresses&nbsp;in&nbsp;modules&nbsp;that&nbsp;are&nbsp;not&nbsp;safeseh&nbsp;protected<br />	and&nbsp;not&nbsp;subject&nbsp;to&nbsp;aslr&nbsp;will&nbsp;be&nbsp;listed,&nbsp;unless&nbsp;you&nbsp;specify&nbsp;your&nbsp;own&nbsp;module&nbsp;name.<br />&nbsp;&nbsp;&nbsp;&nbsp;"""</span><br />&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;args[<span style="color:#ff0044;font-weight:400">0</span>]&nbsp;==&nbsp;<span style="color:#3ad900;font-weight:400">"a"</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;modulefilter&nbsp;&lt;&gt;&nbsp;<span style="color:#3ad900;font-weight:400">""</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;noos=<span style="color:#ff0044;font-weight:400">0</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"-------------------------------------------------------------------"</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"Search&nbsp;for&nbsp;pop&nbsp;pop&nbsp;ret&nbsp;alternative&nbsp;(add&nbsp;esp&nbsp;8,ret)&nbsp;started&nbsp;"</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"Search&nbsp;in&nbsp;non-safeseh,&nbsp;non-aslr&nbsp;modules&nbsp;and&nbsp;non-fixup&nbsp;modules&nbsp;only"</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"Please&nbsp;wait..."</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"-------------------------------------------------------------------"</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;filename=<span style="color:#3ad900;font-weight:400">"ppralternative.txt"</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;resetfile(filename)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;writemodinfo(filename)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;getnosafesehaslr(imm,<span style="color:#ff0044;font-weight:400">1</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"--------------------------------------------------------------"</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;opcodej=[<span style="color:#3ad900;font-weight:400">"\x83\xc4\x08\xc3"</span>,<span style="color:#3ad900;font-weight:400">"\x83\xc4\x08\xc2"</span>,<span style="color:#0088ff;font-weight:400">#add&nbsp;esp,8&nbsp;+ret</span><br />		<span style="color:#3ad900;font-weight:400">"\x94\x8d\x40\x08\x8b\x10\x94\xc3"</span>,&nbsp;<span style="color:#0088ff;font-weight:400">#XCHG&nbsp;EAX,ESP#LEA&nbsp;EAX,[EAX+8]#MOV&nbsp;EDX,EAX#XCHG&nbsp;EAX,ESP#RETN</span><br />		<span style="color:#3ad900;font-weight:400">"\x94\x8d\x40\x08\x8b\x10\x94\xc2"</span>]<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">for</span>&nbsp;op&nbsp;<span style="color:#ff9d00;font-weight:700">in</span>&nbsp;opcodej:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;addys=imm.search(op)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;results&nbsp;+=&nbsp;addys<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">for</span>&nbsp;ad1&nbsp;<span style="color:#ff9d00;font-weight:700">in</span>&nbsp;addys:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;module&nbsp;=&nbsp;getmodnamefromptr(ad1)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;<span style="color:#ff9d00;font-weight:700">not</span>&nbsp;module:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;module&nbsp;=&nbsp;<span style="color:#3ad900;font-weight:400">"none"</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">else</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;module==<span style="color:#3ad900;font-weight:400">""</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;module&nbsp;=&nbsp;<span style="color:#3ad900;font-weight:400">"none"</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">else</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;module&nbsp;=&nbsp;module.lower()<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;module.upper().find(modulefilter.upper())&nbsp;&gt;=&nbsp;<span style="color:#ff0044;font-weight:400">0</span>&nbsp;<span style="color:#ff9d00;font-weight:700">and</span>&nbsp;getmoduleprop(module,<span style="color:#3ad900;font-weight:400">"fixup"</span>)==<span style="color:#3ad900;font-weight:400">"0"</span>&nbsp;<span style="color:#ff9d00;font-weight:700">and</span>&nbsp;getmoduleprop(module,<span style="color:#3ad900;font-weight:400">"aslr"</span>)==<span style="color:#3ad900;font-weight:400">"0"</span>&nbsp;<span style="color:#ff9d00;font-weight:700">and</span>&nbsp;getmoduleprop(module,<span style="color:#3ad900;font-weight:400">"safeseh"</span>)==<span style="color:#3ad900;font-weight:400">"0"</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;(noos==<span style="color:#ff0044;font-weight:400">0</span>)&nbsp;<span style="color:#ff9d00;font-weight:700">or</span>&nbsp;(noos==<span style="color:#ff0044;font-weight:400">1</span>&nbsp;<span style="color:#ff9d00;font-weight:700">and</span>&nbsp;isosmodule(module)==<span style="color:#ff0044;font-weight:400">0</span>):<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;aspec=addressspec(tohex(ad1)).upper()<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;(nonull==<span style="color:#ff0044;font-weight:400">0</span>)&nbsp;<span style="color:#ff9d00;font-weight:700">or</span>&nbsp;(nonull==<span style="color:#ff0044;font-weight:400">1</span>&nbsp;<span style="color:#ff9d00;font-weight:700">and</span>&nbsp;aspec.find(<span style="color:#3ad900;font-weight:400">"NULL"</span>)&nbsp;==&nbsp;-<span style="color:#ff0044;font-weight:400">1</span>):<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">try</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;page&nbsp;=&nbsp;imm.getMemoryPagebyAddress(&nbsp;ad1&nbsp;)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;access&nbsp;=&nbsp;page.getAccess(&nbsp;human&nbsp;=&nbsp;<span style="color:#ff0044;font-weight:400">True</span>&nbsp;)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;hexaddr=tohex(ad1)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;op&nbsp;=&nbsp;imm.Disasm(&nbsp;ad1&nbsp;)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;opstring=op.getDisasm()<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"Found&nbsp;%s&nbsp;at&nbsp;0x%08x&nbsp;[%s]&nbsp;Access:&nbsp;(%s)&nbsp;"</span>&nbsp;%&nbsp;(opstring,&nbsp;ad1,&nbsp;module,&nbsp;access),&nbsp;address&nbsp;=&nbsp;ad1,highlight=<span style="color:#ff0044;font-weight:400">1</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tofile(<span style="color:#3ad900;font-weight:400">"Found&nbsp;"</span>+opstring+<span style="color:#3ad900;font-weight:400">"&nbsp;at&nbsp;0x"</span>&nbsp;+&nbsp;tohex(ad1)+<span style="color:#3ad900;font-weight:400">"&nbsp;["</span>+module+<span style="color:#3ad900;font-weight:400">"]"</span>,filename,ad1)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;nrfound+=<span style="color:#ff0044;font-weight:400">1</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">except</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">pass</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"Search&nbsp;complete"</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"Output&nbsp;written&nbsp;to&nbsp;"</span>+filename)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;results:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"Found&nbsp;%d&nbsp;address(es)&nbsp;in&nbsp;non-safeseh&nbsp;protected&nbsp;and&nbsp;non-aslr&nbsp;aware&nbsp;modules,&nbsp;out&nbsp;of&nbsp;%d&nbsp;addresses"</span>&nbsp;%&nbsp;(nrfound,<span style="color:#ff9d00;font-weight:700">len</span>(results)))<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tofile(<span style="color:#3ad900;font-weight:400">"See&nbsp;if&nbsp;one&nbsp;of&nbsp;these&nbsp;addresses&nbsp;is&nbsp;followed&nbsp;by&nbsp;RET&nbsp;!"</span>,filename)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"See&nbsp;if&nbsp;one&nbsp;of&nbsp;these&nbsp;addresses&nbsp;is&nbsp;followed&nbsp;by&nbsp;RET&nbsp;!"</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">return</span>&nbsp;<span style="color:#3ad900;font-weight:400">"Found&nbsp;%d&nbsp;address(es)&nbsp;(Check&nbsp;the&nbsp;Log&nbsp;Windows&nbsp;for&nbsp;details)"</span>&nbsp;%&nbsp;nrfound<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">else</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"No&nbsp;addresses&nbsp;found"</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">return</span>&nbsp;<span style="color:#3ad900;font-weight:400">"Sorry,&nbsp;no&nbsp;addresses&nbsp;found"</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"--------------------------------------------------------------"</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">return</span>&nbsp;<span style="color:#3ad900;font-weight:400">"Done&nbsp;-&nbsp;check&nbsp;%s"</span>&nbsp;%&nbsp;filename<br /><br /><br />&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#3ad900;font-weight:400">"""<br />&nbsp;&nbsp;&nbsp;&nbsp;Search&nbsp;for&nbsp;pop&nbsp;pop&nbsp;ret&nbsp;(mostly&nbsp;used&nbsp;in&nbsp;SEH&nbsp;based&nbsp;overflows)<br />&nbsp;&nbsp;&nbsp;&nbsp;"""</span><br />&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;args[<span style="color:#ff0044;font-weight:400">0</span>]&nbsp;==&nbsp;<span style="color:#3ad900;font-weight:400">"p"</span>&nbsp;<span style="color:#ff9d00;font-weight:700">or</span>&nbsp;args[<span style="color:#ff0044;font-weight:400">0</span>]==<span style="color:#3ad900;font-weight:400">"p1"</span>&nbsp;<span style="color:#ff9d00;font-weight:700">or</span>&nbsp;args[<span style="color:#ff0044;font-weight:400">0</span>]==<span style="color:#3ad900;font-weight:400">"p2"</span>&nbsp;<span style="color:#ff9d00;font-weight:700">or</span>&nbsp;args[<span style="color:#ff0044;font-weight:400">0</span>]&nbsp;==&nbsp;<span style="color:#3ad900;font-weight:400">"xp"</span>&nbsp;<span style="color:#ff9d00;font-weight:700">or</span>&nbsp;args[<span style="color:#ff0044;font-weight:400">0</span>]==<span style="color:#3ad900;font-weight:400">"xp1"</span>&nbsp;<span style="color:#ff9d00;font-weight:700">or</span>&nbsp;args[<span style="color:#ff0044;font-weight:400">0</span>]==<span style="color:#3ad900;font-weight:400">"xp2"</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"------------------------------------------------------------------"</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;args[<span style="color:#ff0044;font-weight:400">0</span>]&nbsp;==&nbsp;<span style="color:#3ad900;font-weight:400">"p"</span>&nbsp;<span style="color:#ff9d00;font-weight:700">or</span>&nbsp;args[<span style="color:#ff0044;font-weight:400">0</span>]==<span style="color:#3ad900;font-weight:400">"p1"</span>&nbsp;<span style="color:#ff9d00;font-weight:700">or</span>&nbsp;args[<span style="color:#ff0044;font-weight:400">0</span>]==<span style="color:#3ad900;font-weight:400">"p2"</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"Search&nbsp;for&nbsp;pop&nbsp;XX&nbsp;pop&nbsp;XX&nbsp;ret&nbsp;combinations"</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;args[<span style="color:#ff0044;font-weight:400">0</span>]&nbsp;==&nbsp;<span style="color:#3ad900;font-weight:400">"xp"</span>&nbsp;<span style="color:#ff9d00;font-weight:700">or</span>&nbsp;args[<span style="color:#ff0044;font-weight:400">0</span>]==<span style="color:#3ad900;font-weight:400">"xp1"</span>&nbsp;<span style="color:#ff9d00;font-weight:700">or</span>&nbsp;args[<span style="color:#ff0044;font-weight:400">0</span>]==<span style="color:#3ad900;font-weight:400">"xp2"</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"Search&nbsp;for&nbsp;xor&nbsp;+&nbsp;pop&nbsp;XX&nbsp;pop&nbsp;XX&nbsp;ret&nbsp;combinations&nbsp;(sehop)"</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"------------------------------------------------------------------"</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;nosafeseh=<span style="color:#ff0044;font-weight:400">1</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;noaslr=<span style="color:#ff0044;font-weight:400">0</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;filename=<span style="color:#3ad900;font-weight:400">"ppr.txt"</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;args[<span style="color:#ff0044;font-weight:400">0</span>]&nbsp;==&nbsp;<span style="color:#3ad900;font-weight:400">"p1"</span>&nbsp;<span style="color:#ff9d00;font-weight:700">or</span>&nbsp;args[<span style="color:#ff0044;font-weight:400">0</span>]&nbsp;==&nbsp;<span style="color:#3ad900;font-weight:400">"xp1"</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;noaslr=<span style="color:#ff0044;font-weight:400">1</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;filename=<span style="color:#3ad900;font-weight:400">"ppr1.txt"</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;args[<span style="color:#ff0044;font-weight:400">0</span>]&nbsp;==&nbsp;<span style="color:#3ad900;font-weight:400">"p2"</span>&nbsp;<span style="color:#ff9d00;font-weight:700">or</span>&nbsp;args[<span style="color:#ff0044;font-weight:400">0</span>]&nbsp;==&nbsp;<span style="color:#3ad900;font-weight:400">"xp2"</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;noaslr=<span style="color:#ff0044;font-weight:400">0</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;nosafeseh=<span style="color:#ff0044;font-weight:400">0</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;filename=<span style="color:#3ad900;font-weight:400">"ppr2.txt"</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;args[<span style="color:#ff0044;font-weight:400">0</span>].lower().find(<span style="color:#3ad900;font-weight:400">"x"</span>)&nbsp;&gt;&nbsp;-<span style="color:#ff0044;font-weight:400">1</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;filename=<span style="color:#3ad900;font-weight:400">"x"</span>&nbsp;+&nbsp;filename<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;resetfile(filename)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;writemodinfo(filename)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;shownosafeseh()<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;offsets&nbsp;=&nbsp;[&nbsp;<span style="color:#3ad900;font-weight:400">""</span>,&nbsp;<span style="color:#3ad900;font-weight:400">"&nbsp;04"</span>,<span style="color:#3ad900;font-weight:400">"&nbsp;08"</span>,<span style="color:#3ad900;font-weight:400">"&nbsp;0c"</span>,<span style="color:#3ad900;font-weight:400">"&nbsp;10"</span>,<span style="color:#3ad900;font-weight:400">"&nbsp;12"</span>,<span style="color:#3ad900;font-weight:400">"&nbsp;1C"</span>]<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;returns=&nbsp;[<span style="color:#3ad900;font-weight:400">"ret"</span>]<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;regs=[<span style="color:#3ad900;font-weight:400">"eax"</span>,<span style="color:#3ad900;font-weight:400">"ebx"</span>,<span style="color:#3ad900;font-weight:400">"ecx"</span>,<span style="color:#3ad900;font-weight:400">"edx"</span>,<span style="color:#3ad900;font-weight:400">"esi"</span>,<span style="color:#3ad900;font-weight:400">"edi"</span>,<span style="color:#3ad900;font-weight:400">"esp"</span>,<span style="color:#3ad900;font-weight:400">"ebp"</span>]<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">filter</span>=<span style="color:#3ad900;font-weight:400">""</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;<span style="color:#ff9d00;font-weight:700">len</span>(args)&nbsp;&gt;&nbsp;<span style="color:#ff0044;font-weight:400">1</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cnt=<span style="color:#ff0044;font-weight:400">1</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">while</span>&nbsp;cnt&nbsp;&lt;&nbsp;<span style="color:#ff9d00;font-weight:700">len</span>(args):<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;args[cnt]==<span style="color:#3ad900;font-weight:400">'-r'</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;cnt&nbsp;&lt;&nbsp;(<span style="color:#ff9d00;font-weight:700">len</span>(args)-<span style="color:#ff0044;font-weight:400">1</span>):<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">filter</span>=args[cnt+<span style="color:#ff0044;font-weight:400">1</span>]<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cnt=cnt+<span style="color:#ff0044;font-weight:400">1</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;modulefilter&nbsp;&lt;&gt;&nbsp;<span style="color:#3ad900;font-weight:400">""</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;noos=<span style="color:#ff0044;font-weight:400">0</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;nosafeseh==<span style="color:#ff0044;font-weight:400">1</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"[+]&nbsp;Excluding&nbsp;safeseh&nbsp;protected&nbsp;modules"</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">else</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"[+]&nbsp;Including&nbsp;safeseh&nbsp;protected&nbsp;modules"</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;noaslr==<span style="color:#ff0044;font-weight:400">1</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"[+]&nbsp;Excluding&nbsp;ASLR&nbsp;enabled&nbsp;modules"</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">else</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"[+]&nbsp;Including&nbsp;ASLR&nbsp;enabled&nbsp;modules"</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;noos==<span style="color:#ff0044;font-weight:400">1</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"[+]&nbsp;Excluding&nbsp;modules&nbsp;from&nbsp;Windows&nbsp;folder"</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">else</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"[+]&nbsp;Including&nbsp;modules&nbsp;from&nbsp;Windows&nbsp;folder"</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;nonull==<span style="color:#ff0044;font-weight:400">1</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"[+]&nbsp;Excluding&nbsp;pointers&nbsp;with&nbsp;null&nbsp;bytes"</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">else</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"[+]&nbsp;Including&nbsp;pointers&nbsp;with&nbsp;null&nbsp;bytes"</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;modulefilter&nbsp;&lt;&gt;&nbsp;<span style="color:#3ad900;font-weight:400">""</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"[+]&nbsp;Only&nbsp;showing&nbsp;pointers&nbsp;from&nbsp;module&nbsp;%s"</span>&nbsp;%&nbsp;modulefilter)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.updateLog()<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;results=[]<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"Launching&nbsp;search,&nbsp;please&nbsp;wait..."</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">for</span>&nbsp;r1&nbsp;<span style="color:#ff9d00;font-weight:700">in</span>&nbsp;regs:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">for</span>&nbsp;r2&nbsp;<span style="color:#ff9d00;font-weight:700">in</span>&nbsp;regs:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">for</span>&nbsp;roffset&nbsp;<span style="color:#ff9d00;font-weight:700">in</span>&nbsp;offsets:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;op&nbsp;=&nbsp;<span style="color:#3ad900;font-weight:400">"pop&nbsp;"</span>+r1+<span style="color:#3ad900;font-weight:400">"\npop&nbsp;"</span>+r2+<span style="color:#3ad900;font-weight:400">"\nret&nbsp;"</span>+roffset<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;op=op.strip()<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;op.find(<span style="color:#ff9d00;font-weight:700">filter</span>)&nbsp;&gt;=&nbsp;<span style="color:#ff0044;font-weight:400">0</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;addys=imm.search(&nbsp;imm.assemble&nbsp;(op)&nbsp;)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;results&nbsp;+=&nbsp;addys<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;*&nbsp;%d&nbsp;pointers&nbsp;found&nbsp;ending&nbsp;with&nbsp;RET%s,&nbsp;now&nbsp;filtering&nbsp;results..."</span>&nbsp;%&nbsp;(<span style="color:#ff9d00;font-weight:700">len</span>(addys),roffset))<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">for</span>&nbsp;ad1&nbsp;<span style="color:#ff9d00;font-weight:700">in</span>&nbsp;addys:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;module&nbsp;=&nbsp;getmodnamefromptr(ad1)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;<span style="color:#ff9d00;font-weight:700">not</span>&nbsp;module:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;module&nbsp;=&nbsp;<span style="color:#3ad900;font-weight:400">"none"</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">else</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;module==<span style="color:#3ad900;font-weight:400">""</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;module&nbsp;=&nbsp;<span style="color:#3ad900;font-weight:400">"none"</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">else</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;module&nbsp;=&nbsp;module.lower()<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;module.upper().find(modulefilter.upper())&nbsp;&gt;=&nbsp;<span style="color:#ff0044;font-weight:400">0</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;(noaslr==<span style="color:#ff0044;font-weight:400">0</span>)&nbsp;<span style="color:#ff9d00;font-weight:700">or</span>&nbsp;(noaslr==<span style="color:#ff0044;font-weight:400">1</span>&nbsp;<span style="color:#ff9d00;font-weight:700">and</span>&nbsp;getmoduleprop(module,<span style="color:#3ad900;font-weight:400">"aslr"</span>)==<span style="color:#3ad900;font-weight:400">"0"</span>&nbsp;<span style="color:#ff9d00;font-weight:700">and</span>&nbsp;getmoduleprop(module,<span style="color:#3ad900;font-weight:400">"fixup"</span>)==<span style="color:#3ad900;font-weight:400">"0"</span>):<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;(nosafeseh==<span style="color:#ff0044;font-weight:400">0</span>)&nbsp;<span style="color:#ff9d00;font-weight:700">or</span>&nbsp;(nosafeseh==<span style="color:#ff0044;font-weight:400">1</span>&nbsp;<span style="color:#ff9d00;font-weight:700">and</span>&nbsp;getmoduleprop(module,<span style="color:#3ad900;font-weight:400">"safeseh"</span>)==<span style="color:#3ad900;font-weight:400">"0"</span>):<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;(noos==<span style="color:#ff0044;font-weight:400">0</span>)&nbsp;<span style="color:#ff9d00;font-weight:700">or</span>&nbsp;(noos==<span style="color:#ff0044;font-weight:400">1</span>&nbsp;<span style="color:#ff9d00;font-weight:700">and</span>&nbsp;isosmodule(module)==<span style="color:#ff0044;font-weight:400">0</span>):<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;aspec=addressspec(tohex(ad1)).upper()<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;(nonull==<span style="color:#ff0044;font-weight:400">0</span>)&nbsp;<span style="color:#ff9d00;font-weight:700">or</span>&nbsp;(nonull==<span style="color:#ff0044;font-weight:400">1</span>&nbsp;<span style="color:#ff9d00;font-weight:700">and</span>&nbsp;aspec.find(<span style="color:#3ad900;font-weight:400">"NULL"</span>)&nbsp;==&nbsp;-<span style="color:#ff0044;font-weight:400">1</span>):<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;args[<span style="color:#ff0044;font-weight:400">0</span>]&nbsp;==&nbsp;<span style="color:#3ad900;font-weight:400">"xp"</span>&nbsp;<span style="color:#ff9d00;font-weight:700">or</span>&nbsp;args[<span style="color:#ff0044;font-weight:400">0</span>]==<span style="color:#3ad900;font-weight:400">"xp1"</span>&nbsp;<span style="color:#ff9d00;font-weight:700">or</span>&nbsp;args[<span style="color:#ff0044;font-weight:400">0</span>]==<span style="color:#3ad900;font-weight:400">"xp2"</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#0088ff;font-weight:400">#only&nbsp;add&nbsp;if&nbsp;ppr&nbsp;is&nbsp;preceeded&nbsp;with&nbsp;a&nbsp;xor&nbsp;reg,reg&nbsp;operation</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;opstart=imm.DisasmBackward(ad1,<span style="color:#ff0044;font-weight:400">1</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;opadstart=opstart.getAddress()<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;opstring=opstart.getDisasm()<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;opstring.upper().find(<span style="color:#3ad900;font-weight:400">"XOR"</span>)&nbsp;&gt;=&nbsp;<span style="color:#ff0044;font-weight:400">0</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#0088ff;font-weight:400">#xor&nbsp;samereg,samereg&nbsp;?</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;xorfields=opstring.lower().split(<span style="color:#3ad900;font-weight:400">'&nbsp;'</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;<span style="color:#ff9d00;font-weight:700">len</span>(xorfields)&nbsp;&gt;&nbsp;<span style="color:#ff0044;font-weight:400">1</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;xorregs&nbsp;=&nbsp;xorfields[<span style="color:#ff0044;font-weight:400">1</span>].split(<span style="color:#3ad900;font-weight:400">','</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;<span style="color:#ff9d00;font-weight:700">len</span>(xorregs)&nbsp;&gt;&nbsp;<span style="color:#ff0044;font-weight:400">1</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;xorregs[<span style="color:#ff0044;font-weight:400">0</span>].replace(<span style="color:#3ad900;font-weight:400">"&nbsp;"</span>,<span style="color:#3ad900;font-weight:400">""</span>)&nbsp;==&nbsp;xorregs[<span style="color:#ff0044;font-weight:400">1</span>].replace(<span style="color:#3ad900;font-weight:400">"&nbsp;"</span>,<span style="color:#3ad900;font-weight:400">""</span>):<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tofile(<span style="color:#3ad900;font-weight:400">"Found&nbsp;"</span>+opstring.lower()&nbsp;+&nbsp;<span style="color:#3ad900;font-weight:400">"&nbsp;-&nbsp;"</span>&nbsp;+&nbsp;op&nbsp;+&nbsp;<span style="color:#3ad900;font-weight:400">"&nbsp;at&nbsp;0x"</span>&nbsp;+&nbsp;tohex(opadstart)+<span style="color:#3ad900;font-weight:400">"&nbsp;["</span>+module+<span style="color:#3ad900;font-weight:400">"]"</span>,filename,opadstart)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;nrfound+=<span style="color:#ff0044;font-weight:400">1</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">else</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tofile(<span style="color:#3ad900;font-weight:400">"Found&nbsp;"</span>+op+<span style="color:#3ad900;font-weight:400">"&nbsp;at&nbsp;0x"</span>&nbsp;+&nbsp;tohex(ad1)+<span style="color:#3ad900;font-weight:400">"&nbsp;["</span>+module+<span style="color:#3ad900;font-weight:400">"]"</span>,filename,ad1)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;nrfound+=<span style="color:#ff0044;font-weight:400">1</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.updateLog()<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"Search&nbsp;complete"</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"Output&nbsp;written&nbsp;to&nbsp;"</span>+filename)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;results:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"Found&nbsp;%d&nbsp;valid&nbsp;address(es)&nbsp;(out&nbsp;of&nbsp;a&nbsp;total&nbsp;of&nbsp;%d&nbsp;addresses)"</span>&nbsp;%&nbsp;(nrfound,<span style="color:#ff9d00;font-weight:700">len</span>(results)))<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">return</span>&nbsp;<span style="color:#3ad900;font-weight:400">"Found&nbsp;%d&nbsp;address(es)&nbsp;(Check&nbsp;the&nbsp;Log&nbsp;Windows&nbsp;for&nbsp;details)"</span>&nbsp;%&nbsp;nrfound<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">else</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"No&nbsp;addresses&nbsp;found"</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">return</span>&nbsp;<span style="color:#3ad900;font-weight:400">"Sorry,&nbsp;no&nbsp;addresses&nbsp;found"</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"--------------------------------------------------------------"</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">return</span>&nbsp;<span style="color:#3ad900;font-weight:400">"Done&nbsp;-&nbsp;check&nbsp;%s"</span>&nbsp;%&nbsp;filename<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;args[<span style="color:#ff0044;font-weight:400">0</span>]&nbsp;==&nbsp;<span style="color:#3ad900;font-weight:400">"pdep"</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"----------------------------------------------------------------------------------------------------"</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"Search&nbsp;for&nbsp;dep&nbsp;bypass&nbsp;instructions&nbsp;such&nbsp;as&nbsp;p/p/pop&nbsp;esp&nbsp;/&nbsp;ret&nbsp;combinations&nbsp;started&nbsp;-&nbsp;please&nbsp;wait..."</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"----------------------------------------------------------------------------------------------------"</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;filename=<span style="color:#3ad900;font-weight:400">"pdep.txt"</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;resetfile(filename)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;writemodinfo(filename)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;<span style="color:#ff9d00;font-weight:700">len</span>(g_modules)==<span style="color:#ff0044;font-weight:400">0</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;moduleinfo()<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;shownosafeseh()<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;searchreg=<span style="color:#3ad900;font-weight:400">""</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;offsets&nbsp;=&nbsp;[&nbsp;<span style="color:#3ad900;font-weight:400">"&nbsp;04"</span>,<span style="color:#3ad900;font-weight:400">"&nbsp;08"</span>,<span style="color:#3ad900;font-weight:400">"&nbsp;0c"</span>,<span style="color:#3ad900;font-weight:400">"&nbsp;10"</span>]<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ppr&nbsp;=&nbsp;[]<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;aregs=[<span style="color:#3ad900;font-weight:400">"eax"</span>,<span style="color:#3ad900;font-weight:400">"ebx"</span>,<span style="color:#3ad900;font-weight:400">"ecx"</span>,<span style="color:#3ad900;font-weight:400">"edx"</span>,<span style="color:#3ad900;font-weight:400">"esi"</span>,<span style="color:#3ad900;font-weight:400">"edi"</span>,<span style="color:#3ad900;font-weight:400">"ebp"</span>]<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;<span style="color:#ff9d00;font-weight:700">len</span>(args)&nbsp;&gt;&nbsp;<span style="color:#ff0044;font-weight:400">1</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cnt=<span style="color:#ff0044;font-weight:400">1</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">while</span>&nbsp;cnt&nbsp;&lt;&nbsp;<span style="color:#ff9d00;font-weight:700">len</span>(args):<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;args[cnt]==<span style="color:#3ad900;font-weight:400">'-r'</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;cnt&nbsp;&lt;&nbsp;(<span style="color:#ff9d00;font-weight:700">len</span>(args)-<span style="color:#ff0044;font-weight:400">1</span>):<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;searchreg=args[cnt+<span style="color:#ff0044;font-weight:400">1</span>]<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cnt=cnt+<span style="color:#ff0044;font-weight:400">1</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;modulefilter&nbsp;&lt;&gt;&nbsp;<span style="color:#3ad900;font-weight:400">""</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;noos=<span style="color:#ff0044;font-weight:400">0</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">for</span>&nbsp;areg&nbsp;<span style="color:#ff9d00;font-weight:700">in</span>&nbsp;aregs:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">for</span>&nbsp;breg&nbsp;<span style="color:#ff9d00;font-weight:700">in</span>&nbsp;aregs:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ppr.append(<span style="color:#3ad900;font-weight:400">"pop&nbsp;"</span>+areg+<span style="color:#3ad900;font-weight:400">"\npop&nbsp;"</span>+breg+<span style="color:#3ad900;font-weight:400">"\n&nbsp;pop&nbsp;esp\n&nbsp;ret"</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">for</span>&nbsp;op&nbsp;<span style="color:#ff9d00;font-weight:700">in</span>&nbsp;ppr:<br />	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#0088ff;font-weight:400">#filter&nbsp;defined</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">filter</span>=searchreg<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;op.find(<span style="color:#ff9d00;font-weight:700">filter</span>)&nbsp;&gt;=&nbsp;<span style="color:#ff0044;font-weight:400">0</span>:<br />		&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#0088ff;font-weight:400">#first&nbsp;search&nbsp;for&nbsp;normal&nbsp;ppr</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;addys=imm.search(&nbsp;imm.assemble&nbsp;(op)&nbsp;)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;results&nbsp;+=&nbsp;addys<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">for</span>&nbsp;ad1&nbsp;<span style="color:#ff9d00;font-weight:700">in</span>&nbsp;addys:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;module&nbsp;=&nbsp;getmodnamefromptr(ad1)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;<span style="color:#ff9d00;font-weight:700">not</span>&nbsp;module:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;module&nbsp;=&nbsp;<span style="color:#3ad900;font-weight:400">"none"</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">else</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;module==<span style="color:#3ad900;font-weight:400">""</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;module&nbsp;=&nbsp;<span style="color:#3ad900;font-weight:400">"none"</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">else</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;module&nbsp;=&nbsp;module.lower()<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;modulefilter&nbsp;==&nbsp;<span style="color:#3ad900;font-weight:400">""</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;ismodulenosafeseh(module)&nbsp;==&nbsp;<span style="color:#ff0044;font-weight:400">1</span>&nbsp;<span style="color:#ff9d00;font-weight:700">and</span>&nbsp;getmoduleprop(module,<span style="color:#3ad900;font-weight:400">"fixup"</span>)==<span style="color:#3ad900;font-weight:400">"0"</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;(noos==<span style="color:#ff0044;font-weight:400">0</span>)&nbsp;<span style="color:#ff9d00;font-weight:700">or</span>&nbsp;(noos==<span style="color:#ff0044;font-weight:400">1</span>&nbsp;<span style="color:#ff9d00;font-weight:700">and</span>&nbsp;isosmodule(module)==<span style="color:#ff0044;font-weight:400">0</span>):<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;aspec=addressspec(tohex(ad1)).upper()<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;(nonull==<span style="color:#ff0044;font-weight:400">0</span>)&nbsp;<span style="color:#ff9d00;font-weight:700">or</span>&nbsp;(nonull==<span style="color:#ff0044;font-weight:400">1</span>&nbsp;<span style="color:#ff9d00;font-weight:700">and</span>&nbsp;aspec.find(<span style="color:#3ad900;font-weight:400">"NULL"</span>)&nbsp;==&nbsp;-<span style="color:#ff0044;font-weight:400">1</span>):<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tofile(<span style="color:#3ad900;font-weight:400">"Found&nbsp;"</span>+op+<span style="color:#3ad900;font-weight:400">"&nbsp;at&nbsp;0x"</span>&nbsp;+&nbsp;tohex(ad1)+<span style="color:#3ad900;font-weight:400">"&nbsp;["</span>+module+<span style="color:#3ad900;font-weight:400">"]"</span>,filename,ad1)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;nrfound+=<span style="color:#ff0044;font-weight:400">1</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">else</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;(noos==<span style="color:#ff0044;font-weight:400">0</span>)&nbsp;<span style="color:#ff9d00;font-weight:700">or</span>&nbsp;(noos==<span style="color:#ff0044;font-weight:400">1</span>&nbsp;<span style="color:#ff9d00;font-weight:700">and</span>&nbsp;isosmodule(module)==<span style="color:#ff0044;font-weight:400">0</span>):<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;aspec=addressspec(tohex(ad1)).upper()<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;(nonull==<span style="color:#ff0044;font-weight:400">0</span>)&nbsp;<span style="color:#ff9d00;font-weight:700">or</span>&nbsp;(nonull==<span style="color:#ff0044;font-weight:400">1</span>&nbsp;<span style="color:#ff9d00;font-weight:700">and</span>&nbsp;aspec.find(<span style="color:#3ad900;font-weight:400">"NULL"</span>)&nbsp;==&nbsp;-<span style="color:#ff0044;font-weight:400">1</span>):<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tofile(<span style="color:#3ad900;font-weight:400">"Found&nbsp;"</span>+op+<span style="color:#3ad900;font-weight:400">"&nbsp;at&nbsp;0x"</span>&nbsp;+&nbsp;tohex(ad1)+<span style="color:#3ad900;font-weight:400">"&nbsp;["</span>+module+<span style="color:#3ad900;font-weight:400">"]&nbsp;**&nbsp;SafeSEH&nbsp;protected&nbsp;**"</span>,filename,ad1)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;nrfound+=<span style="color:#ff0044;font-weight:400">1</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">else</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;module.find(modulefilter)&nbsp;&gt;=&nbsp;<span style="color:#ff0044;font-weight:400">0</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;(noos==<span style="color:#ff0044;font-weight:400">0</span>)&nbsp;<span style="color:#ff9d00;font-weight:700">or</span>&nbsp;(noos==<span style="color:#ff0044;font-weight:400">1</span>&nbsp;<span style="color:#ff9d00;font-weight:700">and</span>&nbsp;isosmodule(module)==<span style="color:#ff0044;font-weight:400">0</span>):<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;aspec=addressspec(tohex(ad1)).upper()<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;(nonull==<span style="color:#ff0044;font-weight:400">0</span>)&nbsp;<span style="color:#ff9d00;font-weight:700">or</span>&nbsp;(nonull==<span style="color:#ff0044;font-weight:400">1</span>&nbsp;<span style="color:#ff9d00;font-weight:700">and</span>&nbsp;aspec.find(<span style="color:#3ad900;font-weight:400">"NULL"</span>)&nbsp;==&nbsp;-<span style="color:#ff0044;font-weight:400">1</span>):<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tofile(<span style="color:#3ad900;font-weight:400">"Found&nbsp;"</span>+op+<span style="color:#3ad900;font-weight:400">"&nbsp;at&nbsp;0x"</span>&nbsp;+&nbsp;tohex(ad1)+<span style="color:#3ad900;font-weight:400">"&nbsp;["</span>+module+<span style="color:#3ad900;font-weight:400">"]"</span>,filename,ad1)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;nrfound+=<span style="color:#ff0044;font-weight:400">1</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#0088ff;font-weight:400">#now&nbsp;also&nbsp;search&nbsp;for&nbsp;ret+offsets</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">for</span>&nbsp;ofs&nbsp;<span style="color:#ff9d00;font-weight:700">in</span>&nbsp;offsets:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;addys=imm.search(&nbsp;imm.assemble&nbsp;(op+ofs)&nbsp;)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;results&nbsp;+=&nbsp;addys<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">for</span>&nbsp;ad1&nbsp;<span style="color:#ff9d00;font-weight:700">in</span>&nbsp;addys:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;module&nbsp;=&nbsp;getmodnamefromptr(ad1)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;<span style="color:#ff9d00;font-weight:700">not</span>&nbsp;module:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;module&nbsp;=&nbsp;<span style="color:#3ad900;font-weight:400">"none"</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">else</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;module==<span style="color:#3ad900;font-weight:400">""</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;module&nbsp;=&nbsp;<span style="color:#3ad900;font-weight:400">"none"</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">else</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;module&nbsp;=&nbsp;module.lower()<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;modulefilter&nbsp;==&nbsp;<span style="color:#3ad900;font-weight:400">""</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#0088ff;font-weight:400">#only&nbsp;show&nbsp;addresses&nbsp;from&nbsp;non-safeseh&nbsp;protected&nbsp;modules</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;ismodulenosafeseh(module)&nbsp;==&nbsp;<span style="color:#ff0044;font-weight:400">1</span>&nbsp;<span style="color:#ff9d00;font-weight:700">and</span>&nbsp;getmoduleprop(module,<span style="color:#3ad900;font-weight:400">"fixup"</span>)==<span style="color:#3ad900;font-weight:400">"0"</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;(noos==<span style="color:#ff0044;font-weight:400">0</span>)&nbsp;<span style="color:#ff9d00;font-weight:700">or</span>&nbsp;(noos==<span style="color:#ff0044;font-weight:400">1</span>&nbsp;<span style="color:#ff9d00;font-weight:700">and</span>&nbsp;isosmodule(module)==<span style="color:#ff0044;font-weight:400">0</span>):<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;aspec=addressspec(tohex(ad1)).upper()<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;(nonull==<span style="color:#ff0044;font-weight:400">0</span>)&nbsp;<span style="color:#ff9d00;font-weight:700">or</span>&nbsp;(nonull==<span style="color:#ff0044;font-weight:400">1</span>&nbsp;<span style="color:#ff9d00;font-weight:700">and</span>&nbsp;aspec.find(<span style="color:#3ad900;font-weight:400">"NULL"</span>)&nbsp;==&nbsp;-<span style="color:#ff0044;font-weight:400">1</span>):<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tofile(<span style="color:#3ad900;font-weight:400">"Found&nbsp;"</span>+op+ofs+<span style="color:#3ad900;font-weight:400">"&nbsp;at&nbsp;0x"</span>&nbsp;+&nbsp;tohex(ad1)+<span style="color:#3ad900;font-weight:400">"&nbsp;["</span>+module+<span style="color:#3ad900;font-weight:400">"]"</span>,filename,ad1)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;nrfound+=<span style="color:#ff0044;font-weight:400">1</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">else</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;(noos==<span style="color:#ff0044;font-weight:400">0</span>)&nbsp;<span style="color:#ff9d00;font-weight:700">or</span>&nbsp;(noos==<span style="color:#ff0044;font-weight:400">1</span>&nbsp;<span style="color:#ff9d00;font-weight:700">and</span>&nbsp;isosmodule(module)==<span style="color:#ff0044;font-weight:400">0</span>):<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;aspec=addressspec(tohex(ad1)).upper()<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;(nonull==<span style="color:#ff0044;font-weight:400">0</span>)&nbsp;<span style="color:#ff9d00;font-weight:700">or</span>&nbsp;(nonull==<span style="color:#ff0044;font-weight:400">1</span>&nbsp;<span style="color:#ff9d00;font-weight:700">and</span>&nbsp;aspec.find(<span style="color:#3ad900;font-weight:400">"NULL"</span>)&nbsp;==&nbsp;-<span style="color:#ff0044;font-weight:400">1</span>):<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tofile(<span style="color:#3ad900;font-weight:400">"Found&nbsp;"</span>+op+ofs+<span style="color:#3ad900;font-weight:400">"&nbsp;at&nbsp;0x"</span>&nbsp;+&nbsp;tohex(ad1)+<span style="color:#3ad900;font-weight:400">"&nbsp;["</span>+module+<span style="color:#3ad900;font-weight:400">"]&nbsp;**&nbsp;SafeSEH&nbsp;protected&nbsp;**&nbsp;"</span>,filename,ad1)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;nrfound+=<span style="color:#ff0044;font-weight:400">1</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">else</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;module.find(modulefilter)&nbsp;&gt;=&nbsp;<span style="color:#ff0044;font-weight:400">0</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;(noos==<span style="color:#ff0044;font-weight:400">0</span>)&nbsp;<span style="color:#ff9d00;font-weight:700">or</span>&nbsp;(noos==<span style="color:#ff0044;font-weight:400">1</span>&nbsp;<span style="color:#ff9d00;font-weight:700">and</span>&nbsp;isosmodule(module)==<span style="color:#ff0044;font-weight:400">0</span>):<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;aspec=addressspec(tohex(ad1)).upper()<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;(nonull==<span style="color:#ff0044;font-weight:400">0</span>)&nbsp;<span style="color:#ff9d00;font-weight:700">or</span>&nbsp;(nonull==<span style="color:#ff0044;font-weight:400">1</span>&nbsp;<span style="color:#ff9d00;font-weight:700">and</span>&nbsp;aspec.find(<span style="color:#3ad900;font-weight:400">"NULL"</span>)&nbsp;==&nbsp;-<span style="color:#ff0044;font-weight:400">1</span>):<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tofile(<span style="color:#3ad900;font-weight:400">"Found&nbsp;"</span>+op+ofs+<span style="color:#3ad900;font-weight:400">"&nbsp;at&nbsp;0x"</span>&nbsp;+&nbsp;tohex(ad1)+<span style="color:#3ad900;font-weight:400">"&nbsp;["</span>+module+<span style="color:#3ad900;font-weight:400">"]"</span>,filename,ad1)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;nrfound+=<span style="color:#ff0044;font-weight:400">1</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"Search&nbsp;complete"</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"Output&nbsp;written&nbsp;to&nbsp;"</span>+filename)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;results:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"Found&nbsp;%d&nbsp;address(es)&nbsp;in&nbsp;non-safeseh&nbsp;protected&nbsp;modules,&nbsp;out&nbsp;of&nbsp;%d&nbsp;addresses"</span>&nbsp;%&nbsp;(nrfound,<span style="color:#ff9d00;font-weight:700">len</span>(results)))<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">return</span>&nbsp;<span style="color:#3ad900;font-weight:400">"Found&nbsp;%d&nbsp;address(es)&nbsp;(Check&nbsp;the&nbsp;Log&nbsp;Windows&nbsp;for&nbsp;details)"</span>&nbsp;%&nbsp;nrfound<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">else</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"No&nbsp;addresses&nbsp;found"</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">return</span>&nbsp;<span style="color:#3ad900;font-weight:400">"Sorry,&nbsp;no&nbsp;addresses&nbsp;found"</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"--------------------------------------------------------------"</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">return</span>&nbsp;<span style="color:#3ad900;font-weight:400">"Done&nbsp;-&nbsp;check&nbsp;%s"</span>&nbsp;%&nbsp;filename<br /><br /><br />&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#3ad900;font-weight:400">"""<br />&nbsp;&nbsp;&nbsp;&nbsp;Function&nbsp;that&nbsp;looks&nbsp;for&nbsp;jump/call/push&nbsp;addresses&nbsp;(mostly&nbsp;used&nbsp;in&nbsp;direct&nbsp;RET&nbsp;BOF)<br />&nbsp;&nbsp;&nbsp;&nbsp;"""</span><br />&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;args[<span style="color:#ff0044;font-weight:400">0</span>]&nbsp;==&nbsp;<span style="color:#3ad900;font-weight:400">"j"</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;filename=<span style="color:#3ad900;font-weight:400">"j.txt"</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;resetfile(filename)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;writemodinfo(filename)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;searchreg=<span style="color:#3ad900;font-weight:400">"esp"</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;<span style="color:#ff9d00;font-weight:700">len</span>(args)&nbsp;&gt;&nbsp;<span style="color:#ff0044;font-weight:400">1</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cnt=<span style="color:#ff0044;font-weight:400">1</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">while</span>&nbsp;cnt&nbsp;&lt;&nbsp;<span style="color:#ff9d00;font-weight:700">len</span>(args):<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;args[cnt]==<span style="color:#3ad900;font-weight:400">'-r'</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;cnt&nbsp;&lt;&nbsp;(<span style="color:#ff9d00;font-weight:700">len</span>(args)-<span style="color:#ff0044;font-weight:400">1</span>):<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;searchreg=args[cnt+<span style="color:#ff0044;font-weight:400">1</span>]<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cnt=cnt+<span style="color:#ff0044;font-weight:400">1</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;modulefilter&nbsp;&lt;&gt;&nbsp;<span style="color:#3ad900;font-weight:400">""</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;noos=<span style="color:#ff0044;font-weight:400">0</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"------------------------------------------------------------------"</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"Search&nbsp;for&nbsp;jmp/call/push&nbsp;ret&nbsp;combinations&nbsp;started&nbsp;-&nbsp;please&nbsp;wait..."</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"------------------------------------------------------------------"</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;opcodej=[<span style="color:#3ad900;font-weight:400">"jmp&nbsp;"</span>+searchreg,<span style="color:#3ad900;font-weight:400">"call&nbsp;"</span>+searchreg,<span style="color:#3ad900;font-weight:400">"push&nbsp;"</span>+searchreg+<span style="color:#3ad900;font-weight:400">"\n&nbsp;ret"</span>,<span style="color:#3ad900;font-weight:400">"push&nbsp;"</span>+searchreg+<span style="color:#3ad900;font-weight:400">"\n&nbsp;ret&nbsp;4"</span>,<span style="color:#3ad900;font-weight:400">"push&nbsp;"</span>+searchreg+<span style="color:#3ad900;font-weight:400">"\n&nbsp;ret&nbsp;8"</span>,<span style="color:#3ad900;font-weight:400">"push&nbsp;"</span>+searchreg+<span style="color:#3ad900;font-weight:400">"\n&nbsp;ret&nbsp;0c"</span>]<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;regs=[<span style="color:#3ad900;font-weight:400">"eax"</span>,<span style="color:#3ad900;font-weight:400">"ebx"</span>,<span style="color:#3ad900;font-weight:400">"ecx"</span>,<span style="color:#3ad900;font-weight:400">"edx"</span>,<span style="color:#3ad900;font-weight:400">"esi"</span>,<span style="color:#3ad900;font-weight:400">"edi"</span>]<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">for</span>&nbsp;thisreg&nbsp;<span style="color:#ff9d00;font-weight:700">in</span>&nbsp;regs:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;opcodej.append(<span style="color:#3ad900;font-weight:400">"push&nbsp;"</span>+searchreg+<span style="color:#3ad900;font-weight:400">"\n&nbsp;pop&nbsp;"</span>+thisreg+<span style="color:#3ad900;font-weight:400">"\n&nbsp;jmp&nbsp;"</span>+thisreg)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;opcodej.append(<span style="color:#3ad900;font-weight:400">"push&nbsp;"</span>+searchreg+<span style="color:#3ad900;font-weight:400">"\n&nbsp;pop&nbsp;"</span>+thisreg+<span style="color:#3ad900;font-weight:400">"\n&nbsp;call&nbsp;"</span>+thisreg)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;thisreg.upper()&lt;&gt;searchreg.upper():<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;opcodej.append(<span style="color:#3ad900;font-weight:400">"mov&nbsp;"</span>+thisreg+<span style="color:#3ad900;font-weight:400">","</span>+searchreg+<span style="color:#3ad900;font-weight:400">"\n&nbsp;jmp&nbsp;"</span>+thisreg)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;opcodej.append(<span style="color:#3ad900;font-weight:400">"mov&nbsp;"</span>+thisreg+<span style="color:#3ad900;font-weight:400">","</span>+searchreg+<span style="color:#3ad900;font-weight:400">"\n&nbsp;call&nbsp;"</span>+thisreg)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;opcodej.append(<span style="color:#3ad900;font-weight:400">"mov&nbsp;"</span>+thisreg+<span style="color:#3ad900;font-weight:400">","</span>+searchreg+<span style="color:#3ad900;font-weight:400">"\n&nbsp;push&nbsp;"</span>+thisreg+<span style="color:#3ad900;font-weight:400">"\n&nbsp;ret"</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">for</span>&nbsp;opj&nbsp;<span style="color:#ff9d00;font-weight:700">in</span>&nbsp;opcodej:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"-&gt;&nbsp;Searching&nbsp;for&nbsp;%s"</span>&nbsp;%&nbsp;(opj),highlight=<span style="color:#ff0044;font-weight:400">1</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.updateLog()<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;addys=imm.search(&nbsp;imm.assemble&nbsp;(opj)&nbsp;)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;results&nbsp;+=&nbsp;addys<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">for</span>&nbsp;ad1&nbsp;<span style="color:#ff9d00;font-weight:700">in</span>&nbsp;addys:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;module&nbsp;=&nbsp;getmodnamefromptr(ad1)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;<span style="color:#ff9d00;font-weight:700">not</span>&nbsp;module:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;module&nbsp;=&nbsp;<span style="color:#3ad900;font-weight:400">"none"</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">else</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;module==<span style="color:#3ad900;font-weight:400">""</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;module&nbsp;=&nbsp;<span style="color:#3ad900;font-weight:400">"none"</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">else</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;module&nbsp;=&nbsp;module.lower()<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;isfixup=getmoduleprop(module,<span style="color:#3ad900;font-weight:400">"fixup"</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;isaslr=getmoduleprop(module,<span style="color:#3ad900;font-weight:400">"aslr"</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#0088ff;font-weight:400">#reset&nbsp;fixup/aslr&nbsp;values&nbsp;if&nbsp;you&nbsp;specified&nbsp;a&nbsp;module&nbsp;name</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;modulefilter&nbsp;&lt;&gt;&nbsp;<span style="color:#3ad900;font-weight:400">""</span>&nbsp;<span style="color:#ff9d00;font-weight:700">and</span>&nbsp;module.upper().find(modulefilter.upper())&nbsp;&gt;=&nbsp;<span style="color:#ff0044;font-weight:400">0</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;isfixup=<span style="color:#3ad900;font-weight:400">"0"</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;isaslr=<span style="color:#3ad900;font-weight:400">"0"</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;module.upper().find(modulefilter.upper())&nbsp;&gt;=&nbsp;<span style="color:#ff0044;font-weight:400">0</span>&nbsp;<span style="color:#ff9d00;font-weight:700">and</span>&nbsp;isfixup&nbsp;==<span style="color:#3ad900;font-weight:400">"0"</span>&nbsp;<span style="color:#ff9d00;font-weight:700">and</span>&nbsp;isaslr==<span style="color:#3ad900;font-weight:400">"0"</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;(noos==<span style="color:#ff0044;font-weight:400">0</span>)&nbsp;<span style="color:#ff9d00;font-weight:700">or</span>&nbsp;(noos==<span style="color:#ff0044;font-weight:400">1</span>&nbsp;<span style="color:#ff9d00;font-weight:700">and</span>&nbsp;isosmodule(module)==<span style="color:#ff0044;font-weight:400">0</span>):<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;aspec=addressspec(tohex(ad1)).upper()<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;(nonull==<span style="color:#ff0044;font-weight:400">0</span>)&nbsp;<span style="color:#ff9d00;font-weight:700">or</span>&nbsp;(nonull==<span style="color:#ff0044;font-weight:400">1</span>&nbsp;<span style="color:#ff9d00;font-weight:700">and</span>&nbsp;aspec.find(<span style="color:#3ad900;font-weight:400">"NULL"</span>)&nbsp;==&nbsp;-<span style="color:#ff0044;font-weight:400">1</span>):<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#0088ff;font-weight:400">#page&nbsp;&nbsp;&nbsp;=&nbsp;imm.getMemoryPagebyAddress(&nbsp;ad1&nbsp;)</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#0088ff;font-weight:400">#access&nbsp;=&nbsp;page.getAccess(&nbsp;human&nbsp;=&nbsp;True&nbsp;)</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#0088ff;font-weight:400">#hexaddr=tohex(ad1)</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#0088ff;font-weight:400">#imm.log("Found&nbsp;%s&nbsp;at&nbsp;0x%08x&nbsp;[%s]&nbsp;Access:&nbsp;(%s)&nbsp;"&nbsp;%&nbsp;(opj,&nbsp;ad1,&nbsp;module,&nbsp;access),&nbsp;address&nbsp;=&nbsp;ad1)</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tofile(<span style="color:#3ad900;font-weight:400">"Found&nbsp;"</span>+opj+<span style="color:#3ad900;font-weight:400">"&nbsp;at&nbsp;0x"</span>&nbsp;+&nbsp;tohex(ad1)+<span style="color:#3ad900;font-weight:400">"&nbsp;["</span>+module+<span style="color:#3ad900;font-weight:400">"]"</span>,filename,ad1)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.updateLog()<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;nrfound+=<span style="color:#ff0044;font-weight:400">1</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"Search&nbsp;complete"</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"Output&nbsp;written&nbsp;to&nbsp;"</span>+filename)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;results:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"Found&nbsp;%d&nbsp;address(es)"</span>&nbsp;%&nbsp;nrfound)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">return</span>&nbsp;<span style="color:#3ad900;font-weight:400">"Found&nbsp;%d&nbsp;address(es)&nbsp;(Check&nbsp;the&nbsp;Log&nbsp;Windows&nbsp;for&nbsp;details)"</span>&nbsp;%&nbsp;nrfound<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">else</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"No&nbsp;addresses&nbsp;found"</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">return</span>&nbsp;<span style="color:#3ad900;font-weight:400">"Sorry,&nbsp;no&nbsp;addresses&nbsp;found"</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"--------------------------------------------------------------"</span>)<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">else</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;usage(imm)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">return</span>&nbsp;<span style="color:#3ad900;font-weight:400">"Error:&nbsp;Please&nbsp;provide&nbsp;register&nbsp;and&nbsp;optional&nbsp;module&nbsp;name"</span><br /><br />&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#3ad900;font-weight:400">"""<br />&nbsp;&nbsp;&nbsp;&nbsp;Function&nbsp;that&nbsp;looks&nbsp;for&nbsp;jump/call/push&nbsp;addresses&nbsp;(mostly&nbsp;used&nbsp;in&nbsp;direct&nbsp;RET&nbsp;BOF)<br />&nbsp;&nbsp;&nbsp;&nbsp;"""</span><br />&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;args[<span style="color:#ff0044;font-weight:400">0</span>]&nbsp;==&nbsp;<span style="color:#3ad900;font-weight:400">"jp"</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;<span style="color:#ff9d00;font-weight:700">len</span>(args)&nbsp;&gt;&nbsp;<span style="color:#ff0044;font-weight:400">1</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"------------------------------------------------------------------------------------------------"</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"Search&nbsp;for&nbsp;jmp/call/push&nbsp;ret&nbsp;combinations&nbsp;+&nbsp;pointers&nbsp;to&nbsp;these&nbsp;address&nbsp;started&nbsp;-&nbsp;please&nbsp;wait..."</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"------------------------------------------------------------------------------------------------"</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cnt=<span style="color:#ff0044;font-weight:400">1</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">while</span>&nbsp;cnt&nbsp;&lt;&nbsp;<span style="color:#ff9d00;font-weight:700">len</span>(args):<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;args[cnt]==<span style="color:#3ad900;font-weight:400">'-r'</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;cnt&nbsp;&lt;&nbsp;(<span style="color:#ff9d00;font-weight:700">len</span>(args)-<span style="color:#ff0044;font-weight:400">1</span>):<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;searchreg=args[cnt+<span style="color:#ff0044;font-weight:400">1</span>]<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cnt=cnt+<span style="color:#ff0044;font-weight:400">1</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;modulefilter&nbsp;&lt;&gt;&nbsp;<span style="color:#3ad900;font-weight:400">""</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;noos=<span style="color:#ff0044;font-weight:400">0</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;opcodej=[<span style="color:#3ad900;font-weight:400">"jmp&nbsp;"</span>+searchreg,<span style="color:#3ad900;font-weight:400">"call&nbsp;"</span>+searchreg,<span style="color:#3ad900;font-weight:400">"push&nbsp;"</span>+searchreg+<span style="color:#3ad900;font-weight:400">"\n&nbsp;ret"</span>,<span style="color:#3ad900;font-weight:400">"push&nbsp;"</span>+searchreg+<span style="color:#3ad900;font-weight:400">"\n&nbsp;ret&nbsp;4"</span>,<span style="color:#3ad900;font-weight:400">"push&nbsp;"</span>+searchreg+<span style="color:#3ad900;font-weight:400">"\n&nbsp;ret&nbsp;8"</span>,<span style="color:#3ad900;font-weight:400">"push&nbsp;"</span>+searchreg+<span style="color:#3ad900;font-weight:400">"\n&nbsp;ret&nbsp;0c"</span>]<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;filename=<span style="color:#3ad900;font-weight:400">"jp.txt"</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;resetfile(filename)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;writemodinfo(filename)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">for</span>&nbsp;opj&nbsp;<span style="color:#ff9d00;font-weight:700">in</span>&nbsp;opcodej:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;addys=imm.search(&nbsp;imm.assemble&nbsp;(opj)&nbsp;)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;results&nbsp;+=&nbsp;addys<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">for</span>&nbsp;ad1&nbsp;<span style="color:#ff9d00;font-weight:700">in</span>&nbsp;addys:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;module&nbsp;=&nbsp;getmodnamefromptr(ad1)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;<span style="color:#ff9d00;font-weight:700">not</span>&nbsp;module:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;module&nbsp;=&nbsp;<span style="color:#3ad900;font-weight:400">"none"</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">else</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;module==<span style="color:#3ad900;font-weight:400">""</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;module&nbsp;=&nbsp;<span style="color:#3ad900;font-weight:400">"none"</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">else</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;module&nbsp;=&nbsp;module.lower()<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;module.find(modulefilter)&nbsp;&gt;=&nbsp;<span style="color:#ff0044;font-weight:400">0</span>&nbsp;<span style="color:#ff9d00;font-weight:700">and</span>&nbsp;getmoduleprop(module,<span style="color:#3ad900;font-weight:400">"fixup"</span>)==<span style="color:#3ad900;font-weight:400">"0"</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#0088ff;font-weight:400">#page&nbsp;&nbsp;&nbsp;=&nbsp;imm.getMemoryPagebyAddress(&nbsp;ad1&nbsp;)</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#0088ff;font-weight:400">#access&nbsp;=&nbsp;page.getAccess(&nbsp;human&nbsp;=&nbsp;True&nbsp;)</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#0088ff;font-weight:400">#now&nbsp;look&nbsp;for&nbsp;a&nbsp;pointer&nbsp;to&nbsp;that&nbsp;address</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#0088ff;font-weight:400">#imm.log("Found&nbsp;%s&nbsp;at&nbsp;0x%08x&nbsp;[%s]&nbsp;Access:&nbsp;(%s)"&nbsp;%&nbsp;(opj,&nbsp;ad1,&nbsp;module,&nbsp;access),&nbsp;address&nbsp;=&nbsp;ad1)</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;thisadr=tohex(ad1)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">try</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;b4&nbsp;=&nbsp;thisadr[<span style="color:#ff0044;font-weight:400">0</span>]+thisadr[<span style="color:#ff0044;font-weight:400">1</span>]<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;b3&nbsp;=&nbsp;thisadr[<span style="color:#ff0044;font-weight:400">2</span>]+thisadr[<span style="color:#ff0044;font-weight:400">3</span>]<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;b2&nbsp;=&nbsp;thisadr[<span style="color:#ff0044;font-weight:400">4</span>]+thisadr[<span style="color:#ff0044;font-weight:400">5</span>]<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;b1&nbsp;=&nbsp;thisadr[<span style="color:#ff0044;font-weight:400">6</span>]+thisadr[<span style="color:#ff0044;font-weight:400">7</span>]<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;b=binascii.a2b_hex(b1)+binascii.a2b_hex(b2)+binascii.a2b_hex(b3)+binascii.a2b_hex(b4)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#0088ff;font-weight:400">#imm.log("Looking&nbsp;for&nbsp;pointers&nbsp;to&nbsp;%s"&nbsp;%&nbsp;b)</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;addys2=imm.search(b)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">for</span>&nbsp;ad2&nbsp;<span style="color:#ff9d00;font-weight:700">in</span>&nbsp;addys2:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;module&nbsp;=&nbsp;getmodnamefromptr(ad2)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;<span style="color:#ff9d00;font-weight:700">not</span>&nbsp;module:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;module&nbsp;=&nbsp;<span style="color:#3ad900;font-weight:400">"none"</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">else</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;module&nbsp;&lt;&gt;&nbsp;<span style="color:#3ad900;font-weight:400">""</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;module&nbsp;=&nbsp;module.lower()<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;page&nbsp;&nbsp;&nbsp;=&nbsp;imm.getMemoryPagebyAddress(&nbsp;ad2&nbsp;)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;access&nbsp;=&nbsp;page.getAccess(&nbsp;human&nbsp;=&nbsp;<span style="color:#ff0044;font-weight:400">True</span>&nbsp;)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"Found&nbsp;%s&nbsp;at&nbsp;0x%08x&nbsp;[%s]&nbsp;Access:&nbsp;(%s)"</span>&nbsp;%&nbsp;(opj,&nbsp;ad1,&nbsp;module,&nbsp;access),&nbsp;address&nbsp;=&nbsp;ad1)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;&nbsp;-&gt;&nbsp;Found&nbsp;pointer&nbsp;to&nbsp;%s&nbsp;at&nbsp;0x%08x&nbsp;(%s)&nbsp;-&nbsp;Access:&nbsp;(%s)"</span>&nbsp;%&nbsp;(opj,&nbsp;ad2,&nbsp;module,access),&nbsp;address&nbsp;=&nbsp;ad2)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tofile(<span style="color:#3ad900;font-weight:400">"Found&nbsp;"</span>+opj+<span style="color:#3ad900;font-weight:400">"&nbsp;at&nbsp;0x"</span>&nbsp;+&nbsp;tohex(ad1)+<span style="color:#3ad900;font-weight:400">"&nbsp;["</span>+module+<span style="color:#3ad900;font-weight:400">"]"</span>,filename,ad1)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tofile(<span style="color:#3ad900;font-weight:400">"&nbsp;&nbsp;-&gt;&nbsp;Found&nbsp;pointer&nbsp;to&nbsp;"</span>&nbsp;+&nbsp;opj&nbsp;+&nbsp;<span style="color:#3ad900;font-weight:400">"&nbsp;at&nbsp;0x"</span>+tohex(ad2)+<span style="color:#3ad900;font-weight:400">"&nbsp;["</span>+module+<span style="color:#3ad900;font-weight:400">"]"</span>,filename,ad2)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;nrfound+=<span style="color:#ff0044;font-weight:400">1</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;b=binascii.a2b_hex(b2)+binascii.a2b_hex(b3)+binascii.a2b_hex(b4)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#0088ff;font-weight:400">#imm.log("Looking&nbsp;for&nbsp;pointers&nbsp;to&nbsp;%s"&nbsp;%&nbsp;b)</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;addys2=imm.search(b)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">for</span>&nbsp;ad2&nbsp;<span style="color:#ff9d00;font-weight:700">in</span>&nbsp;addys2:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ad2=ad2-<span style="color:#ff0044;font-weight:400">1</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;module&nbsp;=&nbsp;getmodnamefromptr(ad2)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;<span style="color:#ff9d00;font-weight:700">not</span>&nbsp;module:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;module&nbsp;=&nbsp;<span style="color:#3ad900;font-weight:400">"none"</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">else</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;module&nbsp;&lt;&gt;&nbsp;<span style="color:#3ad900;font-weight:400">""</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;page&nbsp;&nbsp;&nbsp;=&nbsp;imm.getMemoryPagebyAddress(&nbsp;ad2&nbsp;)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;access&nbsp;=&nbsp;page.getAccess(&nbsp;human&nbsp;=&nbsp;<span style="color:#ff0044;font-weight:400">True</span>&nbsp;)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"Found&nbsp;%s&nbsp;at&nbsp;0x%08x&nbsp;[%s]&nbsp;Access:&nbsp;(%s)"</span>&nbsp;%&nbsp;(opj,&nbsp;ad1,&nbsp;module,&nbsp;access),&nbsp;address&nbsp;=&nbsp;ad1)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;&nbsp;-&gt;&nbsp;Found&nbsp;possible&nbsp;pointer&nbsp;to&nbsp;%s&nbsp;at&nbsp;0x%08x&nbsp;(%s)&nbsp;-&nbsp;Access:&nbsp;(%s)"</span>&nbsp;%&nbsp;(opj,&nbsp;ad2,&nbsp;module,access),&nbsp;address&nbsp;=&nbsp;ad2)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tofile(<span style="color:#3ad900;font-weight:400">"Found&nbsp;"</span>+opj+<span style="color:#3ad900;font-weight:400">"&nbsp;at&nbsp;0x"</span>&nbsp;+&nbsp;tohex(ad1)+<span style="color:#3ad900;font-weight:400">"&nbsp;["</span>+module+<span style="color:#3ad900;font-weight:400">"]"</span>,filename,ad1)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tofile(<span style="color:#3ad900;font-weight:400">"&nbsp;&nbsp;-&gt;&nbsp;Found&nbsp;'close'&nbsp;pointer&nbsp;to&nbsp;"</span>&nbsp;+&nbsp;opj+<span style="color:#3ad900;font-weight:400">"&nbsp;at&nbsp;0x"</span>+tohex(ad2)+<span style="color:#3ad900;font-weight:400">"&nbsp;["</span>+module+<span style="color:#3ad900;font-weight:400">"]"</span>,filename,ad2)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;nrfound+=<span style="color:#ff0044;font-weight:400">1</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">except</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;&nbsp;Unable&nbsp;to&nbsp;search&nbsp;for&nbsp;pointers&nbsp;(due&nbsp;to&nbsp;null&nbsp;byte)"</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"Search&nbsp;complete"</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"Output&nbsp;written&nbsp;to&nbsp;"</span>+filename)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;results:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"Found&nbsp;%d&nbsp;pointer(s)"</span>&nbsp;%&nbsp;nrfound)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">return</span>&nbsp;<span style="color:#3ad900;font-weight:400">"Found&nbsp;%d&nbsp;address(es)&nbsp;(Check&nbsp;the&nbsp;Log&nbsp;Windows&nbsp;for&nbsp;details)"</span>&nbsp;%&nbsp;nrfound<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">else</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"No&nbsp;addresses&nbsp;found"</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">return</span>&nbsp;<span style="color:#3ad900;font-weight:400">"Sorry,&nbsp;no&nbsp;addresses&nbsp;found"</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"--------------------------------------------------------------"</span>)<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">else</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;usage(imm)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">return</span>&nbsp;<span style="color:#3ad900;font-weight:400">"Error:&nbsp;Please&nbsp;provide&nbsp;register&nbsp;and&nbsp;optional&nbsp;module&nbsp;name"</span><br /><br /><br /><br />&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#3ad900;font-weight:400">"""<br />&nbsp;&nbsp;&nbsp;&nbsp;Function&nbsp;that&nbsp;looks&nbsp;for&nbsp;a&nbsp;jump&nbsp;to&nbsp;a&nbsp;register+offset<br />&nbsp;&nbsp;&nbsp;&nbsp;"""</span><br />&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;args[<span style="color:#ff0044;font-weight:400">0</span>]&nbsp;==&nbsp;<span style="color:#3ad900;font-weight:400">"jo"</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;filename=<span style="color:#3ad900;font-weight:400">"jo.txt"</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;resetfile(filename)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;writemodinfo(filename)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;opsearch&nbsp;=&nbsp;[]<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;minoffset=-<span style="color:#ff0044;font-weight:400">101</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;maxoffset=<span style="color:#ff0044;font-weight:400">101</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;<span style="color:#ff9d00;font-weight:700">len</span>(args)&nbsp;&gt;&nbsp;<span style="color:#ff0044;font-weight:400">1</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cnt=<span style="color:#ff0044;font-weight:400">1</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">while</span>&nbsp;cnt&nbsp;&lt;&nbsp;<span style="color:#ff9d00;font-weight:700">len</span>(args):<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;args[cnt]==<span style="color:#3ad900;font-weight:400">'-r'</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;cnt&nbsp;&lt;&nbsp;(<span style="color:#ff9d00;font-weight:700">len</span>(args)-<span style="color:#ff0044;font-weight:400">1</span>):<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;searchreg=args[cnt+<span style="color:#ff0044;font-weight:400">1</span>].upper()<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;args[cnt]==<span style="color:#3ad900;font-weight:400">'-l'</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;cnt&nbsp;&lt;&nbsp;(<span style="color:#ff9d00;font-weight:700">len</span>(args)-<span style="color:#ff0044;font-weight:400">1</span>):<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;IsNumber(args[cnt+<span style="color:#ff0044;font-weight:400">1</span>]):<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;minoffset=<span style="color:#ff9d00;font-weight:700">int</span>(args[cnt+<span style="color:#ff0044;font-weight:400">1</span>])<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;args[cnt]==<span style="color:#3ad900;font-weight:400">'-t'</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;cnt&nbsp;&lt;&nbsp;(<span style="color:#ff9d00;font-weight:700">len</span>(args)-<span style="color:#ff0044;font-weight:400">1</span>):<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;IsNumber(args[cnt+<span style="color:#ff0044;font-weight:400">1</span>]):<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;maxoffset=<span style="color:#ff9d00;font-weight:700">int</span>(args[cnt+<span style="color:#ff0044;font-weight:400">1</span>])<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cnt=cnt+<span style="color:#ff0044;font-weight:400">1</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;modulefilter&nbsp;&lt;&gt;&nbsp;<span style="color:#3ad900;font-weight:400">""</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;noos=<span style="color:#ff0044;font-weight:400">0</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"---------------------------------------------------------------------"</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"Search&nbsp;for&nbsp;jump&nbsp;to&nbsp;reg&nbsp;+&nbsp;offset&nbsp;combinations&nbsp;started&nbsp;-&nbsp;please&nbsp;wait..."</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"---------------------------------------------------------------------"</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#0088ff;font-weight:400">#arg1&nbsp;=&nbsp;reg</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;targetreg=searchreg<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;allop=[<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#3ad900;font-weight:400">"EAX&nbsp;0xff0x500x??"</span>,&nbsp;&nbsp;&nbsp;<span style="color:#0088ff;font-weight:400">#call&nbsp;dword&nbsp;ptr&nbsp;EAX</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#3ad900;font-weight:400">"ECX&nbsp;0xff0x510x??"</span>,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#0088ff;font-weight:400">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ECX</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#3ad900;font-weight:400">"EDX&nbsp;0xff0x520x??"</span>,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#0088ff;font-weight:400">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EDX</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#3ad900;font-weight:400">"EBX&nbsp;0xff0x530x??"</span>,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#0088ff;font-weight:400">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EBX</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#3ad900;font-weight:400">"EBP&nbsp;0xff0x550x??"</span>,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#0088ff;font-weight:400">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EBP</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#3ad900;font-weight:400">"ESI&nbsp;0xff0x560x??"</span>,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#0088ff;font-weight:400">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ESI</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#3ad900;font-weight:400">"EDI&nbsp;0xff0x570x??"</span>,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#0088ff;font-weight:400">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EDI</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#3ad900;font-weight:400">"EAX&nbsp;0xff0x580x??"</span>,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#0088ff;font-weight:400">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;far&nbsp;EAX</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#3ad900;font-weight:400">"ESP&nbsp;0xff0x540x240x??"</span>,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#0088ff;font-weight:400">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ESP</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#3ad900;font-weight:400">"EAX&nbsp;0xff0x600x240x??"</span>,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#0088ff;font-weight:400">#jmp&nbsp;dword&nbsp;ptr&nbsp;eax</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#3ad900;font-weight:400">"ECX&nbsp;0xff0x610x240x??"</span>,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#0088ff;font-weight:400">#jmp&nbsp;dword&nbsp;ptr&nbsp;ecx</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#3ad900;font-weight:400">"EDX&nbsp;0xff0x620x240x??"</span>,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#0088ff;font-weight:400">#jmp&nbsp;dword&nbsp;ptr&nbsp;edx</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#3ad900;font-weight:400">"EBX&nbsp;0xff0x630x240x??"</span>,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#0088ff;font-weight:400">#jmp&nbsp;dword&nbsp;ptr&nbsp;ebx</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#3ad900;font-weight:400">"ESP&nbsp;0xff0x640x240x??"</span>,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#0088ff;font-weight:400">#jmp&nbsp;dword&nbsp;ptr&nbsp;esp</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#3ad900;font-weight:400">"EBP&nbsp;0xff0x650x240x??"</span>,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#0088ff;font-weight:400">#jmp&nbsp;dword&nbsp;ptr&nbsp;ebp</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#3ad900;font-weight:400">"ESI&nbsp;0xff0x660x240x??"</span>,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#0088ff;font-weight:400">#jmp&nbsp;dword&nbsp;ptr&nbsp;esi</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#3ad900;font-weight:400">"EDI&nbsp;0xff0x670x240x??"</span>,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#0088ff;font-weight:400">#jmp&nbsp;dword&nbsp;ptr&nbsp;edi</span><br /><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#3ad900;font-weight:400">"EAX&nbsp;0xff0x700x240x??0xc3"</span>,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#0088ff;font-weight:400">#push&nbsp;dword&nbsp;ptr&nbsp;eax</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#3ad900;font-weight:400">"EAX&nbsp;0xff0x700x240x??0xc2"</span>,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#0088ff;font-weight:400">#push&nbsp;dword&nbsp;ptr&nbsp;eax</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#3ad900;font-weight:400">"ECX&nbsp;0xff0x710x240x??0xc3"</span>,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#0088ff;font-weight:400">#push&nbsp;dword&nbsp;ptr&nbsp;ecx</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#3ad900;font-weight:400">"ECX&nbsp;0xff0x710x240x??0xc2"</span>,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#0088ff;font-weight:400">#push&nbsp;dword&nbsp;ptr&nbsp;ecx</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#3ad900;font-weight:400">"EDX&nbsp;0xff0x720x240x??0xc3"</span>,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#0088ff;font-weight:400">#push&nbsp;dword&nbsp;ptr&nbsp;edx</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#3ad900;font-weight:400">"EDX&nbsp;0xff0x720x240x??0xc2"</span>,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#0088ff;font-weight:400">#push&nbsp;dword&nbsp;ptr&nbsp;edx</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#3ad900;font-weight:400">"EBX&nbsp;0xff0x730x240x??0xc3"</span>,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#0088ff;font-weight:400">#push&nbsp;dword&nbsp;ptr&nbsp;ebx</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#3ad900;font-weight:400">"EBX&nbsp;0xff0x730x240x??0xc2"</span>,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#0088ff;font-weight:400">#push&nbsp;dword&nbsp;ptr&nbsp;ebx</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#3ad900;font-weight:400">"ESP&nbsp;0xff0x740x240x??0xc3"</span>,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#0088ff;font-weight:400">#push&nbsp;dword&nbsp;ptr&nbsp;esp</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#3ad900;font-weight:400">"ESP&nbsp;0xff0x740x240x??0xc2"</span>,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#0088ff;font-weight:400">#push&nbsp;dword&nbsp;ptr&nbsp;esp</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#3ad900;font-weight:400">"EBP&nbsp;0xff0x750x??0xc3"</span>,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#0088ff;font-weight:400">#push&nbsp;dword&nbsp;ptr&nbsp;ebp</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#3ad900;font-weight:400">"EBP&nbsp;0xff0x750x??0xc2"</span>,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#0088ff;font-weight:400">#push&nbsp;dword&nbsp;ptr&nbsp;ebp</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#3ad900;font-weight:400">"ESI&nbsp;0xff0x760x240x??0xc3"</span>,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#0088ff;font-weight:400">#push&nbsp;dword&nbsp;ptr&nbsp;esi</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#3ad900;font-weight:400">"ESI&nbsp;0xff0x760x240x??0xc2"</span>,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#0088ff;font-weight:400">#push&nbsp;dword&nbsp;ptr&nbsp;esi</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#3ad900;font-weight:400">"EDI&nbsp;0xff0x770x240x??0xc3"</span>,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#0088ff;font-weight:400">#push&nbsp;dword&nbsp;ptr&nbsp;edi</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#3ad900;font-weight:400">"EDI&nbsp;0xff0x770x240x??0xc2"</span>,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#0088ff;font-weight:400">#push&nbsp;dword&nbsp;ptr&nbsp;edi</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#3ad900;font-weight:400">"EAX&nbsp;0xff0x680x??"</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#0088ff;font-weight:400">#jmp&nbsp;far&nbsp;dword&nbsp;ptr&nbsp;eax</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;]<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;posop=[<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#3ad900;font-weight:400">"EAX&nbsp;0x830xc00x??0x500xc3"</span>,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#0088ff;font-weight:400">#add&nbsp;eax&nbsp;+&nbsp;push&nbsp;+&nbsp;ret</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#3ad900;font-weight:400">"EAX&nbsp;0x810xc00x??0x000x000x000x500xc3"</span>,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#3ad900;font-weight:400">"EAX&nbsp;0x830xc00x??0x500xc2"</span>,		&nbsp;<span style="color:#0088ff;font-weight:400">#add&nbsp;eax&nbsp;+&nbsp;push&nbsp;+&nbsp;ret&nbsp;n</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#3ad900;font-weight:400">"EAX&nbsp;0x810xc00x??0x000x000x000x500xc2"</span>,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#3ad900;font-weight:400">"ECX&nbsp;0x830xc10x??0x510xc3"</span>,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#0088ff;font-weight:400">#add&nbsp;ecx&nbsp;+&nbsp;push&nbsp;+&nbsp;ret</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#3ad900;font-weight:400">"ECX&nbsp;0x810xc10x??0x000x000x000x510xc3"</span>,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#3ad900;font-weight:400">"ECX&nbsp;0x830xc10x??0x510xc2"</span>,		&nbsp;<span style="color:#0088ff;font-weight:400">#add&nbsp;ecx&nbsp;+&nbsp;push&nbsp;+&nbsp;ret&nbsp;n</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#3ad900;font-weight:400">"ECX&nbsp;0x810xc10x??0x000x000x000x510xc2"</span>,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#3ad900;font-weight:400">"EDX&nbsp;0x830xc20x??0x520xc3"</span>,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#0088ff;font-weight:400">#add&nbsp;edx&nbsp;+&nbsp;push&nbsp;+&nbsp;ret</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#3ad900;font-weight:400">"EDX&nbsp;0x810xc20x??0x000x000x000x520xc3"</span>,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#3ad900;font-weight:400">"EDX&nbsp;0x830xc20x??0x520xc2"</span>,		&nbsp;<span style="color:#0088ff;font-weight:400">#add&nbsp;edx&nbsp;+&nbsp;push&nbsp;+&nbsp;ret&nbsp;n</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#3ad900;font-weight:400">"EDX&nbsp;0x810xc20x??0x000x000x000x520xc3"</span>,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#3ad900;font-weight:400">"EBX&nbsp;0x830xc30x??0x530xc3"</span>,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#0088ff;font-weight:400">#add&nbsp;ebx&nbsp;+&nbsp;push&nbsp;+&nbsp;ret</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#3ad900;font-weight:400">"EBX&nbsp;0x810xc30x??0x000x000x000x530xc3"</span>,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#3ad900;font-weight:400">"EBX&nbsp;0x830xc30x??0x530xc2"</span>,		&nbsp;<span style="color:#0088ff;font-weight:400">#add&nbsp;ebx&nbsp;+&nbsp;push&nbsp;+&nbsp;ret&nbsp;n</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#3ad900;font-weight:400">"EBX&nbsp;0x810xc30x??0x000x000x000x530xc3"</span>,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#3ad900;font-weight:400">"ESP&nbsp;0x830xc40x??0x540xc3"</span>,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#0088ff;font-weight:400">#add&nbsp;esp&nbsp;+&nbsp;push&nbsp;+&nbsp;ret</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#3ad900;font-weight:400">"ESP&nbsp;0x810xc40x??0x000x000x000x540xc3"</span>,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#3ad900;font-weight:400">"ESP&nbsp;0x830xc40x??0x540xc2"</span>,		&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#0088ff;font-weight:400">#add&nbsp;esp&nbsp;+&nbsp;pups&nbsp;+&nbsp;ret&nbsp;n</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#3ad900;font-weight:400">"ESP&nbsp;0x810xc40x??0x000x000x000x540xc2"</span>,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#3ad900;font-weight:400">"EBP&nbsp;0x830xc50x??0x550xc3"</span>,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#0088ff;font-weight:400">#add&nbsp;ebp&nbsp;+&nbsp;push&nbsp;+&nbsp;ret</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#3ad900;font-weight:400">"EBP&nbsp;0x810xc50x??0x000x000x000x550xc3"</span>,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#3ad900;font-weight:400">"EBP&nbsp;0x830xc50x??0x550xc2"</span>,		&nbsp;<span style="color:#0088ff;font-weight:400">#add&nbsp;ebp&nbsp;+&nbsp;push&nbsp;+&nbsp;ret&nbsp;n</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#3ad900;font-weight:400">"EBP&nbsp;0x810xc50x??0x000x000x000x550xc2"</span>,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#3ad900;font-weight:400">"ESI&nbsp;0x830xc60x??0x560xc3"</span>,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#0088ff;font-weight:400">#add&nbsp;esi&nbsp;+&nbsp;push&nbsp;+&nbsp;ret</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#3ad900;font-weight:400">"ESI&nbsp;0x810xc60x??0x000x000x000x560xc3"</span>,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#3ad900;font-weight:400">"ESI&nbsp;0x830xc60x??0x560xc2"</span>,		&nbsp;<span style="color:#0088ff;font-weight:400">#add&nbsp;esi&nbsp;+&nbsp;push&nbsp;+&nbsp;ret&nbsp;n</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#3ad900;font-weight:400">"ESI&nbsp;0x810xc60x??0x000x000x000x560xc3"</span>,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#3ad900;font-weight:400">"EDI&nbsp;0x830xc70x??0x570xc3"</span>,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#0088ff;font-weight:400">#add&nbsp;edi&nbsp;+&nbsp;push&nbsp;+&nbsp;ret</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#3ad900;font-weight:400">"EDI&nbsp;0x810xc70x??0x000x000x000x570xc3"</span>,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#3ad900;font-weight:400">"EDI&nbsp;0x830xc70x??0x570xc2"</span>,		&nbsp;<span style="color:#0088ff;font-weight:400">#add&nbsp;edi&nbsp;+&nbsp;push&nbsp;+&nbsp;ret&nbsp;n</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#3ad900;font-weight:400">"EDI&nbsp;0x810xc70x??0x000x000x000x570xc3"</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;]<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;posvalop=[<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#3ad900;font-weight:400">"EAX&nbsp;0x830xe8x??0x500xc3"</span>,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#0088ff;font-weight:400">#sub&nbsp;eax&nbsp;-value&nbsp;+&nbsp;push&nbsp;+&nbsp;ret</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#3ad900;font-weight:400">"EAX&nbsp;0x810xe8x??0xff0xff0xff0x500xc3"</span>,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#3ad900;font-weight:400">"EAX&nbsp;0x830xe8x??0x500xc2"</span>,		&nbsp;<span style="color:#0088ff;font-weight:400">#</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#3ad900;font-weight:400">"EAX&nbsp;0x810xe8x??0xff0xff0xff0x500xc2"</span>,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#3ad900;font-weight:400">"ECX&nbsp;0x830xe90x??0x510xc3"</span>,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#0088ff;font-weight:400">#sub&nbsp;ecx&nbsp;-value&nbsp;+&nbsp;push&nbsp;+&nbsp;ret</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#3ad900;font-weight:400">"ECX&nbsp;0x810xe90x??0xff0xff0xff0x510xc3"</span>,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#3ad900;font-weight:400">"ECX&nbsp;0x830xe90x??0x510xc2"</span>,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#3ad900;font-weight:400">"ECX&nbsp;0x810xe90x??0xff0xff0xff0x510xc2"</span>,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#3ad900;font-weight:400">"EDX&nbsp;0x830xea0x??0x520xc3"</span>,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#0088ff;font-weight:400">#sub&nbsp;edx&nbsp;-value&nbsp;+&nbsp;push&nbsp;+&nbsp;ret</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#3ad900;font-weight:400">"EDX&nbsp;0x810xea0x??0xff0xff0xff0x520xc3"</span>,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#3ad900;font-weight:400">"EDX&nbsp;0x830xea0x??0x520xc2"</span>,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#3ad900;font-weight:400">"EDX&nbsp;0x810xea0x??0xff0xff0xff0x520xc3"</span>,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#3ad900;font-weight:400">"EBX&nbsp;0x830xeb0x??0x530xc3"</span>,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#0088ff;font-weight:400">#sub&nbsp;ebx&nbsp;-value&nbsp;+&nbsp;push&nbsp;+&nbsp;ret</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#3ad900;font-weight:400">"EBX&nbsp;0x810xeb0x??0xff0xff0xff0x530xc3"</span>,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#3ad900;font-weight:400">"EBX&nbsp;0x830xeb0x??0x530xc2"</span>,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#3ad900;font-weight:400">"EBX&nbsp;0x810xeb0x??0xff0xff0xff0x530xc3"</span>,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#3ad900;font-weight:400">"ESP&nbsp;0x830xec0x??0x540xc3"</span>,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#0088ff;font-weight:400">#sub&nbsp;esp&nbsp;-value&nbsp;+&nbsp;push&nbsp;+&nbsp;ret</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#3ad900;font-weight:400">"ESP&nbsp;0x810xec0x??0xff0xff0xff0x540xc3"</span>,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#3ad900;font-weight:400">"ESP&nbsp;0x830xec0x??0x540xc2"</span>,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#3ad900;font-weight:400">"ESP&nbsp;0x810xec0x??0xff0xff0xff0x540xc2"</span>,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#3ad900;font-weight:400">"EBP&nbsp;0x830xed0x??0x550xc3"</span>,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#0088ff;font-weight:400">#sub&nbsp;ebp&nbsp;-value&nbsp;+&nbsp;push&nbsp;+&nbsp;ret</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#3ad900;font-weight:400">"EBP&nbsp;0x810xed0x??0xff0xff0xff0x550xc3"</span>,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#3ad900;font-weight:400">"EBP&nbsp;0x830xed0x??0x550xc2"</span>,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#3ad900;font-weight:400">"EBP&nbsp;0x810xed0x??0xff0xff0xff0x550xc2"</span>,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#3ad900;font-weight:400">"ESI&nbsp;0x830xee0x??0x560xc3"</span>,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#0088ff;font-weight:400">#sub&nbsp;esi&nbsp;-value&nbsp;+&nbsp;push&nbsp;+&nbsp;ret</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#3ad900;font-weight:400">"ESI&nbsp;0x810xee0x??0xff0xff0xff0x560xc3"</span>,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#3ad900;font-weight:400">"ESI&nbsp;0x830xee0x??0x560xc2"</span>,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#3ad900;font-weight:400">"ESI&nbsp;0x810xee0x??0xff0xff0xff0x560xc3"</span>,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#3ad900;font-weight:400">"EDI&nbsp;0x830xef0x??0x570xc3"</span>,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#0088ff;font-weight:400">#sub&nbsp;edi&nbsp;-value&nbsp;+&nbsp;push&nbsp;+&nbsp;ret</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#3ad900;font-weight:400">"EDI&nbsp;0x810xef0x??0xff0xff0xff0x570xc3"</span>,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#3ad900;font-weight:400">"EDI&nbsp;0x830xef0x??0x570xc2"</span>,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#3ad900;font-weight:400">"EDI&nbsp;0x810xef0x??0xff0xff0xff0x570xc3"</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;]<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;negop=[<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#3ad900;font-weight:400">"EAX&nbsp;0x810xe80x??0x000x000x000x500xc3"</span>,&nbsp;<span style="color:#0088ff;font-weight:400">#sub&nbsp;eax&nbsp;+&nbsp;push&nbsp;+&nbsp;ret</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#3ad900;font-weight:400">"EAX&nbsp;0x810xe80x??0x000x000x000x500xc2"</span>,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#3ad900;font-weight:400">"EAX&nbsp;0x830xe80x??0x500xc3"</span>,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#3ad900;font-weight:400">"EAX&nbsp;0x830xe80x??0x500xc2"</span>,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#3ad900;font-weight:400">"ECX&nbsp;0x810xe90x??0x000x000x000x510xc3"</span>,&nbsp;<span style="color:#0088ff;font-weight:400">#sub&nbsp;ecx&nbsp;+&nbsp;push&nbsp;+&nbsp;ret</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#3ad900;font-weight:400">"ECX&nbsp;0x810xe90x??0x000x000x000x510xc2"</span>,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#3ad900;font-weight:400">"ECX&nbsp;0x830xe90x??0x510xc3"</span>,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#3ad900;font-weight:400">"ECX&nbsp;0x830xe90x??0x510xc2"</span>,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#3ad900;font-weight:400">"EDX&nbsp;0x810xea0x??0x000x000x000x520xc3"</span>,&nbsp;<span style="color:#0088ff;font-weight:400">#sub&nbsp;edx&nbsp;+&nbsp;push&nbsp;+&nbsp;ret</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#3ad900;font-weight:400">"EDX&nbsp;0x810xea0x??0x000x000x000x520xc2"</span>,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#3ad900;font-weight:400">"EDX&nbsp;0x830xea0x??0x520xc3"</span>,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#3ad900;font-weight:400">"EDX&nbsp;0x830xea0x??0x520xc2"</span>,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#3ad900;font-weight:400">"EBX&nbsp;0x810xeb0x??0x000x000x000x530xc3"</span>,&nbsp;<span style="color:#0088ff;font-weight:400">#sub&nbsp;ebx&nbsp;+&nbsp;push&nbsp;+&nbsp;ret</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#3ad900;font-weight:400">"EBX&nbsp;0x810xeb0x??0x000x000x000x530xc2"</span>,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#3ad900;font-weight:400">"EBX&nbsp;0x830xeb0x??0x530xc3"</span>,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#3ad900;font-weight:400">"EBX&nbsp;0x830xeb0x??0x530xc2"</span>,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#3ad900;font-weight:400">"ESP&nbsp;0x810xec0x??0x000x000x000x540xc3"</span>,&nbsp;<span style="color:#0088ff;font-weight:400">#sub&nbsp;esp&nbsp;+&nbsp;push&nbsp;+&nbsp;ret</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#3ad900;font-weight:400">"ESP&nbsp;0x810xec0x??0x000x000x000x540xc2"</span>,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#3ad900;font-weight:400">"ESP&nbsp;0x830xec0x??0x540xc3"</span>,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#3ad900;font-weight:400">"ESP&nbsp;0x830xec0x??0x540xc2"</span>,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#3ad900;font-weight:400">"EBP&nbsp;0x810xed0x??0x000x000x000x550xc3"</span>,&nbsp;<span style="color:#0088ff;font-weight:400">#sub&nbsp;ebp&nbsp;+&nbsp;push&nbsp;+&nbsp;ret</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#3ad900;font-weight:400">"EBP&nbsp;0x810xed0x??0x000x000x000x550xc2"</span>,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#3ad900;font-weight:400">"EBP&nbsp;0x830xed0x??0x550xc3"</span>,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#3ad900;font-weight:400">"EBP&nbsp;0x830xed0x??0x550xc2"</span>,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#3ad900;font-weight:400">"ESI&nbsp;0x810xee0x??0x000x000x000x560xc3"</span>,&nbsp;<span style="color:#0088ff;font-weight:400">#sub&nbsp;esi&nbsp;+&nbsp;push&nbsp;+&nbsp;ret</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#3ad900;font-weight:400">"ESI&nbsp;0x810xee0x??0x000x000x000x560xc2"</span>,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#3ad900;font-weight:400">"ESI&nbsp;0x830xee0x??0x560xc3"</span>,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#3ad900;font-weight:400">"ESI&nbsp;0x830xee0x??0x560xc2"</span>,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#3ad900;font-weight:400">"EDI&nbsp;0x810xef0x??0x000x000x000x570xc3"</span>,&nbsp;<span style="color:#0088ff;font-weight:400">#sub&nbsp;edi&nbsp;+&nbsp;push&nbsp;+&nbsp;ret</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#3ad900;font-weight:400">"EDI&nbsp;0x810xef0x??0x000x000x000x570xc2"</span>,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#3ad900;font-weight:400">"EDI&nbsp;0x830xef0x??0x570xc3"</span>,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#3ad900;font-weight:400">"EDI&nbsp;0x830xef0x??0x570xc2"</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;]<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;negvalop=[<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#3ad900;font-weight:400">"EAX&nbsp;0x810xc00x??0xFF0xFF0xFF0x500xc3"</span>,&nbsp;&nbsp;<span style="color:#0088ff;font-weight:400">#add&nbsp;eax&nbsp;-&nbsp;x&nbsp;+&nbsp;push&nbsp;+&nbsp;ret</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#3ad900;font-weight:400">"EAX&nbsp;0x830xc00x??0x500xc3"</span>,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#3ad900;font-weight:400">"EAX&nbsp;0x810xc00x??0xFF0xFF0xFF0x500xc2"</span>,&nbsp;&nbsp;<span style="color:#0088ff;font-weight:400">#add&nbsp;eax&nbsp;-&nbsp;x&nbsp;+&nbsp;push&nbsp;+&nbsp;ret&nbsp;n</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#3ad900;font-weight:400">"EAX&nbsp;0x830xc00x??0x500xc2"</span>,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#3ad900;font-weight:400">"ECX&nbsp;0x810xc10x??0xFF0xFF0xFF0x510xc3"</span>,&nbsp;&nbsp;<span style="color:#0088ff;font-weight:400">#add&nbsp;ecx&nbsp;-&nbsp;x&nbsp;+&nbsp;push&nbsp;+&nbsp;ret</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#3ad900;font-weight:400">"ECX&nbsp;0x830xc10x??0x510xc3"</span>,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#3ad900;font-weight:400">"ECX&nbsp;0x810xc10x??0xFF0xFF0xFF0x510xc2"</span>,&nbsp;&nbsp;<span style="color:#0088ff;font-weight:400">#add&nbsp;ecx&nbsp;-&nbsp;x&nbsp;+&nbsp;push&nbsp;+&nbsp;ret&nbsp;n</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#3ad900;font-weight:400">"ECX&nbsp;0x830xc10x??0x510xc2"</span>,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#3ad900;font-weight:400">"EDX&nbsp;0x810xc20x??0xFF0xFF0xFF0x520xc3"</span>,&nbsp;&nbsp;<span style="color:#0088ff;font-weight:400">#add&nbsp;edx&nbsp;-&nbsp;x&nbsp;+&nbsp;push&nbsp;+&nbsp;ret</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#3ad900;font-weight:400">"EDX&nbsp;0x830xc20x??0x520xc3"</span>,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#3ad900;font-weight:400">"EDX&nbsp;0x810xc20x??0xFF0xFF0xFF0x520xc2"</span>,&nbsp;&nbsp;<span style="color:#0088ff;font-weight:400">#add&nbsp;edx&nbsp;-&nbsp;x&nbsp;+&nbsp;push&nbsp;+&nbsp;ret&nbsp;n</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#3ad900;font-weight:400">"EDX&nbsp;0x830xc20x??0x520xc2"</span>,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#3ad900;font-weight:400">"EBX&nbsp;0x810xc30x??0xFF0xFF0xFF0x530xc3"</span>,&nbsp;&nbsp;<span style="color:#0088ff;font-weight:400">#add&nbsp;ebx&nbsp;-&nbsp;x&nbsp;+&nbsp;push&nbsp;+&nbsp;ret</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#3ad900;font-weight:400">"EBX&nbsp;0x830xc30x??0x530xc3"</span>,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#3ad900;font-weight:400">"EBX&nbsp;0x810xc30x??0xFF0xFF0xFF0x530xc2"</span>,&nbsp;&nbsp;<span style="color:#0088ff;font-weight:400">#add&nbsp;ebx&nbsp;-&nbsp;x&nbsp;+&nbsp;push&nbsp;+&nbsp;ret&nbsp;n</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#3ad900;font-weight:400">"EBX&nbsp;0x830xc30x??0x530xc2"</span>,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#3ad900;font-weight:400">"ESP&nbsp;0x810xc40x??0xFF0xFF0xFF0x540xc3"</span>,&nbsp;&nbsp;<span style="color:#0088ff;font-weight:400">#add&nbsp;esp&nbsp;-&nbsp;x&nbsp;+&nbsp;push&nbsp;+&nbsp;ret</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#3ad900;font-weight:400">"ESP&nbsp;0x830xc40x??0x540xc3"</span>,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#3ad900;font-weight:400">"ESP&nbsp;0x810xc40x??0xFF0xFF0xFF0x540xc2"</span>,&nbsp;&nbsp;<span style="color:#0088ff;font-weight:400">#add&nbsp;esp&nbsp;-&nbsp;x&nbsp;+&nbsp;push&nbsp;+&nbsp;ret&nbsp;n</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#3ad900;font-weight:400">"ESP&nbsp;0x830xc40x??0x540xc2"</span>,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#3ad900;font-weight:400">"EBP&nbsp;0x810xc50x??0xFF0xFF0xFF0x550xc3"</span>,&nbsp;&nbsp;<span style="color:#0088ff;font-weight:400">#add&nbsp;ebp&nbsp;-&nbsp;x&nbsp;+&nbsp;push&nbsp;+&nbsp;ret</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#3ad900;font-weight:400">"EBP&nbsp;0x830xc50x??0x550xc3"</span>,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#3ad900;font-weight:400">"EBP&nbsp;0x810xc50x??0xFF0xFF0xFF0x550xc2"</span>,&nbsp;&nbsp;<span style="color:#0088ff;font-weight:400">#add&nbsp;ebp&nbsp;-&nbsp;x&nbsp;+&nbsp;push&nbsp;+&nbsp;ret&nbsp;n</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#3ad900;font-weight:400">"EBP&nbsp;0x830xc50x??0x550xc2"</span>,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#3ad900;font-weight:400">"ESI&nbsp;0x810xc60x??0xFF0xFF0xFF0x560xc3"</span>,&nbsp;&nbsp;<span style="color:#0088ff;font-weight:400">#add&nbsp;esi&nbsp;-&nbsp;x&nbsp;+&nbsp;push&nbsp;+&nbsp;ret</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#3ad900;font-weight:400">"ESI&nbsp;0x830xc60x??0x560xc3"</span>,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#3ad900;font-weight:400">"ESI&nbsp;0x810xc60x??0xFF0xFF0xFF0x560xc2"</span>,&nbsp;&nbsp;<span style="color:#0088ff;font-weight:400">#add&nbsp;esi&nbsp;-&nbsp;x&nbsp;+&nbsp;push&nbsp;+&nbsp;ret&nbsp;n</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#3ad900;font-weight:400">"ESI&nbsp;0x830xc60x??0x560xc2"</span>,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#3ad900;font-weight:400">"EDI&nbsp;0x810xc70x??0xFF0xFF0xFF0x570xc3"</span>,&nbsp;&nbsp;<span style="color:#0088ff;font-weight:400">#add&nbsp;edi&nbsp;-&nbsp;x&nbsp;+&nbsp;push&nbsp;+&nbsp;ret</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#3ad900;font-weight:400">"EDI&nbsp;0x830xc70x??0x570xc3"</span>,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#3ad900;font-weight:400">"EDI&nbsp;0x810xc70x??0xFF0xFF0xFF0x570xc2"</span>,&nbsp;&nbsp;<span style="color:#0088ff;font-weight:400">#add&nbsp;edi&nbsp;-&nbsp;x&nbsp;+&nbsp;push&nbsp;+&nbsp;ret&nbsp;n</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#3ad900;font-weight:400">"EDI&nbsp;0x830xc70x??0x570xc2"</span>,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;]<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;offsettable=imm.createTable(<span style="color:#3ad900;font-weight:400">'pvefindaddr&nbsp;Jump&nbsp;to&nbsp;'</span>+targetreg+<span style="color:#3ad900;font-weight:400">'+offset&nbsp;results'</span>,[<span style="color:#3ad900;font-weight:400">'Address'</span>,<span style="color:#3ad900;font-weight:400">'Offset'</span>,<span style="color:#3ad900;font-weight:400">'Instruction'</span>,<span style="color:#3ad900;font-weight:400">'Module'</span>,<span style="color:#3ad900;font-weight:400">'Access'</span>])<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;startoffset=minoffset<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;startoffset&nbsp;&gt;&nbsp;maxoffset:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tmpoffset=startoffset<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;startoffset=maxoffset<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;maxoffset=tmpoffset<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;startoffset&nbsp;&lt;&nbsp;-<span style="color:#ff0044;font-weight:400">254</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;startoffset=-<span style="color:#ff0044;font-weight:400">254</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;maxoffset&nbsp;&gt;&nbsp;<span style="color:#ff0044;font-weight:400">254</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;maxoffset=<span style="color:#ff0044;font-weight:400">254</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"Target&nbsp;register&nbsp;:&nbsp;%s&nbsp;"</span>&nbsp;%&nbsp;targetreg)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"Offset&nbsp;range&nbsp;:&nbsp;from&nbsp;%d&nbsp;to&nbsp;%d"</span>&nbsp;%&nbsp;(startoffset,maxoffset))<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;modulefilter&nbsp;&lt;&gt;&nbsp;<span style="color:#3ad900;font-weight:400">""</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"Only&nbsp;show&nbsp;addresses&nbsp;from&nbsp;module&nbsp;%s&nbsp;"</span>&nbsp;%&nbsp;modulefilter)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"-----------------------------------------------------"</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;startoff=startoffset<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ofstring=<span style="color:#3ad900;font-weight:400">""</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">while</span>&nbsp;startoff&nbsp;&lt;=&nbsp;maxoffset:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;startoff&nbsp;&lt;&nbsp;<span style="color:#ff0044;font-weight:400">0</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ofstring=tohexbyte(<span style="color:#ff0044;font-weight:400">255</span>+startoff+<span style="color:#ff0044;font-weight:400">1</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;startoff&nbsp;&gt;&nbsp;<span style="color:#ff0044;font-weight:400">0</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ofstring=tohexbyte(startoff)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;startoff&nbsp;!=&nbsp;<span style="color:#ff0044;font-weight:400">0</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"Finding&nbsp;pointers&nbsp;to&nbsp;jump&nbsp;to&nbsp;%s&nbsp;offset&nbsp;%s"</span>&nbsp;%&nbsp;(targetreg,startoff))<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.updateLog()<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">for</span>&nbsp;thiscall&nbsp;<span style="color:#ff9d00;font-weight:700">in</span>&nbsp;allop:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.updateLog()<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;thiscall.find(targetreg)&nbsp;&gt;&nbsp;-<span style="color:#ff0044;font-weight:400">1</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;thiscall=thiscall.replace(targetreg+<span style="color:#3ad900;font-weight:400">"&nbsp;"</span>,<span style="color:#3ad900;font-weight:400">""</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;newsearch=thiscall.replace(<span style="color:#3ad900;font-weight:400">"??"</span>,ofstring).replace(<span style="color:#3ad900;font-weight:400">"0x"</span>,<span style="color:#3ad900;font-weight:400">"\\x"</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#0088ff;font-weight:400">#perform&nbsp;search</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;addys=imm.search(&nbsp;newsearch.decode(<span style="color:#3ad900;font-weight:400">'string_escape'</span>))<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"%d&nbsp;pointers&nbsp;found"</span>&nbsp;%&nbsp;<span style="color:#ff9d00;font-weight:700">len</span>(addys))<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">for</span>&nbsp;ad1&nbsp;<span style="color:#ff9d00;font-weight:700">in</span>&nbsp;addys:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;module&nbsp;=&nbsp;getmodnamefromptr(ad1)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;<span style="color:#ff9d00;font-weight:700">not</span>&nbsp;module:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;module&nbsp;=&nbsp;<span style="color:#3ad900;font-weight:400">"none"</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">else</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;module==<span style="color:#3ad900;font-weight:400">""</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;module&nbsp;=&nbsp;<span style="color:#3ad900;font-weight:400">"none"</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">else</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;module&nbsp;=&nbsp;module.lower()<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;getmoduleprop(module,<span style="color:#3ad900;font-weight:400">"fixup"</span>)==<span style="color:#3ad900;font-weight:400">"0"</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;(modulefilter==<span style="color:#3ad900;font-weight:400">""</span>)&nbsp;<span style="color:#ff9d00;font-weight:700">or</span>&nbsp;(modulefilter&nbsp;&lt;&gt;&nbsp;<span style="color:#3ad900;font-weight:400">""</span>&nbsp;<span style="color:#ff9d00;font-weight:700">and</span>&nbsp;module.upper().find(modulefilter.upper())&nbsp;&gt;&nbsp;-<span style="color:#ff0044;font-weight:400">1</span>):<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;(noos==<span style="color:#ff0044;font-weight:400">0</span>)&nbsp;<span style="color:#ff9d00;font-weight:700">or</span>&nbsp;(noos==<span style="color:#ff0044;font-weight:400">1</span>&nbsp;<span style="color:#ff9d00;font-weight:700">and</span>&nbsp;isosmodule(module)==<span style="color:#ff0044;font-weight:400">0</span>):<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;aspec=addressspec(tohex(ad1)).upper()<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;(nonull==<span style="color:#ff0044;font-weight:400">0</span>)&nbsp;<span style="color:#ff9d00;font-weight:700">or</span>&nbsp;(nonull==<span style="color:#ff0044;font-weight:400">1</span>&nbsp;<span style="color:#ff9d00;font-weight:700">and</span>&nbsp;aspec.find(<span style="color:#3ad900;font-weight:400">"NULL"</span>)&nbsp;==&nbsp;-<span style="color:#ff0044;font-weight:400">1</span>):<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;page&nbsp;&nbsp;&nbsp;=&nbsp;imm.getMemoryPagebyAddress(&nbsp;ad1&nbsp;)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;access&nbsp;=&nbsp;page.getAccess(&nbsp;human&nbsp;=&nbsp;<span style="color:#ff0044;font-weight:400">True</span>&nbsp;)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;hexaddr=tohex(ad1)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;op&nbsp;=&nbsp;imm.Disasm(&nbsp;ad1&nbsp;)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;opstring=op.getDisasm()<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;offsettable.add(<span style="color:#ff0044;font-weight:400">0</span>,[<span style="color:#3ad900;font-weight:400">"%s"</span>%(tohex(ad1)),<span style="color:#3ad900;font-weight:400">"%d"</span>%(startoff),<span style="color:#3ad900;font-weight:400">"%s"</span>%(opstring),<span style="color:#3ad900;font-weight:400">"%s"</span>%(module),<span style="color:#3ad900;font-weight:400">"%s"</span>%(access)])<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.updateLog()<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tofile(<span style="color:#3ad900;font-weight:400">"Found&nbsp;"</span>+opstring+<span style="color:#3ad900;font-weight:400">"&nbsp;at&nbsp;0x"</span>&nbsp;+&nbsp;tohex(ad1)+<span style="color:#3ad900;font-weight:400">"&nbsp;["</span>+module+<span style="color:#3ad900;font-weight:400">"]"</span>,filename,ad1)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;nrfound=nrfound+<span style="color:#ff0044;font-weight:400">1</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;startoff&nbsp;&gt;&nbsp;<span style="color:#ff0044;font-weight:400">0</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">for</span>&nbsp;addcall&nbsp;<span style="color:#ff9d00;font-weight:700">in</span>&nbsp;posop:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;addcall.find(targetreg)&nbsp;&gt;&nbsp;-<span style="color:#ff0044;font-weight:400">1</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;addcall=addcall.replace(targetreg+<span style="color:#3ad900;font-weight:400">"&nbsp;"</span>,<span style="color:#3ad900;font-weight:400">""</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;newsearch=addcall.replace(<span style="color:#3ad900;font-weight:400">"??"</span>,ofstring).replace(<span style="color:#3ad900;font-weight:400">"0x"</span>,<span style="color:#3ad900;font-weight:400">"\\x"</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;addys=imm.search(&nbsp;newsearch.decode(<span style="color:#3ad900;font-weight:400">'string_escape'</span>))<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">for</span>&nbsp;ad1&nbsp;<span style="color:#ff9d00;font-weight:700">in</span>&nbsp;addys:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;module&nbsp;=&nbsp;getmodnamefromptr(ad1)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;<span style="color:#ff9d00;font-weight:700">not</span>&nbsp;module:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;module&nbsp;=&nbsp;<span style="color:#3ad900;font-weight:400">"none"</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">else</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;module==<span style="color:#3ad900;font-weight:400">""</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;module&nbsp;=&nbsp;<span style="color:#3ad900;font-weight:400">"none"</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">else</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;module&nbsp;=&nbsp;module.lower()<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;getmoduleprop(module,<span style="color:#3ad900;font-weight:400">"fixup"</span>)==<span style="color:#3ad900;font-weight:400">"0"</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;(modulefilter==<span style="color:#3ad900;font-weight:400">""</span>)&nbsp;<span style="color:#ff9d00;font-weight:700">or</span>&nbsp;(modulefilter&nbsp;!=&nbsp;<span style="color:#3ad900;font-weight:400">""</span>&nbsp;<span style="color:#ff9d00;font-weight:700">and</span>&nbsp;module.upper().find(modulefilter.upper())&nbsp;&gt;&nbsp;-<span style="color:#ff0044;font-weight:400">1</span>):<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;(noos==<span style="color:#ff0044;font-weight:400">0</span>)&nbsp;<span style="color:#ff9d00;font-weight:700">or</span>&nbsp;(noos==<span style="color:#ff0044;font-weight:400">1</span>&nbsp;<span style="color:#ff9d00;font-weight:700">and</span>&nbsp;isosmodule(module)==<span style="color:#ff0044;font-weight:400">0</span>):<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;aspec=addressspec(tohex(ad1)).upper()<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;(nonull==<span style="color:#ff0044;font-weight:400">0</span>)&nbsp;<span style="color:#ff9d00;font-weight:700">or</span>&nbsp;(nonull==<span style="color:#ff0044;font-weight:400">1</span>&nbsp;<span style="color:#ff9d00;font-weight:700">and</span>&nbsp;aspec.find(<span style="color:#3ad900;font-weight:400">"NULL"</span>)&nbsp;==&nbsp;-<span style="color:#ff0044;font-weight:400">1</span>):<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;page&nbsp;&nbsp;&nbsp;=&nbsp;imm.getMemoryPagebyAddress(&nbsp;ad1&nbsp;)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;access&nbsp;=&nbsp;page.getAccess(&nbsp;human&nbsp;=&nbsp;<span style="color:#ff0044;font-weight:400">True</span>&nbsp;)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;hexaddr=tohex(ad1)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;op&nbsp;=&nbsp;imm.Disasm(&nbsp;ad1&nbsp;)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;opstring=op.getDisasm()<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;offsettable.add(<span style="color:#ff0044;font-weight:400">0</span>,[<span style="color:#3ad900;font-weight:400">"%s"</span>%(tohex(ad1)),<span style="color:#3ad900;font-weight:400">"%d"</span>%(startoff),<span style="color:#3ad900;font-weight:400">"%s"</span>%(opstring),<span style="color:#3ad900;font-weight:400">"%s"</span>%(module),<span style="color:#3ad900;font-weight:400">"%s"</span>%(access)])<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.updateLog()<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tofile(<span style="color:#3ad900;font-weight:400">"Found&nbsp;"</span>+opstring+<span style="color:#3ad900;font-weight:400">"&nbsp;at&nbsp;0x"</span>&nbsp;+&nbsp;tohex(ad1)+<span style="color:#3ad900;font-weight:400">"&nbsp;["</span>+module+<span style="color:#3ad900;font-weight:400">"]"</span>,filename,ad1)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;nrfound=nrfound+<span style="color:#ff0044;font-weight:400">1</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">for</span>&nbsp;addcall&nbsp;<span style="color:#ff9d00;font-weight:700">in</span>&nbsp;posvalop:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;addcall.find(targetreg)&nbsp;&gt;&nbsp;-<span style="color:#ff0044;font-weight:400">1</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;addcall=addcall.replace(targetreg+<span style="color:#3ad900;font-weight:400">"&nbsp;"</span>,<span style="color:#3ad900;font-weight:400">""</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;newsearch=addcall.replace(<span style="color:#3ad900;font-weight:400">"??"</span>,tohexbyte(<span style="color:#ff0044;font-weight:400">255</span>+startoff+<span style="color:#ff0044;font-weight:400">1</span>)).replace(<span style="color:#3ad900;font-weight:400">"0x"</span>,<span style="color:#3ad900;font-weight:400">"\\x"</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;addys=imm.search(&nbsp;newsearch.decode(<span style="color:#3ad900;font-weight:400">'string_escape'</span>))<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">for</span>&nbsp;ad1&nbsp;<span style="color:#ff9d00;font-weight:700">in</span>&nbsp;addys:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;module&nbsp;=&nbsp;getmodnamefromptr(ad1)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;<span style="color:#ff9d00;font-weight:700">not</span>&nbsp;module:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;module&nbsp;=&nbsp;<span style="color:#3ad900;font-weight:400">"none"</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">else</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;module==<span style="color:#3ad900;font-weight:400">""</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;module&nbsp;=&nbsp;<span style="color:#3ad900;font-weight:400">"none"</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">else</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;module&nbsp;=&nbsp;module.lower()<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;getmoduleprop(module,<span style="color:#3ad900;font-weight:400">"fixup"</span>)==<span style="color:#3ad900;font-weight:400">"0"</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;(modulefilter==<span style="color:#3ad900;font-weight:400">""</span>)&nbsp;<span style="color:#ff9d00;font-weight:700">or</span>&nbsp;(modulefilter&nbsp;!=&nbsp;<span style="color:#3ad900;font-weight:400">""</span>&nbsp;<span style="color:#ff9d00;font-weight:700">and</span>&nbsp;module.upper().find(modulefilter.upper())&nbsp;&gt;&nbsp;-<span style="color:#ff0044;font-weight:400">1</span>):<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;(noos==<span style="color:#ff0044;font-weight:400">0</span>)&nbsp;<span style="color:#ff9d00;font-weight:700">or</span>&nbsp;(noos==<span style="color:#ff0044;font-weight:400">1</span>&nbsp;<span style="color:#ff9d00;font-weight:700">and</span>&nbsp;isosmodule(module)==<span style="color:#ff0044;font-weight:400">0</span>):<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;aspec=addressspec(tohex(ad1)).upper()<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;(nonull==<span style="color:#ff0044;font-weight:400">0</span>)&nbsp;<span style="color:#ff9d00;font-weight:700">or</span>&nbsp;(nonull==<span style="color:#ff0044;font-weight:400">1</span>&nbsp;<span style="color:#ff9d00;font-weight:700">and</span>&nbsp;aspec.find(<span style="color:#3ad900;font-weight:400">"NULL"</span>)&nbsp;==&nbsp;-<span style="color:#ff0044;font-weight:400">1</span>):<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;page&nbsp;&nbsp;&nbsp;=&nbsp;imm.getMemoryPagebyAddress(&nbsp;ad1&nbsp;)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;access&nbsp;=&nbsp;page.getAccess(&nbsp;human&nbsp;=&nbsp;<span style="color:#ff0044;font-weight:400">True</span>&nbsp;)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;hexaddr=tohex(ad1)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;op&nbsp;=&nbsp;imm.Disasm(&nbsp;ad1&nbsp;)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;opstring=op.getDisasm()<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;offsettable.add(<span style="color:#ff0044;font-weight:400">0</span>,[<span style="color:#3ad900;font-weight:400">"%s"</span>%(tohex(ad1)),<span style="color:#3ad900;font-weight:400">"%d"</span>%(startoff),<span style="color:#3ad900;font-weight:400">"%s"</span>%(opstring),<span style="color:#3ad900;font-weight:400">"%s"</span>%(module),<span style="color:#3ad900;font-weight:400">"%s"</span>%(access)])<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.updateLog()<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tofile(<span style="color:#3ad900;font-weight:400">"Found&nbsp;"</span>+opstring+<span style="color:#3ad900;font-weight:400">"&nbsp;at&nbsp;0x"</span>&nbsp;+&nbsp;tohex(ad1)+<span style="color:#3ad900;font-weight:400">"&nbsp;["</span>+module+<span style="color:#3ad900;font-weight:400">"]"</span>,filename,ad1)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;nrfound=nrfound+<span style="color:#ff0044;font-weight:400">1</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;startoff&nbsp;&lt;&nbsp;<span style="color:#ff0044;font-weight:400">0</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">for</span>&nbsp;subcall&nbsp;<span style="color:#ff9d00;font-weight:700">in</span>&nbsp;negop:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;subcall.find(targetreg)&nbsp;&gt;&nbsp;-<span style="color:#ff0044;font-weight:400">1</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;subcall=subcall.replace(targetreg+<span style="color:#3ad900;font-weight:400">"&nbsp;"</span>,<span style="color:#3ad900;font-weight:400">""</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;newsearch=subcall.replace(<span style="color:#3ad900;font-weight:400">"??"</span>,tohexbyte(startoff*(-<span style="color:#ff0044;font-weight:400">1</span>))).replace(<span style="color:#3ad900;font-weight:400">"0x"</span>,<span style="color:#3ad900;font-weight:400">"\\x"</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;addys=imm.search(&nbsp;newsearch.decode(<span style="color:#3ad900;font-weight:400">'string_escape'</span>))<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">for</span>&nbsp;ad1&nbsp;<span style="color:#ff9d00;font-weight:700">in</span>&nbsp;addys:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;module&nbsp;=&nbsp;getmodnamefromptr(ad1)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;<span style="color:#ff9d00;font-weight:700">not</span>&nbsp;module:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;module&nbsp;=&nbsp;<span style="color:#3ad900;font-weight:400">"none"</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">else</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;module==<span style="color:#3ad900;font-weight:400">""</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;module&nbsp;=&nbsp;<span style="color:#3ad900;font-weight:400">"none"</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">else</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;module&nbsp;=&nbsp;module.lower()<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;getmoduleprop(module,<span style="color:#3ad900;font-weight:400">"fixup"</span>)==<span style="color:#3ad900;font-weight:400">"0"</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;(modulefilter==<span style="color:#3ad900;font-weight:400">""</span>)&nbsp;<span style="color:#ff9d00;font-weight:700">or</span>&nbsp;(modulefilter&nbsp;!=&nbsp;<span style="color:#3ad900;font-weight:400">""</span>&nbsp;<span style="color:#ff9d00;font-weight:700">and</span>&nbsp;module.upper().find(modulefilter.upper())&nbsp;&gt;&nbsp;-<span style="color:#ff0044;font-weight:400">1</span>):<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;(noos==<span style="color:#ff0044;font-weight:400">0</span>)&nbsp;<span style="color:#ff9d00;font-weight:700">or</span>&nbsp;(noos==<span style="color:#ff0044;font-weight:400">1</span>&nbsp;<span style="color:#ff9d00;font-weight:700">and</span>&nbsp;isosmodule(module)==<span style="color:#ff0044;font-weight:400">0</span>):<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;aspec=addressspec(tohex(ad1)).upper()<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;(nonull==<span style="color:#ff0044;font-weight:400">0</span>)&nbsp;<span style="color:#ff9d00;font-weight:700">or</span>&nbsp;(nonull==<span style="color:#ff0044;font-weight:400">1</span>&nbsp;<span style="color:#ff9d00;font-weight:700">and</span>&nbsp;aspec.find(<span style="color:#3ad900;font-weight:400">"NULL"</span>)&nbsp;==&nbsp;-<span style="color:#ff0044;font-weight:400">1</span>):<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;page&nbsp;&nbsp;&nbsp;=&nbsp;imm.getMemoryPagebyAddress(&nbsp;ad1&nbsp;)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;access&nbsp;=&nbsp;page.getAccess(&nbsp;human&nbsp;=&nbsp;<span style="color:#ff0044;font-weight:400">True</span>&nbsp;)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;hexaddr=tohex(ad1)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;op&nbsp;=&nbsp;imm.Disasm(&nbsp;ad1&nbsp;)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;opstring=op.getDisasm()<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;offsettable.add(<span style="color:#ff0044;font-weight:400">0</span>,[<span style="color:#3ad900;font-weight:400">"%s"</span>%(tohex(ad1)),<span style="color:#3ad900;font-weight:400">"%d"</span>%(startoff),<span style="color:#3ad900;font-weight:400">"%s"</span>%(opstring),<span style="color:#3ad900;font-weight:400">"%s"</span>%(module),<span style="color:#3ad900;font-weight:400">"%s"</span>%(access)])<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.updateLog()<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tofile(<span style="color:#3ad900;font-weight:400">"Found&nbsp;"</span>+opstring+<span style="color:#3ad900;font-weight:400">"&nbsp;at&nbsp;0x"</span>&nbsp;+&nbsp;tohex(ad1)+<span style="color:#3ad900;font-weight:400">"&nbsp;["</span>+module+<span style="color:#3ad900;font-weight:400">"]"</span>,filename,ad1)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;nrfound=nrfound+<span style="color:#ff0044;font-weight:400">1</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">for</span>&nbsp;subcall&nbsp;<span style="color:#ff9d00;font-weight:700">in</span>&nbsp;negvalop:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;subcall.find(targetreg)&nbsp;&gt;&nbsp;-<span style="color:#ff0044;font-weight:400">1</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;subcall=subcall.replace(targetreg+<span style="color:#3ad900;font-weight:400">"&nbsp;"</span>,<span style="color:#3ad900;font-weight:400">""</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;newsearch=subcall.replace(<span style="color:#3ad900;font-weight:400">"??"</span>,tohexbyte(<span style="color:#ff0044;font-weight:400">255</span>+startoff+<span style="color:#ff0044;font-weight:400">1</span>).replace(<span style="color:#3ad900;font-weight:400">"0x"</span>,<span style="color:#3ad900;font-weight:400">"\\x"</span>))<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;addys=imm.search(&nbsp;newsearch.decode(<span style="color:#3ad900;font-weight:400">'string_escape'</span>))<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">for</span>&nbsp;ad1&nbsp;<span style="color:#ff9d00;font-weight:700">in</span>&nbsp;addys:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;module&nbsp;=&nbsp;getmodnamefromptr(ad1)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;<span style="color:#ff9d00;font-weight:700">not</span>&nbsp;module:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;module&nbsp;=&nbsp;<span style="color:#3ad900;font-weight:400">"none"</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">else</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;module==<span style="color:#3ad900;font-weight:400">""</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;module&nbsp;=&nbsp;<span style="color:#3ad900;font-weight:400">"none"</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">else</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;module&nbsp;=&nbsp;module.lower()<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;getmoduleprop(module,<span style="color:#3ad900;font-weight:400">"fixup"</span>)==<span style="color:#3ad900;font-weight:400">"0"</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;(modulefilter==<span style="color:#3ad900;font-weight:400">""</span>)&nbsp;<span style="color:#ff9d00;font-weight:700">or</span>&nbsp;(modulefilter&nbsp;!=&nbsp;<span style="color:#3ad900;font-weight:400">""</span>&nbsp;<span style="color:#ff9d00;font-weight:700">and</span>&nbsp;module.upper().find(modulefilter.upper())&nbsp;&gt;&nbsp;-<span style="color:#ff0044;font-weight:400">1</span>):<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;(noos==<span style="color:#ff0044;font-weight:400">0</span>)&nbsp;<span style="color:#ff9d00;font-weight:700">or</span>&nbsp;(noos==<span style="color:#ff0044;font-weight:400">1</span>&nbsp;<span style="color:#ff9d00;font-weight:700">and</span>&nbsp;isosmodule(module)==<span style="color:#ff0044;font-weight:400">0</span>):<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;aspec=addressspec(tohex(ad1)).upper()<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;(nonull==<span style="color:#ff0044;font-weight:400">0</span>)&nbsp;<span style="color:#ff9d00;font-weight:700">or</span>&nbsp;(nonull==<span style="color:#ff0044;font-weight:400">1</span>&nbsp;<span style="color:#ff9d00;font-weight:700">and</span>&nbsp;aspec.find(<span style="color:#3ad900;font-weight:400">"NULL"</span>)&nbsp;==&nbsp;-<span style="color:#ff0044;font-weight:400">1</span>):<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;page&nbsp;&nbsp;&nbsp;=&nbsp;imm.getMemoryPagebyAddress(&nbsp;ad1&nbsp;)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;access&nbsp;=&nbsp;page.getAccess(&nbsp;human&nbsp;=&nbsp;<span style="color:#ff0044;font-weight:400">True</span>&nbsp;)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;hexaddr=tohex(ad1)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;op&nbsp;=&nbsp;imm.Disasm(&nbsp;ad1&nbsp;)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;opstring=op.getDisasm()<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;offsettable.add(<span style="color:#ff0044;font-weight:400">0</span>,[<span style="color:#3ad900;font-weight:400">"%s"</span>%(tohex(ad1)),<span style="color:#3ad900;font-weight:400">"%d"</span>%(startoff),<span style="color:#3ad900;font-weight:400">"%s"</span>%(opstring),<span style="color:#3ad900;font-weight:400">"%s"</span>%(module),<span style="color:#3ad900;font-weight:400">"%s"</span>%(access)])<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.updateLog()<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tofile(<span style="color:#3ad900;font-weight:400">"Found&nbsp;"</span>+opstring+<span style="color:#3ad900;font-weight:400">"&nbsp;at&nbsp;0x"</span>&nbsp;+&nbsp;tohex(ad1)+<span style="color:#3ad900;font-weight:400">"&nbsp;["</span>+module+<span style="color:#3ad900;font-weight:400">"]"</span>,filename,ad1)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;nrfound=nrfound+<span style="color:#ff0044;font-weight:400">1</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;startoff=startoff+<span style="color:#ff0044;font-weight:400">1</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"Output&nbsp;written&nbsp;to&nbsp;"</span>+filename)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;nrfound&gt;<span style="color:#ff0044;font-weight:400">0</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"Found&nbsp;%d&nbsp;address(es)"</span>&nbsp;%&nbsp;nrfound)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">return</span>&nbsp;<span style="color:#3ad900;font-weight:400">"Found&nbsp;%d&nbsp;address(es)&nbsp;(Check&nbsp;the&nbsp;Log&nbsp;Window/Table&nbsp;for&nbsp;details)"</span>&nbsp;%&nbsp;nrfound<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">else</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"No&nbsp;addresses&nbsp;found"</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">return</span>&nbsp;<span style="color:#3ad900;font-weight:400">"Sorry,&nbsp;no&nbsp;addresses&nbsp;found"</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"--------------------------------------------------------------"</span>)<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">else</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;usage(imm)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">return</span>&nbsp;<span style="color:#3ad900;font-weight:400">"Error:&nbsp;Please&nbsp;provide&nbsp;register,&nbsp;offset&nbsp;(start&nbsp;and&nbsp;end&nbsp;int)&nbsp;and&nbsp;optional&nbsp;module&nbsp;name"</span><br /><br /><br /><br />&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;args[<span style="color:#ff0044;font-weight:400">0</span>]&nbsp;==&nbsp;<span style="color:#3ad900;font-weight:400">"depxp"</span>&nbsp;<span style="color:#ff9d00;font-weight:700">or</span>&nbsp;args[<span style="color:#ff0044;font-weight:400">0</span>]==<span style="color:#3ad900;font-weight:400">"depxpsp3"</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"--------------------------------------------------------------------------------"</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"Search&nbsp;for&nbsp;addresses&nbsp;used&nbsp;to&nbsp;disable&nbsp;DEP&nbsp;(-&gt;&nbsp;XP&nbsp;SP3)&nbsp;via&nbsp;NtSetInformationProcess"</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"--------------------------------------------------------------------------------"</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;opcodej=[<span style="color:#3ad900;font-weight:400">"\xb0\x01\xc3"</span>,&nbsp;<span style="color:#0088ff;font-weight:400">#mov&nbsp;al,0x1&nbsp;/&nbsp;ret</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#3ad900;font-weight:400">"\xb0\x01\xc2\x04"</span>,&nbsp;<span style="color:#0088ff;font-weight:400">#mov&nbsp;al,0x1&nbsp;/&nbsp;ret&nbsp;04</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#3ad900;font-weight:400">"\xb0\x01\xc2\x08"</span>,&nbsp;<span style="color:#0088ff;font-weight:400">#mov&nbsp;al,0x1&nbsp;/&nbsp;ret&nbsp;08</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#3ad900;font-weight:400">"\x31\xc0\x40\xc3"</span>,&nbsp;<span style="color:#0088ff;font-weight:400">#xor&nbsp;eax,eax/inc&nbsp;eax/ret</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#3ad900;font-weight:400">"\x31\xc0\x40\xc2\x04"</span>,&nbsp;<span style="color:#0088ff;font-weight:400">#xor&nbsp;eax,eax/inc&nbsp;eax/ret&nbsp;04</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#3ad900;font-weight:400">"\x31\xc0\x40\xc2\x08"</span>,&nbsp;<span style="color:#0088ff;font-weight:400">#xor&nbsp;eax,eax/inc&nbsp;eax/ret&nbsp;08</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#3ad900;font-weight:400">"\x31\xc0\x40\xc2\x1c"</span>]&nbsp;<span style="color:#0088ff;font-weight:400">#xor&nbsp;eax,eax/inc&nbsp;eax/ret&nbsp;1c</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"Phase&nbsp;1&nbsp;:&nbsp;set&nbsp;eax&nbsp;to&nbsp;1&nbsp;and&nbsp;return"</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"--------------------------------"</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;filename=<span style="color:#3ad900;font-weight:400">"depxp.txt"</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;resetfile(filename)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;writemodinfo(filename)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">for</span>&nbsp;opjc&nbsp;<span style="color:#ff9d00;font-weight:700">in</span>&nbsp;opcodej:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;addys=imm.search(&nbsp;opjc&nbsp;)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;results&nbsp;+=&nbsp;addys<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">for</span>&nbsp;ad1&nbsp;<span style="color:#ff9d00;font-weight:700">in</span>&nbsp;addys:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;module&nbsp;=&nbsp;getmodnamefromptr(ad1)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;<span style="color:#ff9d00;font-weight:700">not</span>&nbsp;module:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;module&nbsp;=&nbsp;<span style="color:#3ad900;font-weight:400">"none"</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">else</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;module==<span style="color:#3ad900;font-weight:400">""</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;module&nbsp;=&nbsp;<span style="color:#3ad900;font-weight:400">"none"</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">else</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;module&nbsp;=&nbsp;module.lower()<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;page&nbsp;&nbsp;&nbsp;=&nbsp;imm.getMemoryPagebyAddress(&nbsp;ad1&nbsp;)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;access&nbsp;=&nbsp;page.getAccess(&nbsp;human&nbsp;=&nbsp;<span style="color:#ff0044;font-weight:400">True</span>&nbsp;)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;op&nbsp;=&nbsp;imm.Disasm(&nbsp;ad1&nbsp;)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;opstring=op.getDisasm()<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"Found&nbsp;%s&nbsp;at&nbsp;0x%08x&nbsp;(%s)&nbsp;-&nbsp;Access:&nbsp;(%s)"</span>&nbsp;%&nbsp;(opstring,&nbsp;ad1,&nbsp;module,access),&nbsp;address&nbsp;=&nbsp;ad1)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tofile(<span style="color:#3ad900;font-weight:400">"Found&nbsp;"</span>+opstring+<span style="color:#3ad900;font-weight:400">"&nbsp;at&nbsp;0x"</span>&nbsp;+&nbsp;tohex(ad1)+<span style="color:#3ad900;font-weight:400">"&nbsp;["</span>+module+<span style="color:#3ad900;font-weight:400">"]"</span>,filename,ad1)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;nrfound+=<span style="color:#ff0044;font-weight:400">1</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;results:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"Found&nbsp;%d&nbsp;address(es)"</span>&nbsp;%&nbsp;nrfound)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">else</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"No&nbsp;addresses&nbsp;found"</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;nrfound=<span style="color:#ff0044;font-weight:400">0</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mod&nbsp;=&nbsp;imm.getModule(<span style="color:#3ad900;font-weight:400">"ntdll.dll"</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"Phase&nbsp;2&nbsp;:&nbsp;compare&nbsp;AL&nbsp;with&nbsp;1,&nbsp;push&nbsp;0x2&nbsp;and&nbsp;pop&nbsp;esi"</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"-------------------------------------------------"</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;searchfor=<span style="color:#3ad900;font-weight:400">"\x3c\x01\x6a\x02\x5e"</span>;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ret&nbsp;=&nbsp;imm.search(&nbsp;searchfor&nbsp;)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">for</span>&nbsp;res&nbsp;<span style="color:#ff9d00;font-weight:700">in</span>&nbsp;ret:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;module&nbsp;=&nbsp;getmodnamefromptr(res)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;<span style="color:#ff9d00;font-weight:700">not</span>&nbsp;module:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;module&nbsp;=&nbsp;<span style="color:#3ad900;font-weight:400">"none"</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">else</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;module==<span style="color:#3ad900;font-weight:400">""</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;module&nbsp;=&nbsp;<span style="color:#3ad900;font-weight:400">"none"</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">else</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;module&nbsp;=&nbsp;module.lower()<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;page&nbsp;&nbsp;&nbsp;=&nbsp;imm.getMemoryPagebyAddress(&nbsp;res&nbsp;)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;access&nbsp;=&nbsp;page.getAccess(&nbsp;human&nbsp;=&nbsp;<span style="color:#ff0044;font-weight:400">True</span>&nbsp;)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;op&nbsp;=&nbsp;imm.Disasm(&nbsp;res&nbsp;)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;opstring=op.getDisasm()<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"Found&nbsp;%s&nbsp;at&nbsp;0x%08x&nbsp;(%s)&nbsp;-&nbsp;Access:&nbsp;(%s)"</span>&nbsp;%&nbsp;(opstring,&nbsp;res,&nbsp;module,access),&nbsp;address&nbsp;=&nbsp;res)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tofile(<span style="color:#3ad900;font-weight:400">"Found&nbsp;"</span>+opstring+<span style="color:#3ad900;font-weight:400">"&nbsp;at&nbsp;0x"</span>&nbsp;+&nbsp;tohex(res)+<span style="color:#3ad900;font-weight:400">"&nbsp;["</span>+module+<span style="color:#3ad900;font-weight:400">"]"</span>,filename,ad1)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;nrfound+=<span style="color:#ff0044;font-weight:400">1</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;results:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"Found&nbsp;%d&nbsp;address(es)"</span>&nbsp;%&nbsp;nrfound)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">else</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"No&nbsp;addresses&nbsp;found"</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;nrfound=<span style="color:#ff0044;font-weight:400">0</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"Finding&nbsp;addresses&nbsp;for&nbsp;EBP&nbsp;stack&nbsp;adjustment"</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"------------------------------------------"</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;searchebp=[<span style="color:#3ad900;font-weight:400">"\x8b\xec\xc3"</span>,&nbsp;<span style="color:#0088ff;font-weight:400">#mov&nbsp;ebp,esp&nbsp;/&nbsp;ret</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#3ad900;font-weight:400">"\x8b\xec\xc2\x04\x00"</span>,&nbsp;&nbsp;<span style="color:#0088ff;font-weight:400">#mov&nbsp;ebp,esp&nbsp;/&nbsp;ret&nbsp;4</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#3ad900;font-weight:400">"\x54\x5d\xc3"</span>,&nbsp;<span style="color:#0088ff;font-weight:400">#push&nbsp;ebp&nbsp;/&nbsp;pop&nbsp;ebp&nbsp;/&nbsp;ret</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#3ad900;font-weight:400">"\x54\x5d\xc2\x04\x00"</span>]&nbsp;&nbsp;&nbsp;<span style="color:#0088ff;font-weight:400">#push&nbsp;ebp&nbsp;/&nbsp;pop&nbsp;ebp&nbsp;/&nbsp;ret&nbsp;4</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">for</span>&nbsp;sebp&nbsp;<span style="color:#ff9d00;font-weight:700">in</span>&nbsp;searchebp:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;thisadr=imm.search(sebp)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;results&nbsp;+=&nbsp;thisadr<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">for</span>&nbsp;ad1&nbsp;<span style="color:#ff9d00;font-weight:700">in</span>&nbsp;thisadr:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;module&nbsp;=&nbsp;getmodnamefromptr(ad1)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;<span style="color:#ff9d00;font-weight:700">not</span>&nbsp;module:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;module&nbsp;=&nbsp;<span style="color:#3ad900;font-weight:400">"none"</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">else</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;module==<span style="color:#3ad900;font-weight:400">""</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;module&nbsp;=&nbsp;<span style="color:#3ad900;font-weight:400">"none"</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">else</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;module&nbsp;=&nbsp;module.lower()<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;page&nbsp;&nbsp;&nbsp;=&nbsp;imm.getMemoryPagebyAddress(&nbsp;ad1&nbsp;)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;access&nbsp;=&nbsp;page.getAccess(&nbsp;human&nbsp;=&nbsp;<span style="color:#ff0044;font-weight:400">True</span>&nbsp;)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;op&nbsp;=&nbsp;imm.Disasm(&nbsp;ad1&nbsp;)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;opstring=op.getDisasm()<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"Found&nbsp;%s&nbsp;at&nbsp;0x%08x&nbsp;(%s)&nbsp;-&nbsp;Access:&nbsp;(%s)"</span>&nbsp;%&nbsp;(opstring,&nbsp;ad1,&nbsp;module,access),&nbsp;address&nbsp;=&nbsp;ad1)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tofile(<span style="color:#3ad900;font-weight:400">"Found&nbsp;"</span>+opstring+<span style="color:#3ad900;font-weight:400">"&nbsp;at&nbsp;0x"</span>&nbsp;+&nbsp;tohex(ad1)+<span style="color:#3ad900;font-weight:400">"&nbsp;["</span>+module+<span style="color:#3ad900;font-weight:400">"]"</span>,filename,ad1)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;nrfound=nrfound+<span style="color:#ff0044;font-weight:400">1</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"Output&nbsp;written&nbsp;to&nbsp;"</span>+filename)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;results:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"Found&nbsp;%d&nbsp;address(es)"</span>&nbsp;%&nbsp;nrfound)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">else</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"No&nbsp;addresses&nbsp;found"</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">return</span>&nbsp;<span style="color:#3ad900;font-weight:400">"Done&nbsp;-&nbsp;check&nbsp;%s"</span>&nbsp;%&nbsp;filename<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;args[<span style="color:#ff0044;font-weight:400">0</span>]&nbsp;==&nbsp;<span style="color:#3ad900;font-weight:400">"depwin2k3"</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;filename=<span style="color:#3ad900;font-weight:400">"depwin2k3"</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;resetfile(filename)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;writemodinfo(filename)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"-----------------------------------------------------------------------------------------------"</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"Search&nbsp;for&nbsp;addresses&nbsp;used&nbsp;to&nbsp;disable&nbsp;DEP&nbsp;(Windows&nbsp;2003&nbsp;SP2&nbsp;and&nbsp;SP3)&nbsp;via&nbsp;NtSetInformationProcess"</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"-----------------------------------------------------------------------------------------------"</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;opcodej=[<span style="color:#3ad900;font-weight:400">"\xb0\x01\xc3"</span>,&nbsp;<span style="color:#0088ff;font-weight:400">#mov&nbsp;al,0x1&nbsp;/&nbsp;ret</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#3ad900;font-weight:400">"\xb0\x01\xc2\x04"</span>,&nbsp;<span style="color:#0088ff;font-weight:400">#mov&nbsp;al,0x1&nbsp;/&nbsp;ret&nbsp;04</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#3ad900;font-weight:400">"\xb0\x01\xc2\x08"</span>,&nbsp;<span style="color:#0088ff;font-weight:400">#mov&nbsp;al,0x1&nbsp;/&nbsp;ret&nbsp;08</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#3ad900;font-weight:400">"\x31\xc0\x40\xc3"</span>,&nbsp;<span style="color:#0088ff;font-weight:400">#xor&nbsp;eax,eax/inc&nbsp;eax/ret</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#3ad900;font-weight:400">"\x31\xc0\x40\xc2\x04"</span>,&nbsp;<span style="color:#0088ff;font-weight:400">#xor&nbsp;eax,eax/inc&nbsp;eax/ret&nbsp;04</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#3ad900;font-weight:400">"\x31\xc0\x40\xc2\x08"</span>,&nbsp;<span style="color:#0088ff;font-weight:400">#xor&nbsp;eax,eax/inc&nbsp;eax/ret&nbsp;08</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#3ad900;font-weight:400">"\x31\xc0\x40\xc2\x1c"</span>]&nbsp;<span style="color:#0088ff;font-weight:400">#xor&nbsp;eax,eax/inc&nbsp;eax/ret&nbsp;1c</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"Phase&nbsp;1&nbsp;:&nbsp;set&nbsp;eax&nbsp;to&nbsp;1&nbsp;and&nbsp;return"</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"--------------------------------"</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">for</span>&nbsp;opjc&nbsp;<span style="color:#ff9d00;font-weight:700">in</span>&nbsp;opcodej:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;addys=imm.search(&nbsp;opjc&nbsp;)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;results&nbsp;+=&nbsp;addys<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">for</span>&nbsp;ad1&nbsp;<span style="color:#ff9d00;font-weight:700">in</span>&nbsp;addys:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;module&nbsp;=&nbsp;imm.findModule(ad1)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;<span style="color:#ff9d00;font-weight:700">not</span>&nbsp;module:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;module&nbsp;=&nbsp;<span style="color:#3ad900;font-weight:400">"none"</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">else</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;module&nbsp;=&nbsp;module[<span style="color:#ff0044;font-weight:400">0</span>].lower()<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;page&nbsp;&nbsp;&nbsp;=&nbsp;imm.getMemoryPagebyAddress(&nbsp;ad1&nbsp;)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;access&nbsp;=&nbsp;page.getAccess(&nbsp;human&nbsp;=&nbsp;<span style="color:#ff0044;font-weight:400">True</span>&nbsp;)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;op&nbsp;=&nbsp;imm.Disasm(&nbsp;ad1&nbsp;)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;opstring=op.getDisasm()<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"Found&nbsp;%s&nbsp;at&nbsp;0x%08x&nbsp;(%s)&nbsp;-&nbsp;Access:&nbsp;(%s)"</span>&nbsp;%&nbsp;(opstring,&nbsp;ad1,&nbsp;module,access),&nbsp;address&nbsp;=&nbsp;ad1)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tofile(<span style="color:#3ad900;font-weight:400">"Found&nbsp;"</span>+opstring+<span style="color:#3ad900;font-weight:400">"&nbsp;at&nbsp;0x"</span>&nbsp;+&nbsp;tohex(ad1)+<span style="color:#3ad900;font-weight:400">"&nbsp;["</span>+module+<span style="color:#3ad900;font-weight:400">"]"</span>,filename,ad1)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;nrfound+=<span style="color:#ff0044;font-weight:400">1</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;results:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"Found&nbsp;%d&nbsp;address(es)"</span>&nbsp;%&nbsp;nrfound)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">else</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"No&nbsp;addresses&nbsp;found"</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;nrfound=<span style="color:#ff0044;font-weight:400">0</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mod&nbsp;=&nbsp;imm.getModule(<span style="color:#3ad900;font-weight:400">"ntdll.dll"</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"Phase&nbsp;2&nbsp;:&nbsp;Initiate&nbsp;NX&nbsp;Disable&nbsp;process"</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"-------------------------------------------------"</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;searchfor=<span style="color:#3ad900;font-weight:400">"\x83\x7d\xfc\x00"</span>;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ret&nbsp;=&nbsp;imm.search(&nbsp;searchfor&nbsp;)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">for</span>&nbsp;res&nbsp;<span style="color:#ff9d00;font-weight:700">in</span>&nbsp;ret:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;module&nbsp;=&nbsp;imm.findModule(res)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;<span style="color:#ff9d00;font-weight:700">not</span>&nbsp;module:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;module=<span style="color:#3ad900;font-weight:400">"none"</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">else</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;module=module[<span style="color:#ff0044;font-weight:400">0</span>].lower()<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;page&nbsp;&nbsp;&nbsp;=&nbsp;imm.getMemoryPagebyAddress(&nbsp;res&nbsp;)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;access&nbsp;=&nbsp;page.getAccess(&nbsp;human&nbsp;=&nbsp;<span style="color:#ff0044;font-weight:400">True</span>&nbsp;)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;op&nbsp;=&nbsp;imm.Disasm(&nbsp;res&nbsp;)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;opstring=op.getDisasm()<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"Found&nbsp;%s&nbsp;at&nbsp;0x%08x&nbsp;(%s)&nbsp;-&nbsp;Access:&nbsp;(%s)"</span>&nbsp;%&nbsp;(opstring,&nbsp;res,&nbsp;module,access),&nbsp;address&nbsp;=&nbsp;res)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tofile(<span style="color:#3ad900;font-weight:400">"Found&nbsp;"</span>+opstring+<span style="color:#3ad900;font-weight:400">"&nbsp;at&nbsp;0x"</span>&nbsp;+&nbsp;tohex(res)+<span style="color:#3ad900;font-weight:400">"&nbsp;["</span>+module+<span style="color:#3ad900;font-weight:400">"]"</span>,filename,ad1)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;nrfound+=<span style="color:#ff0044;font-weight:400">1</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;results:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"Found&nbsp;%d&nbsp;address(es)"</span>&nbsp;%&nbsp;nrfound)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">else</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"No&nbsp;addresses&nbsp;found"</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;nrfound=<span style="color:#ff0044;font-weight:400">0</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"Finding&nbsp;addresses&nbsp;for&nbsp;EBP&nbsp;stack&nbsp;adjustment"</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"------------------------------------------"</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;searchebp=[<span style="color:#3ad900;font-weight:400">"\x8b\xec\xc3"</span>,&nbsp;<span style="color:#0088ff;font-weight:400">#mov&nbsp;ebp,esp&nbsp;/&nbsp;ret</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#3ad900;font-weight:400">"\x8b\xec\xc2\x04\x00"</span>,&nbsp;&nbsp;<span style="color:#0088ff;font-weight:400">#mov&nbsp;ebp,esp&nbsp;/&nbsp;ret&nbsp;4</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#3ad900;font-weight:400">"\x54\x5d\xc3"</span>,&nbsp;<span style="color:#0088ff;font-weight:400">#push&nbsp;esp&nbsp;/&nbsp;pop&nbsp;ebp&nbsp;/&nbsp;ret</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#3ad900;font-weight:400">"\x54\x5d\xc2\x04\x00"</span>]&nbsp;&nbsp;&nbsp;<span style="color:#0088ff;font-weight:400">#push&nbsp;esp&nbsp;/&nbsp;pop&nbsp;ebp&nbsp;/&nbsp;ret&nbsp;4</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">for</span>&nbsp;sebp&nbsp;<span style="color:#ff9d00;font-weight:700">in</span>&nbsp;searchebp:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;thisadr=imm.search(sebp)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;results&nbsp;+=&nbsp;thisadr<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">for</span>&nbsp;ad1&nbsp;<span style="color:#ff9d00;font-weight:700">in</span>&nbsp;thisadr:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;module&nbsp;=&nbsp;imm.findModule(ad1)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;<span style="color:#ff9d00;font-weight:700">not</span>&nbsp;module:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;module&nbsp;=&nbsp;<span style="color:#3ad900;font-weight:400">"none"</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">else</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;module&nbsp;=&nbsp;module[<span style="color:#ff0044;font-weight:400">0</span>].lower()<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;page&nbsp;&nbsp;&nbsp;=&nbsp;imm.getMemoryPagebyAddress(&nbsp;ad1&nbsp;)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;access&nbsp;=&nbsp;page.getAccess(&nbsp;human&nbsp;=&nbsp;<span style="color:#ff0044;font-weight:400">True</span>&nbsp;)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;op&nbsp;=&nbsp;imm.Disasm(&nbsp;ad1&nbsp;)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;opstring=op.getDisasm()<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"Found&nbsp;%s&nbsp;at&nbsp;0x%08x&nbsp;(%s)&nbsp;-&nbsp;Access:&nbsp;(%s)"</span>&nbsp;%&nbsp;(opstring,&nbsp;ad1,&nbsp;module,access),&nbsp;address&nbsp;=&nbsp;ad1)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tofile(<span style="color:#3ad900;font-weight:400">"Found&nbsp;"</span>+opstring+<span style="color:#3ad900;font-weight:400">"&nbsp;at&nbsp;0x"</span>&nbsp;+&nbsp;tohex(ad1)+<span style="color:#3ad900;font-weight:400">"&nbsp;["</span>+module+<span style="color:#3ad900;font-weight:400">"]"</span>,filename,ad1)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;nrfound+=<span style="color:#ff0044;font-weight:400">1</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;results:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"Found&nbsp;%d&nbsp;address(es)"</span>&nbsp;%&nbsp;nrfound)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">else</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"No&nbsp;addresses&nbsp;found"</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;nrfound=<span style="color:#ff0044;font-weight:400">0</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"Finding&nbsp;addresses&nbsp;for&nbsp;ESI&nbsp;stack&nbsp;adjustment"</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"------------------------------------------"</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;searchebp=[<span style="color:#3ad900;font-weight:400">"\x8b\xf4\xc3"</span>,&nbsp;<span style="color:#0088ff;font-weight:400">#mov&nbsp;esi,esp&nbsp;/&nbsp;ret</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#3ad900;font-weight:400">"\x8b\xf4\xc2\x04\x00"</span>,&nbsp;&nbsp;<span style="color:#0088ff;font-weight:400">#mov&nbsp;esi,esp&nbsp;/&nbsp;ret&nbsp;4</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#3ad900;font-weight:400">"\x54\x5e\xc3"</span>,&nbsp;<span style="color:#0088ff;font-weight:400">#push&nbsp;esp&nbsp;/&nbsp;pop&nbsp;esi&nbsp;/&nbsp;ret</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#3ad900;font-weight:400">"\x54\x5e\xc2\x04\x00"</span>,&nbsp;&nbsp;&nbsp;<span style="color:#0088ff;font-weight:400">#push&nbsp;esp&nbsp;/&nbsp;pop&nbsp;esi&nbsp;/&nbsp;ret&nbsp;4</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#3ad900;font-weight:400">"\x55\x5e\xc3"</span>,&nbsp;<span style="color:#0088ff;font-weight:400">#push&nbsp;ebp&nbsp;/&nbsp;pop&nbsp;esi&nbsp;/&nbsp;ret&nbsp;#&nbsp;only&nbsp;use&nbsp;this&nbsp;one&nbsp;if&nbsp;you&nbsp;have&nbsp;pushed&nbsp;ESP&nbsp;to&nbsp;EBP&nbsp;first</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#3ad900;font-weight:400">"\x55\x5e\xc2\x04\x00"</span>]&nbsp;&nbsp;&nbsp;<span style="color:#0088ff;font-weight:400">#push&nbsp;ebp&nbsp;/&nbsp;pop&nbsp;esi&nbsp;/&nbsp;ret&nbsp;4&nbsp;#&nbsp;only&nbsp;use&nbsp;this&nbsp;one&nbsp;if&nbsp;you&nbsp;have&nbsp;pushed&nbsp;ESP&nbsp;to&nbsp;EBP&nbsp;first</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">for</span>&nbsp;sebp&nbsp;<span style="color:#ff9d00;font-weight:700">in</span>&nbsp;searchebp:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;thisadr=imm.search(sebp)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;results&nbsp;+=&nbsp;thisadr<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">for</span>&nbsp;ad1&nbsp;<span style="color:#ff9d00;font-weight:700">in</span>&nbsp;thisadr:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;module&nbsp;=&nbsp;imm.findModule(ad1)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;<span style="color:#ff9d00;font-weight:700">not</span>&nbsp;module:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;module&nbsp;=&nbsp;<span style="color:#3ad900;font-weight:400">"none"</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">else</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;module&nbsp;=&nbsp;module[<span style="color:#ff0044;font-weight:400">0</span>].lower()<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;page&nbsp;&nbsp;&nbsp;=&nbsp;imm.getMemoryPagebyAddress(&nbsp;ad1&nbsp;)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;access&nbsp;=&nbsp;page.getAccess(&nbsp;human&nbsp;=&nbsp;<span style="color:#ff0044;font-weight:400">True</span>&nbsp;)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;op&nbsp;=&nbsp;imm.Disasm(&nbsp;ad1&nbsp;)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;opstring=op.getDisasm()<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"Found&nbsp;%s&nbsp;at&nbsp;0x%08x&nbsp;(%s)&nbsp;-&nbsp;Access:&nbsp;(%s)"</span>&nbsp;%&nbsp;(opstring,&nbsp;ad1,&nbsp;module,access),&nbsp;address&nbsp;=&nbsp;ad1)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tofile(<span style="color:#3ad900;font-weight:400">"Found&nbsp;"</span>+opstring+<span style="color:#3ad900;font-weight:400">"&nbsp;at&nbsp;0x"</span>&nbsp;+&nbsp;tohex(ad1)+<span style="color:#3ad900;font-weight:400">"&nbsp;["</span>+module+<span style="color:#3ad900;font-weight:400">"]"</span>,filename,ad1)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;nrfound+=<span style="color:#ff0044;font-weight:400">1</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;results:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"Found&nbsp;%d&nbsp;address(es)"</span>&nbsp;%&nbsp;nrfound)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">else</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"No&nbsp;addresses&nbsp;found"</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"Output&nbsp;written&nbsp;to&nbsp;"</span>+filename)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">return</span>&nbsp;<span style="color:#3ad900;font-weight:400">"Done&nbsp;-&nbsp;check&nbsp;%s"</span>&nbsp;%&nbsp;filename<br /><br /><br />&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;args[<span style="color:#ff0044;font-weight:400">0</span>]&nbsp;==&nbsp;<span style="color:#3ad900;font-weight:400">"jseh"</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;filename=<span style="color:#3ad900;font-weight:400">"jseh.txt"</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;resetfile(filename)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;writemodinfo(filename)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;showred=<span style="color:#ff0044;font-weight:400">0</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;showall=<span style="color:#ff0044;font-weight:400">0</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;<span style="color:#ff9d00;font-weight:700">len</span>(args)&nbsp;&gt;&nbsp;<span style="color:#ff0044;font-weight:400">1</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;args[<span style="color:#ff0044;font-weight:400">1</span>].lower()==&nbsp;<span style="color:#3ad900;font-weight:400">"all"</span>:<br />			&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;showall=<span style="color:#ff0044;font-weight:400">1</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"-----------------------------------------------------------------------"</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"Search&nbsp;for&nbsp;jmp/call&nbsp;dword[ebp/esp+nn]&nbsp;(and&nbsp;other)&nbsp;combinations&nbsp;started&nbsp;"</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"-----------------------------------------------------------------------"</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;opcodej=[<span style="color:#3ad900;font-weight:400">"\xff\x54\x24\x08"</span>,&nbsp;<span style="color:#0088ff;font-weight:400">#call&nbsp;dword&nbsp;ptr&nbsp;[esp+08]</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#3ad900;font-weight:400">"\xff\x64\x24\x08"</span>,&nbsp;<span style="color:#0088ff;font-weight:400">#jmp&nbsp;dword&nbsp;ptr&nbsp;[esp+08]</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#3ad900;font-weight:400">"\xff\x54\x24\x14"</span>,&nbsp;<span style="color:#0088ff;font-weight:400">#call&nbsp;dword&nbsp;ptr&nbsp;[esp+14]</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#3ad900;font-weight:400">"\xff\x54\x24\x14"</span>,&nbsp;<span style="color:#0088ff;font-weight:400">#jmp&nbsp;dword&nbsp;ptr&nbsp;[esp+14]</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#3ad900;font-weight:400">"\xff\x54\x24\x1c"</span>,&nbsp;<span style="color:#0088ff;font-weight:400">#call&nbsp;dword&nbsp;ptr&nbsp;[esp+1c]</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#3ad900;font-weight:400">"\xff\x54\x24\x1c"</span>,&nbsp;<span style="color:#0088ff;font-weight:400">#jmp&nbsp;dword&nbsp;ptr&nbsp;[esp+1c]</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#3ad900;font-weight:400">"\xff\x54\x24\x2c"</span>,&nbsp;<span style="color:#0088ff;font-weight:400">#call&nbsp;dword&nbsp;ptr&nbsp;[esp+2c]</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#3ad900;font-weight:400">"\xff\x54\x24\x2c"</span>,&nbsp;<span style="color:#0088ff;font-weight:400">#jmp&nbsp;dword&nbsp;ptr&nbsp;[esp+2c]</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#3ad900;font-weight:400">"\xff\x54\x24\x44"</span>,&nbsp;<span style="color:#0088ff;font-weight:400">#call&nbsp;dword&nbsp;ptr&nbsp;[esp+44]</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#3ad900;font-weight:400">"\xff\x54\x24\x44"</span>,&nbsp;<span style="color:#0088ff;font-weight:400">#jmp&nbsp;dword&nbsp;ptr&nbsp;[esp+44]</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#3ad900;font-weight:400">"\xff\x54\x24\x50"</span>,&nbsp;<span style="color:#0088ff;font-weight:400">#call&nbsp;dword&nbsp;ptr&nbsp;[esp+50]</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#3ad900;font-weight:400">"\xff\x54\x24\x50"</span>,&nbsp;<span style="color:#0088ff;font-weight:400">#jmp&nbsp;dword&nbsp;ptr&nbsp;[esp+50]</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#3ad900;font-weight:400">"\xff\x55\x0c"</span>,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#0088ff;font-weight:400">#call&nbsp;dword&nbsp;ptr&nbsp;[ebp+0c]</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#3ad900;font-weight:400">"\xff\x65\x0c"</span>,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#0088ff;font-weight:400">#jmp&nbsp;dword&nbsp;ptr&nbsp;[ebp+0c]</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#3ad900;font-weight:400">"\xff\x55\x24"</span>,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#0088ff;font-weight:400">#call&nbsp;dword&nbsp;ptr&nbsp;[ebp+24]</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#3ad900;font-weight:400">"\xff\x65\x24"</span>,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#0088ff;font-weight:400">#jmp&nbsp;dword&nbsp;ptr&nbsp;[ebp+24]</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#3ad900;font-weight:400">"\xff\x55\x30"</span>,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#0088ff;font-weight:400">#call&nbsp;dword&nbsp;ptr&nbsp;[ebp+30]</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#3ad900;font-weight:400">"\xff\x65\x30"</span>,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#0088ff;font-weight:400">#jmp&nbsp;dword&nbsp;ptr&nbsp;[ebp+30]</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#3ad900;font-weight:400">"\xff\x55\xfc"</span>,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#0088ff;font-weight:400">#call&nbsp;dword&nbsp;ptr&nbsp;[ebp-04]</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#3ad900;font-weight:400">"\xff\x65\xfc"</span>,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#0088ff;font-weight:400">#jmp&nbsp;dword&nbsp;ptr&nbsp;[ebp-04]</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#3ad900;font-weight:400">"\xff\x55\xf4"</span>,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#0088ff;font-weight:400">#call&nbsp;dword&nbsp;ptr&nbsp;[ebp-0c]</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#3ad900;font-weight:400">"\xff\x65\xf4"</span>,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#0088ff;font-weight:400">#jmp&nbsp;dword&nbsp;ptr&nbsp;[ebp-0c]</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#3ad900;font-weight:400">"\xff\x55\xe8"</span>,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#0088ff;font-weight:400">#call&nbsp;dword&nbsp;ptr&nbsp;[ebp-18]</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#3ad900;font-weight:400">"\xff\x65\xe8"</span>,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#0088ff;font-weight:400">#jmp&nbsp;dword&nbsp;ptr&nbsp;[ebp-18]</span><br />				&nbsp;&nbsp;&nbsp;<span style="color:#3ad900;font-weight:400">"\x83\xc4\x08\xc3"</span>,&nbsp;<span style="color:#0088ff;font-weight:400">#add&nbsp;esp,8&nbsp;+&nbsp;ret</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#3ad900;font-weight:400">"\x83\xc4\x08\xc2"</span>]&nbsp;<span style="color:#0088ff;font-weight:400">#add&nbsp;esp,8&nbsp;+&nbsp;ret&nbsp;X</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">for</span>&nbsp;opjc&nbsp;<span style="color:#ff9d00;font-weight:700">in</span>&nbsp;opcodej:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;addys=imm.search(&nbsp;opjc&nbsp;)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;results&nbsp;+=&nbsp;addys<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">for</span>&nbsp;ad1&nbsp;<span style="color:#ff9d00;font-weight:700">in</span>&nbsp;addys:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;module&nbsp;=&nbsp;imm.findModule(ad1)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;<span style="color:#ff9d00;font-weight:700">not</span>&nbsp;module:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;module=<span style="color:#3ad900;font-weight:400">""</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;page&nbsp;&nbsp;&nbsp;=&nbsp;imm.getMemoryPagebyAddress(&nbsp;ad1&nbsp;)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;access&nbsp;=&nbsp;page.getAccess(&nbsp;human&nbsp;=&nbsp;<span style="color:#ff0044;font-weight:400">True</span>&nbsp;)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;op&nbsp;=&nbsp;imm.Disasm(&nbsp;ad1&nbsp;)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;opstring=op.getDisasm()<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"Found&nbsp;%s&nbsp;at&nbsp;0x%08x&nbsp;-&nbsp;Access:&nbsp;(%s)"</span>&nbsp;%&nbsp;(opstring,&nbsp;ad1,&nbsp;access),&nbsp;address&nbsp;=&nbsp;ad1,highlight=<span style="color:#ff0044;font-weight:400">1</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tofile(<span style="color:#3ad900;font-weight:400">"Found&nbsp;"</span>+opstring+<span style="color:#3ad900;font-weight:400">"&nbsp;at&nbsp;0x"</span>&nbsp;+&nbsp;tohex(ad1)+<span style="color:#3ad900;font-weight:400">"&nbsp;[none]"</span>,filename,ad1)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;nrfound+=<span style="color:#ff0044;font-weight:400">1</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">else</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;showall==<span style="color:#ff0044;font-weight:400">1</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;page&nbsp;&nbsp;&nbsp;=&nbsp;imm.getMemoryPagebyAddress(&nbsp;ad1&nbsp;)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;access&nbsp;=&nbsp;page.getAccess(&nbsp;human&nbsp;=&nbsp;<span style="color:#ff0044;font-weight:400">True</span>&nbsp;)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;op&nbsp;=&nbsp;imm.Disasm(&nbsp;ad1&nbsp;)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;opstring=op.getDisasm()<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;ismodulenosafeseh(module[<span style="color:#ff0044;font-weight:400">0</span>])==<span style="color:#ff0044;font-weight:400">1</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;extratext=<span style="color:#3ad900;font-weight:400">"===&nbsp;Safeseh&nbsp;:&nbsp;NO&nbsp;==="</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;showred=<span style="color:#ff0044;font-weight:400">1</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">else</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;extratext=<span style="color:#3ad900;font-weight:400">"Safeseh&nbsp;protected"</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;showred=<span style="color:#ff0044;font-weight:400">0</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"Found&nbsp;%s&nbsp;at&nbsp;0x%08x&nbsp;(%s)&nbsp;-&nbsp;Access:&nbsp;(%s)&nbsp;-&nbsp;%s"</span>&nbsp;%&nbsp;(opstring,&nbsp;ad1,&nbsp;module,access,extratext),&nbsp;address&nbsp;=&nbsp;ad1,highlight=showred)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tofile(<span style="color:#3ad900;font-weight:400">"Found&nbsp;"</span>+opstring+<span style="color:#3ad900;font-weight:400">"&nbsp;at&nbsp;0x"</span>&nbsp;+&nbsp;tohex(ad1)+<span style="color:#3ad900;font-weight:400">"&nbsp;["</span>+module[<span style="color:#ff0044;font-weight:400">0</span>]+<span style="color:#3ad900;font-weight:400">"]&nbsp;-&nbsp;"</span>&nbsp;+&nbsp;extratext,filename,ad1)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;nrfound+=<span style="color:#ff0044;font-weight:400">1</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"Search&nbsp;complete"</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"Output&nbsp;written&nbsp;to&nbsp;"</span>+filename)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;results:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"Found&nbsp;%d&nbsp;address(es)"</span>&nbsp;%&nbsp;nrfound)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">return</span>&nbsp;<span style="color:#3ad900;font-weight:400">"Found&nbsp;%d&nbsp;address(es)&nbsp;(Check&nbsp;the&nbsp;Log&nbsp;Windows&nbsp;for&nbsp;details)"</span>&nbsp;%&nbsp;nrfound<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">else</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"No&nbsp;addresses&nbsp;found"</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">return</span>&nbsp;<span style="color:#3ad900;font-weight:400">"Sorry,&nbsp;no&nbsp;addresses&nbsp;found"</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"--------------------------------------------------------------"</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">return</span>&nbsp;<span style="color:#3ad900;font-weight:400">"Done&nbsp;-&nbsp;check&nbsp;%s"</span>&nbsp;%&nbsp;filename<br /><br /><br />&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;args[<span style="color:#ff0044;font-weight:400">0</span>]&nbsp;==&nbsp;<span style="color:#3ad900;font-weight:400">"fa"</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;filename=<span style="color:#3ad900;font-weight:400">"fa.txt"</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;resetfile(filename)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;writemodinfo(filename)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;nrfound=<span style="color:#ff0044;font-weight:400">0</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;nrfoundptr=<span style="color:#ff0044;font-weight:400">0</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;opcodej=[<span style="color:#3ad900;font-weight:400">"\x41\x41\x41\x41"</span>]<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;<span style="color:#ff9d00;font-weight:700">len</span>(args)&nbsp;==&nbsp;<span style="color:#ff0044;font-weight:400">3</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;stra=binascii.a2b_hex(args[<span style="color:#ff0044;font-weight:400">1</span>]+args[<span style="color:#ff0044;font-weight:400">2</span>])<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;opcodej=[stra]<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"Custom&nbsp;provided&nbsp;search&nbsp;pattern&nbsp;found&nbsp;(2&nbsp;bytes)"</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;<span style="color:#ff9d00;font-weight:700">len</span>(args)&nbsp;==&nbsp;<span style="color:#ff0044;font-weight:400">5</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;strb=binascii.a2b_hex(args[<span style="color:#ff0044;font-weight:400">1</span>]+args[<span style="color:#ff0044;font-weight:400">2</span>]+args[<span style="color:#ff0044;font-weight:400">3</span>]+args[<span style="color:#ff0044;font-weight:400">4</span>])<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;opcodej=[strb]<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"Custom&nbsp;provided&nbsp;search&nbsp;pattern&nbsp;found&nbsp;(4&nbsp;bytes)"</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"---------------------------------------------------------------------------"</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"Search&nbsp;for&nbsp;locations&nbsp;that&nbsp;contain&nbsp;the&nbsp;search&nbsp;pattern&nbsp;%s"</span>&nbsp;%&nbsp;opcodej[<span style="color:#ff0044;font-weight:400">0</span>])<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"---------------------------------------------------------------------------"</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">for</span>&nbsp;opjc&nbsp;<span style="color:#ff9d00;font-weight:700">in</span>&nbsp;opcodej:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"Searching&nbsp;for&nbsp;%s&nbsp;"</span>&nbsp;%&nbsp;opjc)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;addys=imm.search(&nbsp;opjc&nbsp;)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;results&nbsp;+=&nbsp;addys<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">for</span>&nbsp;<span style="color:#ff9d00;font-weight:700">all</span>&nbsp;<span style="color:#ff9d00;font-weight:700">in</span>&nbsp;results:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;nrfound&nbsp;+=&nbsp;<span style="color:#ff0044;font-weight:400">1</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;results:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"Found&nbsp;%d&nbsp;location(s)&nbsp;that&nbsp;point&nbsp;to&nbsp;the&nbsp;search&nbsp;string"</span>&nbsp;%&nbsp;(nrfound))<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"Now&nbsp;searching&nbsp;for&nbsp;pointers&nbsp;to&nbsp;those&nbsp;location(s)..."</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">for</span>&nbsp;pntr&nbsp;<span style="color:#ff9d00;font-weight:700">in</span>&nbsp;results:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#0088ff;font-weight:400">#first&nbsp;reverse&nbsp;the&nbsp;address&nbsp;so&nbsp;we&nbsp;can&nbsp;use&nbsp;it&nbsp;in&nbsp;a&nbsp;search&nbsp;operation</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;taddr=tohex(pntr)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sstr=taddr[<span style="color:#ff0044;font-weight:400">6</span>]+taddr[<span style="color:#ff0044;font-weight:400">7</span>]+<span style="color:#3ad900;font-weight:400">"&nbsp;"</span>+taddr[<span style="color:#ff0044;font-weight:400">4</span>]+taddr[<span style="color:#ff0044;font-weight:400">5</span>]+<span style="color:#3ad900;font-weight:400">"&nbsp;"</span>+taddr[<span style="color:#ff0044;font-weight:400">2</span>]+taddr[<span style="color:#ff0044;font-weight:400">3</span>]+<span style="color:#3ad900;font-weight:400">"&nbsp;"</span>+taddr[<span style="color:#ff0044;font-weight:400">0</span>]+taddr[<span style="color:#ff0044;font-weight:400">1</span>]<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;&nbsp;-&gt;&nbsp;searching&nbsp;for&nbsp;%s"</span>&nbsp;%&nbsp;(sstr),&nbsp;address=pntr)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;addys=imm.search(&nbsp;sstr&nbsp;)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">for</span>&nbsp;adptr&nbsp;<span style="color:#ff9d00;font-weight:700">in</span>&nbsp;addys:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;**&nbsp;Found&nbsp;pointer&nbsp;at&nbsp;0x%08x&nbsp;**&nbsp;"</span>&nbsp;%&nbsp;(adptr),&nbsp;address&nbsp;=&nbsp;adptr)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tofile(<span style="color:#3ad900;font-weight:400">"Found&nbsp;pointer&nbsp;to&nbsp;"</span>+tohex(pntr)+<span style="color:#3ad900;font-weight:400">"&nbsp;at&nbsp;"</span>&nbsp;+&nbsp;tohex(adptr),filename,adptr)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;nrfoundptr&nbsp;+=&nbsp;<span style="color:#ff0044;font-weight:400">1</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sstr=taddr[<span style="color:#ff0044;font-weight:400">4</span>]+taddr[<span style="color:#ff0044;font-weight:400">5</span>]+<span style="color:#3ad900;font-weight:400">"&nbsp;"</span>+taddr[<span style="color:#ff0044;font-weight:400">2</span>]+taddr[<span style="color:#ff0044;font-weight:400">3</span>]+<span style="color:#3ad900;font-weight:400">"&nbsp;"</span>+taddr[<span style="color:#ff0044;font-weight:400">0</span>]+taddr[<span style="color:#ff0044;font-weight:400">1</span>]<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;&nbsp;-&gt;&nbsp;searching&nbsp;for&nbsp;%s&nbsp;(possible&nbsp;close&nbsp;pointer)"</span>&nbsp;%&nbsp;sstr)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;addus=imm.search(&nbsp;sstr&nbsp;)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">for</span>&nbsp;adptr&nbsp;<span style="color:#ff9d00;font-weight:700">in</span>&nbsp;addys:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;**&nbsp;Possible&nbsp;close&nbsp;pointer&nbsp;found&nbsp;at&nbsp;0x%08x&nbsp;**&nbsp;"</span>&nbsp;%&nbsp;(adptr),&nbsp;address&nbsp;=&nbsp;adptr)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tofile(<span style="color:#3ad900;font-weight:400">"Found&nbsp;possible&nbsp;close&nbsp;pointer&nbsp;to&nbsp;"</span>+tohex(pntr)+<span style="color:#3ad900;font-weight:400">"&nbsp;at&nbsp;"</span>+tohex(adptr),filename,adptr)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;nrfoundptr&nbsp;+=&nbsp;<span style="color:#ff0044;font-weight:400">1</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;nrfoundptr&nbsp;&gt;&nbsp;<span style="color:#ff0044;font-weight:400">0</span>:<br />			&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"Pointers&nbsp;to&nbsp;pointers&nbsp;found&nbsp;:&nbsp;%d&nbsp;!"</span>&nbsp;%&nbsp;nrfoundptr)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">else</span>:<br />			&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"Sorry,&nbsp;no&nbsp;pointers&nbsp;to&nbsp;pointers&nbsp;found&nbsp;!"</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">else</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"No&nbsp;addresses&nbsp;found"</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">return</span>&nbsp;<span style="color:#3ad900;font-weight:400">"Sorry,&nbsp;no&nbsp;addresses&nbsp;found"</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"--------------------------------------------------------------"</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">return</span>&nbsp;<span style="color:#3ad900;font-weight:400">"Done&nbsp;-&nbsp;check&nbsp;%s"</span>&nbsp;%&nbsp;filename<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;args[<span style="color:#ff0044;font-weight:400">0</span>]&nbsp;==&nbsp;<span style="color:#3ad900;font-weight:400">"pattern_create"</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"-------------------------------------------------------------------------"</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"Creating&nbsp;(Metasploit)&nbsp;pattern..."</span>);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"-------------------------------------------------------------------------"</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;<span style="color:#ff9d00;font-weight:700">len</span>(args)&nbsp;!=&nbsp;<span style="color:#ff0044;font-weight:400">2</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"Syntax&nbsp;:&nbsp;!pvefindaddr&nbsp;pattern_create&nbsp;size"</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">return</span>&nbsp;<span style="color:#3ad900;font-weight:400">"Invalid&nbsp;syntax"</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">else</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mypat=pattern_create(args[<span style="color:#ff0044;font-weight:400">1</span>])<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"Pattern&nbsp;of&nbsp;%s&nbsp;bytes&nbsp;:"</span>&nbsp;%&nbsp;args[<span style="color:#ff0044;font-weight:400">1</span>])<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(mypat)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;filename=<span style="color:#3ad900;font-weight:400">"mspattern.txt"</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;resetfile(filename)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FILE=<span style="color:#ff9d00;font-weight:700">open</span>(filename,<span style="color:#3ad900;font-weight:400">"a"</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FILE.write(<span style="color:#3ad900;font-weight:400">"Cyclic&nbsp;pattern&nbsp;of&nbsp;"</span>&nbsp;+&nbsp;args[<span style="color:#ff0044;font-weight:400">1</span>]+<span style="color:#3ad900;font-weight:400">"&nbsp;characters&nbsp;:\n"</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FILE.write(mypat)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FILE.close()<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">return</span>&nbsp;<span style="color:#3ad900;font-weight:400">"Done&nbsp;-&nbsp;check&nbsp;%s"</span>&nbsp;%&nbsp;filename<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;args[<span style="color:#ff0044;font-weight:400">0</span>]&nbsp;==&nbsp;<span style="color:#3ad900;font-weight:400">"pattern_offset"</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"-------------------------------------------------------------------------"</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"Calculating&nbsp;offset&nbsp;in&nbsp;(Metasploit)&nbsp;pattern..."</span>);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"-------------------------------------------------------------------------"</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;(<span style="color:#ff9d00;font-weight:700">len</span>(args)&nbsp;!=&nbsp;<span style="color:#ff0044;font-weight:400">2</span>&nbsp;<span style="color:#ff9d00;font-weight:700">and</span>&nbsp;<span style="color:#ff9d00;font-weight:700">len</span>(args)&nbsp;!=&nbsp;<span style="color:#ff0044;font-weight:400">3</span>):<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"Syntax&nbsp;:&nbsp;!pvefindaddr&nbsp;pattern_offset&nbsp;Pattern&nbsp;[Size]"</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">else</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;<span style="color:#ff9d00;font-weight:700">len</span>(args)==<span style="color:#ff0044;font-weight:400">2</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pattern_offset(args[<span style="color:#ff0044;font-weight:400">1</span>],<span style="color:#ff0044;font-weight:400">8000</span>,imm)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;<span style="color:#ff9d00;font-weight:700">len</span>(args)==<span style="color:#ff0044;font-weight:400">3</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pattern_offset(args[<span style="color:#ff0044;font-weight:400">1</span>],args[<span style="color:#ff0044;font-weight:400">2</span>],imm)<br /><br /><br /><br /><br />&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;args[<span style="color:#ff0044;font-weight:400">0</span>]&nbsp;==&nbsp;<span style="color:#3ad900;font-weight:400">"findmsp"</span>&nbsp;<span style="color:#ff9d00;font-weight:700">or</span>&nbsp;args[<span style="color:#ff0044;font-weight:400">0</span>]&nbsp;==&nbsp;<span style="color:#3ad900;font-weight:400">"suggest"</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"-------------------------------------------------------------------------"</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"Searching&nbsp;for&nbsp;metasploit&nbsp;pattern&nbsp;references"</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"-------------------------------------------------------------------------"</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mspattern=pattern_create(<span style="color:#ff0044;font-weight:400">20280</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;regs&nbsp;=&nbsp;imm.getRegs()<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;<span style="color:#ff9d00;font-weight:700">len</span>(args)&nbsp;==&nbsp;<span style="color:#ff0044;font-weight:400">1</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fchars=pattern_create(<span style="color:#ff0044;font-weight:400">8</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"[1]&nbsp;Searching&nbsp;for&nbsp;first&nbsp;8&nbsp;characters&nbsp;of&nbsp;Metasploit&nbsp;pattern&nbsp;:&nbsp;%s"</span>&nbsp;%&nbsp;fchars)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"====================================================================="</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.updateLog()<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;firstchars=<span style="color:#3ad900;font-weight:400">""</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">for</span>&nbsp;mspchar&nbsp;<span style="color:#ff9d00;font-weight:700">in</span>&nbsp;fchars:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;firstchars&nbsp;+=&nbsp;<span style="color:#ff9d00;font-weight:700">hex</span>(<span style="color:#ff9d00;font-weight:700">ord</span>(mspchar)).replace(<span style="color:#3ad900;font-weight:400">"0x"</span>,<span style="color:#3ad900;font-weight:400">"&nbsp;"</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;toSearch&nbsp;=&nbsp;firstchars.replace(<span style="color:#3ad900;font-weight:400">"&nbsp;"</span>,<span style="color:#3ad900;font-weight:400">'\\x'</span>).decode(<span style="color:#3ad900;font-weight:400">'string_escape'</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;toSearch&nbsp;=&nbsp;toSearch.decode(<span style="color:#3ad900;font-weight:400">'string_escape'</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sresults=imm.search(&nbsp;toSearch&nbsp;)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;(<span style="color:#ff9d00;font-weight:700">len</span>(sresults)&nbsp;==&nbsp;<span style="color:#ff0044;font-weight:400">0</span>):<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;**&nbsp;Could&nbsp;not&nbsp;find&nbsp;begin&nbsp;of&nbsp;Metasploit&nbsp;pattern&nbsp;(ascii)&nbsp;in&nbsp;memory&nbsp;!&nbsp;**"</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">else</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">for</span>&nbsp;sr&nbsp;<span style="color:#ff9d00;font-weight:700">in</span>&nbsp;sresults:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;-&nbsp;Found&nbsp;begin&nbsp;of&nbsp;Metasploit&nbsp;pattern&nbsp;at&nbsp;0x%08x"</span>&nbsp;%&nbsp;sr,address=sr)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">""</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#0088ff;font-weight:400">#perhaps&nbsp;it's&nbsp;unicode</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;firstchars=<span style="color:#3ad900;font-weight:400">""</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">for</span>&nbsp;mspchar&nbsp;<span style="color:#ff9d00;font-weight:700">in</span>&nbsp;fchars:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;firstchars&nbsp;+=&nbsp;<span style="color:#ff9d00;font-weight:700">hex</span>(<span style="color:#ff9d00;font-weight:700">ord</span>(mspchar)).replace(<span style="color:#3ad900;font-weight:400">"0x"</span>,<span style="color:#3ad900;font-weight:400">"&nbsp;"</span>)+<span style="color:#3ad900;font-weight:400">"\x00"</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;toSearch&nbsp;=&nbsp;firstchars.replace(<span style="color:#3ad900;font-weight:400">"&nbsp;"</span>,<span style="color:#3ad900;font-weight:400">'\\x'</span>).decode(<span style="color:#3ad900;font-weight:400">'string_escape'</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;toSearch&nbsp;=&nbsp;toSearch.decode(<span style="color:#3ad900;font-weight:400">'string_escape'</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sresults=imm.search(&nbsp;toSearch&nbsp;)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;(<span style="color:#ff9d00;font-weight:700">len</span>(sresults)&nbsp;==&nbsp;<span style="color:#ff0044;font-weight:400">0</span>):<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;**&nbsp;Could&nbsp;not&nbsp;find&nbsp;begin&nbsp;of&nbsp;Metasploit&nbsp;pattern&nbsp;(unicode&nbsp;expanded)&nbsp;in&nbsp;memory&nbsp;!&nbsp;**"</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">else</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">for</span>&nbsp;sr&nbsp;<span style="color:#ff9d00;font-weight:700">in</span>&nbsp;sresults:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;-&nbsp;Found&nbsp;begin&nbsp;of&nbsp;Unicode&nbsp;expanded&nbsp;Metasploit&nbsp;pattern&nbsp;at&nbsp;0x%08x"</span>&nbsp;%&nbsp;sr,address=sr)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">""</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.updateLog()<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"[2]&nbsp;Checking&nbsp;register&nbsp;addresses&nbsp;and&nbsp;contents"</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"============================================"</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">for</span>&nbsp;reg&nbsp;<span style="color:#ff9d00;font-weight:700">in</span>&nbsp;regs:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.updateLog()<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;foundreg=<span style="color:#ff0044;font-weight:400">0</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;regvalue&nbsp;=&nbsp;tohex(regs[reg])<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;hex1=regvalue[<span style="color:#ff0044;font-weight:400">6</span>]+regvalue[<span style="color:#ff0044;font-weight:400">7</span>]<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;hex2=regvalue[<span style="color:#ff0044;font-weight:400">4</span>]+regvalue[<span style="color:#ff0044;font-weight:400">5</span>]<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;hex3=regvalue[<span style="color:#ff0044;font-weight:400">2</span>]+regvalue[<span style="color:#ff0044;font-weight:400">3</span>]<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;hex4=regvalue[<span style="color:#ff0044;font-weight:400">0</span>]+regvalue[<span style="color:#ff0044;font-weight:400">1</span>]<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;asciivalue=toascii(imm,hex1)+toascii(imm,hex2)+toascii(imm,hex3)+toascii(imm,hex4)<br />		&nbsp;&nbsp;&nbsp;<span style="color:#0088ff;font-weight:400">#see&nbsp;if&nbsp;string&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;Metasploit&nbsp;pattern</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;asciivalue&nbsp;<span style="color:#ff9d00;font-weight:700">in</span>&nbsp;mspattern:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PatternPos&nbsp;=&nbsp;mspattern.find(asciivalue)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;-&nbsp;Register&nbsp;%s&nbsp;is&nbsp;overwritten&nbsp;with&nbsp;Metasploit&nbsp;pattern&nbsp;at&nbsp;position&nbsp;%d"</span>&nbsp;%&nbsp;(reg,PatternPos))<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;foundreg=<span style="color:#ff0044;font-weight:400">1</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;reg&nbsp;==&nbsp;<span style="color:#3ad900;font-weight:400">'EIP'</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;g_typeofsploit=<span style="color:#ff0044;font-weight:400">1</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;g_offset=PatternPos<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;asciivalue&nbsp;<span style="color:#ff9d00;font-weight:700">in</span>&nbsp;mspattern.lower():<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PatternPos&nbsp;=&nbsp;mspattern.lower().find(asciivalue)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;-&nbsp;Register&nbsp;%s&nbsp;is&nbsp;overwritten&nbsp;with&nbsp;lowercase&nbsp;Metasploit&nbsp;pattern&nbsp;at&nbsp;position&nbsp;%d"</span>&nbsp;%&nbsp;(reg,PatternPos))<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;foundreg=<span style="color:#ff0044;font-weight:400">1</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;reg&nbsp;==&nbsp;<span style="color:#3ad900;font-weight:400">'EIP'</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;g_typeofsploit=<span style="color:#ff0044;font-weight:400">1</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;g_offset=PatternPos<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;asciivalue&nbsp;<span style="color:#ff9d00;font-weight:700">in</span>&nbsp;mspattern.upper():<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PatternPos&nbsp;=&nbsp;mspattern.upper().find(asciivalue)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;-&nbsp;Register&nbsp;%s&nbsp;is&nbsp;overwritten&nbsp;with&nbsp;uppercase&nbsp;Metasploit&nbsp;pattern&nbsp;at&nbsp;position&nbsp;%d"</span>&nbsp;%&nbsp;(reg,PatternPos))<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;foundreg=<span style="color:#ff0044;font-weight:400">1</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;reg&nbsp;==&nbsp;<span style="color:#3ad900;font-weight:400">'EIP'</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;g_typeofsploit=<span style="color:#ff0044;font-weight:400">1</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;g_offset=PatternPos<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#0088ff;font-weight:400">#perhaps&nbsp;it's&nbsp;a&nbsp;unicode&nbsp;pattern.</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;hex4==<span style="color:#3ad900;font-weight:400">"00"</span>&nbsp;<span style="color:#ff9d00;font-weight:700">and</span>&nbsp;hex2==<span style="color:#3ad900;font-weight:400">"00"</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;reg&nbsp;==&nbsp;<span style="color:#3ad900;font-weight:400">'EIP'</span>:<br />		&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#0088ff;font-weight:400">#get&nbsp;contents&nbsp;at&nbsp;ESP</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;espaddress=regs[<span style="color:#3ad900;font-weight:400">"ESP"</span>]<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;regesp=imm.readMemory(espaddress,<span style="color:#ff0044;font-weight:400">4</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ascuni=regesp[<span style="color:#ff0044;font-weight:400">0</span>]&nbsp;+&nbsp;regesp[<span style="color:#ff0044;font-weight:400">2</span>]&nbsp;+&nbsp;toascii(imm,hex1)&nbsp;+&nbsp;toascii(imm,hex3)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;-&nbsp;EIP&nbsp;overwritten&nbsp;with&nbsp;unicode&nbsp;pattern&nbsp;'%s%s%s%s'.&nbsp;Together&nbsp;with&nbsp;contents&nbsp;of&nbsp;ESP&nbsp;(0x%s)&nbsp;this&nbsp;makes&nbsp;%s"</span>&nbsp;%&nbsp;(hex4,hex3,hex2,hex1,tohex(espaddress),ascuni))<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;ascuni&nbsp;<span style="color:#ff9d00;font-weight:700">in</span>&nbsp;mspattern:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PatternPos&nbsp;=&nbsp;mspattern.find(ascuni)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;&nbsp;&nbsp;&nbsp;It&nbsp;looks&nbsp;like&nbsp;EIP&nbsp;was&nbsp;overwritten&nbsp;with&nbsp;Metasploit&nbsp;pattern&nbsp;at&nbsp;position&nbsp;%d"</span>&nbsp;%&nbsp;PatternPos)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;g_typeofsploit=<span style="color:#ff0044;font-weight:400">1</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;g_offset=PatternPos<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">else</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;hex1&lt;&gt;<span style="color:#3ad900;font-weight:400">"00"</span>&nbsp;<span style="color:#ff9d00;font-weight:700">and</span>&nbsp;hex3&lt;&gt;<span style="color:#3ad900;font-weight:400">"00"</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;-&nbsp;%s&nbsp;overwritten&nbsp;with&nbsp;unicode&nbsp;pattern&nbsp;'%s%s%s%s'."</span>&nbsp;%&nbsp;(reg,hex4,hex3,hex2,hex1))<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#0088ff;font-weight:400">#perhaps&nbsp;we&nbsp;forgot&nbsp;to&nbsp;use&nbsp;Metasploit&nbsp;pattern&nbsp;-&nbsp;look&nbsp;for&nbsp;41414141/42424242</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;(asciivalue==<span style="color:#3ad900;font-weight:400">"AAAA"</span>&nbsp;<span style="color:#ff9d00;font-weight:700">or</span>&nbsp;asciivalue==<span style="color:#3ad900;font-weight:400">"BBBB"</span>):<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;-&nbsp;Register&nbsp;%s&nbsp;is&nbsp;overwritten&nbsp;with&nbsp;%s&nbsp;-&nbsp;Try&nbsp;using&nbsp;a&nbsp;Metasploit&nbsp;pattern&nbsp;next&nbsp;time"</span>&nbsp;%&nbsp;(reg,asciivalue))<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;reg&nbsp;==&nbsp;<span style="color:#3ad900;font-weight:400">'EIP'</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;guessstart(asciivalue,<span style="color:#ff0044;font-weight:400">1</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;(asciivalue==<span style="color:#3ad900;font-weight:400">"aaaa"</span>&nbsp;<span style="color:#ff9d00;font-weight:700">or</span>&nbsp;asciivalue==<span style="color:#3ad900;font-weight:400">"bbbb"</span>):<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;-&nbsp;Register&nbsp;%s&nbsp;is&nbsp;overwritten&nbsp;with&nbsp;%s&nbsp;(lowercase)-&nbsp;Try&nbsp;using&nbsp;a&nbsp;Metasploit&nbsp;pattern&nbsp;next&nbsp;time"</span>&nbsp;%&nbsp;(reg,asciivalue))<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;reg&nbsp;==&nbsp;<span style="color:#3ad900;font-weight:400">'EIP'</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;guessstart(asciivalue,<span style="color:#ff0044;font-weight:400">1</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;(hex1==<span style="color:#3ad900;font-weight:400">"00"</span>&nbsp;<span style="color:#ff9d00;font-weight:700">and</span>&nbsp;hex2==<span style="color:#3ad900;font-weight:400">"41"</span>&nbsp;<span style="color:#ff9d00;font-weight:700">and</span>&nbsp;hex3==<span style="color:#3ad900;font-weight:400">"00"</span>&nbsp;<span style="color:#ff9d00;font-weight:700">and</span>&nbsp;hex4==<span style="color:#3ad900;font-weight:400">"41"</span>):<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;-&nbsp;Register&nbsp;%s&nbsp;is&nbsp;overwritten&nbsp;with&nbsp;00410041&nbsp;(Unicode&nbsp;?)&nbsp;-&nbsp;Try&nbsp;using&nbsp;a&nbsp;Metasploit&nbsp;pattern&nbsp;next&nbsp;time"</span>&nbsp;%&nbsp;(reg))<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#0088ff;font-weight:400">#now&nbsp;look&nbsp;at&nbsp;contents&nbsp;of&nbsp;register</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;regcnt=<span style="color:#ff0044;font-weight:400">0</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;offfound=<span style="color:#ff0044;font-weight:400">0</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.updateLog()<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">while</span>&nbsp;(regcnt&nbsp;&lt;&nbsp;<span style="color:#ff0044;font-weight:400">127</span>&nbsp;<span style="color:#ff9d00;font-weight:700">and</span>&nbsp;offfound==<span style="color:#ff0044;font-weight:400">0</span>):<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">try</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;thisregaddr=regs[reg]+regcnt<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;regcnt&nbsp;&gt;&nbsp;<span style="color:#ff0044;font-weight:400">0</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;regofftxt=<span style="color:#3ad900;font-weight:400">"+"</span>&nbsp;+&nbsp;<span style="color:#ff9d00;font-weight:700">hex</span>(regcnt)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">else</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;regofftxt=<span style="color:#3ad900;font-weight:400">""</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cont&nbsp;&nbsp;=&nbsp;imm.readMemory(thisregaddr,&nbsp;<span style="color:#ff0044;font-weight:400">4</span>&nbsp;)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;cont&nbsp;==&nbsp;<span style="color:#3ad900;font-weight:400">""</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cont=<span style="color:#3ad900;font-weight:400">"REALLYBADCOFFEE"</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;cont&nbsp;<span style="color:#ff9d00;font-weight:700">in</span>&nbsp;mspattern:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PatternPos&nbsp;=&nbsp;mspattern.find(cont)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;PatternPos&nbsp;&gt;=&nbsp;<span style="color:#ff0044;font-weight:400">0</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;-&nbsp;Register&nbsp;%s&nbsp;points&nbsp;to&nbsp;Metasploit&nbsp;pattern&nbsp;at&nbsp;position&nbsp;%d"</span>&nbsp;%&nbsp;(reg+regofftxt,PatternPos))<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;offfound=<span style="color:#ff0044;font-weight:400">1</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;(PatternPos&nbsp;&lt;&nbsp;g_regpos)&nbsp;<span style="color:#ff9d00;font-weight:700">or</span>&nbsp;(g_regpos&nbsp;==&nbsp;<span style="color:#ff0044;font-weight:400">0</span>):<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;g_jumpreg=reg<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;g_regoff=regofftxt<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;g_regpos=PatternPos<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;cont&nbsp;<span style="color:#ff9d00;font-weight:700">in</span>&nbsp;mspattern.lower():<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PatternPos&nbsp;=&nbsp;mspattern.lower().find(cont)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;PatternPos&nbsp;&gt;=&nbsp;<span style="color:#ff0044;font-weight:400">0</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;-&nbsp;Register&nbsp;%s&nbsp;points&nbsp;to&nbsp;lowercase&nbsp;Metasploit&nbsp;pattern&nbsp;at&nbsp;position&nbsp;%d"</span>&nbsp;%&nbsp;(reg+regofftxt,PatternPos))<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;offfound=<span style="color:#ff0044;font-weight:400">1</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;(PatternPos&nbsp;&lt;&nbsp;g_regpos)&nbsp;<span style="color:#ff9d00;font-weight:700">or</span>&nbsp;(g_regpos&nbsp;==&nbsp;<span style="color:#ff0044;font-weight:400">0</span>):<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;g_jumpreg=reg<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;g_regoff=regofftxt<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;g_regpos=PatternPos<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;cont&nbsp;<span style="color:#ff9d00;font-weight:700">in</span>&nbsp;mspattern.upper():<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PatternPos&nbsp;=&nbsp;mspattern.upper().find(cont)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;PatternPos&nbsp;&gt;=&nbsp;<span style="color:#ff0044;font-weight:400">0</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;-&nbsp;Register&nbsp;%s&nbsp;points&nbsp;to&nbsp;uppercase&nbsp;Metasploit&nbsp;pattern&nbsp;at&nbsp;position&nbsp;%d"</span>&nbsp;%&nbsp;(reg+regofftxt,PatternPos))<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;offfound=<span style="color:#ff0044;font-weight:400">1</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;(PatternPos&nbsp;&lt;&nbsp;g_regpos)&nbsp;<span style="color:#ff9d00;font-weight:700">or</span>&nbsp;(g_regpos&nbsp;==&nbsp;<span style="color:#ff0044;font-weight:400">0</span>):<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;g_jumpreg=reg<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;g_regoff=regofftxt<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;g_regpos=PatternPos<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;(cont==<span style="color:#3ad900;font-weight:400">"AAAA"</span>&nbsp;<span style="color:#ff9d00;font-weight:700">or</span>&nbsp;cont==<span style="color:#3ad900;font-weight:400">"BBBB"</span>):<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;-&nbsp;Register&nbsp;%s&nbsp;points&nbsp;to&nbsp;%s&nbsp;-&nbsp;Try&nbsp;using&nbsp;a&nbsp;Metasploit&nbsp;pattern&nbsp;next&nbsp;time"</span>&nbsp;%&nbsp;(reg+regofftxt,cont))<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;offfound=<span style="color:#ff0044;font-weight:400">1</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;(cont==<span style="color:#3ad900;font-weight:400">"aaaa"</span>&nbsp;<span style="color:#ff9d00;font-weight:700">or</span>&nbsp;cont==<span style="color:#3ad900;font-weight:400">"bbbb"</span>):<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;-&nbsp;Register&nbsp;%s&nbsp;points&nbsp;to&nbsp;%s&nbsp;(converted&nbsp;to&nbsp;lowercase&nbsp;?)-&nbsp;Try&nbsp;using&nbsp;a&nbsp;Metasploit&nbsp;pattern&nbsp;next&nbsp;time"</span>&nbsp;%&nbsp;(reg+regofftxt,cont))<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;offfound=<span style="color:#ff0044;font-weight:400">1</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;uregvalue=imm.readMemory(thisregaddr,<span style="color:#ff0044;font-weight:400">8</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ascuni=uregvalue[<span style="color:#ff0044;font-weight:400">0</span>]&nbsp;+&nbsp;uregvalue[<span style="color:#ff0044;font-weight:400">2</span>]&nbsp;+&nbsp;uregvalue[<span style="color:#ff0044;font-weight:400">4</span>]&nbsp;+&nbsp;uregvalue[<span style="color:#ff0044;font-weight:400">6</span>]<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;ascuni&nbsp;<span style="color:#ff9d00;font-weight:700">in</span>&nbsp;mspattern:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;offfound=<span style="color:#ff0044;font-weight:400">1</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PatternPos&nbsp;=&nbsp;mspattern.find(ascuni)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;-&nbsp;Register&nbsp;%s&nbsp;points&nbsp;to&nbsp;position&nbsp;%d&nbsp;in&nbsp;Metasploit&nbsp;pattern&nbsp;(unicode&nbsp;expanded)"</span>&nbsp;%&nbsp;(reg,PatternPos))<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">except</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">pass</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;regcnt=regcnt+<span style="color:#ff0044;font-weight:400">1</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.updateLog()<br />	&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#0088ff;font-weight:400">#finally&nbsp;look&nbsp;at&nbsp;sehchain</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">""</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"[3]&nbsp;Checking&nbsp;seh&nbsp;chain"</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"======================"</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.updateLog()<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;thissehchain=imm.getSehChain()<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;nrofentries=<span style="color:#ff0044;font-weight:400">0</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">for</span>&nbsp;chainentry&nbsp;<span style="color:#ff9d00;font-weight:700">in</span>&nbsp;thissehchain:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#0088ff;font-weight:400">#try:</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.updateLog()<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sehvalue=tohex(chainentry[<span style="color:#ff0044;font-weight:400">1</span>])<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;hex1=sehvalue[<span style="color:#ff0044;font-weight:400">6</span>]+sehvalue[<span style="color:#ff0044;font-weight:400">7</span>]<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;hex2=sehvalue[<span style="color:#ff0044;font-weight:400">4</span>]+sehvalue[<span style="color:#ff0044;font-weight:400">5</span>]<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;hex3=sehvalue[<span style="color:#ff0044;font-weight:400">2</span>]+sehvalue[<span style="color:#ff0044;font-weight:400">3</span>]<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;hex4=sehvalue[<span style="color:#ff0044;font-weight:400">0</span>]+sehvalue[<span style="color:#ff0044;font-weight:400">1</span>]<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;asciivalue=toascii(imm,hex1)+toascii(imm,hex2)+toascii(imm,hex3)+toascii(imm,hex4)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;-&nbsp;Checking&nbsp;seh&nbsp;chain&nbsp;entry&nbsp;at&nbsp;0x%08x,&nbsp;value&nbsp;%08x"</span>&nbsp;%&nbsp;(chainentry[<span style="color:#ff0044;font-weight:400">0</span>],chainentry[<span style="color:#ff0044;font-weight:400">1</span>]))<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#0088ff;font-weight:400">#see&nbsp;if&nbsp;string&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;Metasploit&nbsp;pattern</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;asciivalue&nbsp;<span style="color:#ff9d00;font-weight:700">in</span>&nbsp;mspattern:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PatternPos&nbsp;=&nbsp;mspattern.find(asciivalue)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;&nbsp;&nbsp;=&gt;&nbsp;record&nbsp;is&nbsp;overwritten&nbsp;with&nbsp;Metasploit&nbsp;pattern&nbsp;after&nbsp;%d&nbsp;bytes"</span>&nbsp;%&nbsp;(PatternPos))<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;g_typeofsploit=<span style="color:#ff0044;font-weight:400">2</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;g_offset=PatternPos<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;asciivalue&nbsp;<span style="color:#ff9d00;font-weight:700">in</span>&nbsp;mspattern.lower():<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PatternPos&nbsp;=&nbsp;mspattern.lower().find(asciivalue)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;&nbsp;&nbsp;=&gt;&nbsp;record&nbsp;is&nbsp;overwritten&nbsp;with&nbsp;lowercase&nbsp;Metasploit&nbsp;pattern&nbsp;after&nbsp;%d&nbsp;bytes"</span>&nbsp;%&nbsp;(PatternPos))<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;g_typeofsploit=<span style="color:#ff0044;font-weight:400">2</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;g_offset=PatternPos<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;asciivalue&nbsp;<span style="color:#ff9d00;font-weight:700">in</span>&nbsp;mspattern.upper():<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PatternPos&nbsp;=&nbsp;mspattern.upper().find(asciivalue)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;&nbsp;&nbsp;=&gt;&nbsp;record&nbsp;is&nbsp;overwritten&nbsp;with&nbsp;uppercase&nbsp;Metasploit&nbsp;pattern&nbsp;after&nbsp;%d&nbsp;bytes"</span>&nbsp;%&nbsp;(PatternPos))<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;g_typeofsploit=<span style="color:#ff0044;font-weight:400">2</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;g_offset=PatternPos<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;(asciivalue==<span style="color:#3ad900;font-weight:400">"AAAA"</span>&nbsp;<span style="color:#ff9d00;font-weight:700">or</span>&nbsp;asciivalue==<span style="color:#3ad900;font-weight:400">"BBBB"</span>):<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;&nbsp;&nbsp;=&gt;&nbsp;record&nbsp;is&nbsp;overwritten&nbsp;with&nbsp;%s"</span>&nbsp;%&nbsp;(asciivalue))<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;guessstart(asciivalue,<span style="color:#ff0044;font-weight:400">2</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;(asciivalue==<span style="color:#3ad900;font-weight:400">"aaaa"</span>&nbsp;<span style="color:#ff9d00;font-weight:700">or</span>&nbsp;asciivalue==<span style="color:#3ad900;font-weight:400">"bbbb"</span>):<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;&nbsp;&nbsp;=&gt;&nbsp;record&nbsp;is&nbsp;overwritten&nbsp;with&nbsp;%s&nbsp;(lowercase)"</span>&nbsp;%&nbsp;(asciivalue))<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;guessstart(asciivalue,<span style="color:#ff0044;font-weight:400">2</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;nrofentries=nrofentries+<span style="color:#ff0044;font-weight:400">1</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#0088ff;font-weight:400">#see&nbsp;if&nbsp;sehchain&nbsp;is&nbsp;overwritten&nbsp;with&nbsp;unicode&nbsp;pattern.&nbsp;We&nbsp;need&nbsp;at&nbsp;least&nbsp;2&nbsp;entries&nbsp;for&nbsp;the&nbsp;easy&nbsp;way</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>	nrofentries&nbsp;&gt;&nbsp;<span style="color:#ff0044;font-weight:400">1</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pos=<span style="color:#ff0044;font-weight:400">0</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;previousentry=<span style="color:#3ad900;font-weight:400">"01010101"</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">for</span>&nbsp;chainentry&nbsp;<span style="color:#ff9d00;font-weight:700">in</span>&nbsp;thissehchain:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;(pos&nbsp;&gt;&nbsp;<span style="color:#ff0044;font-weight:400">0</span>):<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;thisaddr=tohex(chainentry[<span style="color:#ff0044;font-weight:400">0</span>])<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;(thisaddr[<span style="color:#ff0044;font-weight:400">0</span>]==<span style="color:#3ad900;font-weight:400">"0"</span>&nbsp;<span style="color:#ff9d00;font-weight:700">and</span>&nbsp;thisaddr[<span style="color:#ff0044;font-weight:400">1</span>]==<span style="color:#3ad900;font-weight:400">"0"</span>&nbsp;<span style="color:#ff9d00;font-weight:700">and</span>&nbsp;thisaddr[<span style="color:#ff0044;font-weight:400">4</span>]==<span style="color:#3ad900;font-weight:400">"0"</span>&nbsp;<span style="color:#ff9d00;font-weight:700">and</span>&nbsp;thisaddr[<span style="color:#ff0044;font-weight:400">5</span>]==<span style="color:#3ad900;font-weight:400">"0"</span>&nbsp;<span style="color:#ff9d00;font-weight:700">and</span>&nbsp;previousentry[<span style="color:#ff0044;font-weight:400">0</span>]==<span style="color:#3ad900;font-weight:400">"0"</span>&nbsp;<span style="color:#ff9d00;font-weight:700">and</span>&nbsp;previousentry[<span style="color:#ff0044;font-weight:400">1</span>]==<span style="color:#3ad900;font-weight:400">"0"</span>&nbsp;<span style="color:#ff9d00;font-weight:700">and</span>&nbsp;previousentry[<span style="color:#ff0044;font-weight:400">4</span>]==<span style="color:#3ad900;font-weight:400">"0"</span>&nbsp;<span style="color:#ff9d00;font-weight:700">and</span>&nbsp;previousentry[<span style="color:#ff0044;font-weight:400">5</span>]==<span style="color:#3ad900;font-weight:400">"0"</span>):<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#0088ff;font-weight:400">#unicode&nbsp;address</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#0088ff;font-weight:400">#try&nbsp;to&nbsp;reassemble&nbsp;entire&nbsp;string</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;patstring=thisaddr[<span style="color:#ff0044;font-weight:400">6</span>]+thisaddr[<span style="color:#ff0044;font-weight:400">7</span>]+&nbsp;thisaddr[<span style="color:#ff0044;font-weight:400">2</span>]+thisaddr[<span style="color:#ff0044;font-weight:400">3</span>]+&nbsp;previousentry[<span style="color:#ff0044;font-weight:400">6</span>]+previousentry[<span style="color:#ff0044;font-weight:400">7</span>]+previousentry[<span style="color:#ff0044;font-weight:400">2</span>]+previousentry[<span style="color:#ff0044;font-weight:400">3</span>]<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">try</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ascipat=toascii(imm,thisaddr[<span style="color:#ff0044;font-weight:400">6</span>]+thisaddr[<span style="color:#ff0044;font-weight:400">7</span>])+toascii(imm,thisaddr[<span style="color:#ff0044;font-weight:400">2</span>]+thisaddr[<span style="color:#ff0044;font-weight:400">3</span>])+toascii(imm,previousentry[<span style="color:#ff0044;font-weight:400">6</span>]+previousentry[<span style="color:#ff0044;font-weight:400">7</span>])+toascii(imm,previousentry[<span style="color:#ff0044;font-weight:400">2</span>]+previousentry[<span style="color:#ff0044;font-weight:400">3</span>])<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;&nbsp;&nbsp;&nbsp;***&nbsp;Unicode&nbsp;pattern&nbsp;found&nbsp;:&nbsp;%s&nbsp;=&gt;&nbsp;%s&nbsp;***&nbsp;"</span>&nbsp;%&nbsp;(patstring,ascipat))<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">except</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">pass</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;ascipat&nbsp;<span style="color:#ff9d00;font-weight:700">in</span>&nbsp;mspattern:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PatternPos&nbsp;=&nbsp;mspattern.find(ascipat)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;&nbsp;&nbsp;=&gt;&nbsp;record&nbsp;is&nbsp;overwritten&nbsp;with&nbsp;Unicode&nbsp;Metasploit&nbsp;pattern&nbsp;at&nbsp;position&nbsp;%d"</span>&nbsp;%&nbsp;(PatternPos))<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;g_typeofsploit=<span style="color:#ff0044;font-weight:400">3</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;g_offset=PatternPos<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;ascipat&nbsp;<span style="color:#ff9d00;font-weight:700">in</span>&nbsp;mspattern.lower():<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PatternPos&nbsp;=&nbsp;mspattern.lower().find(ascipat)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;&nbsp;&nbsp;=&gt;&nbsp;record&nbsp;is&nbsp;overwritten&nbsp;with&nbsp;Unicode&nbsp;lowercase&nbsp;Metasploit&nbsp;pattern&nbsp;at&nbsp;position&nbsp;%d"</span>&nbsp;%&nbsp;(PatternPos))<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;g_typeofsploit=<span style="color:#ff0044;font-weight:400">3</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;g_offset=PatternPos<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;ascipat&nbsp;<span style="color:#ff9d00;font-weight:700">in</span>&nbsp;mspattern.upper():<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PatternPos&nbsp;=&nbsp;mspattern.upper().find(ascipat)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;&nbsp;&nbsp;=&gt;&nbsp;record&nbsp;is&nbsp;overwritten&nbsp;with&nbsp;Unicode&nbsp;uppercase&nbsp;Metasploit&nbsp;pattern&nbsp;at&nbsp;position&nbsp;%d"</span>&nbsp;%&nbsp;(PatternPos))<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;g_typeofsploit=<span style="color:#ff0044;font-weight:400">3</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;g_offset=PatternPos<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;previousentry=tohex(chainentry[<span style="color:#ff0044;font-weight:400">1</span>])<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pos=pos+<span style="color:#ff0044;font-weight:400">1</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;nrofentries&nbsp;==&nbsp;<span style="color:#ff0044;font-weight:400">1</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#0088ff;font-weight:400">#only&nbsp;one&nbsp;entry,&nbsp;so&nbsp;read&nbsp;one&nbsp;from&nbsp;chainentry,&nbsp;other&nbsp;from&nbsp;stack</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;thisaddr=tohex(chainentry[<span style="color:#ff0044;font-weight:400">1</span>])<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;(thisaddr[<span style="color:#ff0044;font-weight:400">0</span>]==<span style="color:#3ad900;font-weight:400">"0"</span>&nbsp;<span style="color:#ff9d00;font-weight:700">and</span>&nbsp;thisaddr[<span style="color:#ff0044;font-weight:400">1</span>]==<span style="color:#3ad900;font-weight:400">"0"</span>&nbsp;<span style="color:#ff9d00;font-weight:700">and</span>&nbsp;thisaddr[<span style="color:#ff0044;font-weight:400">4</span>]==<span style="color:#3ad900;font-weight:400">"0"</span>&nbsp;<span style="color:#ff9d00;font-weight:700">and</span>&nbsp;thisaddr[<span style="color:#ff0044;font-weight:400">5</span>]==<span style="color:#3ad900;font-weight:400">"0"</span>):<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#0088ff;font-weight:400">#SE&nbsp;Handler&nbsp;is&nbsp;unicode.&nbsp;Read&nbsp;previous&nbsp;4&nbsp;bytes&nbsp;too</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;nsehaddress=chainentry[<span style="color:#ff0044;font-weight:400">0</span>]<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;nsehvalue=imm.readMemory(nsehaddress,<span style="color:#ff0044;font-weight:400">4</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;b1=toascii(imm,thisaddr[<span style="color:#ff0044;font-weight:400">6</span>]+thisaddr[<span style="color:#ff0044;font-weight:400">7</span>])<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;b2=toascii(imm,thisaddr[<span style="color:#ff0044;font-weight:400">2</span>]+thisaddr[<span style="color:#ff0044;font-weight:400">3</span>])<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ascuni=nsehvalue[<span style="color:#ff0044;font-weight:400">0</span>]&nbsp;+&nbsp;nsehvalue[<span style="color:#ff0044;font-weight:400">2</span>]&nbsp;+&nbsp;b1&nbsp;+&nbsp;b2<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;ascuni&nbsp;<span style="color:#ff9d00;font-weight:700">in</span>&nbsp;mspattern:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PatternPos&nbsp;=&nbsp;mspattern.find(ascuni)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;g_typeofsploit=<span style="color:#ff0044;font-weight:400">3</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;g_offset=PatternPos<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;-&nbsp;SEH&nbsp;Chain&nbsp;overwritten&nbsp;with&nbsp;unicode&nbsp;pattern&nbsp;%s&nbsp;:"</span>&nbsp;%&nbsp;ascuni)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NSEH&nbsp;overwritten&nbsp;after&nbsp;%d&nbsp;bytes"</span>&nbsp;%&nbsp;(PatternPos))<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SE&nbsp;Handler&nbsp;overwritten&nbsp;2&nbsp;bytes&nbsp;after&nbsp;(offset&nbsp;%d&nbsp;-&nbsp;expanded&nbsp;to&nbsp;unicode,&nbsp;this&nbsp;becomes&nbsp;4&nbsp;bytes)&nbsp;"</span>&nbsp;%&nbsp;(PatternPos+<span style="color:#ff0044;font-weight:400">2</span>))<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;&nbsp;&nbsp;Evaluated&nbsp;%d&nbsp;SEH&nbsp;entries"</span>&nbsp;%&nbsp;nrofentries)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">else</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;<span style="color:#ff9d00;font-weight:700">len</span>(args)&nbsp;==&nbsp;<span style="color:#ff0044;font-weight:400">2</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#0088ff;font-weight:400">#do&nbsp;pattern_offset&nbsp;search</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pattern_offset(args[<span style="color:#ff0044;font-weight:400">1</span>],<span style="color:#ff0044;font-weight:400">8000</span>,imm)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"-------------------------------------------------------------------------"</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;args[<span style="color:#ff0044;font-weight:400">0</span>]&nbsp;==&nbsp;<span style="color:#3ad900;font-weight:400">"findmsp"</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">return</span>&nbsp;<span style="color:#3ad900;font-weight:400">"Done"</span><br /><br /><br />&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;args[<span style="color:#ff0044;font-weight:400">0</span>]&nbsp;==&nbsp;<span style="color:#3ad900;font-weight:400">"suggest"</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"Exploit&nbsp;payload&nbsp;information&nbsp;and&nbsp;suggestions&nbsp;:"</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"---------------------------------------------"</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;g_typeofsploit==<span style="color:#ff0044;font-weight:400">0</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;[+]&nbsp;Sorry,&nbsp;you'll&nbsp;have&nbsp;to&nbsp;analyse&nbsp;this&nbsp;vulnerability&nbsp;manually"</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;g_typeofsploit==<span style="color:#ff0044;font-weight:400">1</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;[+]&nbsp;Type&nbsp;of&nbsp;exploit&nbsp;:&nbsp;Direct&nbsp;RET&nbsp;overwrite&nbsp;(EIP&nbsp;is&nbsp;overwritten)"</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Offset&nbsp;to&nbsp;direct&nbsp;RET&nbsp;:&nbsp;%d&nbsp;"</span>&nbsp;%&nbsp;g_offset)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;[+]&nbsp;Payload&nbsp;found&nbsp;at&nbsp;%s&nbsp;"</span>&nbsp;%&nbsp;g_jumpreg)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Offset&nbsp;to&nbsp;register&nbsp;:&nbsp;%d&nbsp;"</span>&nbsp;%&nbsp;g_regpos)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;[+]&nbsp;Payload&nbsp;suggestion&nbsp;(perl)&nbsp;:"</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;g_regpos&nbsp;&gt;&nbsp;g_offset:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my&nbsp;$junk="\\x41"&nbsp;x&nbsp;%d;&nbsp;'</span>&nbsp;%&nbsp;g_offset)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;g_regoff==<span style="color:#3ad900;font-weight:400">""</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my&nbsp;$ret&nbsp;=&nbsp;XXXXXXXX;&nbsp;#jump&nbsp;to&nbsp;%s&nbsp;-&nbsp;run&nbsp;&nbsp;!pvefindaddr&nbsp;j&nbsp;-r&nbsp;%s&nbsp;-n&nbsp;&nbsp;to&nbsp;find&nbsp;an&nbsp;address'</span>&nbsp;%&nbsp;(g_jumpreg,g_jumpreg))<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">else</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my&nbsp;$ret&nbsp;=&nbsp;XXXXXXXX;&nbsp;#jump&nbsp;to&nbsp;%s+%s&nbsp;-&nbsp;run&nbsp;&nbsp;!pvefindaddr&nbsp;jo&nbsp;-r&nbsp;%s&nbsp;-n&nbsp;to&nbsp;find&nbsp;an&nbsp;address'</span>&nbsp;%&nbsp;(g_jumpreg,g_regoff,g_jumpreg))<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;posdiff=<span style="color:#ff9d00;font-weight:700">int</span>(g_regpos)-<span style="color:#ff9d00;font-weight:700">int</span>(g_offset)-<span style="color:#ff0044;font-weight:400">4</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;posdiff&nbsp;&gt;&nbsp;<span style="color:#ff0044;font-weight:400">0</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my&nbsp;$padding&nbsp;=&nbsp;"\\x90"&nbsp;x&nbsp;%d;&nbsp;'</span>&nbsp;%&nbsp;posdiff)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my&nbsp;$shellcode="&lt;your&nbsp;shellcode&nbsp;here&gt;";'</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my&nbsp;$payload=$junk.$ret.$padding.$shellcode;'</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">else</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my&nbsp;$shellcode="&lt;your&nbsp;shellcode&nbsp;here&gt;";'</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my&nbsp;$payload=$junk.$ret.$shellcode;'</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">else</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my&nbsp;$junk="\\x41"&nbsp;x&nbsp;%d;&nbsp;'</span>&nbsp;%&nbsp;g_regpos)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;maxbytes=<span style="color:#ff9d00;font-weight:700">int</span>(g_offset)-<span style="color:#ff9d00;font-weight:700">int</span>(g_regpos)-<span style="color:#ff0044;font-weight:400">4</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my&nbsp;$shellcode="&lt;your&nbsp;shellcode&nbsp;here,&nbsp;max&nbsp;%d&nbsp;bytes&gt;";'</span>&nbsp;%&nbsp;maxbytes)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my&nbsp;$morejunk="\\x90"&nbsp;x&nbsp;(%d-length($shellcode));'</span>&nbsp;%&nbsp;maxbytes)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my&nbsp;$ret&nbsp;=&nbsp;XXXXXXXX;&nbsp;#jump&nbsp;to&nbsp;%s&nbsp;-&nbsp;run&nbsp;&nbsp;!pvefindaddr&nbsp;j&nbsp;-r&nbsp;%s&nbsp;-n&nbsp;&nbsp;to&nbsp;find&nbsp;an&nbsp;address'</span>&nbsp;%&nbsp;(g_jumpreg,g_jumpreg))<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my&nbsp;$payload&nbsp;=&nbsp;$junk.$shellcode.$morejunk.$ret;'</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">'&nbsp;[+]&nbsp;Read&nbsp;more&nbsp;about&nbsp;this&nbsp;type&nbsp;of&nbsp;exploit&nbsp;at'</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;http://www.corelan.be:8800/index.php/2009/07/19/exploit-writing-tutorial-part-1-stack-based-overflows/'</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;g_typeofsploit==<span style="color:#ff0044;font-weight:400">2</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;[+]&nbsp;Type&nbsp;of&nbsp;exploit&nbsp;:&nbsp;SEH&nbsp;(SE&nbsp;Handler&nbsp;is&nbsp;overwritten)"</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;nseh=<span style="color:#ff9d00;font-weight:700">int</span>(g_offset)-<span style="color:#ff0044;font-weight:400">4</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Offset&nbsp;to&nbsp;next&nbsp;SEH&nbsp;:&nbsp;%d&nbsp;"</span>&nbsp;%&nbsp;nseh)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Offset&nbsp;to&nbsp;SE&nbsp;Handler&nbsp;:&nbsp;%d&nbsp;"</span>&nbsp;%&nbsp;g_offset)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;[+]&nbsp;Payload&nbsp;suggestion&nbsp;(perl)&nbsp;:"</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my&nbsp;$junk="\\x41"&nbsp;x&nbsp;%d;&nbsp;'</span>&nbsp;%&nbsp;nseh)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my&nbsp;$nseh="\\xeb\\x06\\x90\\x90";'</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my&nbsp;$seh=&nbsp;XXXXXXXX;&nbsp;&nbsp;#pop&nbsp;pop&nbsp;ret&nbsp;-&nbsp;use&nbsp;!pvefindaddr&nbsp;p&nbsp;-n&nbsp;&nbsp;&nbsp;&nbsp;to&nbsp;find&nbsp;a&nbsp;suitable&nbsp;address'</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my&nbsp;$nops="\\x90"&nbsp;x&nbsp;24;'</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my&nbsp;$shellcode="&lt;your&nbsp;shellcode&nbsp;here&gt;";'</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my&nbsp;$payload&nbsp;=&nbsp;$junk.$nseh.$seh.$nops.$shellcode;'</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">'&nbsp;[+]&nbsp;Read&nbsp;more&nbsp;about&nbsp;this&nbsp;type&nbsp;of&nbsp;exploit&nbsp;at&nbsp;'</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;http://www.corelan.be:8800/index.php/2009/07/25/writing-buffer-overflow-exploits-a-quick-and-basic-tutorial-part-3-seh/'</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;g_typeofsploit==<span style="color:#ff0044;font-weight:400">3</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;[+]&nbsp;Type&nbsp;of&nbsp;exploit&nbsp;:&nbsp;SEH&nbsp;Unicode&nbsp;(SE&nbsp;Handler&nbsp;is&nbsp;overwritten&nbsp;with&nbsp;Unicode&nbsp;pattern"</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Offset&nbsp;to&nbsp;next&nbsp;SEH&nbsp;:&nbsp;%d&nbsp;"</span>&nbsp;%&nbsp;g_offset)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;[+]&nbsp;Payload&nbsp;suggestion&nbsp;(perl)&nbsp;:"</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my&nbsp;$junk="\\x41"&nbsp;x&nbsp;%d;&nbsp;'</span>&nbsp;%&nbsp;g_offset)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my&nbsp;$nseh=\\x??\\x??;&nbsp;&nbsp;#find&nbsp;2&nbsp;instructions&nbsp;that,&nbsp;when&nbsp;converted&nbsp;to&nbsp;\\x??\\x00\\x??\\x00&nbsp;will&nbsp;not&nbsp;do&nbsp;any&nbsp;harm'</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my&nbsp;$seh=&nbsp;\\x??\\x??;&nbsp;&nbsp;#find&nbsp;pop&nbsp;pop&nbsp;ret&nbsp;(Unicode&nbsp;compatible).&nbsp;use&nbsp;&nbsp;!pvefindaddr&nbsp;p&nbsp;&nbsp;to&nbsp;find&nbsp;a&nbsp;suitable&nbsp;address'</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my&nbsp;$padding&nbsp;=&nbsp;....&nbsp;;&nbsp;&nbsp;#write&nbsp;venetian&nbsp;code&nbsp;to&nbsp;point&nbsp;a&nbsp;register&nbsp;to&nbsp;the&nbsp;beginning&nbsp;of&nbsp;the&nbsp;shellcode'</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my&nbsp;$jmp&nbsp;=&nbsp;"\\x50\\x6d\\xc3";&nbsp;&nbsp;#write&nbsp;venetion&nbsp;code&nbsp;to&nbsp;jump&nbsp;to&nbsp;the&nbsp;register&nbsp;(example&nbsp;shown&nbsp;here&nbsp;=&nbsp;push&nbsp;eax&nbsp;+&nbsp;ret)'</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my&nbsp;$shellcode="XXXXXXXXXXXX...";&nbsp;&nbsp;#venetian&nbsp;shellcode'</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my&nbsp;$payload=$junk.$nseh.$seh.$padding.$jmp.$shellcode;'</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">'&nbsp;[+]&nbsp;Read&nbsp;more&nbsp;about&nbsp;this&nbsp;type&nbsp;of&nbsp;exploit&nbsp;at&nbsp;'</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;http://www.corelan.be:8800/index.php/2009/11/06/exploit-writing-tutorial-part-7-unicode-from-0x00410041-to-calc/'</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"---------------------------------------------------------------"</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">return</span>&nbsp;<span style="color:#3ad900;font-weight:400">"Done"</span><br /><br /><br />&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;args[<span style="color:#ff0044;font-weight:400">0</span>]&nbsp;==&nbsp;<span style="color:#3ad900;font-weight:400">"update"</span>&nbsp;<span style="color:#ff9d00;font-weight:700">or</span>&nbsp;args[<span style="color:#ff0044;font-weight:400">0</span>]==<span style="color:#3ad900;font-weight:400">"selfupdate"</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;updatetype&nbsp;=&nbsp;<span style="color:#3ad900;font-weight:400">"release"</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;(__VERSION__.find(<span style="color:#3ad900;font-weight:400">"dev"</span>)&nbsp;&gt;&nbsp;-<span style="color:#ff0044;font-weight:400">1</span>):<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;updatetype=&nbsp;<span style="color:#3ad900;font-weight:400">"trunk"</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;<span style="color:#ff9d00;font-weight:700">len</span>(args)&nbsp;&gt;&nbsp;<span style="color:#ff0044;font-weight:400">1</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;args[<span style="color:#ff0044;font-weight:400">1</span>].lower()&nbsp;==&nbsp;<span style="color:#3ad900;font-weight:400">"get"</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;getupdate(imm,updatetype)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">else</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;findupdate(imm)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">else</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;args[<span style="color:#ff0044;font-weight:400">0</span>]==<span style="color:#3ad900;font-weight:400">"update"</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;findupdate(imm)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;args[<span style="color:#ff0044;font-weight:400">0</span>]==<span style="color:#3ad900;font-weight:400">"selfupdate"</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;getupdate(imm,updatetype)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">return</span>&nbsp;<span style="color:#3ad900;font-weight:400">"Done&nbsp;checking&nbsp;for&nbsp;updates"</span><br /><br /><br />&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;args[<span style="color:#ff0044;font-weight:400">0</span>]&nbsp;==&nbsp;<span style="color:#3ad900;font-weight:400">"compare"</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;<span style="color:#ff9d00;font-weight:700">len</span>(args)&nbsp;&gt;&nbsp;<span style="color:#ff0044;font-weight:400">1</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;filename=<span style="color:#3ad900;font-weight:400">"compare.txt"</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;resetfile(filename)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"---------------------------------------------"</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;Compare&nbsp;memory&nbsp;with&nbsp;bytes&nbsp;in&nbsp;file"</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"---------------------------------------------"</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;Reading&nbsp;file&nbsp;%s&nbsp;(ascii)..."</span>&nbsp;%&nbsp;args[<span style="color:#ff0044;font-weight:400">1</span>])<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;os.path.isfile(args[<span style="color:#ff0044;font-weight:400">1</span>]):<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">try</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;srcdata=[]<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tagresults=[]<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;srcfile&nbsp;=&nbsp;<span style="color:#ff9d00;font-weight:700">open</span>(args[<span style="color:#ff0044;font-weight:400">1</span>],<span style="color:#3ad900;font-weight:400">"rb"</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;content&nbsp;=&nbsp;srcfile.readlines()<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;srcfile.close()<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">for</span>&nbsp;eachLine&nbsp;<span style="color:#ff9d00;font-weight:700">in</span>&nbsp;content:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;srcdata&nbsp;+=&nbsp;eachLine<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;Read&nbsp;%d&nbsp;bytes&nbsp;from&nbsp;file"</span>&nbsp;%&nbsp;<span style="color:#ff9d00;font-weight:700">len</span>(srcdata))<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cnt=<span style="color:#ff0044;font-weight:400">0</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;maxcnt=<span style="color:#ff9d00;font-weight:700">len</span>(srcdata)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;startat=<span style="color:#3ad900;font-weight:400">""</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;(maxcnt&nbsp;&lt;&nbsp;<span style="color:#ff0044;font-weight:400">8</span>):<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;File&nbsp;contains&nbsp;less&nbsp;than&nbsp;8&nbsp;bytes&nbsp;!"</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;<span style="color:#ff9d00;font-weight:700">len</span>(args)&nbsp;==&nbsp;<span style="color:#ff0044;font-weight:400">3</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;(<span style="color:#ff9d00;font-weight:700">len</span>(args[<span style="color:#ff0044;font-weight:400">2</span>])&nbsp;==&nbsp;<span style="color:#ff0044;font-weight:400">10</span>):<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;startat=args[<span style="color:#ff0044;font-weight:400">2</span>].replace(<span style="color:#3ad900;font-weight:400">"0x"</span>,<span style="color:#3ad900;font-weight:400">""</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;startat=startat.replace(<span style="color:#3ad900;font-weight:400">"0X"</span>,<span style="color:#3ad900;font-weight:400">""</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">else</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;startat=args[<span style="color:#ff0044;font-weight:400">2</span>]<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;Compare&nbsp;will&nbsp;only&nbsp;look&nbsp;at&nbsp;address&nbsp;%s&nbsp;"</span>&nbsp;%&nbsp;startat)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">else</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;Starting&nbsp;search&nbsp;in&nbsp;memory"</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;linecount=<span style="color:#ff0044;font-weight:400">0</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">while</span>&nbsp;(cnt&nbsp;&lt;&nbsp;maxcnt):<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">try</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#0088ff;font-weight:400">#group&nbsp;per&nbsp;8&nbsp;bytes&nbsp;to&nbsp;get&nbsp;first&nbsp;line&nbsp;with&nbsp;8&nbsp;bytes&nbsp;(tag&nbsp;to&nbsp;search&nbsp;for)</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;btcnt=<span style="color:#ff0044;font-weight:400">0</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;hexstr=<span style="color:#3ad900;font-weight:400">""</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">while</span>&nbsp;((btcnt&nbsp;&lt;&nbsp;<span style="color:#ff0044;font-weight:400">8</span>)&nbsp;<span style="color:#ff9d00;font-weight:700">and</span>&nbsp;(cnt&nbsp;&lt;&nbsp;maxcnt)):<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;<span style="color:#ff9d00;font-weight:700">len</span>((<span style="color:#ff9d00;font-weight:700">hex</span>(<span style="color:#ff9d00;font-weight:700">ord</span>(srcdata[cnt]))).replace(<span style="color:#3ad900;font-weight:400">'0x'</span>,<span style="color:#3ad900;font-weight:400">''</span>))==<span style="color:#ff0044;font-weight:400">1</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;hexchar=<span style="color:#ff9d00;font-weight:700">hex</span>(<span style="color:#ff9d00;font-weight:700">ord</span>(srcdata[cnt])).replace(<span style="color:#3ad900;font-weight:400">'0x'</span>,&nbsp;<span style="color:#3ad900;font-weight:400">'\\x0'</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">else</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;hexchar&nbsp;=&nbsp;<span style="color:#ff9d00;font-weight:700">hex</span>(<span style="color:#ff9d00;font-weight:700">ord</span>(srcdata[cnt])).replace(<span style="color:#3ad900;font-weight:400">'0x'</span>,&nbsp;<span style="color:#3ad900;font-weight:400">'\\x'</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;hexstr&nbsp;+=&nbsp;hexchar<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;btcnt=btcnt+<span style="color:#ff0044;font-weight:400">1</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cnt=cnt+<span style="color:#ff0044;font-weight:400">1</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;linecount=linecount+<span style="color:#ff0044;font-weight:400">1</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;((linecount&nbsp;==&nbsp;<span style="color:#ff0044;font-weight:400">1</span>)&nbsp;<span style="color:#ff9d00;font-weight:700">and</span>&nbsp;(startat&nbsp;==&nbsp;<span style="color:#3ad900;font-weight:400">""</span>)):<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;&nbsp;&nbsp;-&gt;&nbsp;searching&nbsp;for&nbsp;"</span>+hexstr)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;toSearch&nbsp;=&nbsp;hexstr.replace(<span style="color:#3ad900;font-weight:400">"&nbsp;"</span>,<span style="color:#3ad900;font-weight:400">'\\x'</span>).decode(<span style="color:#3ad900;font-weight:400">'string_escape'</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;toSearch&nbsp;=&nbsp;toSearch.decode(<span style="color:#3ad900;font-weight:400">'string_escape'</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tagresults=imm.search(&nbsp;toSearch&nbsp;)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;(<span style="color:#ff9d00;font-weight:700">len</span>(tagresults)&nbsp;==&nbsp;<span style="color:#ff0044;font-weight:400">0</span>):<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;Could&nbsp;not&nbsp;find&nbsp;code&nbsp;in&nbsp;memory&nbsp;!"</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">return</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">except</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cnt=cnt+<span style="color:#ff0044;font-weight:400">1</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">pass</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;Comparing&nbsp;bytes&nbsp;from&nbsp;file&nbsp;with&nbsp;memory&nbsp;:"</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;comparetable=imm.createTable(<span style="color:#3ad900;font-weight:400">'pvefindaddr&nbsp;Memory&nbsp;comparison&nbsp;results'</span>,[<span style="color:#3ad900;font-weight:400">'Address'</span>,<span style="color:#3ad900;font-weight:400">'Status'</span>,<span style="color:#3ad900;font-weight:400">'Type'</span>])<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">for</span>&nbsp;tres&nbsp;<span style="color:#ff9d00;font-weight:700">in</span>&nbsp;tagresults:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;memcompare(imm,tohex(tres),srcdata,comparetable,<span style="color:#3ad900;font-weight:400">"ascii"</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;(startat&nbsp;&lt;&gt;&nbsp;<span style="color:#3ad900;font-weight:400">""</span>):<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;memcompare(imm,startat,srcdata,comparetable,<span style="color:#3ad900;font-weight:400">"ascii"</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">except</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;**&nbsp;Unable&nbsp;to&nbsp;read&nbsp;file&nbsp;**"</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">""</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">""</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;Reading&nbsp;file&nbsp;%s&nbsp;(expanding&nbsp;to&nbsp;unicode)..."</span>&nbsp;%&nbsp;args[<span style="color:#ff0044;font-weight:400">1</span>])<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">try</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;srcdata=[]<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tagresults=[]<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;srcfile&nbsp;=&nbsp;<span style="color:#ff9d00;font-weight:700">open</span>(args[<span style="color:#ff0044;font-weight:400">1</span>],<span style="color:#3ad900;font-weight:400">"rb"</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;content&nbsp;=&nbsp;srcfile.readlines()<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;srcfile.close()<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">for</span>&nbsp;eachLine&nbsp;<span style="color:#ff9d00;font-weight:700">in</span>&nbsp;content:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;srcdata&nbsp;+=&nbsp;eachLine<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;Read&nbsp;%d&nbsp;bytes&nbsp;from&nbsp;file"</span>&nbsp;%&nbsp;<span style="color:#ff9d00;font-weight:700">len</span>(srcdata))<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;Expanding&nbsp;to&nbsp;unicode"</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;unisrcdata=[]<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;nullbyte=<span style="color:#3ad900;font-weight:400">"0"</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">for</span>&nbsp;eachByte&nbsp;<span style="color:#ff9d00;font-weight:700">in</span>&nbsp;srcdata:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;eachByte+=struct.pack(<span style="color:#3ad900;font-weight:400">'B'</span>,&nbsp;<span style="color:#ff0044;font-weight:400">0</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;unisrcdata+=eachByte<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;srcdata=unisrcdata<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cnt=<span style="color:#ff0044;font-weight:400">0</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;maxcnt=<span style="color:#ff9d00;font-weight:700">len</span>(srcdata)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;Unicode&nbsp;expanded&nbsp;to&nbsp;%d&nbsp;bytes"</span>&nbsp;%&nbsp;maxcnt)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;startat=<span style="color:#3ad900;font-weight:400">""</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;(maxcnt&nbsp;&lt;&nbsp;<span style="color:#ff0044;font-weight:400">16</span>):<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;File&nbsp;contains&nbsp;less&nbsp;than&nbsp;16&nbsp;bytes&nbsp;!"</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;<span style="color:#ff9d00;font-weight:700">len</span>(args)&nbsp;==&nbsp;<span style="color:#ff0044;font-weight:400">3</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;(<span style="color:#ff9d00;font-weight:700">len</span>(args[<span style="color:#ff0044;font-weight:400">2</span>])&nbsp;==&nbsp;<span style="color:#ff0044;font-weight:400">10</span>):<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;startat=args[<span style="color:#ff0044;font-weight:400">2</span>].replace(<span style="color:#3ad900;font-weight:400">"0x"</span>,<span style="color:#3ad900;font-weight:400">""</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;startat=startat.replace(<span style="color:#3ad900;font-weight:400">"0X"</span>,<span style="color:#3ad900;font-weight:400">""</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">else</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;startat=args[<span style="color:#ff0044;font-weight:400">2</span>]<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;Compare&nbsp;will&nbsp;only&nbsp;look&nbsp;at&nbsp;address&nbsp;%s&nbsp;"</span>&nbsp;%&nbsp;startat)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">else</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;Starting&nbsp;search&nbsp;in&nbsp;memory"</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;linecount=<span style="color:#ff0044;font-weight:400">0</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">while</span>&nbsp;(cnt&nbsp;&lt;&nbsp;maxcnt):<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">try</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#0088ff;font-weight:400">#group&nbsp;per&nbsp;16&nbsp;bytes&nbsp;to&nbsp;get&nbsp;first&nbsp;line&nbsp;with&nbsp;16&nbsp;bytes&nbsp;(tag&nbsp;to&nbsp;search&nbsp;for)</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;btcnt=<span style="color:#ff0044;font-weight:400">0</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;hexstr=<span style="color:#3ad900;font-weight:400">""</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">while</span>&nbsp;((btcnt&nbsp;&lt;&nbsp;<span style="color:#ff0044;font-weight:400">16</span>)&nbsp;<span style="color:#ff9d00;font-weight:700">and</span>&nbsp;(cnt&nbsp;&lt;&nbsp;maxcnt)):<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;<span style="color:#ff9d00;font-weight:700">len</span>((<span style="color:#ff9d00;font-weight:700">hex</span>(<span style="color:#ff9d00;font-weight:700">ord</span>(srcdata[cnt]))).replace(<span style="color:#3ad900;font-weight:400">'0x'</span>,<span style="color:#3ad900;font-weight:400">''</span>))==<span style="color:#ff0044;font-weight:400">1</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;hexchar=<span style="color:#ff9d00;font-weight:700">hex</span>(<span style="color:#ff9d00;font-weight:700">ord</span>(srcdata[cnt])).replace(<span style="color:#3ad900;font-weight:400">'0x'</span>,&nbsp;<span style="color:#3ad900;font-weight:400">'\\x0'</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">else</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;hexchar&nbsp;=&nbsp;<span style="color:#ff9d00;font-weight:700">hex</span>(<span style="color:#ff9d00;font-weight:700">ord</span>(srcdata[cnt])).replace(<span style="color:#3ad900;font-weight:400">'0x'</span>,&nbsp;<span style="color:#3ad900;font-weight:400">'\\x'</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;hexstr&nbsp;+=&nbsp;hexchar<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;btcnt=btcnt+<span style="color:#ff0044;font-weight:400">1</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cnt=cnt+<span style="color:#ff0044;font-weight:400">1</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;linecount=linecount+<span style="color:#ff0044;font-weight:400">1</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;((linecount&nbsp;==&nbsp;<span style="color:#ff0044;font-weight:400">1</span>)&nbsp;<span style="color:#ff9d00;font-weight:700">and</span>&nbsp;(startat&nbsp;==&nbsp;<span style="color:#3ad900;font-weight:400">""</span>)):<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;&nbsp;&nbsp;-&gt;&nbsp;searching&nbsp;for&nbsp;"</span>+hexstr)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;toSearch&nbsp;=&nbsp;hexstr.replace(<span style="color:#3ad900;font-weight:400">"&nbsp;"</span>,<span style="color:#3ad900;font-weight:400">'\\x'</span>).decode(<span style="color:#3ad900;font-weight:400">'string_escape'</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;toSearch&nbsp;=&nbsp;toSearch.decode(<span style="color:#3ad900;font-weight:400">'string_escape'</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tagresults=imm.search(&nbsp;toSearch&nbsp;)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;(<span style="color:#ff9d00;font-weight:700">len</span>(tagresults)&nbsp;==&nbsp;<span style="color:#ff0044;font-weight:400">0</span>):<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;Could&nbsp;not&nbsp;find&nbsp;code&nbsp;in&nbsp;memory&nbsp;!"</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">return</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">except</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cnt=cnt+<span style="color:#ff0044;font-weight:400">1</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">pass</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;Comparing&nbsp;bytes&nbsp;from&nbsp;file&nbsp;with&nbsp;memory&nbsp;:"</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">for</span>&nbsp;tres&nbsp;<span style="color:#ff9d00;font-weight:700">in</span>&nbsp;tagresults:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;memcompare(imm,tohex(tres),srcdata,comparetable,<span style="color:#3ad900;font-weight:400">"unicode"</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;(startat&nbsp;&lt;&gt;&nbsp;<span style="color:#3ad900;font-weight:400">""</span>):<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;memcompare(imm,startat,srcdata,comparetable,<span style="color:#3ad900;font-weight:400">"unicode"</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">except</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;**&nbsp;Unable&nbsp;to&nbsp;read&nbsp;file&nbsp;**"</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">else</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;**************************&nbsp;"</span>,highlight=<span style="color:#ff0044;font-weight:400">1</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;**&nbsp;File&nbsp;does&nbsp;not&nbsp;exist&nbsp;!**&nbsp;"</span>,highlight=<span style="color:#ff0044;font-weight:400">1</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;**************************&nbsp;"</span>,highlight=<span style="color:#ff0044;font-weight:400">1</span>)<br /><br /><br />&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;args[<span style="color:#ff0044;font-weight:400">0</span>]&nbsp;==&nbsp;<span style="color:#3ad900;font-weight:400">"peb"</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#0088ff;font-weight:400">#find&nbsp;peb</span><br />		<span style="color:#0088ff;font-weight:400">#structure&nbsp;http://undocumented.ntinternals.net/UserMode/Undocumented%20Functions/NT%20Objects/Process/PEB.html</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">""</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PEB&nbsp;=&nbsp;imm.getPEBaddress()<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;PEB&nbsp;==&nbsp;<span style="color:#ff0044;font-weight:400">0</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"No&nbsp;PEB"</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">else</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"PEB&nbsp;at&nbsp;0x%08x"</span>&nbsp;%&nbsp;PEB,address=PEB)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ias&nbsp;=&nbsp;tocontent(imm.readMemory(PEB+<span style="color:#ff0044;font-weight:400">0x0</span>,<span style="color:#ff0044;font-weight:400">1</span>))<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;(ias	==&nbsp;<span style="color:#3ad900;font-weight:400">"00"</span>):<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;iasstr=<span style="color:#3ad900;font-weight:400">"No"</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">else</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;iasstr=<span style="color:#3ad900;font-weight:400">"Yes"</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;&nbsp;InheritedAddressSpace:&nbsp;%s"</span>&nbsp;%&nbsp;iasstr)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rifeo&nbsp;=&nbsp;tocontent(imm.readMemory(PEB+<span style="color:#ff0044;font-weight:400">0x1</span>,<span style="color:#ff0044;font-weight:400">1</span>))<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;(rifeo&nbsp;==&nbsp;<span style="color:#3ad900;font-weight:400">"00"</span>):<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rifeostr=<span style="color:#3ad900;font-weight:400">"No"</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">else</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rifeostr=<span style="color:#3ad900;font-weight:400">"Yes"</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;&nbsp;ReadImageFileExecOptions:&nbsp;%s&nbsp;"</span>&nbsp;%&nbsp;rifeostr)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;bd&nbsp;=&nbsp;tocontent(imm.readMemory(PEB+<span style="color:#ff0044;font-weight:400">0x2</span>,<span style="color:#ff0044;font-weight:400">1</span>))<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;(bd&nbsp;==&nbsp;<span style="color:#3ad900;font-weight:400">"00"</span>):<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;bdstr&nbsp;=<span style="color:#3ad900;font-weight:400">"No"</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">else</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;bdstr&nbsp;=<span style="color:#3ad900;font-weight:400">"Yes"</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;&nbsp;BeingDebugged:&nbsp;%s"</span>&nbsp;%&nbsp;bdstr)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;spare&nbsp;=&nbsp;tocontent(imm.readMemory(PEB+<span style="color:#ff0044;font-weight:400">0x3</span>,<span style="color:#ff0044;font-weight:400">1</span>))<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;(spare&nbsp;==&nbsp;<span style="color:#3ad900;font-weight:400">"00"</span>):<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sparestr&nbsp;=<span style="color:#3ad900;font-weight:400">"No"</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">else</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sparestr&nbsp;=<span style="color:#3ad900;font-weight:400">"Yes"</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;&nbsp;Spare:&nbsp;%s"</span>&nbsp;%&nbsp;sparestr)<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;hmutant&nbsp;=&nbsp;tocontent(imm.readMemory(PEB+<span style="color:#ff0044;font-weight:400">0x4</span>,<span style="color:#ff0044;font-weight:400">4</span>))<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;&nbsp;Handle:&nbsp;%s"</span>&nbsp;%&nbsp;(hmutant))<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ba&nbsp;=&nbsp;tocontent(imm.readMemory(PEB+<span style="color:#ff0044;font-weight:400">0x8</span>,<span style="color:#ff0044;font-weight:400">4</span>))<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;&nbsp;ImageBaseAddress:&nbsp;%s"</span>&nbsp;%&nbsp;(ba))<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ldr&nbsp;=&nbsp;tocontent(imm.readMemory(PEB+<span style="color:#ff0044;font-weight:400">0xc</span>,<span style="color:#ff0044;font-weight:400">4</span>))<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;&nbsp;Ldr:&nbsp;%s"</span>&nbsp;%&nbsp;ldr)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#0088ff;font-weight:400">#imm.log("&nbsp;&nbsp;Ldr.Initialized:")</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#0088ff;font-weight:400">#imm.log("&nbsp;&nbsp;Ldr.InInitializationOrderModuleList:&nbsp;")</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#0088ff;font-weight:400">#imm.log("&nbsp;&nbsp;Ldr.InLoadOrderModuleList:")</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#0088ff;font-weight:400">#imm.log("&nbsp;&nbsp;Ldr.InMemoryOrderModuleList:")</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#0088ff;font-weight:400">#modules</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;allmodules=imm.getAllModules()<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Base&nbsp;&nbsp;Size&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Module"</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">for</span>&nbsp;key&nbsp;<span style="color:#ff9d00;font-weight:700">in</span>&nbsp;allmodules.keys():<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mod=imm.getModule(key)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mzbase=mod.getBaseAddress()<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;&nbsp;&nbsp;&nbsp;0x%08x&nbsp;&nbsp;%d&nbsp;&nbsp;%s"</span>&nbsp;%&nbsp;(mzbase,mod.getSize(),mod.getPath()))<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ssd&nbsp;=&nbsp;tocontent(imm.readMemory(PEB+<span style="color:#ff0044;font-weight:400">0x14</span>,<span style="color:#ff0044;font-weight:400">4</span>))<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;&nbsp;SubSystemData:&nbsp;%s"</span>&nbsp;%&nbsp;ssd)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ph&nbsp;=&nbsp;tocontent(imm.readMemory(PEB+<span style="color:#ff0044;font-weight:400">0x18</span>,<span style="color:#ff0044;font-weight:400">4</span>))<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;&nbsp;ProcessHeap:&nbsp;%s"</span>&nbsp;%&nbsp;ph)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pp&nbsp;=&nbsp;tocontent(imm.readMemory(PEB+<span style="color:#ff0044;font-weight:400">0x10</span>,<span style="color:#ff0044;font-weight:400">4</span>))<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;&nbsp;ProcessParameters:&nbsp;%s"</span>&nbsp;%&nbsp;pp)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">""</span>)<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;(args[<span style="color:#ff0044;font-weight:400">0</span>]&nbsp;==&nbsp;<span style="color:#3ad900;font-weight:400">"assemble"</span>):<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"Opcode&nbsp;results&nbsp;:&nbsp;"</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"----------------&nbsp;"</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cnt=<span style="color:#ff0044;font-weight:400">1</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cmdInput=<span style="color:#3ad900;font-weight:400">""</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;allopcode=<span style="color:#3ad900;font-weight:400">""</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;encodecmd=<span style="color:#3ad900;font-weight:400">""</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;encodebad=<span style="color:#3ad900;font-weight:400">""</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;curpos=<span style="color:#ff0044;font-weight:400">0</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">while</span>&nbsp;(cnt&nbsp;&lt;&nbsp;<span style="color:#ff9d00;font-weight:700">len</span>(args)):<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;(args[cnt].lower()&nbsp;==&nbsp;<span style="color:#3ad900;font-weight:400">"encode"</span>):<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;curpos=cnt<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cnt=<span style="color:#ff9d00;font-weight:700">len</span>(args)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">else</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cmdInput=cmdInput+args[cnt]+<span style="color:#3ad900;font-weight:400">"&nbsp;"</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cnt=cnt+<span style="color:#ff0044;font-weight:400">1</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;curpos&nbsp;&gt;&nbsp;<span style="color:#ff0044;font-weight:400">0</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;curpos==<span style="color:#ff9d00;font-weight:700">len</span>(args)-<span style="color:#ff0044;font-weight:400">1</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;encodecmd=<span style="color:#3ad900;font-weight:400">"ascii"</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;curpos==<span style="color:#ff9d00;font-weight:700">len</span>(args)-<span style="color:#ff0044;font-weight:400">2</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;encodecmd=args[curpos+<span style="color:#ff0044;font-weight:400">1</span>]<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;curpos==<span style="color:#ff9d00;font-weight:700">len</span>(args)-<span style="color:#ff0044;font-weight:400">3</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;encodecmd=args[curpos+<span style="color:#ff0044;font-weight:400">1</span>]<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;encodebad=args[curpos+<span style="color:#ff0044;font-weight:400">2</span>]<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cmdInput=cmdInput.replace(<span style="color:#3ad900;font-weight:400">"'"</span>,<span style="color:#3ad900;font-weight:400">""</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cmdInput=cmdInput.replace(<span style="color:#3ad900;font-weight:400">'"'</span>,<span style="color:#3ad900;font-weight:400">''</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;splitter=re.compile(<span style="color:#3ad900;font-weight:400">'#'</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;instructions=splitter.split(cmdInput)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">for</span>&nbsp;instruct&nbsp;<span style="color:#ff9d00;font-weight:700">in</span>&nbsp;instructions:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">try</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assembled=imm.assemble(&nbsp;instruct&nbsp;)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;strAssembled=<span style="color:#3ad900;font-weight:400">""</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">for</span>&nbsp;assemOpc&nbsp;<span style="color:#ff9d00;font-weight:700">in</span>&nbsp;assembled:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;(<span style="color:#ff9d00;font-weight:700">len</span>(<span style="color:#ff9d00;font-weight:700">hex</span>(<span style="color:#ff9d00;font-weight:700">ord</span>(assemOpc))))&nbsp;==&nbsp;<span style="color:#ff0044;font-weight:400">3</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;subAssembled&nbsp;=&nbsp;<span style="color:#3ad900;font-weight:400">"\\x0"</span>+<span style="color:#ff9d00;font-weight:700">hex</span>(<span style="color:#ff9d00;font-weight:700">ord</span>(assemOpc)).replace(<span style="color:#3ad900;font-weight:400">'0x'</span>,<span style="color:#3ad900;font-weight:400">''</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;strAssembled&nbsp;=&nbsp;strAssembled+subAssembled<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">else</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;strAssembled&nbsp;=&nbsp;&nbsp;strAssembled+<span style="color:#ff9d00;font-weight:700">hex</span>(<span style="color:#ff9d00;font-weight:700">ord</span>(assemOpc)).replace(<span style="color:#3ad900;font-weight:400">'0x'</span>,&nbsp;<span style="color:#3ad900;font-weight:400">'\\x'</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;<span style="color:#ff9d00;font-weight:700">len</span>(strAssembled)&nbsp;&lt;&nbsp;<span style="color:#ff0044;font-weight:400">30</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;%s&nbsp;=&nbsp;%s"</span>&nbsp;%&nbsp;(instruct,strAssembled))<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;allopcode=allopcode+strAssembled<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">else</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;%s&nbsp;=&gt;&nbsp;Unable&nbsp;to&nbsp;assemble&nbsp;this&nbsp;instruction&nbsp;!"</span>&nbsp;%&nbsp;instruct,highlight=<span style="color:#ff0044;font-weight:400">1</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">except</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;&nbsp;&nbsp;Could&nbsp;not&nbsp;assemble&nbsp;%s&nbsp;"</span>&nbsp;%&nbsp;instruct)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">pass</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;Full&nbsp;opcode&nbsp;:&nbsp;%s&nbsp;"</span>&nbsp;%&nbsp;allopcode)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;(encodecmd&nbsp;!=&nbsp;<span style="color:#3ad900;font-weight:400">""</span>):<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;Invoking&nbsp;encoder..."</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">""</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;encodeargs=[]<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;encodeargs.append(<span style="color:#3ad900;font-weight:400">"doencode"</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;encodeargs.append(encodecmd)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;encodeargs.append(allopcode.replace(<span style="color:#3ad900;font-weight:400">'\\x'</span>,<span style="color:#3ad900;font-weight:400">''</span>))<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;encodeargs.append(encodebad)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;doencode(encodeargs)<br /><br /><br />&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;args[<span style="color:#ff0044;font-weight:400">0</span>]&nbsp;==&nbsp;<span style="color:#3ad900;font-weight:400">"offset"</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;endaddr=[]<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;<span style="color:#ff9d00;font-weight:700">len</span>(args)&nbsp;==&nbsp;<span style="color:#ff0044;font-weight:400">3</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;regs&nbsp;=&nbsp;imm.getRegs()<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;startaddr=args[<span style="color:#ff0044;font-weight:400">1</span>]<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;startreg=<span style="color:#3ad900;font-weight:400">""</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;startregname=<span style="color:#3ad900;font-weight:400">""</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;endaddr.append(args[<span style="color:#ff0044;font-weight:400">2</span>])<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;endreg=<span style="color:#3ad900;font-weight:400">""</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;regaction=<span style="color:#3ad900;font-weight:400">""</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;(<span style="color:#ff9d00;font-weight:700">len</span>(startaddr)==<span style="color:#ff0044;font-weight:400">3</span>):<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#0088ff;font-weight:400">#perhaps&nbsp;this&nbsp;is&nbsp;a&nbsp;register</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#0088ff;font-weight:400">#get&nbsp;the&nbsp;value&nbsp;of&nbsp;the&nbsp;register</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">for</span>&nbsp;reg&nbsp;<span style="color:#ff9d00;font-weight:700">in</span>&nbsp;regs:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;reg.upper()&nbsp;==&nbsp;startaddr.upper():<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;startaddr=tohex(regs[reg])<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;startreg=<span style="color:#3ad900;font-weight:400">"&nbsp;("</span>+reg+<span style="color:#3ad900;font-weight:400">")"</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;startregname=reg<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;(<span style="color:#ff9d00;font-weight:700">len</span>(endaddr[<span style="color:#ff0044;font-weight:400">0</span>])==<span style="color:#ff0044;font-weight:400">3</span>):<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#0088ff;font-weight:400">#perhaps&nbsp;this&nbsp;is&nbsp;a&nbsp;register</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#0088ff;font-weight:400">#get&nbsp;the&nbsp;value&nbsp;of&nbsp;the&nbsp;register</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">for</span>&nbsp;reg&nbsp;<span style="color:#ff9d00;font-weight:700">in</span>&nbsp;regs:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;reg.upper()&nbsp;==&nbsp;endaddr[<span style="color:#ff0044;font-weight:400">0</span>].upper():<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;endaddr[<span style="color:#ff0044;font-weight:400">0</span>]=tohex(regs[reg])<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;endreg=<span style="color:#3ad900;font-weight:400">"&nbsp;("</span>+reg+<span style="color:#3ad900;font-weight:400">")"</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;(<span style="color:#ff9d00;font-weight:700">len</span>(endaddr[<span style="color:#ff0044;font-weight:400">0</span>])==<span style="color:#ff0044;font-weight:400">16</span>):<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#0088ff;font-weight:400">#search&nbsp;pattern</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;strb=binascii.a2b_hex(endaddr[<span style="color:#ff0044;font-weight:400">0</span>])<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;opcodej=[strb]<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;-&nbsp;Trying&nbsp;to&nbsp;locate&nbsp;custom&nbsp;search&nbsp;pattern,&nbsp;please&nbsp;wait..."</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.updateLog()<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">for</span>&nbsp;opjc&nbsp;<span style="color:#ff9d00;font-weight:700">in</span>&nbsp;opcodej:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;addys=imm.search(&nbsp;opjc&nbsp;)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;results&nbsp;+=&nbsp;addys<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;nrres=<span style="color:#ff0044;font-weight:400">0</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;results:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;nrres=<span style="color:#ff9d00;font-weight:700">len</span>(results)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;-&nbsp;Number&nbsp;of&nbsp;locations&nbsp;found&nbsp;:&nbsp;%d"</span>&nbsp;%&nbsp;nrres)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">del</span>&nbsp;endaddr[<span style="color:#ff0044;font-weight:400">0</span>]<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">for</span>&nbsp;res&nbsp;<span style="color:#ff9d00;font-weight:700">in</span>&nbsp;results:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;endaddr.append(tohex(res))<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">try</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">for</span>&nbsp;endad&nbsp;<span style="color:#ff9d00;font-weight:700">in</span>&nbsp;endaddr:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"[+]&nbsp;Calculating&nbsp;offset&nbsp;between&nbsp;%s%s&nbsp;and&nbsp;%s%s"</span>&nbsp;%&nbsp;(startaddr,startreg,endad,endreg))<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;val1=addresstoint(startaddr)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;val2=addresstoint(endad)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;diff=<span style="color:#ff0044;font-weight:400">0</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;val1&nbsp;&gt;&nbsp;val2:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;diff=val1-val2<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">else</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;diff=val2-val1<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;result=tohex(diff)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;&nbsp;&nbsp;&nbsp;-&gt;&nbsp;Offset&nbsp;:&nbsp;%d&nbsp;bytes&nbsp;(0x%s)"</span>&nbsp;%&nbsp;(diff,result))<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;val1&nbsp;&gt;&nbsp;val2:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Warning&nbsp;:&nbsp;negative&nbsp;offset,&nbsp;so&nbsp;backward&nbsp;jump&nbsp;needed!"</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;negjmp=tohex(<span style="color:#ff0044;font-weight:400">4294967296</span>-diff)&nbsp;&nbsp;<span style="color:#0088ff;font-weight:400">#=(FFFFFFFF+1)&nbsp;-&nbsp;value</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;negjmpbytes=<span style="color:#3ad900;font-weight:400">"\\x"</span>+&nbsp;negjmp[<span style="color:#ff0044;font-weight:400">6</span>]+negjmp[<span style="color:#ff0044;font-weight:400">7</span>]+<span style="color:#3ad900;font-weight:400">"\\x"</span>+negjmp[<span style="color:#ff0044;font-weight:400">4</span>]+negjmp[<span style="color:#ff0044;font-weight:400">5</span>]+<span style="color:#3ad900;font-weight:400">"\\x"</span>+negjmp[<span style="color:#ff0044;font-weight:400">2</span>]+negjmp[<span style="color:#ff0044;font-weight:400">3</span>]+<span style="color:#3ad900;font-weight:400">"\\x"</span>+negjmp[<span style="color:#ff0044;font-weight:400">0</span>]+negjmp[<span style="color:#ff0044;font-weight:400">1</span>]<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Jump&nbsp;offset&nbsp;:&nbsp;%s"</span>&nbsp;%&nbsp;negjmpbytes)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;regaction=<span style="color:#3ad900;font-weight:400">"sub"</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">else</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;result[<span style="color:#ff0044;font-weight:400">0</span>]==<span style="color:#3ad900;font-weight:400">"0"</span>&nbsp;<span style="color:#ff9d00;font-weight:700">and</span>&nbsp;result[<span style="color:#ff0044;font-weight:400">1</span>]==<span style="color:#3ad900;font-weight:400">"0"</span>&nbsp;<span style="color:#ff9d00;font-weight:700">and</span>&nbsp;result[<span style="color:#ff0044;font-weight:400">2</span>]==<span style="color:#3ad900;font-weight:400">"0"</span>&nbsp;<span style="color:#ff9d00;font-weight:700">and</span>&nbsp;result[<span style="color:#ff0044;font-weight:400">3</span>]==<span style="color:#3ad900;font-weight:400">"0"</span>&nbsp;<span style="color:#ff9d00;font-weight:700">and</span>&nbsp;result[<span style="color:#ff0044;font-weight:400">4</span>]==<span style="color:#3ad900;font-weight:400">"0"</span>&nbsp;<span style="color:#ff9d00;font-weight:700">and</span>&nbsp;result[<span style="color:#ff0044;font-weight:400">5</span>]==<span style="color:#3ad900;font-weight:400">"0"</span>:<br />						&nbsp;&nbsp;&nbsp;&nbsp;posjmpbytes=<span style="color:#3ad900;font-weight:400">"\\x"</span>+result[<span style="color:#ff0044;font-weight:400">6</span>]+result[<span style="color:#ff0044;font-weight:400">7</span>]<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">else</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;posjmpbytes=<span style="color:#3ad900;font-weight:400">"\\x"</span>+&nbsp;result[<span style="color:#ff0044;font-weight:400">6</span>]+result[<span style="color:#ff0044;font-weight:400">7</span>]+<span style="color:#3ad900;font-weight:400">"\\x"</span>+result[<span style="color:#ff0044;font-weight:400">4</span>]+result[<span style="color:#ff0044;font-weight:400">5</span>]+<span style="color:#3ad900;font-weight:400">"\\x"</span>+result[<span style="color:#ff0044;font-weight:400">2</span>]+result[<span style="color:#ff0044;font-weight:400">3</span>]+<span style="color:#3ad900;font-weight:400">"\\x"</span>+result[<span style="color:#ff0044;font-weight:400">0</span>]+result[<span style="color:#ff0044;font-weight:400">1</span>]<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Jump&nbsp;offset&nbsp;:&nbsp;%s"</span>&nbsp;%&nbsp;posjmpbytes)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;regaction=<span style="color:#3ad900;font-weight:400">"add"</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;strTotalOpcode=<span style="color:#3ad900;font-weight:400">""</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;startregname&nbsp;!=&nbsp;<span style="color:#3ad900;font-weight:400">""</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;strAsm=regaction+<span style="color:#3ad900;font-weight:400">"&nbsp;"</span>+startregname+<span style="color:#3ad900;font-weight:400">","</span>+result<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;strToAsm=[]<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;strToAsm.append(strAsm)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;strToAsm.append(<span style="color:#3ad900;font-weight:400">"jmp&nbsp;"</span>&nbsp;+&nbsp;startregname)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">for</span>&nbsp;strAsmThis&nbsp;<span style="color:#ff9d00;font-weight:700">in</span>&nbsp;strToAsm:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assembled=imm.Assemble(&nbsp;strAsmThis&nbsp;)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;strAssembled=<span style="color:#3ad900;font-weight:400">""</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">for</span>&nbsp;assemOpc&nbsp;<span style="color:#ff9d00;font-weight:700">in</span>&nbsp;assembled:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;(<span style="color:#ff9d00;font-weight:700">len</span>(<span style="color:#ff9d00;font-weight:700">hex</span>(<span style="color:#ff9d00;font-weight:700">ord</span>(assemOpc))))&nbsp;==&nbsp;<span style="color:#ff0044;font-weight:400">3</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;subAssembled&nbsp;=&nbsp;<span style="color:#3ad900;font-weight:400">"\\x0"</span>+<span style="color:#ff9d00;font-weight:700">hex</span>(<span style="color:#ff9d00;font-weight:700">ord</span>(assemOpc)).replace(<span style="color:#3ad900;font-weight:400">'0x'</span>,<span style="color:#3ad900;font-weight:400">''</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;strAssembled&nbsp;=&nbsp;strAssembled+subAssembled<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">else</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;strAssembled&nbsp;=&nbsp;&nbsp;strAssembled+<span style="color:#ff9d00;font-weight:700">hex</span>(<span style="color:#ff9d00;font-weight:700">ord</span>(assemOpc)).replace(<span style="color:#3ad900;font-weight:400">'0x'</span>,&nbsp;<span style="color:#3ad900;font-weight:400">'\\x'</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Assembly&nbsp;:&nbsp;%s,&nbsp;Opcode&nbsp;:&nbsp;%s"</span>&nbsp;%&nbsp;(strAsmThis.lower(),strAssembled))<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;strTotalOpcode=strTotalOpcode+strAssembled<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Full&nbsp;opcode&nbsp;:&nbsp;"</span>&nbsp;+&nbsp;strTotalOpcode)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">""</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">except</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;!!&nbsp;Unable&nbsp;to&nbsp;calculate&nbsp;offset.&nbsp;Verify&nbsp;input&nbsp;and&nbsp;try&nbsp;again"</span>)<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;(args[<span style="color:#ff0044;font-weight:400">0</span>]&nbsp;==&nbsp;<span style="color:#3ad900;font-weight:400">"encode"</span>):<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;doencode(args)<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;(args[<span style="color:#ff0044;font-weight:400">0</span>]&nbsp;==&nbsp;<span style="color:#3ad900;font-weight:400">"info"</span>):<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;addr=<span style="color:#3ad900;font-weight:400">""</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;addrname=<span style="color:#3ad900;font-weight:400">""</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;<span style="color:#ff9d00;font-weight:700">len</span>(args)&nbsp;&gt;&nbsp;<span style="color:#ff0044;font-weight:400">1</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;(<span style="color:#ff9d00;font-weight:700">len</span>(args[<span style="color:#ff0044;font-weight:400">1</span>])&nbsp;==&nbsp;<span style="color:#ff0044;font-weight:400">10</span>):<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;addr=args[<span style="color:#ff0044;font-weight:400">1</span>].replace(<span style="color:#3ad900;font-weight:400">"0x"</span>,<span style="color:#3ad900;font-weight:400">""</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;addr=addr.replace(<span style="color:#3ad900;font-weight:400">"0X"</span>,<span style="color:#3ad900;font-weight:400">""</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">else</span>:<br />			&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#0088ff;font-weight:400">#check&nbsp;if&nbsp;it&nbsp;is&nbsp;a&nbsp;register</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;regs&nbsp;=&nbsp;imm.getRegs()<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">for</span>&nbsp;reg&nbsp;<span style="color:#ff9d00;font-weight:700">in</span>&nbsp;regs:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;reg.upper()&nbsp;==&nbsp;args[<span style="color:#ff0044;font-weight:400">1</span>].upper():<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;addr=tohex(regs[reg])<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;addrname=<span style="color:#3ad900;font-weight:400">"&nbsp;("</span>+reg+<span style="color:#3ad900;font-weight:400">")"</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;addr==<span style="color:#3ad900;font-weight:400">""</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;addr=args[<span style="color:#ff0044;font-weight:400">1</span>]<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"Information&nbsp;about&nbsp;address&nbsp;%s%s&nbsp;:&nbsp;"</span>&nbsp;%&nbsp;(addr,addrname))<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(addressinfo(addresstoint(addr)))<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(addressspec(addr))<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">try</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;op&nbsp;=&nbsp;imm.Disasm(&nbsp;addresstoint(addr)&nbsp;)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;opstring=op.getDisasm()<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"Instruction&nbsp;at&nbsp;%s&nbsp;:&nbsp;%s"</span>&nbsp;%&nbsp;(addr,opstring))<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">except</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">pass</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">else</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"You&nbsp;forgot&nbsp;to&nbsp;specify&nbsp;an&nbsp;address&nbsp;or&nbsp;register"</span>)<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>(args[<span style="color:#ff0044;font-weight:400">0</span>]&nbsp;==&nbsp;<span style="color:#3ad900;font-weight:400">"find"</span>):<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dofind(imm,args,modulefilter)<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>(args[<span style="color:#ff0044;font-weight:400">0</span>]&nbsp;==&nbsp;<span style="color:#3ad900;font-weight:400">"fd"</span>):<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;filename=<span style="color:#3ad900;font-weight:400">"fd.txt"</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;resetfile(filename)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;writemodinfo(filename)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;startaddr=<span style="color:#ff0044;font-weight:400">1</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;found=<span style="color:#ff0044;font-weight:400">0</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;allownull=<span style="color:#ff0044;font-weight:400">0</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;doread=<span style="color:#ff0044;font-weight:400">1</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;<span style="color:#ff9d00;font-weight:700">len</span>(args)==<span style="color:#ff0044;font-weight:400">2</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;args[<span style="color:#ff0044;font-weight:400">1</span>].lower()==<span style="color:#3ad900;font-weight:400">"allownull"</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;allownull=<span style="color:#ff0044;font-weight:400">1</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"Started&nbsp;looking&nbsp;for&nbsp;addresses,&nbsp;please&nbsp;wait..."</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.updateLog()<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;maxval=<span style="color:#ff0044;font-weight:400">2147483645</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">while</span>&nbsp;((startaddr&nbsp;&lt;&nbsp;maxval)&nbsp;<span style="color:#ff9d00;font-weight:700">and</span>&nbsp;(found&nbsp;&lt;&nbsp;<span style="color:#ff0044;font-weight:400">10</span>)):<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;daddr=startaddr*<span style="color:#ff0044;font-weight:400">2</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">try</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;(allownull==<span style="color:#ff0044;font-weight:400">0</span>):<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;starta=tohex(startaddr)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dstarta=tohex(daddr)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;doread=<span style="color:#ff0044;font-weight:400">1</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;((starta[<span style="color:#ff0044;font-weight:400">0</span>]==<span style="color:#3ad900;font-weight:400">"0"</span>&nbsp;<span style="color:#ff9d00;font-weight:700">and</span>&nbsp;starta[<span style="color:#ff0044;font-weight:400">1</span>]==<span style="color:#3ad900;font-weight:400">"0"</span>)&nbsp;<span style="color:#ff9d00;font-weight:700">or</span>&nbsp;(starta[<span style="color:#ff0044;font-weight:400">2</span>]==<span style="color:#3ad900;font-weight:400">"0"</span>&nbsp;<span style="color:#ff9d00;font-weight:700">and</span>&nbsp;starta[<span style="color:#ff0044;font-weight:400">3</span>]==<span style="color:#3ad900;font-weight:400">"0"</span>)&nbsp;<span style="color:#ff9d00;font-weight:700">or</span>&nbsp;(starta[<span style="color:#ff0044;font-weight:400">4</span>]==<span style="color:#3ad900;font-weight:400">"0"</span>&nbsp;<span style="color:#ff9d00;font-weight:700">and</span>&nbsp;starta[<span style="color:#ff0044;font-weight:400">5</span>]==<span style="color:#3ad900;font-weight:400">"0"</span>)&nbsp;<span style="color:#ff9d00;font-weight:700">or</span>&nbsp;(starta[<span style="color:#ff0044;font-weight:400">6</span>]==<span style="color:#3ad900;font-weight:400">"0"</span>&nbsp;<span style="color:#ff9d00;font-weight:700">and</span>&nbsp;starta[<span style="color:#ff0044;font-weight:400">7</span>]==<span style="color:#3ad900;font-weight:400">"0"</span>)):<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;doread=<span style="color:#ff0044;font-weight:400">0</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;((dstarta[<span style="color:#ff0044;font-weight:400">0</span>]==<span style="color:#3ad900;font-weight:400">"0"</span>&nbsp;<span style="color:#ff9d00;font-weight:700">and</span>&nbsp;dstarta[<span style="color:#ff0044;font-weight:400">1</span>]==<span style="color:#3ad900;font-weight:400">"0"</span>)&nbsp;<span style="color:#ff9d00;font-weight:700">or</span>&nbsp;(dstarta[<span style="color:#ff0044;font-weight:400">2</span>]==<span style="color:#3ad900;font-weight:400">"0"</span>&nbsp;<span style="color:#ff9d00;font-weight:700">and</span>&nbsp;dstarta[<span style="color:#ff0044;font-weight:400">3</span>]==<span style="color:#3ad900;font-weight:400">"0"</span>)&nbsp;<span style="color:#ff9d00;font-weight:700">or</span>&nbsp;(dstarta[<span style="color:#ff0044;font-weight:400">4</span>]==<span style="color:#3ad900;font-weight:400">"0"</span>&nbsp;<span style="color:#ff9d00;font-weight:700">and</span>&nbsp;dstarta[<span style="color:#ff0044;font-weight:400">5</span>]==<span style="color:#3ad900;font-weight:400">"0"</span>)&nbsp;<span style="color:#ff9d00;font-weight:700">or</span>&nbsp;(dstarta[<span style="color:#ff0044;font-weight:400">6</span>]==<span style="color:#3ad900;font-weight:400">"0"</span>&nbsp;<span style="color:#ff9d00;font-weight:700">and</span>&nbsp;dstarta[<span style="color:#ff0044;font-weight:400">7</span>]==<span style="color:#3ad900;font-weight:400">"0"</span>)):<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;doread=<span style="color:#ff0044;font-weight:400">0</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">else</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;doread=<span style="color:#ff0044;font-weight:400">1</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;doread==<span style="color:#ff0044;font-weight:400">1</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.updateLog()<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;startval=imm.readMemory(startaddr,<span style="color:#ff0044;font-weight:400">4</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dval=imm.readMemory(daddr,<span style="color:#ff0044;font-weight:400">4</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;(startval&nbsp;&lt;&gt;&nbsp;<span style="color:#3ad900;font-weight:400">""</span>)&nbsp;<span style="color:#ff9d00;font-weight:700">and</span>&nbsp;(dval&nbsp;&lt;&gt;&nbsp;<span style="color:#3ad900;font-weight:400">""</span>):<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;extrastring1=addressinfo(startval)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;extrastring2=addressinfo(dval)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;Addresses&nbsp;found&nbsp;:"</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;&nbsp;&nbsp;Address&nbsp;:&nbsp;0x%08x&nbsp;%s"</span>&nbsp;%&nbsp;(startaddr,extrastring1))<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;&nbsp;&nbsp;Double&nbsp;of&nbsp;address&nbsp;:&nbsp;&nbsp;0x%08x&nbsp;%s"</span>&nbsp;%&nbsp;(daddr,extrastring2))<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tofile(<span style="color:#3ad900;font-weight:400">"Found&nbsp;2&nbsp;possible&nbsp;addresses&nbsp;:"</span>,filename)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tofile(<span style="color:#3ad900;font-weight:400">"&nbsp;&nbsp;&nbsp;-&nbsp;"</span>&nbsp;+&nbsp;tohex(startaddr)+<span style="color:#3ad900;font-weight:400">"&nbsp;"</span>+extrastring,filename)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tofile(<span style="color:#3ad900;font-weight:400">"&nbsp;&nbsp;&nbsp;-&nbsp;"</span>&nbsp;+&nbsp;tohex(daddr)+<span style="color:#3ad900;font-weight:400">"&nbsp;"</span>+extrastring,filename)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">""</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.updateLog()<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;found=found+<span style="color:#ff0044;font-weight:400">1</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;startaddr=startaddr+<span style="color:#ff0044;font-weight:400">1</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;nextaddr=tohex(startaddr)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;nextaddr[<span style="color:#ff0044;font-weight:400">4</span>]==<span style="color:#3ad900;font-weight:400">"0"</span>&nbsp;<span style="color:#ff9d00;font-weight:700">and</span>&nbsp;nextaddr[<span style="color:#ff0044;font-weight:400">5</span>]==<span style="color:#3ad900;font-weight:400">"0"</span>&nbsp;<span style="color:#ff9d00;font-weight:700">and</span>&nbsp;nextaddr[<span style="color:#ff0044;font-weight:400">6</span>]==<span style="color:#3ad900;font-weight:400">"0"</span>&nbsp;<span style="color:#ff9d00;font-weight:700">and</span>&nbsp;nextaddr[<span style="color:#ff0044;font-weight:400">7</span>]==<span style="color:#3ad900;font-weight:400">"0"</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"Progress&nbsp;update&nbsp;-&nbsp;reached&nbsp;address&nbsp;%s&nbsp;..."</span>&nbsp;%&nbsp;nextaddr)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.updateLog()<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">except</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.updateLog()<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;startaddr=startaddr+<span style="color:#ff0044;font-weight:400">1</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;nextaddr=tohex(startaddr)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;nextaddr[<span style="color:#ff0044;font-weight:400">4</span>]==<span style="color:#3ad900;font-weight:400">"0"</span>&nbsp;<span style="color:#ff9d00;font-weight:700">and</span>&nbsp;nextaddr[<span style="color:#ff0044;font-weight:400">5</span>]==<span style="color:#3ad900;font-weight:400">"0"</span>&nbsp;<span style="color:#ff9d00;font-weight:700">and</span>&nbsp;nextaddr[<span style="color:#ff0044;font-weight:400">6</span>]==<span style="color:#3ad900;font-weight:400">"0"</span>&nbsp;<span style="color:#ff9d00;font-weight:700">and</span>&nbsp;nextaddr[<span style="color:#ff0044;font-weight:400">7</span>]==<span style="color:#3ad900;font-weight:400">"0"</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"Progress&nbsp;update&nbsp;-&nbsp;reached&nbsp;address&nbsp;%s&nbsp;..."</span>&nbsp;%&nbsp;nextaddr)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.updateLog()<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">pass</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;found==<span style="color:#ff0044;font-weight:400">0</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"Sorry,&nbsp;no&nbsp;usable&nbsp;addresses&nbsp;found"</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">else</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"%d&nbsp;addresses&nbsp;found"</span>&nbsp;%&nbsp;found)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">return</span>&nbsp;<span style="color:#3ad900;font-weight:400">"Search&nbsp;complete,&nbsp;%d&nbsp;pointers&nbsp;found"</span>&nbsp;%&nbsp;found<br /><br /><br />&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>(args[<span style="color:#ff0044;font-weight:400">0</span>]&nbsp;==&nbsp;<span style="color:#3ad900;font-weight:400">"rop"</span>):<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;filename=<span style="color:#3ad900;font-weight:400">"rop.txt"</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;stackpivotfile=<span style="color:#3ad900;font-weight:400">"rop_stackpivot.txt"</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;progressid=tohex(imm.getDebuggedPid())<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;progressfile=<span style="color:#3ad900;font-weight:400">"_rop_progress_"</span>+imm.getDebuggedName()+<span style="color:#3ad900;font-weight:400">"_"</span>+progressid+<span style="color:#3ad900;font-weight:400">".log"</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"-----------------------"</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;ROP&nbsp;Gadget&nbsp;generation"</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"-----------------------"</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"[+]&nbsp;ROP&nbsp;progress&nbsp;will&nbsp;be&nbsp;written&nbsp;to&nbsp;%s"</span>&nbsp;%&nbsp;progressfile)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.updateLog()<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;resetfile(progressfile)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;resetfile(stackpivotfile)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tofile(<span style="color:#3ad900;font-weight:400">"-------------------------------------------"</span>,stackpivotfile)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tofile(<span style="color:#3ad900;font-weight:400">"Possibly&nbsp;interesting&nbsp;stack&nbsp;pivot&nbsp;pointers&nbsp;:"</span>,stackpivotfile)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tofile(<span style="color:#3ad900;font-weight:400">"-------------------------------------------"</span>,stackpivotfile)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;thistimestamp=datetime.datetime.now().strftime(<span style="color:#3ad900;font-weight:400">"%a&nbsp;%Y/%m/%d&nbsp;%I:%M:%S&nbsp;%p"</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tofile(<span style="color:#3ad900;font-weight:400">"ROP&nbsp;Gadget&nbsp;generation&nbsp;process&nbsp;started&nbsp;at&nbsp;"</span>&nbsp;+&nbsp;thistimestamp+<span style="color:#3ad900;font-weight:400">"\n"</span>,progressfile)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;<span style="color:#ff9d00;font-weight:700">len</span>(g_modules)==<span style="color:#ff0044;font-weight:400">0</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;moduleinfo()<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;instrfilter=<span style="color:#3ad900;font-weight:400">"&nbsp;"</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;opcodej=[]<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mbase=<span style="color:#ff0044;font-weight:400">0</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;maxretval=<span style="color:#ff0044;font-weight:400">32</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mutations=<span style="color:#ff0044;font-weight:400">0</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;goodgadgets=<span style="color:#ff0044;font-weight:400">0</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dosplit=<span style="color:#ff0044;font-weight:400">0</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dodeep=<span style="color:#ff0044;font-weight:400">0</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ignorefixup=<span style="color:#ff0044;font-weight:400">0</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;customendwith=<span style="color:#3ad900;font-weight:400">""</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;argstr=<span style="color:#3ad900;font-weight:400">""</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cnt=<span style="color:#ff0044;font-weight:400">1</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">while</span>&nbsp;cnt&nbsp;&lt;&nbsp;<span style="color:#ff9d00;font-weight:700">len</span>(args):<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;args[cnt]==<span style="color:#3ad900;font-weight:400">'-f'</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;cnt&nbsp;&lt;&nbsp;(<span style="color:#ff9d00;font-weight:700">len</span>(args)-<span style="color:#ff0044;font-weight:400">1</span>):<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;instrfilter=args[cnt+<span style="color:#ff0044;font-weight:400">1</span>]<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;args[cnt]==<span style="color:#3ad900;font-weight:400">'-r'</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;cnt&nbsp;&lt;&nbsp;(<span style="color:#ff9d00;font-weight:700">len</span>(args)-<span style="color:#ff0044;font-weight:400">1</span>):<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;maxretval=<span style="color:#ff9d00;font-weight:700">int</span>(args[cnt+<span style="color:#ff0044;font-weight:400">1</span>])<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;args[cnt]==<span style="color:#3ad900;font-weight:400">'-s'</span>:	dosplit=<span style="color:#ff0044;font-weight:400">1</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;args[cnt]==<span style="color:#3ad900;font-weight:400">'-d'</span>:&nbsp;dodeep=<span style="color:#ff0044;font-weight:400">1</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;args[cnt]==<span style="color:#3ad900;font-weight:400">'-i'</span>:&nbsp;ignorefixup=<span style="color:#ff0044;font-weight:400">1</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;args[cnt]==<span style="color:#3ad900;font-weight:400">'-c'</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cnt2=cnt<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">while</span>&nbsp;cnt2&nbsp;&lt;&nbsp;(<span style="color:#ff9d00;font-weight:700">len</span>(args)-<span style="color:#ff0044;font-weight:400">1</span>):<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;args[cnt2+<span style="color:#ff0044;font-weight:400">1</span>][:<span style="color:#ff0044;font-weight:400">1</span>]&nbsp;&lt;&gt;&nbsp;<span style="color:#3ad900;font-weight:400">"-"</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;customendwith=customendwith+<span style="color:#3ad900;font-weight:400">"&nbsp;"</span>+args[cnt2+<span style="color:#ff0044;font-weight:400">1</span>].upper()<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cnt2=cnt2+<span style="color:#ff0044;font-weight:400">1</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cnt=cnt+<span style="color:#ff0044;font-weight:400">1</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;customendwith=customendwith.strip()<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cinstrparts=customendwith.split(<span style="color:#3ad900;font-weight:400">'#'</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;customendwith&nbsp;&lt;&gt;&nbsp;<span style="color:#3ad900;font-weight:400">""</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"[+]&nbsp;You&nbsp;have&nbsp;specified&nbsp;%d&nbsp;custom&nbsp;gadget&nbsp;end&nbsp;instruction(s)&nbsp;:&nbsp;%s"</span>&nbsp;%&nbsp;(<span style="color:#ff9d00;font-weight:700">len</span>(cinstrparts),customendwith))<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;modulefilter&nbsp;&lt;&gt;&nbsp;<span style="color:#3ad900;font-weight:400">""</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;dosplit==<span style="color:#ff0044;font-weight:400">1</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"[+]&nbsp;You&nbsp;have&nbsp;specified&nbsp;a&nbsp;module&nbsp;filter&nbsp;and&nbsp;enabled&nbsp;'split'&nbsp;(-s)"</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;&nbsp;&nbsp;&nbsp;Split&nbsp;functionality&nbsp;won't&nbsp;make&nbsp;a&nbsp;difference,&nbsp;so&nbsp;option&nbsp;has&nbsp;been&nbsp;removed&nbsp;again"</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dosplit=<span style="color:#ff0044;font-weight:400">0</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;(noos==<span style="color:#ff0044;font-weight:400">1</span>):<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"[+]&nbsp;Module&nbsp;filter&nbsp;and&nbsp;option&nbsp;to&nbsp;exclude&nbsp;OS&nbsp;dll's&nbsp;set.&nbsp;If&nbsp;module&nbsp;is&nbsp;an&nbsp;OS&nbsp;dll,&nbsp;it&nbsp;will&nbsp;not&nbsp;be&nbsp;excluded"</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"[+]&nbsp;Finding&nbsp;module&nbsp;that&nbsp;starts&nbsp;with&nbsp;%s"</span>&nbsp;%&nbsp;modulefilter)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">for</span>&nbsp;mname&nbsp;<span style="color:#ff9d00;font-weight:700">in</span>&nbsp;g_modules:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mnamentry=mname.split(<span style="color:#3ad900;font-weight:400">'\t'</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;mnamentry[<span style="color:#ff0044;font-weight:400">0</span>].lower().startswith(modulefilter.lower()):<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mfound=<span style="color:#ff0044;font-weight:400">1</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;modulefilter=mnamentry[<span style="color:#ff0044;font-weight:400">0</span>].lower()<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mbase=<span style="color:#ff9d00;font-weight:700">int</span>(mnamentry[<span style="color:#ff0044;font-weight:400">2</span>])<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mtop=<span style="color:#ff9d00;font-weight:700">int</span>(mnamentry[<span style="color:#ff0044;font-weight:400">4</span>])<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;isaslr=<span style="color:#ff9d00;font-weight:700">int</span>(mnamentry[<span style="color:#ff0044;font-weight:400">6</span>])<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;isfixup=<span style="color:#ff9d00;font-weight:700">int</span>(mnamentry[<span style="color:#ff0044;font-weight:400">8</span>])<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;modversion=mnamentry[<span style="color:#ff0044;font-weight:400">9</span>]<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;filename=getropfilename(modulefilter)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;customendwith&nbsp;==&nbsp;<span style="color:#3ad900;font-weight:400">""</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;opcodej.append(<span style="color:#3ad900;font-weight:400">"RET\n"</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">else</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;inscnt=<span style="color:#ff0044;font-weight:400">0</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">while</span>&nbsp;inscnt&nbsp;&lt;&nbsp;<span style="color:#ff9d00;font-weight:700">len</span>(cinstrparts):<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;opcodej.append(cinstrparts[inscnt].strip().upper())<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;inscnt=inscnt+<span style="color:#ff0044;font-weight:400">1</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;dosplit==<span style="color:#ff0044;font-weight:400">0</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;resetfile(filename)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;writemodinfo(filename)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"[+]&nbsp;Preparing&nbsp;log&nbsp;file&nbsp;%s"</span>&nbsp;%&nbsp;filename)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tofile(<span style="color:#3ad900;font-weight:400">"-"</span>&nbsp;*&nbsp;<span style="color:#ff0044;font-weight:400">80</span>,filename)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tofile(<span style="color:#3ad900;font-weight:400">"&nbsp;ROP&nbsp;gadgets&nbsp;-&nbsp;Relatively&nbsp;safe/basic&nbsp;instructions&nbsp;"</span>,filename)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tofile(<span style="color:#3ad900;font-weight:400">"-"</span>&nbsp;*&nbsp;<span style="color:#ff0044;font-weight:400">80</span>,filename)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tofile(<span style="color:#3ad900;font-weight:400">""</span>,filename)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">else</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#0088ff;font-weight:400">#create&nbsp;individual&nbsp;files</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">for</span>&nbsp;mname&nbsp;<span style="color:#ff9d00;font-weight:700">in</span>&nbsp;g_modules:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mnamentry=mname.split(<span style="color:#3ad900;font-weight:400">'\t'</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;modname=mnamentry[<span style="color:#ff0044;font-weight:400">0</span>]<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;modname.upper().find(modulefilter.upper())&nbsp;&gt;=&nbsp;<span style="color:#ff0044;font-weight:400">0</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;(noos==<span style="color:#ff0044;font-weight:400">0</span>)&nbsp;<span style="color:#ff9d00;font-weight:700">or</span>&nbsp;(noos==<span style="color:#ff0044;font-weight:400">1</span>&nbsp;<span style="color:#ff9d00;font-weight:700">and</span>&nbsp;isosmodule(modname)==<span style="color:#ff0044;font-weight:400">0</span>):<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;thisfilename=getropfilename(modname)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"[+]&nbsp;Preparing&nbsp;log&nbsp;file&nbsp;%s"</span>&nbsp;%&nbsp;thisfilename)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tofile(<span style="color:#3ad900;font-weight:400">"Preparing&nbsp;log&nbsp;file&nbsp;"</span>&nbsp;+&nbsp;thisfilename,progressfile)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.updateLog()<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;resetfile(thisfilename)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;writemodinfo(thisfilename)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tofile(<span style="color:#3ad900;font-weight:400">"-"</span>&nbsp;*&nbsp;<span style="color:#ff0044;font-weight:400">80</span>,thisfilename)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tofile(<span style="color:#3ad900;font-weight:400">"&nbsp;ROP&nbsp;gadgets&nbsp;-&nbsp;Relatively&nbsp;safe/basic&nbsp;instructions&nbsp;"</span>,thisfilename)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tofile(<span style="color:#3ad900;font-weight:400">"-"</span>&nbsp;*&nbsp;<span style="color:#ff0044;font-weight:400">80</span>,thisfilename)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tofile(<span style="color:#3ad900;font-weight:400">""</span>,thisfilename)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;c1=<span style="color:#ff0044;font-weight:400">2</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.updateLog()<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;customendwith==<span style="color:#3ad900;font-weight:400">""</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">while</span>&nbsp;c1&nbsp;&lt;=&nbsp;maxretval:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;opcodej.append(<span style="color:#3ad900;font-weight:400">"RET&nbsp;"</span>&nbsp;+&nbsp;tohexbyte(c1)+<span style="color:#3ad900;font-weight:400">"\n"</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;c1=c1+<span style="color:#ff0044;font-weight:400">2</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;aslrfilt=<span style="color:#3ad900;font-weight:400">"ASLR:&nbsp;**&nbsp;NO"</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fixupfilt=<span style="color:#3ad900;font-weight:400">"FIXUP:&nbsp;**&nbsp;NO"</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;isfixup=<span style="color:#ff0044;font-weight:400">0</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.updateLog()<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;isaslr=<span style="color:#ff0044;font-weight:400">0</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mfound=<span style="color:#ff0044;font-weight:400">0</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;modversion=<span style="color:#3ad900;font-weight:400">""</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;(dodeep==<span style="color:#ff0044;font-weight:400">1</span>):<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"[+]&nbsp;Deep&nbsp;search&nbsp;enabled.&nbsp;Possibly&nbsp;interesting&nbsp;gadgets&nbsp;will&nbsp;be&nbsp;written&nbsp;to&nbsp;%s"</span>&nbsp;%&nbsp;filename)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;(noos==<span style="color:#ff0044;font-weight:400">1</span>):<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"[+]&nbsp;Dll's&nbsp;residing&nbsp;in&nbsp;the&nbsp;Windows&nbsp;folder&nbsp;will&nbsp;be&nbsp;excluded."</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;(dosplit==<span style="color:#ff0044;font-weight:400">0</span>):<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tofile(<span style="color:#3ad900;font-weight:400">"&nbsp;[+]&nbsp;Excluding&nbsp;dll's&nbsp;from&nbsp;Windows&nbsp;folder"</span>,filename)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;(ignorefixup==<span style="color:#ff0044;font-weight:400">1</span>):<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tofile(<span style="color:#3ad900;font-weight:400">"&nbsp;[+]&nbsp;Excluding&nbsp;pointers&nbsp;from&nbsp;modules&nbsp;that&nbsp;have&nbsp;fixup&nbsp;flag&nbsp;set"</span>,filename)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"[+]&nbsp;Excluding&nbsp;pointers&nbsp;from&nbsp;modules&nbsp;that&nbsp;have&nbsp;fixup&nbsp;flag&nbsp;set"</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;modulefilter&nbsp;&lt;&gt;&nbsp;<span style="color:#3ad900;font-weight:400">""</span>&nbsp;<span style="color:#ff9d00;font-weight:700">and</span>&nbsp;mbase&nbsp;&gt;&nbsp;<span style="color:#ff0044;font-weight:400">0</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"[+]&nbsp;Module&nbsp;filter&nbsp;set&nbsp;to&nbsp;'%s',&nbsp;at&nbsp;baseaddress&nbsp;0x%s"</span>&nbsp;%&nbsp;(modulefilter,tohex(mbase)))<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tofile(<span style="color:#3ad900;font-weight:400">"&nbsp;[+]&nbsp;Module&nbsp;filter&nbsp;set&nbsp;to&nbsp;'"</span>&nbsp;+&nbsp;modulefilter+<span style="color:#3ad900;font-weight:400">"'&nbsp;"</span>+modversion,filename)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;aslrfilt=<span style="color:#3ad900;font-weight:400">"&nbsp;"</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fixupfilt=<span style="color:#3ad900;font-weight:400">"&nbsp;"</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;isaslr==<span style="color:#ff0044;font-weight:400">1</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;&nbsp;&nbsp;&nbsp;!&nbsp;Module&nbsp;is&nbsp;aslr&nbsp;aware&nbsp;-&nbsp;you'd&nbsp;better&nbsp;start&nbsp;looking&nbsp;for&nbsp;memory&nbsp;leaks&nbsp;now&nbsp;:-)"</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;For&nbsp;your&nbsp;convenience,&nbsp;output&nbsp;will&nbsp;contain&nbsp;offset&nbsp;to&nbsp;base"</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">else</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;&nbsp;&nbsp;&nbsp;Module&nbsp;is&nbsp;not&nbsp;aslr&nbsp;aware"</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">else</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"[+]&nbsp;No&nbsp;module&nbsp;filter&nbsp;set&nbsp;"</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.updateLog()<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tofile(<span style="color:#3ad900;font-weight:400">""</span>,filename)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;modulefilter&nbsp;&lt;&gt;&nbsp;<span style="color:#3ad900;font-weight:400">""</span>&nbsp;<span style="color:#ff9d00;font-weight:700">and</span>&nbsp;mbase==<span style="color:#ff0044;font-weight:400">0</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;[-]&nbsp;Warning&nbsp;:&nbsp;modulefilter&nbsp;set,&nbsp;but&nbsp;no&nbsp;matching&nbsp;module&nbsp;found&nbsp;!"</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;instrfilter=instrfilter.upper().lstrip().rstrip().replace(<span style="color:#3ad900;font-weight:400">'"'</span>,<span style="color:#3ad900;font-weight:400">''</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;instrfilter.replace(<span style="color:#3ad900;font-weight:400">"&nbsp;"</span>,<span style="color:#3ad900;font-weight:400">""</span>)&nbsp;&lt;&gt;&nbsp;<span style="color:#3ad900;font-weight:400">""</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"[+]&nbsp;Instruction&nbsp;filter&nbsp;set&nbsp;to&nbsp;'%s'&nbsp;"</span>&nbsp;%&nbsp;instrfilter)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;dosplit==<span style="color:#ff0044;font-weight:400">0</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tofile(<span style="color:#3ad900;font-weight:400">"&nbsp;[+]&nbsp;Instruction&nbsp;filter&nbsp;set&nbsp;to&nbsp;'"</span>&nbsp;+&nbsp;instrfilter+<span style="color:#3ad900;font-weight:400">"'"</span>,filename)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;dosplit==<span style="color:#ff0044;font-weight:400">1</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"[+]&nbsp;Output&nbsp;will&nbsp;be&nbsp;written&nbsp;to&nbsp;individual&nbsp;files&nbsp;(one&nbsp;file&nbsp;per&nbsp;module)"</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">else</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"[+]&nbsp;Output&nbsp;will&nbsp;be&nbsp;written&nbsp;to&nbsp;%s"</span>&nbsp;%&nbsp;filename)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"Searching&nbsp;for&nbsp;possible&nbsp;ROP&nbsp;gadgets...please&nbsp;wait"</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.updateLog()<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.updateLog()<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;nrchains=<span style="color:#ff0044;font-weight:400">0</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;nrgood=<span style="color:#ff0044;font-weight:400">0</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;addys=[]<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;stackpivots=[]<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pivottable=imm.createTable(<span style="color:#3ad900;font-weight:400">'pvefindaddr&nbsp;ROP&nbsp;Stack&nbsp;Pivot'</span>,[<span style="color:#3ad900;font-weight:400">'Address'</span>,<span style="color:#3ad900;font-weight:400">'Offset/Register'</span>,<span style="color:#3ad900;font-weight:400">'Instruction'</span>,<span style="color:#3ad900;font-weight:400">'Module'</span>,<span style="color:#3ad900;font-weight:400">'Info'</span>])<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cinstructs0=<span style="color:#3ad900;font-weight:400">""</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cinstructs=<span style="color:#3ad900;font-weight:400">""</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cinstructs2=<span style="color:#3ad900;font-weight:400">""</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;opnr=<span style="color:#ff9d00;font-weight:700">len</span>(opcodej)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;thisnr=<span style="color:#ff0044;font-weight:400">1</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;offsetcnt=<span style="color:#ff0044;font-weight:400">0</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#0088ff;font-weight:400">#get&nbsp;all&nbsp;search&nbsp;results</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;-&nbsp;Searching&nbsp;memory&nbsp;for&nbsp;gadgets,&nbsp;please&nbsp;wait..."</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tofile(<span style="color:#3ad900;font-weight:400">"\nStarted&nbsp;generating&nbsp;rop&nbsp;gadgets"</span>,progressfile)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;scnt=<span style="color:#ff0044;font-weight:400">1</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">for</span>&nbsp;searchcmd&nbsp;<span style="color:#ff9d00;font-weight:700">in</span>&nbsp;opcodej:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;&nbsp;&nbsp;Search&nbsp;sequence&nbsp;%d&nbsp;/&nbsp;%d&nbsp;(%s)"</span>&nbsp;%&nbsp;(scnt,opnr,searchcmd.strip()))<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tofile(<span style="color:#3ad900;font-weight:400">"&nbsp;-&nbsp;Search&nbsp;sequence&nbsp;"</span>&nbsp;+&nbsp;<span style="color:#ff9d00;font-weight:700">str</span>(scnt)+<span style="color:#3ad900;font-weight:400">"/"</span>+<span style="color:#ff9d00;font-weight:700">str</span>(opnr),progressfile)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;addys&nbsp;+=&nbsp;imm.searchCommands(searchcmd.strip())<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;scnt=scnt+<span style="color:#ff0044;font-weight:400">1</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.updateLog()<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;-&nbsp;Total&nbsp;number&nbsp;of&nbsp;pointers&nbsp;found&nbsp;in&nbsp;memory:&nbsp;%d&nbsp;"</span>&nbsp;%&nbsp;<span style="color:#ff9d00;font-weight:700">len</span>(addys))<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tofile(<span style="color:#3ad900;font-weight:400">"Total&nbsp;number&nbsp;of&nbsp;pointers&nbsp;found&nbsp;in&nbsp;memory&nbsp;:&nbsp;"</span>&nbsp;+&nbsp;<span style="color:#ff9d00;font-weight:700">str</span>(<span style="color:#ff9d00;font-weight:700">len</span>(addys)),progressfile)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;-&nbsp;Filtering,&nbsp;verifying&nbsp;and&nbsp;mutating&nbsp;gadgets,please&nbsp;wait..."</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tofile(<span style="color:#3ad900;font-weight:400">"\nFiltering&nbsp;and&nbsp;mutating&nbsp;gadgets,&nbsp;this&nbsp;can&nbsp;take&nbsp;a&nbsp;long&nbsp;time."</span>,progressfile)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tofile(<span style="color:#3ad900;font-weight:400">"(Periodic&nbsp;updates&nbsp;will&nbsp;be&nbsp;written&nbsp;to&nbsp;this&nbsp;file...&nbsp;stay&nbsp;tuned&nbsp;!)"</span>,progressfile)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.updateLog()<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;adcnt=<span style="color:#ff0044;font-weight:400">0</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tc=<span style="color:#ff0044;font-weight:400">1</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;totaladdys=<span style="color:#ff9d00;font-weight:700">len</span>(addys)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">for</span>&nbsp;ad1&nbsp;<span style="color:#ff9d00;font-weight:700">in</span>&nbsp;addys:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;adcnt=adcnt+<span style="color:#ff0044;font-weight:400">1</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;adcnt&nbsp;&gt;&nbsp;(tc*<span style="color:#ff0044;font-weight:400">1000</span>):<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;thistimestamp=datetime.datetime.now().strftime(<span style="color:#3ad900;font-weight:400">"%a&nbsp;%Y/%m/%d&nbsp;%I:%M:%S&nbsp;%p"</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tofile(<span style="color:#3ad900;font-weight:400">"&nbsp;-&nbsp;Progress&nbsp;update&nbsp;:&nbsp;"</span>&nbsp;+&nbsp;<span style="color:#ff9d00;font-weight:700">str</span>(tc*<span style="color:#ff0044;font-weight:400">1000</span>)&nbsp;+&nbsp;<span style="color:#3ad900;font-weight:400">"&nbsp;pointers&nbsp;processed&nbsp;("</span>&nbsp;+&nbsp;thistimestamp&nbsp;+&nbsp;<span style="color:#3ad900;font-weight:400">")"</span>,progressfile)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tc=tc+<span style="color:#ff0044;font-weight:400">1</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ad1=ad1[<span style="color:#ff0044;font-weight:400">0</span>]<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.updateLog()<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;smodule=<span style="color:#ff0044;font-weight:400">0</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#0088ff;font-weight:400">#what&nbsp;module&nbsp;does&nbsp;this&nbsp;pointer&nbsp;belong&nbsp;to,&nbsp;and&nbsp;does&nbsp;it&nbsp;need&nbsp;to&nbsp;be&nbsp;examined&nbsp;?</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;thismodname=getmodnamefromptr(ad1)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;thismodname&nbsp;&lt;&gt;&nbsp;<span style="color:#3ad900;font-weight:400">""</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;isaslr=<span style="color:#ff9d00;font-weight:700">int</span>(getmoduleprop(thismodname,<span style="color:#3ad900;font-weight:400">"aslr"</span>))<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;isfixup=<span style="color:#ff9d00;font-weight:700">int</span>(getmoduleprop(thismodname,<span style="color:#3ad900;font-weight:400">"fixup"</span>))<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mbase=<span style="color:#ff9d00;font-weight:700">int</span>(getmoduleprop(thismodname,<span style="color:#3ad900;font-weight:400">"base"</span>))<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mtop=<span style="color:#ff9d00;font-weight:700">int</span>(getmoduleprop(thismodname,<span style="color:#3ad900;font-weight:400">"top"</span>))<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#0088ff;font-weight:400">#filtering&nbsp;modules&nbsp;?</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;(modulefilter&nbsp;&lt;&gt;&nbsp;<span style="color:#3ad900;font-weight:400">""</span>):<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;(modulefilter.upper()==thismodname.upper()):<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;smodule=<span style="color:#ff0044;font-weight:400">1</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">else</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;smodule=<span style="color:#ff0044;font-weight:400">0</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">else</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#0088ff;font-weight:400">#no&nbsp;module&nbsp;filter</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;smodule=<span style="color:#ff0044;font-weight:400">1</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;(noos==<span style="color:#ff0044;font-weight:400">1</span>):<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>(isosmodule(thismodname)==<span style="color:#ff0044;font-weight:400">1</span>):<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;smodule=<span style="color:#ff0044;font-weight:400">0</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;(isaslr==<span style="color:#ff0044;font-weight:400">1</span>):<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;smodule=<span style="color:#ff0044;font-weight:400">0</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;(ignorefixup==<span style="color:#ff0044;font-weight:400">1</span>)&nbsp;<span style="color:#ff9d00;font-weight:700">and</span>&nbsp;(isfixup==<span style="color:#ff0044;font-weight:400">1</span>):<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;smodule=<span style="color:#ff0044;font-weight:400">0</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;smodule==<span style="color:#ff0044;font-weight:400">1</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.updateLog()<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;foundarr=[]<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cinstr=<span style="color:#ff0044;font-weight:400">0</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#0088ff;font-weight:400">#info=addressinfo(ad1)</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#0088ff;font-weight:400">#infovars=info.split(']')</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#0088ff;font-weight:400">#mname=infovars[0].replace("[","")</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mname=getmodnamefromptr(ad1)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#0088ff;font-weight:400">#get&nbsp;current&nbsp;instruction</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;op0&nbsp;=&nbsp;imm.Disasm(&nbsp;ad1&nbsp;)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;opstring0=op0.getDisasm()<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;modstr=<span style="color:#3ad900;font-weight:400">"[Module&nbsp;:&nbsp;"</span>+mname+<span style="color:#3ad900;font-weight:400">"]"</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;instrnr=<span style="color:#ff0044;font-weight:400">1</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;stopthisrop=<span style="color:#ff0044;font-weight:400">0</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;datastr=<span style="color:#3ad900;font-weight:400">""</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;allstring=<span style="color:#3ad900;font-weight:400">""</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;backmax=<span style="color:#ff0044;font-weight:400">1</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tofindstr=<span style="color:#3ad900;font-weight:400">"RET"</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gadgetcontains=<span style="color:#ff0044;font-weight:400">0</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;customendwith&nbsp;==&nbsp;<span style="color:#3ad900;font-weight:400">""</span>&nbsp;<span style="color:#ff9d00;font-weight:700">and</span>&nbsp;opstring0.upper().find(tofindstr)&nbsp;&gt;&nbsp;-<span style="color:#ff0044;font-weight:400">1</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gadgetcontains=<span style="color:#ff0044;font-weight:400">1</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;customendwith&nbsp;&lt;&gt;&nbsp;<span style="color:#3ad900;font-weight:400">""</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cinstrcnt=<span style="color:#ff0044;font-weight:400">0</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">while</span>&nbsp;cinstrcnt&nbsp;&lt;&nbsp;<span style="color:#ff9d00;font-weight:700">len</span>(opcodej):<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;opstring0.upper().find(opcodej[cinstrcnt].upper())&nbsp;&gt;&nbsp;-<span style="color:#ff0044;font-weight:400">1</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gadgetcontains=<span style="color:#ff0044;font-weight:400">1</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cinstrcnt=cinstrcnt+<span style="color:#ff0044;font-weight:400">1</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;gadgetcontains==<span style="color:#ff0044;font-weight:400">1</span>:<br />&nbsp;&nbsp;&nbsp;				&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#0088ff;font-weight:400">#jump&nbsp;back&nbsp;up&nbsp;to&nbsp;8&nbsp;instructions</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#0088ff;font-weight:400">#then&nbsp;shift&nbsp;one&nbsp;byte&nbsp;at&nbsp;a&nbsp;time</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#0088ff;font-weight:400">#and&nbsp;skip&nbsp;the&nbsp;chains&nbsp;that&nbsp;do&nbsp;not&nbsp;end&nbsp;with&nbsp;RET/custom&nbsp;end&nbsp;instruction</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#0088ff;font-weight:400">#or&nbsp;contain&nbsp;invalid&nbsp;instructions</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">while</span>&nbsp;backmax&nbsp;&lt;&nbsp;<span style="color:#ff0044;font-weight:400">8</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">try</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;opstart=imm.DisasmBackward(ad1,backmax)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;opadstart=opstart.getAddress()<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#0088ff;font-weight:400">#get&nbsp;number&nbsp;of&nbsp;bytes&nbsp;between&nbsp;ad1&nbsp;and&nbsp;current&nbsp;address</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;maxbytes=ad1-opadstart<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mutations=mutations+<span style="color:#ff0044;font-weight:400">1</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#0088ff;font-weight:400">#max&nbsp;bytes&nbsp;to&nbsp;walk&nbsp;=&nbsp;maxbytes-2</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#0088ff;font-weight:400">#max&nbsp;instructions&nbsp;to&nbsp;read&nbsp;forward&nbsp;:&nbsp;8</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;bytecnt=<span style="color:#ff0044;font-weight:400">0</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">while</span>&nbsp;bytecnt&nbsp;&lt;&nbsp;maxbytes:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#0088ff;font-weight:400">#</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;startad=opadstart+bytecnt<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;thisinstrline=<span style="color:#3ad900;font-weight:400">""</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;icnt=<span style="color:#ff0044;font-weight:400">0</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;stopthisrop=<span style="color:#ff0044;font-weight:400">0</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;retfound=<span style="color:#ff0044;font-weight:400">0</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;nrpush=<span style="color:#ff0044;font-weight:400">0</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;nrpop=<span style="color:#ff0044;font-weight:400">0</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;basicops=<span style="color:#ff0044;font-weight:400">0</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;basicinstr=[<span style="color:#3ad900;font-weight:400">"POP"</span>,<span style="color:#3ad900;font-weight:400">"PUSH"</span>,<span style="color:#3ad900;font-weight:400">"MOV&nbsp;"</span>,<span style="color:#3ad900;font-weight:400">"INC&nbsp;"</span>,<span style="color:#3ad900;font-weight:400">"DEC&nbsp;"</span>,<span style="color:#3ad900;font-weight:400">"RET"</span>,<span style="color:#3ad900;font-weight:400">"XOR&nbsp;"</span>,<span style="color:#3ad900;font-weight:400">"ADD&nbsp;"</span>,<span style="color:#3ad900;font-weight:400">"SUB&nbsp;"</span>,<span style="color:#3ad900;font-weight:400">"ADC&nbsp;"</span>,<span style="color:#3ad900;font-weight:400">"SBB&nbsp;"</span>,<span style="color:#3ad900;font-weight:400">"NOP"</span>,<span style="color:#3ad900;font-weight:400">"CMP&nbsp;"</span>,<span style="color:#3ad900;font-weight:400">"XCHG"</span>,<span style="color:#3ad900;font-weight:400">"LEA&nbsp;"</span>,<span style="color:#3ad900;font-weight:400">"MOV&nbsp;DWORD&nbsp;PTR&nbsp;SS:\[E"</span>,<span style="color:#3ad900;font-weight:400">"MOV&nbsp;DWORD&nbsp;PTR&nbsp;DS:\[E"</span>,<span style="color:#3ad900;font-weight:400">"CALL&nbsp;EAX"</span>,<span style="color:#3ad900;font-weight:400">"CALL&nbsp;EBX"</span>,<span style="color:#3ad900;font-weight:400">"CALL&nbsp;ECX"</span>,<span style="color:#3ad900;font-weight:400">"CALL&nbsp;EDX"</span>,<span style="color:#3ad900;font-weight:400">"CALL&nbsp;EBP"</span>,<span style="color:#3ad900;font-weight:400">"CALL&nbsp;ESI"</span>,<span style="color:#3ad900;font-weight:400">"CALL&nbsp;EDI"</span>,<span style="color:#3ad900;font-weight:400">"CALL&nbsp;ESP"</span>]<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;basicexcl=[<span style="color:#3ad900;font-weight:400">"ADD&nbsp;BYTE"</span>,<span style="color:#3ad900;font-weight:400">"SUB&nbsp;DWORD&nbsp;PTR"</span>,<span style="color:#3ad900;font-weight:400">"PUSH&nbsp;DWORD&nbsp;PTR"</span>,<span style="color:#3ad900;font-weight:400">"JMP"</span>,<span style="color:#3ad900;font-weight:400">"."</span>,<span style="color:#3ad900;font-weight:400">"IRETD"</span>,<span style="color:#3ad900;font-weight:400">"RETF"</span>]<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mustreachexcl=<span style="color:#ff0044;font-weight:400">0</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">while</span>&nbsp;icnt&nbsp;&lt;&nbsp;<span style="color:#ff0044;font-weight:400">8</span>&nbsp;<span style="color:#ff9d00;font-weight:700">and</span>&nbsp;stopthisrop==<span style="color:#ff0044;font-weight:400">0</span>&nbsp;<span style="color:#ff9d00;font-weight:700">and</span>&nbsp;retfound==<span style="color:#ff0044;font-weight:400">0</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">try</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;op=imm.DisasmForward(startad,icnt)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;opstring=op.getDisasm()<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;thisinstrline=thisinstrline+<span style="color:#3ad900;font-weight:400">"&nbsp;#&nbsp;"</span>&nbsp;+&nbsp;opstring<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gadgetcontains=<span style="color:#ff0044;font-weight:400">0</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;customendwith&nbsp;==&nbsp;<span style="color:#3ad900;font-weight:400">""</span>&nbsp;<span style="color:#ff9d00;font-weight:700">and</span>&nbsp;opstring.upper().find(tofindstr)&nbsp;&gt;&nbsp;-<span style="color:#ff0044;font-weight:400">1</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gadgetcontains=<span style="color:#ff0044;font-weight:400">1</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;customendwith&nbsp;&lt;&gt;&nbsp;<span style="color:#3ad900;font-weight:400">""</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cinstrcnt=<span style="color:#ff0044;font-weight:400">0</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">while</span>&nbsp;cinstrcnt&nbsp;&lt;&nbsp;<span style="color:#ff9d00;font-weight:700">len</span>(opcodej):<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;opstring.upper().find(opcodej[cinstrcnt].upper())&nbsp;&gt;&nbsp;-<span style="color:#ff0044;font-weight:400">1</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gadgetcontains=<span style="color:#ff0044;font-weight:400">1</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cinstrcnt=cinstrcnt+<span style="color:#ff0044;font-weight:400">1</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;gadgetcontains==<span style="color:#ff0044;font-weight:400">1</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;retfound=<span style="color:#ff0044;font-weight:400">1</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;opstring.upper().find(<span style="color:#3ad900;font-weight:400">"???"</span>)&nbsp;&gt;&nbsp;-<span style="color:#ff0044;font-weight:400">1</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;stopthisrop=<span style="color:#ff0044;font-weight:400">1</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;opstring.upper().find(<span style="color:#3ad900;font-weight:400">"PUSH&nbsp;"</span>)&nbsp;&gt;&nbsp;-<span style="color:#ff0044;font-weight:400">1</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;nrpush=nrpush+<span style="color:#ff0044;font-weight:400">1</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;opstring.upper().find(<span style="color:#3ad900;font-weight:400">"PUSHAD"</span>)&nbsp;&gt;&nbsp;-<span style="color:#ff0044;font-weight:400">1</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;nrpush=nrpush+<span style="color:#ff0044;font-weight:400">1</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;opstring.upper().find(<span style="color:#3ad900;font-weight:400">"POP&nbsp;"</span>)&nbsp;&gt;&nbsp;-<span style="color:#ff0044;font-weight:400">1</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;nrpop=nrpop+<span style="color:#ff0044;font-weight:400">1</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;opstring.upper().find(<span style="color:#3ad900;font-weight:400">"POPAD"</span>)&nbsp;&gt;&nbsp;-<span style="color:#ff0044;font-weight:400">1</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;nrpop=nrpop+<span style="color:#ff0044;font-weight:400">1</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">for</span>&nbsp;binstr&nbsp;<span style="color:#ff9d00;font-weight:700">in</span>&nbsp;basicinstr:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;opstring.upper().find(binstr.upper())&nbsp;&gt;&nbsp;-<span style="color:#ff0044;font-weight:400">1</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mustreachexcl=<span style="color:#ff0044;font-weight:400">0</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">for</span>&nbsp;bexcl&nbsp;<span style="color:#ff9d00;font-weight:700">in</span>&nbsp;basicexcl:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;opstring.upper().find(bexcl.upper())&nbsp;==&nbsp;-<span style="color:#ff0044;font-weight:400">1</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mustreachexcl=mustreachexcl+<span style="color:#ff0044;font-weight:400">1</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;mustreachexcl==<span style="color:#ff9d00;font-weight:700">len</span>(basicexcl):<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;basicops=basicops+<span style="color:#ff0044;font-weight:400">1</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">except</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;stopthisrop=<span style="color:#ff0044;font-weight:400">1</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;icnt=icnt+<span style="color:#ff0044;font-weight:400">1</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#0088ff;font-weight:400">#is&nbsp;this&nbsp;a&nbsp;good&nbsp;series&nbsp;of&nbsp;instructions&nbsp;?</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;retfound==<span style="color:#ff0044;font-weight:400">1</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;isaslr==<span style="color:#ff0044;font-weight:400">1</span>&nbsp;<span style="color:#ff9d00;font-weight:700">and</span>&nbsp;mbase&nbsp;&gt;&nbsp;-<span style="color:#ff0044;font-weight:400">1</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#0088ff;font-weight:400">#get&nbsp;offset&nbsp;to&nbsp;base&nbsp;as&nbsp;well</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;thisbaseaddr=mbase<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;thoffset=startad-mbase<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;datastr=<span style="color:#3ad900;font-weight:400">"0x"</span>+tohex(startad)+<span style="color:#3ad900;font-weight:400">"&nbsp;(base+0x"</span>&nbsp;+tohex(thoffset)+<span style="color:#3ad900;font-weight:400">")&nbsp;:&nbsp;"</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">else</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;datastr=<span style="color:#3ad900;font-weight:400">"0x"</span>+tohex(startad)+<span style="color:#3ad900;font-weight:400">"&nbsp;:&nbsp;"</span><br />	&nbsp;&nbsp;&nbsp;&nbsp;						&nbsp;&nbsp;&nbsp;<span style="color:#0088ff;font-weight:400">#determine&nbsp;type&nbsp;of&nbsp;instructions</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cinstr=<span style="color:#ff0044;font-weight:400">3</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#0088ff;font-weight:400">#first&nbsp;filter&nbsp;out&nbsp;the&nbsp;ones&nbsp;we're&nbsp;not&nbsp;interested&nbsp;in</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;thisinstrline.upper().find(<span style="color:#3ad900;font-weight:400">"INT3"</span>)&nbsp;==&nbsp;-<span style="color:#ff0044;font-weight:400">1</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;thisinstrline.upper().find(<span style="color:#3ad900;font-weight:400">"LEAVE"</span>)&nbsp;&gt;&nbsp;-<span style="color:#ff0044;font-weight:400">1</span>&nbsp;<span style="color:#ff9d00;font-weight:700">or</span>&nbsp;thisinstrline.upper().find(<span style="color:#3ad900;font-weight:400">"CALL"</span>)&nbsp;&gt;&nbsp;-<span style="color:#ff0044;font-weight:400">1</span>&nbsp;<span style="color:#ff9d00;font-weight:700">or</span>&nbsp;thisinstrline.upper().find(<span style="color:#3ad900;font-weight:400">"JMP"</span>)&nbsp;&gt;&nbsp;-<span style="color:#ff0044;font-weight:400">1</span>&nbsp;<span style="color:#ff9d00;font-weight:700">or</span>&nbsp;thisinstrline.upper().find(<span style="color:#3ad900;font-weight:400">"JE"</span>)&nbsp;&gt;&nbsp;-<span style="color:#ff0044;font-weight:400">1</span>&nbsp;<span style="color:#ff9d00;font-weight:700">or</span>&nbsp;thisinstrline.upper().find(<span style="color:#3ad900;font-weight:400">"JNE"</span>)&nbsp;&gt;&nbsp;-<span style="color:#ff0044;font-weight:400">1</span>&nbsp;<span style="color:#ff9d00;font-weight:700">or</span>&nbsp;thisinstrline.upper().find(<span style="color:#3ad900;font-weight:400">"JZ"</span>)&nbsp;&gt;&nbsp;-<span style="color:#ff0044;font-weight:400">1</span>&nbsp;<span style="color:#ff9d00;font-weight:700">or</span>&nbsp;thisinstrline.upper().find(<span style="color:#3ad900;font-weight:400">"JNZ"</span>)&nbsp;&gt;&nbsp;-<span style="color:#ff0044;font-weight:400">1</span>&nbsp;<span style="color:#ff9d00;font-weight:700">or</span>&nbsp;thisinstrline.upper().find(<span style="color:#3ad900;font-weight:400">"JB"</span>)&nbsp;&gt;&nbsp;-<span style="color:#ff0044;font-weight:400">1</span>&nbsp;<span style="color:#ff9d00;font-weight:700">or</span>&nbsp;thisinstrline.upper().find(<span style="color:#3ad900;font-weight:400">"JNB"</span>)&nbsp;&gt;&nbsp;-<span style="color:#ff0044;font-weight:400">1</span>&nbsp;<span style="color:#ff9d00;font-weight:700">or</span>&nbsp;thisinstrline.upper().find(<span style="color:#3ad900;font-weight:400">"JL"</span>)&nbsp;&gt;&nbsp;-<span style="color:#ff0044;font-weight:400">1</span>&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">or</span>&nbsp;thisinstrline.upper().find(<span style="color:#3ad900;font-weight:400">"JP"</span>)&nbsp;&gt;&nbsp;-<span style="color:#ff0044;font-weight:400">1</span>&nbsp;<span style="color:#ff9d00;font-weight:700">or</span>&nbsp;thisinstrline.upper().find(<span style="color:#3ad900;font-weight:400">"JNL"</span>)&nbsp;&gt;&nbsp;-<span style="color:#ff0044;font-weight:400">1</span>&nbsp;<span style="color:#ff9d00;font-weight:700">or</span>&nbsp;thisinstrline.upper().find(<span style="color:#3ad900;font-weight:400">"JG"</span>)&nbsp;&gt;&nbsp;-<span style="color:#ff0044;font-weight:400">1</span>&nbsp;<span style="color:#ff9d00;font-weight:700">or</span>&nbsp;thisinstrline.upper().find(<span style="color:#3ad900;font-weight:400">"JO"</span>)&nbsp;&gt;&nbsp;-<span style="color:#ff0044;font-weight:400">1</span>&nbsp;<span style="color:#ff9d00;font-weight:700">or</span>&nbsp;thisinstrline.upper().find(<span style="color:#3ad900;font-weight:400">"JA"</span>)&nbsp;&gt;&nbsp;-<span style="color:#ff0044;font-weight:400">1</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cinstr=<span style="color:#ff0044;font-weight:400">1</span><br />	&nbsp;&nbsp;				&nbsp;&nbsp;&nbsp;&nbsp;		&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#0088ff;font-weight:400">#if&nbsp;it's&nbsp;a&nbsp;call&nbsp;to&nbsp;interesting&nbsp;function,&nbsp;then&nbsp;log&nbsp;in&nbsp;separate&nbsp;list</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;thisinstrline.upper().find(<span style="color:#3ad900;font-weight:400">"KERNEL32"</span>)&nbsp;&gt;&nbsp;-<span style="color:#ff0044;font-weight:400">1</span>&nbsp;<span style="color:#ff9d00;font-weight:700">or</span>&nbsp;thisinstrline.upper().find(<span style="color:#3ad900;font-weight:400">"NTDLL"</span>)&nbsp;&gt;&nbsp;-<span style="color:#ff0044;font-weight:400">1</span>&nbsp;<span style="color:#ff9d00;font-weight:700">or</span>&nbsp;thisinstrline.upper().find(<span style="color:#3ad900;font-weight:400">"MSVCR"</span>)&nbsp;&gt;&nbsp;-<span style="color:#ff0044;font-weight:400">1</span>&nbsp;<span style="color:#ff9d00;font-weight:700">or</span>&nbsp;thisinstrline.upper().find(<span style="color:#3ad900;font-weight:400">"USER32"</span>)&nbsp;&gt;&nbsp;-<span style="color:#ff0044;font-weight:400">1</span>&nbsp;<span style="color:#ff9d00;font-weight:700">or</span>&nbsp;thisinstrline.upper().find(<span style="color:#3ad900;font-weight:400">"ADVAPI32"</span>)&nbsp;&gt;&nbsp;-<span style="color:#ff0044;font-weight:400">1</span>&nbsp;<span style="color:#ff9d00;font-weight:700">or</span>&nbsp;thisinstrline.upper().find(<span style="color:#3ad900;font-weight:400">"SHELL32"</span>)&nbsp;&gt;&nbsp;-<span style="color:#ff0044;font-weight:400">1</span>&nbsp;<span style="color:#ff9d00;font-weight:700">or</span>&nbsp;thisinstrline.upper().find(<span style="color:#3ad900;font-weight:400">"WININET"</span>)&nbsp;&gt;&nbsp;-<span style="color:#ff0044;font-weight:400">1</span>&nbsp;<span style="color:#ff9d00;font-weight:700">or</span>&nbsp;thisinstrline.upper().find(<span style="color:#3ad900;font-weight:400">"IERTUTIL"</span>)&nbsp;&gt;&nbsp;-<span style="color:#ff0044;font-weight:400">1</span>&nbsp;<span style="color:#ff9d00;font-weight:700">or</span>&nbsp;thisinstrline.upper().find(<span style="color:#3ad900;font-weight:400">"WSOCK"</span>)&nbsp;&gt;&nbsp;-<span style="color:#ff0044;font-weight:400">1</span>&nbsp;:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cinstr=<span style="color:#ff0044;font-weight:400">2</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#0088ff;font-weight:400">#if&nbsp;we&nbsp;specified&nbsp;a&nbsp;custom&nbsp;end&nbsp;and&nbsp;custom&nbsp;end&nbsp;contains&nbsp;a&nbsp;CALL&nbsp;or&nbsp;LEAVE,&nbsp;then&nbsp;allow&nbsp;it</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;customendwith.upper().find(<span style="color:#3ad900;font-weight:400">"CALL"</span>)&nbsp;&gt;&nbsp;-<span style="color:#ff0044;font-weight:400">1</span>&nbsp;<span style="color:#ff9d00;font-weight:700">or</span>&nbsp;customendwith.upper.find(<span style="color:#3ad900;font-weight:400">"LEAVE"</span>)&nbsp;&gt;&nbsp;-<span style="color:#ff0044;font-weight:400">1</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cinstr=<span style="color:#ff0044;font-weight:400">0</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;basicops&nbsp;==&nbsp;thisinstrline.count(<span style="color:#3ad900;font-weight:400">'#'</span>):<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cinstr=<span style="color:#ff0044;font-weight:400">0</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;thisinstrline.count(<span style="color:#3ad900;font-weight:400">'#'</span>)&nbsp;==&nbsp;<span style="color:#ff0044;font-weight:400">1</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cintr=-<span style="color:#ff0044;font-weight:400">1</span>&nbsp;&nbsp;&nbsp;<span style="color:#0088ff;font-weight:400">#don't&nbsp;log,&nbsp;is&nbsp;just&nbsp;a&nbsp;RET</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">else</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;nonull==<span style="color:#ff0044;font-weight:400">1</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;((addressspec(tohex(startad)).find(<span style="color:#3ad900;font-weight:400">"Null&nbsp;byte"</span>)&nbsp;&gt;&nbsp;-<span style="color:#ff0044;font-weight:400">1</span>)&nbsp;<span style="color:#ff9d00;font-weight:700">or</span>&nbsp;(addressspec(tohex(startad)).find(<span style="color:#3ad900;font-weight:400">"Unicode"</span>)&nbsp;&gt;&nbsp;-<span style="color:#ff0044;font-weight:400">1</span>)):<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#0088ff;font-weight:400">#nonull&nbsp;filter,&nbsp;but&nbsp;address&nbsp;contains&nbsp;null&nbsp;byte</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#0088ff;font-weight:400">#don't&nbsp;log</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cinstr=-<span style="color:#ff0044;font-weight:400">2</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#0088ff;font-weight:400">#do&nbsp;we&nbsp;have&nbsp;match&nbsp;with&nbsp;instruction&nbsp;filter&nbsp;?</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;thisinstrline.upper().find(instrfilter.upper())&nbsp;&gt;&nbsp;-<span style="color:#ff0044;font-weight:400">1</span>:<br />&nbsp;&nbsp;&nbsp;					&nbsp;&nbsp;		&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#0088ff;font-weight:400">#log&nbsp;if&nbsp;not&nbsp;logged&nbsp;already</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;procadbefore=-<span style="color:#ff0044;font-weight:400">1</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">try</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;procadbefore=foundarr.index(startad)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">except</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">pass</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;procadbefore==-<span style="color:#ff0044;font-weight:400">1</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;marker=<span style="color:#3ad900;font-weight:400">""</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;nrpush&nbsp;&gt;&nbsp;<span style="color:#ff0044;font-weight:400">1</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;marker=<span style="color:#3ad900;font-weight:400">"&nbsp;{PUSH}&nbsp;"</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;nrpop&nbsp;&gt;&nbsp;<span style="color:#ff0044;font-weight:400">1</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;marker=marker+<span style="color:#3ad900;font-weight:400">"&nbsp;{POP}&nbsp;"</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;cinstr==<span style="color:#ff0044;font-weight:400">0</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#0088ff;font-weight:400">#write&nbsp;to&nbsp;file</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;dosplit==<span style="color:#ff0044;font-weight:400">0</span>&nbsp;<span style="color:#ff9d00;font-weight:700">and</span>&nbsp;modulefilter==<span style="color:#3ad900;font-weight:400">""</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tofile(datastr+marker+thisinstrline+<span style="color:#3ad900;font-weight:400">"&nbsp;\t"</span>&nbsp;+&nbsp;modstr+<span style="color:#3ad900;font-weight:400">"&nbsp;"</span>+addressspec(tohex(startad)),filename)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">else</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;thisfilename=getropfilename(mname)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tofile(datastr+marker+thisinstrline+<span style="color:#3ad900;font-weight:400">"&nbsp;\t"</span>&nbsp;+&nbsp;modstr+<span style="color:#3ad900;font-weight:400">"&nbsp;"</span>+addressspec(tohex(startad)),thisfilename)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;nrgood=nrgood+<span style="color:#ff0044;font-weight:400">1</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;cinstr==<span style="color:#ff0044;font-weight:400">1</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#0088ff;font-weight:400">#write&nbsp;to&nbsp;array</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cinstructs+=datastr+marker+thisinstrline+<span style="color:#3ad900;font-weight:400">"&nbsp;\t"</span>&nbsp;+&nbsp;modstr+<span style="color:#3ad900;font-weight:400">"&nbsp;"</span>+addressspec(tohex(startad))+<span style="color:#3ad900;font-weight:400">"\n"</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;nrgood=nrgood+<span style="color:#ff0044;font-weight:400">1</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;cinstr==<span style="color:#ff0044;font-weight:400">2</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#0088ff;font-weight:400">#write&nbsp;to&nbsp;array,&nbsp;with&nbsp;function&nbsp;name</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;funcparts=thisinstrline.split(<span style="color:#3ad900;font-weight:400">'&amp;'</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;funccall=<span style="color:#3ad900;font-weight:400">""</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;<span style="color:#ff9d00;font-weight:700">len</span>(funcparts)&nbsp;&gt;&nbsp;<span style="color:#ff0044;font-weight:400">1</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;funcstub=funcparts[<span style="color:#ff0044;font-weight:400">1</span>].split(<span style="color:#3ad900;font-weight:400">'.'</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;<span style="color:#ff9d00;font-weight:700">len</span>(funcstub)&nbsp;&gt;&nbsp;<span style="color:#ff0044;font-weight:400">1</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;funcname=funcstub[<span style="color:#ff0044;font-weight:400">1</span>].split(<span style="color:#3ad900;font-weight:400">'&gt;'</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;funccall=funcname[<span style="color:#ff0044;font-weight:400">0</span>]+<span style="color:#3ad900;font-weight:400">"&nbsp;:&nbsp;"</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cinstructs2+=datastr+marker+funccall+<span style="color:#3ad900;font-weight:400">"[*]&nbsp;"</span>+thisinstrline+<span style="color:#3ad900;font-weight:400">"&nbsp;\t"</span>&nbsp;+&nbsp;modstr+<span style="color:#3ad900;font-weight:400">"&nbsp;"</span>+addressspec(tohex(startad))+<span style="color:#3ad900;font-weight:400">"\n"</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;nrgood=nrgood+<span style="color:#ff0044;font-weight:400">1</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;cinstr==<span style="color:#ff0044;font-weight:400">3</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#0088ff;font-weight:400">#write&nbsp;to&nbsp;array</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cinstructs0+=datastr+marker+thisinstrline+<span style="color:#3ad900;font-weight:400">"&nbsp;\t"</span>&nbsp;+&nbsp;modstr+<span style="color:#3ad900;font-weight:400">"&nbsp;"</span>+addressspec(tohex(startad))+<span style="color:#3ad900;font-weight:400">"\n"</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;nrgood=nrgood+<span style="color:#ff0044;font-weight:400">1</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#0088ff;font-weight:400">#Stack&nbsp;pivot,&nbsp;add&nbsp;to&nbsp;pivot&nbsp;list</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;(cinstr&nbsp;&gt;&nbsp;-<span style="color:#ff0044;font-weight:400">1</span>)&nbsp;<span style="color:#ff9d00;font-weight:700">and</span>&nbsp;(&nbsp;(thisinstrline.upper().find(<span style="color:#3ad900;font-weight:400">"ADD&nbsp;ESP,"</span>)&nbsp;==&nbsp;<span style="color:#ff0044;font-weight:400">3</span>)&nbsp;<span style="color:#ff9d00;font-weight:700">or</span>&nbsp;((thisinstrline.upper().find(<span style="color:#3ad900;font-weight:400">"LEA&nbsp;ESP,"</span>)&nbsp;==&nbsp;<span style="color:#ff0044;font-weight:400">3</span>))&nbsp;<span style="color:#ff9d00;font-weight:700">or</span>&nbsp;((thisinstrline.upper().find(<span style="color:#3ad900;font-weight:400">"XCHG&nbsp;ESP,"</span>)&nbsp;==&nbsp;<span style="color:#ff0044;font-weight:400">3</span>))&nbsp;<span style="color:#ff9d00;font-weight:700">or</span>&nbsp;((thisinstrline.upper().find(<span style="color:#3ad900;font-weight:400">"XCHG&nbsp;EAX,ESP"</span>)&nbsp;==&nbsp;<span style="color:#ff0044;font-weight:400">3</span>))&nbsp;<span style="color:#ff9d00;font-weight:700">or</span>&nbsp;((thisinstrline.upper().find(<span style="color:#3ad900;font-weight:400">"XCHG&nbsp;EBX,ESP"</span>)&nbsp;==&nbsp;<span style="color:#ff0044;font-weight:400">3</span>))&nbsp;<span style="color:#ff9d00;font-weight:700">or</span>&nbsp;((thisinstrline.upper().find(<span style="color:#3ad900;font-weight:400">"XCHG&nbsp;ECX,ESP"</span>)&nbsp;==&nbsp;<span style="color:#ff0044;font-weight:400">3</span>))&nbsp;<span style="color:#ff9d00;font-weight:700">or</span>&nbsp;((thisinstrline.upper().find(<span style="color:#3ad900;font-weight:400">"XCHG&nbsp;EDX,ESP"</span>)&nbsp;==&nbsp;<span style="color:#ff0044;font-weight:400">3</span>))&nbsp;<span style="color:#ff9d00;font-weight:700">or</span>&nbsp;((thisinstrline.upper().find(<span style="color:#3ad900;font-weight:400">"XCHG&nbsp;EBP,ESP"</span>)&nbsp;==&nbsp;<span style="color:#ff0044;font-weight:400">3</span>))&nbsp;<span style="color:#ff9d00;font-weight:700">or</span>&nbsp;((thisinstrline.upper().find(<span style="color:#3ad900;font-weight:400">"XCHG&nbsp;EDI,ESP"</span>)&nbsp;==&nbsp;<span style="color:#ff0044;font-weight:400">3</span>))&nbsp;<span style="color:#ff9d00;font-weight:700">or</span>&nbsp;((thisinstrline.upper().find(<span style="color:#3ad900;font-weight:400">"XCHG&nbsp;ESI,ESP"</span>)&nbsp;==&nbsp;<span style="color:#ff0044;font-weight:400">3</span>))&nbsp;<span style="color:#ff9d00;font-weight:700">or</span>&nbsp;((thisinstrline.upper().find(<span style="color:#3ad900;font-weight:400">"MOV&nbsp;ESP,[EBP"</span>)&nbsp;==&nbsp;<span style="color:#ff0044;font-weight:400">3</span>))):<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;(thisinstrline.upper().find(<span style="color:#3ad900;font-weight:400">"CALL"</span>)&nbsp;==&nbsp;-<span style="color:#ff0044;font-weight:400">1</span>)&nbsp;<span style="color:#ff9d00;font-weight:700">and</span>&nbsp;(thisinstrline.upper().find(<span style="color:#3ad900;font-weight:400">"JMP"</span>)&nbsp;==&nbsp;-<span style="color:#ff0044;font-weight:400">1</span>):<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#0088ff;font-weight:400">#what&nbsp;is&nbsp;the&nbsp;offset&nbsp;or&nbsp;register&nbsp;?</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;stackpivotfields=thisinstrline.upper().split(<span style="color:#3ad900;font-weight:400">','</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;<span style="color:#ff9d00;font-weight:700">len</span>(stackpivotfields)&nbsp;&gt;&nbsp;<span style="color:#ff0044;font-weight:400">1</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;stackpivotoffset=stackpivotfields[<span style="color:#ff0044;font-weight:400">1</span>].split(<span style="color:#3ad900;font-weight:400">'#'</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#0088ff;font-weight:400">#offset&nbsp;is&nbsp;now&nbsp;in&nbsp;stackpivotoffset[0].&nbsp;Add&nbsp;to&nbsp;array&nbsp;and&nbsp;to&nbsp;table,&nbsp;unless&nbsp;it's&nbsp;instr&nbsp;reg,ESP</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;soffset=stackpivotoffset[<span style="color:#ff0044;font-weight:400">0</span>]<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;soffset.strip()==<span style="color:#3ad900;font-weight:400">"ESP"</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;soffsetparts=stackpivotfields[<span style="color:#ff0044;font-weight:400">0</span>].split(<span style="color:#3ad900;font-weight:400">'&nbsp;'</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;soffset=soffsetparts[<span style="color:#ff9d00;font-weight:700">len</span>(soffsetparts)-<span style="color:#ff0044;font-weight:400">1</span>]<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ainfo=addressspec(tohex(startad))<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pivottable.add(<span style="color:#ff0044;font-weight:400">0</span>,[<span style="color:#3ad900;font-weight:400">"%s"</span>%(tohex(startad)),<span style="color:#3ad900;font-weight:400">"%s"</span>%(soffset),<span style="color:#3ad900;font-weight:400">"%s"</span>%(thisinstrline),<span style="color:#3ad900;font-weight:400">"%s"</span>%(mname),<span style="color:#3ad900;font-weight:400">"%s"</span>%(ainfo)])<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tofile(<span style="color:#3ad900;font-weight:400">"0x"</span>&nbsp;+&nbsp;tohex(startad)+<span style="color:#3ad900;font-weight:400">"&nbsp;:&nbsp;"</span>&nbsp;+&nbsp;soffset&nbsp;+&nbsp;<span style="color:#3ad900;font-weight:400">"&nbsp;:&nbsp;\t"</span>&nbsp;+&nbsp;thisinstrline&nbsp;+&nbsp;<span style="color:#3ad900;font-weight:400">"&nbsp;-&nbsp;"</span>&nbsp;+&nbsp;mname&nbsp;+&nbsp;<span style="color:#3ad900;font-weight:400">"&nbsp;-&nbsp;"</span>&nbsp;+&nbsp;ainfo,stackpivotfile)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#0088ff;font-weight:400">#add&nbsp;address&nbsp;to&nbsp;"found"&nbsp;array</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;foundarr.append(startad)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;goodgadgets=goodgadgets+<span style="color:#ff0044;font-weight:400">1</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;bytecnt=bytecnt+<span style="color:#ff0044;font-weight:400">1</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">except</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">pass</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;backmax=backmax+<span style="color:#ff0044;font-weight:400">1</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.updateLog()<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tofile(<span style="color:#3ad900;font-weight:400">"Finished&nbsp;filtering&nbsp;&amp;&nbsp;mutation&nbsp;process"</span>,progressfile)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;&nbsp;&nbsp;Number&nbsp;of&nbsp;gadgets&nbsp;&amp;&nbsp;attempted&nbsp;mutations&nbsp;:&nbsp;%d"</span>&nbsp;%&nbsp;(mutations))<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;goodgadgets&nbsp;&gt;&nbsp;<span style="color:#ff0044;font-weight:400">0</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;&nbsp;&nbsp;Number&nbsp;of&nbsp;good&nbsp;gadgets&nbsp;(before&nbsp;filtering&nbsp;on&nbsp;null&nbsp;bytes,&nbsp;if&nbsp;required):&nbsp;%d"</span>&nbsp;%&nbsp;(goodgadgets),highlight=<span style="color:#ff0044;font-weight:400">1</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">else</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;&nbsp;&nbsp;Number&nbsp;of&nbsp;good&nbsp;gadgets&nbsp;(before&nbsp;filtering&nbsp;on&nbsp;null&nbsp;bytes,&nbsp;if&nbsp;required):&nbsp;%d"</span>&nbsp;%&nbsp;(goodgadgets))<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.updateLog()<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#0088ff;font-weight:400">#write&nbsp;remaining&nbsp;entries&nbsp;only&nbsp;if&nbsp;deep&nbsp;mode&nbsp;is&nbsp;enable</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;dodeep==<span style="color:#ff0044;font-weight:400">1</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tofile(<span style="color:#3ad900;font-weight:400">"\nDumping&nbsp;possibly&nbsp;interesting&nbsp;gadgets&nbsp;to&nbsp;"</span>&nbsp;+&nbsp;filename,progressfile)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tofile(<span style="color:#3ad900;font-weight:400">"&nbsp;"</span>,filename)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tofile(<span style="color:#3ad900;font-weight:400">"-"</span>&nbsp;*&nbsp;<span style="color:#ff0044;font-weight:400">80</span>,filename)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tofile(<span style="color:#3ad900;font-weight:400">"&nbsp;ROP&nbsp;gadgets&nbsp;-&nbsp;Possible&nbsp;interesting&nbsp;gadgets..."</span>,filename)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tofile(<span style="color:#3ad900;font-weight:400">"-"</span>&nbsp;*&nbsp;<span style="color:#ff0044;font-weight:400">80</span>,filename)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cis=cinstructs0.split(<span style="color:#3ad900;font-weight:400">'\n'</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">for</span>&nbsp;cielem&nbsp;<span style="color:#ff9d00;font-weight:700">in</span>&nbsp;cis:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tofile(cielem,filename)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tofile(<span style="color:#3ad900;font-weight:400">"&nbsp;"</span>,filename)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tofile(<span style="color:#3ad900;font-weight:400">"-"</span>&nbsp;*&nbsp;<span style="color:#ff0044;font-weight:400">80</span>,filename)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tofile(<span style="color:#3ad900;font-weight:400">"&nbsp;ROP&nbsp;gadgets&nbsp;-&nbsp;With&nbsp;Jumps/Calls/...&nbsp;to&nbsp;possibly&nbsp;interesting&nbsp;functions..."</span>,filename)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tofile(<span style="color:#3ad900;font-weight:400">"-"</span>&nbsp;*&nbsp;<span style="color:#ff0044;font-weight:400">80</span>,filename)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cis=cinstructs2.split(<span style="color:#3ad900;font-weight:400">'\n'</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">for</span>&nbsp;cielem&nbsp;<span style="color:#ff9d00;font-weight:700">in</span>&nbsp;cis:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tofile(cielem,filename)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tofile(<span style="color:#3ad900;font-weight:400">"&nbsp;"</span>,filename)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tofile(<span style="color:#3ad900;font-weight:400">"-"</span>&nbsp;*&nbsp;<span style="color:#ff0044;font-weight:400">80</span>,filename)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tofile(<span style="color:#3ad900;font-weight:400">"&nbsp;ROP&nbsp;gadgets&nbsp;-&nbsp;With&nbsp;Jumps/Calls/...&nbsp;(may&nbsp;be&nbsp;interesting,&nbsp;may&nbsp;be&nbsp;showstoppers&nbsp;!)"</span>,filename)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tofile(<span style="color:#3ad900;font-weight:400">"-"</span>&nbsp;*&nbsp;<span style="color:#ff0044;font-weight:400">80</span>,filename)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cis=cinstructs.split(<span style="color:#3ad900;font-weight:400">'\n'</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">for</span>&nbsp;cielem&nbsp;<span style="color:#ff9d00;font-weight:700">in</span>&nbsp;cis:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tofile(cielem,filename)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"After&nbsp;filtering&nbsp;and&nbsp;mutating,&nbsp;%d&nbsp;'good'&nbsp;gadgets&nbsp;were&nbsp;left&nbsp;over"</span>&nbsp;%&nbsp;(nrgood))<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.updateLog()<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;thistimestamp=datetime.datetime.now().strftime(<span style="color:#3ad900;font-weight:400">"%a&nbsp;%Y/%m/%d&nbsp;%I:%M:%S&nbsp;%p"</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tofile(<span style="color:#3ad900;font-weight:400">"\nROP&nbsp;Gadget&nbsp;creating&nbsp;process&nbsp;complete&nbsp;at&nbsp;"</span>&nbsp;+&nbsp;thistimestamp,progressfile)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tofile(<span style="color:#ff9d00;font-weight:700">str</span>(nrgood)+<span style="color:#3ad900;font-weight:400">"&nbsp;gadgets&nbsp;created."</span>,progressfile)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">return</span>&nbsp;<span style="color:#3ad900;font-weight:400">"Search&nbsp;complete,&nbsp;%d&nbsp;gadgets&nbsp;generated,&nbsp;check&nbsp;%s"</span>&nbsp;%&nbsp;(nrgood,filename)<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;args[<span style="color:#ff0044;font-weight:400">0</span>]&nbsp;==&nbsp;<span style="color:#3ad900;font-weight:400">"ropcall"</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"------------------------------------------------"</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"Searching&nbsp;for&nbsp;interesting&nbsp;calls&nbsp;to&nbsp;ROP&nbsp;bypass"</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"functions&nbsp;in&nbsp;loaded&nbsp;modules"</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"------------------------------------------------"</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;filename=<span style="color:#3ad900;font-weight:400">"ropcall.txt"</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;resetfile(filename)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;writemodinfo(filename)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;extrafilter=<span style="color:#3ad900;font-weight:400">"&nbsp;"</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;searchcall=[]<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mbase=<span style="color:#ff0044;font-weight:400">0</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;searchcall.append(<span style="color:#3ad900;font-weight:400">"WinExec"</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;searchcall.append(<span style="color:#3ad900;font-weight:400">"VirtualProtect"</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;searchcall.append(<span style="color:#3ad900;font-weight:400">"VirtualAlloc"</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;searchcall.append(<span style="color:#3ad900;font-weight:400">"SetProcessDEPPolicy"</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;searchcall.append(<span style="color:#3ad900;font-weight:400">"HeapCreate"</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;searchcall.append(<span style="color:#3ad900;font-weight:400">"SetInformationProcess"</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;searchcall.append(<span style="color:#3ad900;font-weight:400">"WriteProcessMemory"</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;searchcall.append(<span style="color:#3ad900;font-weight:400">"memcpy"</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;searchcall.append(<span style="color:#3ad900;font-weight:400">"memmove"</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;searchcall.append(<span style="color:#3ad900;font-weight:400">"strncpy"</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;searchcall.append(<span style="color:#3ad900;font-weight:400">"wsa"</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;aslrfilt=<span style="color:#3ad900;font-weight:400">"ASLR:&nbsp;**&nbsp;NO"</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fixupfilt=<span style="color:#3ad900;font-weight:400">"FIXUP:&nbsp;**&nbsp;NO"</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;isfixup=<span style="color:#ff0044;font-weight:400">0</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;<span style="color:#ff9d00;font-weight:700">len</span>(g_modules)==<span style="color:#ff0044;font-weight:400">0</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;moduleinfo()<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.updateLog()<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#0088ff;font-weight:400">#get&nbsp;correct&nbsp;module&nbsp;name</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;isaslr=<span style="color:#ff0044;font-weight:400">0</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mfound=<span style="color:#ff0044;font-weight:400">0</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;modulefilter&nbsp;&lt;&gt;&nbsp;<span style="color:#3ad900;font-weight:400">""</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">for</span>&nbsp;mname&nbsp;<span style="color:#ff9d00;font-weight:700">in</span>&nbsp;g_modules:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mnamentry=mname.split(<span style="color:#3ad900;font-weight:400">'\t'</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;mnamentry[<span style="color:#ff0044;font-weight:400">0</span>].lower().startswith(modulefilter.lower()):<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mfound=<span style="color:#ff0044;font-weight:400">1</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;modulefilter=mnamentry[<span style="color:#ff0044;font-weight:400">0</span>].lower()<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mbase=<span style="color:#ff9d00;font-weight:700">int</span>(mnamentry[<span style="color:#ff0044;font-weight:400">2</span>])<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;isaslr=<span style="color:#ff9d00;font-weight:700">int</span>(mnamentry[<span style="color:#ff0044;font-weight:400">6</span>])<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;isfixup=<span style="color:#ff9d00;font-weight:700">int</span>(mnamentry[<span style="color:#ff0044;font-weight:400">8</span>])<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;modulefilter&nbsp;&lt;&gt;&nbsp;<span style="color:#3ad900;font-weight:400">""</span>&nbsp;<span style="color:#ff9d00;font-weight:700">and</span>&nbsp;mbase&nbsp;&gt;&nbsp;<span style="color:#ff0044;font-weight:400">0</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"[+]&nbsp;Module&nbsp;filter&nbsp;set&nbsp;to&nbsp;'%s',&nbsp;at&nbsp;baseaddress&nbsp;0x%s"</span>&nbsp;%&nbsp;(modulefilter,tohex(mbase)))<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tofile(<span style="color:#3ad900;font-weight:400">"&nbsp;[+]&nbsp;Module&nbsp;filter&nbsp;set&nbsp;to&nbsp;'"</span>&nbsp;+&nbsp;modulefilter+<span style="color:#3ad900;font-weight:400">"'"</span>,filename)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;aslrfilt=<span style="color:#3ad900;font-weight:400">"&nbsp;"</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fixupfilt=<span style="color:#3ad900;font-weight:400">"&nbsp;"</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;isaslr==<span style="color:#ff0044;font-weight:400">1</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;&nbsp;&nbsp;&nbsp;!&nbsp;Module&nbsp;is&nbsp;aslr&nbsp;aware&nbsp;-&nbsp;you'd&nbsp;better&nbsp;start&nbsp;looking&nbsp;for&nbsp;memory&nbsp;leaks&nbsp;now&nbsp;:-)"</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tofile(<span style="color:#3ad900;font-weight:400">"&nbsp;[+]&nbsp;Warning&nbsp;:&nbsp;module&nbsp;is&nbsp;ASLR&nbsp;enabled&nbsp;!"</span>,filename)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">else</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;&nbsp;&nbsp;&nbsp;Module&nbsp;is&nbsp;not&nbsp;aslr&nbsp;aware"</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">else</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"[+]&nbsp;No&nbsp;module&nbsp;filter&nbsp;set&nbsp;"</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.updateLog()<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#0088ff;font-weight:400">#start&nbsp;searching&nbsp;for&nbsp;calls</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;addys=[]<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"Finding&nbsp;CALL&nbsp;instructions..."</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.updateLog()<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;calltypes=[]<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;calltypes.append(<span style="color:#3ad900;font-weight:400">"\xff\x15"</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;totalcalls=<span style="color:#ff0044;font-weight:400">0</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">for</span>&nbsp;calltype&nbsp;<span style="color:#ff9d00;font-weight:700">in</span>&nbsp;calltypes:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;addys+=imm.search(calltype)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;totalcalls=totalcalls+<span style="color:#ff9d00;font-weight:700">len</span>(addys)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"Total&nbsp;number&nbsp;of&nbsp;calls&nbsp;found&nbsp;(in&nbsp;all&nbsp;modules)&nbsp;:&nbsp;%d"</span>&nbsp;%&nbsp;<span style="color:#ff9d00;font-weight:700">len</span>(addys))<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"Filtering&nbsp;calls...&nbsp;please&nbsp;wait"</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.updateLog()<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">for</span>&nbsp;callentry&nbsp;<span style="color:#ff9d00;font-weight:700">in</span>&nbsp;addys:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;callproceed=<span style="color:#ff0044;font-weight:400">0</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;module&nbsp;=&nbsp;imm.findModule(callentry)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;<span style="color:#ff9d00;font-weight:700">not</span>&nbsp;module:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;module&nbsp;=&nbsp;<span style="color:#3ad900;font-weight:400">"none"</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">else</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;module&nbsp;=&nbsp;module[<span style="color:#ff0044;font-weight:400">0</span>].lower()<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;modaslr=getmoduleprop(module,<span style="color:#3ad900;font-weight:400">"aslr"</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;modfixup=getmoduleprop(module,<span style="color:#3ad900;font-weight:400">"fixup"</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;(nonull==<span style="color:#ff0044;font-weight:400">0</span>)&nbsp;<span style="color:#ff9d00;font-weight:700">or</span>&nbsp;(nonull==<span style="color:#ff0044;font-weight:400">1</span>&nbsp;<span style="color:#ff9d00;font-weight:700">and</span>&nbsp;addressspec(tohex(callentry)).upper().find(<span style="color:#3ad900;font-weight:400">"NULL&nbsp;BYTE"</span>)&nbsp;==&nbsp;-<span style="color:#ff0044;font-weight:400">1</span>):<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;modaslr==<span style="color:#3ad900;font-weight:400">"0"</span>&nbsp;<span style="color:#ff9d00;font-weight:700">and</span>&nbsp;modfixup==<span style="color:#3ad900;font-weight:400">"0"</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;modulefilter&nbsp;&lt;&gt;&nbsp;<span style="color:#3ad900;font-weight:400">""</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;module.lower().find(modulefilter.lower())&nbsp;&gt;&nbsp;-<span style="color:#ff0044;font-weight:400">1</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;callproceed=<span style="color:#ff0044;font-weight:400">1</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">else</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;callproceed=<span style="color:#ff0044;font-weight:400">1</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;callproceed==<span style="color:#ff0044;font-weight:400">1</span>&nbsp;<span style="color:#ff9d00;font-weight:700">and</span>&nbsp;addressinfo(callentry).find(<span style="color:#3ad900;font-weight:400">"EXECUTE"</span>)&nbsp;&gt;&nbsp;-<span style="color:#ff0044;font-weight:400">1</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;hexaddr=tohex(callentry)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;op&nbsp;=&nbsp;imm.Disasm(&nbsp;callentry&nbsp;)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;opstring=op.getDisasm()<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">for</span>&nbsp;callfunc&nbsp;<span style="color:#ff9d00;font-weight:700">in</span>&nbsp;searchcall:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;opstring.lower().find(callfunc.lower().lstrip().rstrip())&nbsp;&gt;&nbsp;-<span style="color:#ff0044;font-weight:400">1</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tofile(<span style="color:#3ad900;font-weight:400">"["</span>+module+<span style="color:#3ad900;font-weight:400">"]&nbsp;&nbsp;0x"</span>&nbsp;+&nbsp;tohex(callentry)+<span style="color:#3ad900;font-weight:400">"&nbsp;:&nbsp;"</span>&nbsp;+&nbsp;opstring+<span style="color:#3ad900;font-weight:400">"&nbsp;|&nbsp;"</span>,filename,callentry)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;nrfound+=<span style="color:#ff0044;font-weight:400">1</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"Search&nbsp;complete,&nbsp;%d&nbsp;possibly&nbsp;interesting&nbsp;calls&nbsp;found"</span>&nbsp;%&nbsp;nrfound)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">return</span>&nbsp;<span style="color:#3ad900;font-weight:400">"Search&nbsp;complete,&nbsp;%d&nbsp;possibly&nbsp;interesting&nbsp;calls&nbsp;found"</span>&nbsp;%&nbsp;nrfound<br /><br /><br />&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;args[<span style="color:#ff0044;font-weight:400">0</span>]&nbsp;==&nbsp;<span style="color:#3ad900;font-weight:400">"jrop"</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"--------------------------------------------------------------"</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"Search&nbsp;for&nbsp;jumpboards&nbsp;to&nbsp;ROP&nbsp;chain&nbsp;at&nbsp;ESP&nbsp;"</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"Searching&nbsp;in&nbsp;non&nbsp;aslr&nbsp;modules...&nbsp;please&nbsp;wait"</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"--------------------------------------------------------------"</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;filename=<span style="color:#3ad900;font-weight:400">"jrop.txt"</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;resetfile(filename)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;writemodinfo(filename)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;opcodej=[]<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;opcodej.append(<span style="color:#3ad900;font-weight:400">"call&nbsp;dword&nbsp;[esp]"</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;opcodej.append(<span style="color:#3ad900;font-weight:400">"call&nbsp;dword&nbsp;[esp+0x04]"</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;opcodej.append(<span style="color:#3ad900;font-weight:400">"call&nbsp;dword&nbsp;[esp+0x08]"</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;opcodej.append(<span style="color:#3ad900;font-weight:400">"call&nbsp;dword&nbsp;[esp+0x0c]"</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;opcodej.append(<span style="color:#3ad900;font-weight:400">"pop&nbsp;eax\njmp&nbsp;eax"</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;opcodej.append(<span style="color:#3ad900;font-weight:400">"pop&nbsp;eax\ncall&nbsp;eax"</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;opcodej.append(<span style="color:#3ad900;font-weight:400">"pop&nbsp;ebx\njmp&nbsp;ebx"</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;opcodej.append(<span style="color:#3ad900;font-weight:400">"pop&nbsp;ebx\ncall&nbsp;ebx"</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;opcodej.append(<span style="color:#3ad900;font-weight:400">"pop&nbsp;ecx\njmp&nbsp;ecx"</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;opcodej.append(<span style="color:#3ad900;font-weight:400">"pop&nbsp;ecx\ncall&nbsp;ecx"</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;opcodej.append(<span style="color:#3ad900;font-weight:400">"pop&nbsp;edx\njmp&nbsp;ecx"</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;opcodej.append(<span style="color:#3ad900;font-weight:400">"pop&nbsp;edx\ncall&nbsp;edx"</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;opcodej.append(<span style="color:#3ad900;font-weight:400">"pop&nbsp;esi\njmp&nbsp;esi"</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;opcodej.append(<span style="color:#3ad900;font-weight:400">"pop&nbsp;esi\ncall&nbsp;esi"</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;opcodej.append(<span style="color:#3ad900;font-weight:400">"pop&nbsp;edi\njmp&nbsp;edi"</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;opcodej.append(<span style="color:#3ad900;font-weight:400">"pop&nbsp;edi\ncall&nbsp;edi"</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;opcodej.append(<span style="color:#3ad900;font-weight:400">"pop&nbsp;ebp\njmp&nbsp;ebp"</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;opcodej.append(<span style="color:#3ad900;font-weight:400">"pop&nbsp;ebp\ncall&nbsp;ebp"</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;allregs=[<span style="color:#3ad900;font-weight:400">"eax"</span>,<span style="color:#3ad900;font-weight:400">"ebx"</span>,<span style="color:#3ad900;font-weight:400">"ecx"</span>,<span style="color:#3ad900;font-weight:400">"edx"</span>,<span style="color:#3ad900;font-weight:400">"esi"</span>,<span style="color:#3ad900;font-weight:400">"edi"</span>,<span style="color:#3ad900;font-weight:400">"ebp"</span>]<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">for</span>&nbsp;reg&nbsp;<span style="color:#ff9d00;font-weight:700">in</span>&nbsp;allregs:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;opcodej.append(<span style="color:#3ad900;font-weight:400">"lea&nbsp;"</span>+reg+<span style="color:#3ad900;font-weight:400">",[esp]\njmp&nbsp;"</span>+reg)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;opcodej.append(<span style="color:#3ad900;font-weight:400">"lea&nbsp;"</span>+reg+<span style="color:#3ad900;font-weight:400">",[esp]\ncall&nbsp;"</span>+reg)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">for</span>&nbsp;reg2&nbsp;<span style="color:#ff9d00;font-weight:700">in</span>&nbsp;allregs:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;opcodej.append(<span style="color:#3ad900;font-weight:400">"pop&nbsp;"</span>+reg+<span style="color:#3ad900;font-weight:400">"\nxchg&nbsp;"</span>+reg+<span style="color:#3ad900;font-weight:400">","</span>+reg2+<span style="color:#3ad900;font-weight:400">"\njmp&nbsp;"</span>+reg2)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;opcodej.append(<span style="color:#3ad900;font-weight:400">"pop&nbsp;"</span>+reg+<span style="color:#3ad900;font-weight:400">"\nxchg&nbsp;"</span>+reg+<span style="color:#3ad900;font-weight:400">","</span>+reg2+<span style="color:#3ad900;font-weight:400">"\ncall&nbsp;"</span>+reg2)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;opcodej.append(<span style="color:#3ad900;font-weight:400">"pop&nbsp;"</span>+reg+<span style="color:#3ad900;font-weight:400">"\nxchg&nbsp;"</span>+reg2+<span style="color:#3ad900;font-weight:400">","</span>+reg+<span style="color:#3ad900;font-weight:400">"\njmp&nbsp;"</span>+reg2)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;<span style="color:#ff9d00;font-weight:700">len</span>(g_modules)==<span style="color:#ff0044;font-weight:400">0</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;moduleinfo()<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mbase=<span style="color:#ff0044;font-weight:400">0</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;modulefilter&nbsp;&lt;&gt;&nbsp;<span style="color:#3ad900;font-weight:400">""</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">for</span>&nbsp;mname&nbsp;<span style="color:#ff9d00;font-weight:700">in</span>&nbsp;g_modules:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mnamentry=mname.split(<span style="color:#3ad900;font-weight:400">'\t'</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;mnamentry[<span style="color:#ff0044;font-weight:400">0</span>].lower().startswith(modulefilter.lower()):<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;modulefilter=mnamentry[<span style="color:#ff0044;font-weight:400">0</span>].lower()<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mbase=<span style="color:#ff9d00;font-weight:700">int</span>(mnamentry[<span style="color:#ff0044;font-weight:400">2</span>])<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"Module&nbsp;filter&nbsp;active&nbsp;:&nbsp;%s&nbsp;(baseaddress&nbsp;0x%s)"</span>&nbsp;%&nbsp;(modulefilter,tohex(mbase)))<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;nrfound=<span style="color:#ff0044;font-weight:400">0</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">for</span>&nbsp;op&nbsp;<span style="color:#ff9d00;font-weight:700">in</span>&nbsp;opcodej:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"Searching&nbsp;for&nbsp;%s&nbsp;"</span>&nbsp;%&nbsp;op)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;addys=[]<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;addys=imm.search(imm.assemble(op))<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;&nbsp;Pointers&nbsp;found&nbsp;:&nbsp;%d&nbsp;"</span>&nbsp;%&nbsp;<span style="color:#ff9d00;font-weight:700">len</span>(addys))<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">for</span>&nbsp;ad1&nbsp;<span style="color:#ff9d00;font-weight:700">in</span>&nbsp;addys:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;modproceed=<span style="color:#ff0044;font-weight:400">0</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;module&nbsp;=&nbsp;imm.findModule(ad1)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;<span style="color:#ff9d00;font-weight:700">not</span>&nbsp;module:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;module&nbsp;=&nbsp;<span style="color:#3ad900;font-weight:400">"none"</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">else</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;module&nbsp;=&nbsp;module[<span style="color:#ff0044;font-weight:400">0</span>].lower()<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;modaslr=getmoduleprop(module,<span style="color:#3ad900;font-weight:400">"aslr"</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;modfixup=getmoduleprop(module,<span style="color:#3ad900;font-weight:400">"fixup"</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;(noos==<span style="color:#ff0044;font-weight:400">0</span>)&nbsp;<span style="color:#ff9d00;font-weight:700">or</span>&nbsp;(noos==<span style="color:#ff0044;font-weight:400">1</span>&nbsp;<span style="color:#ff9d00;font-weight:700">and</span>&nbsp;isosmodule(module)==<span style="color:#ff0044;font-weight:400">0</span>):<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;aspec=addressspec(tohex(ad1)).upper()<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;(nonull==<span style="color:#ff0044;font-weight:400">0</span>)&nbsp;<span style="color:#ff9d00;font-weight:700">or</span>&nbsp;(nonull==<span style="color:#ff0044;font-weight:400">1</span>&nbsp;<span style="color:#ff9d00;font-weight:700">and</span>&nbsp;aspec.find(<span style="color:#3ad900;font-weight:400">"NULL"</span>)&nbsp;==&nbsp;-<span style="color:#ff0044;font-weight:400">1</span>):<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;modaslr==<span style="color:#3ad900;font-weight:400">"0"</span>&nbsp;<span style="color:#ff9d00;font-weight:700">and</span>&nbsp;modfixup==<span style="color:#3ad900;font-weight:400">"0"</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;modulefilter&nbsp;&lt;&gt;&nbsp;<span style="color:#3ad900;font-weight:400">""</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;module.lower().find(modulefilter.lower())&nbsp;&gt;&nbsp;-<span style="color:#ff0044;font-weight:400">1</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;modproceed=<span style="color:#ff0044;font-weight:400">1</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">else</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;modproceed=<span style="color:#ff0044;font-weight:400">1</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;modproceed==<span style="color:#ff0044;font-weight:400">1</span>&nbsp;<span style="color:#ff9d00;font-weight:700">and</span>&nbsp;addressinfo(ad1).find(<span style="color:#3ad900;font-weight:400">"EXECUTE"</span>)&nbsp;&gt;&nbsp;-<span style="color:#ff0044;font-weight:400">1</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;hexaddr=tohex(ad1)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tofile(<span style="color:#3ad900;font-weight:400">"["</span>+module+<span style="color:#3ad900;font-weight:400">"]&nbsp;&nbsp;0x"</span>&nbsp;+&nbsp;tohex(ad1)+<span style="color:#3ad900;font-weight:400">"&nbsp;:&nbsp;"</span>&nbsp;+&nbsp;op+<span style="color:#3ad900;font-weight:400">"&nbsp;|&nbsp;"</span>,filename,ad1)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;nrfound+=<span style="color:#ff0044;font-weight:400">1</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.updateLog()<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"Search&nbsp;complete,&nbsp;found&nbsp;%d&nbsp;usable&nbsp;addresses"</span>&nbsp;%&nbsp;nrfound)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"Output&nbsp;written&nbsp;to&nbsp;"</span>+filename)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">return</span>&nbsp;<span style="color:#3ad900;font-weight:400">"Search&nbsp;complete,&nbsp;%d&nbsp;pointers&nbsp;found"</span>&nbsp;%&nbsp;nrfound<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;args[<span style="color:#ff0044;font-weight:400">0</span>]&nbsp;==&nbsp;<span style="color:#3ad900;font-weight:400">"modules"</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;writemodinfo(<span style="color:#3ad900;font-weight:400">""</span>)<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;args[<span style="color:#ff0044;font-weight:400">0</span>]&nbsp;==&nbsp;<span style="color:#3ad900;font-weight:400">"functions"</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"--------------------------------------------------------------"</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"Listing&nbsp;all&nbsp;functions&nbsp;in&nbsp;loaded&nbsp;modules"</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"--------------------------------------------------------------"</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;filename=<span style="color:#3ad900;font-weight:400">"functions.txt"</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;resetfile(filename)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;writemodinfo(filename)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tofile(<span style="color:#3ad900;font-weight:400">"Function&nbsp;pointers&nbsp;:"</span>,filename)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tofile(<span style="color:#3ad900;font-weight:400">"-------------------"</span>,filename)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;allowos=<span style="color:#ff0044;font-weight:400">0</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dohook=<span style="color:#ff0044;font-weight:400">0</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;modname=<span style="color:#3ad900;font-weight:400">""</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;<span style="color:#ff9d00;font-weight:700">len</span>(args)&nbsp;&gt;&nbsp;<span style="color:#ff0044;font-weight:400">1</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;starg=<span style="color:#ff0044;font-weight:400">1</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">while</span>&nbsp;starg&nbsp;&lt;&nbsp;<span style="color:#ff9d00;font-weight:700">len</span>(args):<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;(args[starg].upper()&nbsp;==&nbsp;<span style="color:#3ad900;font-weight:400">"ALL"</span>):<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;allowos=<span style="color:#ff0044;font-weight:400">1</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;(args[starg].upper()&nbsp;==&nbsp;<span style="color:#3ad900;font-weight:400">"BP"</span>):<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dohook=<span style="color:#ff0044;font-weight:400">1</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;starg=starg+<span style="color:#ff0044;font-weight:400">1</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;(allowos==<span style="color:#ff0044;font-weight:400">0</span>):<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;[+]&nbsp;Not&nbsp;showing&nbsp;functions&nbsp;from&nbsp;dll's&nbsp;in&nbsp;windows&nbsp;folder"</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">else</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;[+]&nbsp;Showing&nbsp;functions&nbsp;from&nbsp;all&nbsp;loaded&nbsp;modules"</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;(dohook==<span style="color:#ff0044;font-weight:400">0</span>):<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;[+]&nbsp;No&nbsp;going&nbsp;to&nbsp;set&nbsp;breakpoints"</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">else</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;[+]&nbsp;Enabling&nbsp;breakpoints&nbsp;on&nbsp;all&nbsp;functions"</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;<span style="color:#ff9d00;font-weight:700">len</span>(g_modules)==<span style="color:#ff0044;font-weight:400">0</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;moduleinfo()<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;modulefilter&nbsp;&lt;&gt;&nbsp;<span style="color:#3ad900;font-weight:400">""</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;[+]&nbsp;Only&nbsp;showing&nbsp;functions&nbsp;from&nbsp;module&nbsp;%s"</span>&nbsp;%&nbsp;modulefilter)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.updateLog()<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;nrfuncs=<span style="color:#ff0044;font-weight:400">0</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;calltypes=[]<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fprol=[]<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;addys=[]<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;foundfuncs=[]<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.updateLog()<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">for</span>&nbsp;mname&nbsp;<span style="color:#ff9d00;font-weight:700">in</span>&nbsp;g_modules:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mnamentry=mname.split(<span style="color:#3ad900;font-weight:400">'\t'</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;modname=mnamentry[<span style="color:#ff0044;font-weight:400">0</span>].lower()<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mbase=<span style="color:#ff9d00;font-weight:700">int</span>(mnamentry[<span style="color:#ff0044;font-weight:400">2</span>])<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mloc=mnamentry[<span style="color:#ff0044;font-weight:400">1</span>]<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dosearch=<span style="color:#ff0044;font-weight:400">1</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;allowos==<span style="color:#ff0044;font-weight:400">0</span>&nbsp;<span style="color:#ff9d00;font-weight:700">and</span>&nbsp;isosmodule(modname)&nbsp;==&nbsp;<span style="color:#ff0044;font-weight:400">1</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dosearch=<span style="color:#ff0044;font-weight:400">0</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;modulefilter&nbsp;&lt;&gt;&nbsp;<span style="color:#3ad900;font-weight:400">""</span>&nbsp;<span style="color:#ff9d00;font-weight:700">and</span>&nbsp;modname.lower().find(modulefilter.lower())&nbsp;==&nbsp;-<span style="color:#ff0044;font-weight:400">1</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dosearch=<span style="color:#ff0044;font-weight:400">0</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.updateLog()<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;dosearch==<span style="color:#ff0044;font-weight:400">1</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;allfunctions&nbsp;=&nbsp;imm.getAllFunctions(mbase)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"Number&nbsp;of&nbsp;functions&nbsp;found&nbsp;in&nbsp;%s&nbsp;:&nbsp;%d&nbsp;(pass&nbsp;1)"</span>&nbsp;%&nbsp;(modname,<span style="color:#ff9d00;font-weight:700">len</span>(allfunctions)))<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">for</span>&nbsp;func&nbsp;<span style="color:#ff9d00;font-weight:700">in</span>&nbsp;allfunctions:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;thisfunction=imm.getFunction(func)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;funcaddress=thisfunction.getStart()<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;funcname=thisfunction.getName()<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;funcaddress&nbsp;&gt;&nbsp;<span style="color:#ff0044;font-weight:400">0</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">try</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;itemf&nbsp;=&nbsp;foundfuncs.index(funcaddress)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#0088ff;font-weight:400">#imm.log("Skipping&nbsp;duplicate&nbsp;pointer&nbsp;%s&nbsp;(index&nbsp;%d)"&nbsp;%&nbsp;(tohex(funcaddress),itemf))</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">except</span>&nbsp;<span style="color:#7f0044;font-weight:400">ValueError</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;funcend=getRet(imm,funcaddress)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;funcend&nbsp;&gt;&nbsp;<span style="color:#ff0044;font-weight:400">0</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;*&nbsp;Adding&nbsp;new&nbsp;function&nbsp;at&nbsp;0x%s&nbsp;(RET&nbsp;at&nbsp;0x%s)&nbsp;to&nbsp;list"</span>&nbsp;%&nbsp;(tohex(funcaddress),tohex(funcend)))<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;foundfuncs.append(<span style="color:#ff9d00;font-weight:700">str</span>(funcaddress)+<span style="color:#3ad900;font-weight:400">"&nbsp;"</span>+<span style="color:#ff9d00;font-weight:700">str</span>(funcend))<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;nrfuncs=nrfuncs+<span style="color:#ff0044;font-weight:400">1</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">else</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;*&nbsp;Could&nbsp;not&nbsp;find&nbsp;end&nbsp;of&nbsp;function&nbsp;at&nbsp;0x%s&nbsp;-&nbsp;pointer&nbsp;skipped"</span>&nbsp;%&nbsp;tohex(funcaddress))<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#0088ff;font-weight:400">#also&nbsp;look&nbsp;for&nbsp;function&nbsp;prologues&nbsp;in&nbsp;this&nbsp;module</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;prologue=<span style="color:#3ad900;font-weight:400">"PUSH&nbsp;EBP\n&nbsp;MOV&nbsp;EBP,ESP\n"</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;thissearch=prologue.decode(<span style="color:#3ad900;font-weight:400">'string_escape'</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;addys=imm.searchCommandsOnModule(mbase,thissearch)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#0088ff;font-weight:400">#get&nbsp;function&nbsp;begin&nbsp;for&nbsp;each&nbsp;of&nbsp;those&nbsp;addys</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">for</span>&nbsp;prol&nbsp;<span style="color:#ff9d00;font-weight:700">in</span>&nbsp;addys:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#0088ff;font-weight:400">#funcbegin=imm.getFunctionBegin(prol[0])</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#0088ff;font-weight:400">#if&nbsp;funcbegin==0:</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;funcbegin=prol[<span style="color:#ff0044;font-weight:400">0</span>]<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">try</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;itemf&nbsp;=&nbsp;foundfuncs.index(funcbegin)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#0088ff;font-weight:400">#imm.log("Skipping&nbsp;duplicate&nbsp;pointer&nbsp;%s&nbsp;(index&nbsp;%d)"&nbsp;%&nbsp;(tohex(funcbegin),itemf))</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">except</span>&nbsp;<span style="color:#7f0044;font-weight:400">ValueError</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;funcend=getRet(imm,funcbegin)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;funcend&nbsp;&gt;&nbsp;<span style="color:#ff0044;font-weight:400">0</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;*&nbsp;Adding&nbsp;new&nbsp;function&nbsp;at&nbsp;0x%s&nbsp;(RET&nbsp;at&nbsp;0x%s)&nbsp;to&nbsp;list"</span>&nbsp;%&nbsp;(tohex(funcbegin),tohex(funcend)))<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;foundfuncs.append(<span style="color:#ff9d00;font-weight:700">str</span>(funcbegin)+<span style="color:#3ad900;font-weight:400">"&nbsp;"</span>+<span style="color:#ff9d00;font-weight:700">str</span>(funcend))<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;nrfuncs=nrfuncs+<span style="color:#ff0044;font-weight:400">1</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">else</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;*&nbsp;Could&nbsp;not&nbsp;find&nbsp;end&nbsp;of&nbsp;function&nbsp;at&nbsp;0x%s&nbsp;-&nbsp;pointer&nbsp;skipped"</span>&nbsp;%&nbsp;tohex(funcbegin))<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"Number&nbsp;of&nbsp;prologues&nbsp;found&nbsp;in&nbsp;%s&nbsp;:&nbsp;%d&nbsp;(pass&nbsp;2)"</span>&nbsp;%&nbsp;(modname,<span style="color:#ff9d00;font-weight:700">len</span>(addys)))<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#0088ff;font-weight:400">#finally&nbsp;look&nbsp;for&nbsp;calls&nbsp;into&nbsp;either&nbsp;the&nbsp;executable&nbsp;or&nbsp;non&nbsp;OS&nbsp;modules</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;calls=<span style="color:#3ad900;font-weight:400">"CALL&nbsp;offset"</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;nrcall=<span style="color:#ff0044;font-weight:400">0</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;addys=imm.searchCommandsOnModule(mbase,calls)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">for</span>&nbsp;thiscall&nbsp;<span style="color:#ff9d00;font-weight:700">in</span>&nbsp;addys:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;op&nbsp;=&nbsp;imm.Disasm(&nbsp;thiscall[<span style="color:#ff0044;font-weight:400">0</span>]&nbsp;)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;opstring=op.getDisasm()<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#0088ff;font-weight:400">#filter&nbsp;out&nbsp;OS&nbsp;calls</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;opstring.upper().find(<span style="color:#3ad900;font-weight:400">"&lt;"</span>)&nbsp;==&nbsp;-<span style="color:#ff0044;font-weight:400">1</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;opstring.upper().find(<span style="color:#3ad900;font-weight:400">"."</span>)&nbsp;&gt;&nbsp;-<span style="color:#ff0044;font-weight:400">1</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;addressparts=opstring.split(<span style="color:#3ad900;font-weight:400">'.'</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">try</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;targetfunc=addresstoint(addressparts[<span style="color:#ff9d00;font-weight:700">len</span>(addressparts)-<span style="color:#ff0044;font-weight:400">1</span>])<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#0088ff;font-weight:400">#filter&nbsp;more&nbsp;OS&nbsp;calls</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;isosmodule(addressparts[<span style="color:#ff0044;font-weight:400">0</span>])==<span style="color:#ff0044;font-weight:400">0</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">try</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;itemf&nbsp;=&nbsp;foundfuncs.index(targetfunc)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#0088ff;font-weight:400">#imm.log("&nbsp;&nbsp;&nbsp;Skipping&nbsp;duplicate&nbsp;pointer&nbsp;%s&nbsp;(index&nbsp;%d)"&nbsp;%&nbsp;(tohex(targetfunc),itemf))</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">except</span>&nbsp;<span style="color:#7f0044;font-weight:400">ValueError</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;addptr=<span style="color:#ff0044;font-weight:400">1</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;(allowos==<span style="color:#ff0044;font-weight:400">0</span>):<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ainfo=addressinfo(targetfunc)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;isosmodule(ainfo)==<span style="color:#ff0044;font-weight:400">0</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;addptr=<span style="color:#ff0044;font-weight:400">0</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;addptr==<span style="color:#ff0044;font-weight:400">1</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;funcend=getRet(imm,targetfunc)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;funcend&nbsp;&gt;&nbsp;<span style="color:#ff0044;font-weight:400">0</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;*&nbsp;Adding&nbsp;new&nbsp;function&nbsp;at&nbsp;0x%s&nbsp;(RET&nbsp;at&nbsp;0x%s)&nbsp;to&nbsp;list"</span>&nbsp;%&nbsp;(tohex(targetfunc),tohex(funcend)))<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;foundfuncs.append(<span style="color:#ff9d00;font-weight:700">str</span>(targetfunc)+<span style="color:#3ad900;font-weight:400">"&nbsp;"</span>+<span style="color:#ff9d00;font-weight:700">str</span>(funcend))<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;nrfuncs=nrfuncs+<span style="color:#ff0044;font-weight:400">1</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">else</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;*&nbsp;Could&nbsp;not&nbsp;find&nbsp;end&nbsp;of&nbsp;function&nbsp;at&nbsp;0x%s&nbsp;-&nbsp;pointer&nbsp;skipped"</span>&nbsp;%&nbsp;tohex(targetfunc))<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;nrcall=nrcall+<span style="color:#ff0044;font-weight:400">1</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">except</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">pass</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"Number&nbsp;of&nbsp;functions&nbsp;found&nbsp;in&nbsp;%s&nbsp;:&nbsp;%d&nbsp;(pass&nbsp;3)"</span>&nbsp;%&nbsp;(modname,nrcall))<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"Total&nbsp;number&nbsp;of&nbsp;unique&nbsp;functions&nbsp;found&nbsp;:&nbsp;%d"</span>&nbsp;%&nbsp;<span style="color:#ff9d00;font-weight:700">len</span>(foundfuncs))<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"Dumping&nbsp;function&nbsp;pointers&nbsp;to&nbsp;file"</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.updateLog()<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">for</span>&nbsp;thisptr&nbsp;<span style="color:#ff9d00;font-weight:700">in</span>&nbsp;foundfuncs:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tptr=<span style="color:#ff9d00;font-weight:700">str</span>(thisptr).split(<span style="color:#3ad900;font-weight:400">'&nbsp;'</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fsize=<span style="color:#ff9d00;font-weight:700">int</span>(tptr[<span style="color:#ff0044;font-weight:400">1</span>])-<span style="color:#ff9d00;font-weight:700">int</span>(tptr[<span style="color:#ff0044;font-weight:400">0</span>])<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tofile(<span style="color:#3ad900;font-weight:400">"sub_"</span>+tohex(<span style="color:#ff9d00;font-weight:700">int</span>(tptr[<span style="color:#ff0044;font-weight:400">0</span>]))+<span style="color:#3ad900;font-weight:400">"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.text&nbsp;"</span>+tohex(<span style="color:#ff9d00;font-weight:700">int</span>(tptr[<span style="color:#ff0044;font-weight:400">0</span>]))+<span style="color:#3ad900;font-weight:400">"&nbsp;"</span>+tohex(fsize),filename,<span style="color:#ff9d00;font-weight:700">int</span>(tptr[<span style="color:#ff0044;font-weight:400">0</span>]))<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;(dohook==<span style="color:#ff0044;font-weight:400">1</span>):<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.setBreakpoint(<span style="color:#ff9d00;font-weight:700">int</span>(tptr[<span style="color:#ff0044;font-weight:400">0</span>],<span style="color:#ff0044;font-weight:400">16</span>))<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"Done."</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.updateLog()<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">return</span>&nbsp;<span style="color:#3ad900;font-weight:400">"%i&nbsp;functions&nbsp;found."</span>&nbsp;%&nbsp;<span style="color:#ff9d00;font-weight:700">len</span>(foundfuncs)<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;args[<span style="color:#ff0044;font-weight:400">0</span>]&nbsp;==&nbsp;<span style="color:#3ad900;font-weight:400">"omelet"</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;shellcodefile=<span style="color:#3ad900;font-weight:400">""</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;filename=<span style="color:#3ad900;font-weight:400">"omelet.txt"</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;egg_size=<span style="color:#ff0044;font-weight:400">123</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;egg_tag=<span style="color:#3ad900;font-weight:400">"303077"</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;<span style="color:#ff9d00;font-weight:700">len</span>(args)&nbsp;&gt;&nbsp;<span style="color:#ff0044;font-weight:400">1</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cnt=<span style="color:#ff0044;font-weight:400">1</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">while</span>&nbsp;cnt&nbsp;&lt;&nbsp;<span style="color:#ff9d00;font-weight:700">len</span>(args):<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;args[cnt]==<span style="color:#3ad900;font-weight:400">'-f'</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;cnt&nbsp;&lt;&nbsp;(<span style="color:#ff9d00;font-weight:700">len</span>(args)-<span style="color:#ff0044;font-weight:400">1</span>):<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;shellcodefile=args[cnt+<span style="color:#ff0044;font-weight:400">1</span>]<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;args[cnt]==<span style="color:#3ad900;font-weight:400">'-s'</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;cnt&nbsp;&lt;&nbsp;(<span style="color:#ff9d00;font-weight:700">len</span>(args)-<span style="color:#ff0044;font-weight:400">1</span>):<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;egg_size=args[cnt+<span style="color:#ff0044;font-weight:400">1</span>]<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;args[cnt]==<span style="color:#3ad900;font-weight:400">'-t'</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;cnt&nbsp;&lt;&nbsp;(<span style="color:#ff9d00;font-weight:700">len</span>(args)-<span style="color:#ff0044;font-weight:400">1</span>):<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;egg_tag=args[cnt+<span style="color:#ff0044;font-weight:400">1</span>]<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cnt=cnt+<span style="color:#ff0044;font-weight:400">1</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#0088ff;font-weight:400">#egg&nbsp;tag&nbsp;should&nbsp;be&nbsp;6&nbsp;chars</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;<span style="color:#ff9d00;font-weight:700">len</span>(egg_tag)&nbsp;!=&nbsp;<span style="color:#ff0044;font-weight:400">6</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"Tag&nbsp;should&nbsp;be&nbsp;6&nbsp;characters&nbsp;!"</span>,highlight=<span style="color:#ff0044;font-weight:400">1</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">return</span>&nbsp;<span style="color:#3ad900;font-weight:400">"Error&nbsp;-&nbsp;check&nbsp;input"</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#0088ff;font-weight:400">#egg&nbsp;size</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;IsNumber(egg_size):<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;<span style="color:#ff9d00;font-weight:700">int</span>(egg_size)&nbsp;&lt;=&nbsp;<span style="color:#ff0044;font-weight:400">1</span>&nbsp;<span style="color:#ff9d00;font-weight:700">or</span>&nbsp;<span style="color:#ff9d00;font-weight:700">int</span>(egg_size)&nbsp;&gt;&nbsp;<span style="color:#ff0044;font-weight:400">123</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"Invalid&nbsp;egg&nbsp;block&nbsp;size&nbsp;value.&nbsp;Value&nbsp;must&nbsp;be&nbsp;&gt;&nbsp;0&nbsp;and&nbsp;&lt;=&nbsp;123"</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">return</span>&nbsp;<span style="color:#3ad900;font-weight:400">"Error&nbsp;-&nbsp;check&nbsp;input"</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">else</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"Maximum&nbsp;egg&nbsp;block&nbsp;size&nbsp;value&nbsp;is&nbsp;not&nbsp;a&nbsp;number"</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">return</span>&nbsp;<span style="color:#3ad900;font-weight:400">"Error&nbsp;-&nbsp;check&nbsp;input"</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#0088ff;font-weight:400">#filename</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;os.path.isfile(shellcodefile):<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;resetfile(filename)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"Reading&nbsp;file&nbsp;%s..."</span>&nbsp;%&nbsp;shellcodefile)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;srcdata=[]<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;srcfile&nbsp;=&nbsp;<span style="color:#ff9d00;font-weight:700">open</span>(shellcodefile,<span style="color:#3ad900;font-weight:400">"rb"</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;content&nbsp;=&nbsp;srcfile.readlines()<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;srcfile.close()<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">for</span>&nbsp;eachLine&nbsp;<span style="color:#ff9d00;font-weight:700">in</span>&nbsp;content:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;srcdata&nbsp;+=&nbsp;eachLine<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"[+]&nbsp;Read&nbsp;%d&nbsp;bytes&nbsp;from&nbsp;file"</span>&nbsp;%&nbsp;<span style="color:#ff9d00;font-weight:700">len</span>(srcdata))<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#0088ff;font-weight:400">#calculate&nbsp;number&nbsp;of&nbsp;eggs</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;egg_size=<span style="color:#ff9d00;font-weight:700">int</span>(egg_size)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;nr_eggs=<span style="color:#ff9d00;font-weight:700">len</span>(srcdata)&nbsp;/&nbsp;egg_size<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;delta=nr_eggs&nbsp;*&nbsp;egg_size<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;delta&nbsp;&lt;&nbsp;<span style="color:#ff9d00;font-weight:700">len</span>(srcdata):<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;nr_eggs=nr_eggs+<span style="color:#ff0044;font-weight:400">1</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"[+]&nbsp;Number&nbsp;of&nbsp;eggs&nbsp;to&nbsp;be&nbsp;generated&nbsp;:&nbsp;%d"</span>&nbsp;%&nbsp;nr_eggs)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#0088ff;font-weight:400">#first,&nbsp;create&nbsp;the&nbsp;omelet</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"[+]&nbsp;Generating&nbsp;omelet&nbsp;code..."</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;omelet&nbsp;=&nbsp;<span style="color:#3ad900;font-weight:400">"\xeb\x24\x54\x5f\x66\x81\xcf\xff\xff\x89\xfa\x31\xc0\xb0"</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;omelet&nbsp;+=&nbsp;binascii.unhexlify(tohexbyte(nr_eggs))<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;omelet&nbsp;+=&nbsp;<span style="color:#3ad900;font-weight:400">"\x31\xf6\x66\xbe"</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;omelet&nbsp;+=&nbsp;binascii.unhexlify(tohexbyte(<span style="color:#ff0044;font-weight:400">237</span>-egg_size))<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;omelet&nbsp;+=&nbsp;<span style="color:#3ad900;font-weight:400">"\xff\x4f\x46\x66\x81\xfe\xff\xff\x75\xf7\x48\x75\xee\x31\xdb\xb3"</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;omelet&nbsp;+=&nbsp;binascii.unhexlify(tohexbyte(nr_eggs+<span style="color:#ff0044;font-weight:400">1</span>)&nbsp;)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;omelet&nbsp;+=&nbsp;<span style="color:#3ad900;font-weight:400">"\xc3\xe8\xd7\xff\xff\xff\xeb\x04\x4a\x4a\x4a\x4a\x42\x52\x6a\x02"</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;omelet&nbsp;+=&nbsp;<span style="color:#3ad900;font-weight:400">"\x58\xcd\x2e\x3c\x05\x5a\x74\xf4\xb8\x01"</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;omelet&nbsp;+=&nbsp;binascii.unhexlify(egg_tag)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;omelet&nbsp;+=&nbsp;<span style="color:#3ad900;font-weight:400">"\x01\xd8\x87\xfa"</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;omelet&nbsp;+=&nbsp;<span style="color:#3ad900;font-weight:400">"\xaf\x87\xfa\x75\xe2\x89\xd6\x31\xc9\xb1"</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;omelet&nbsp;+=&nbsp;binascii.unhexlify(tohexbyte(egg_size))<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;omelet&nbsp;+=&nbsp;<span style="color:#3ad900;font-weight:400">"\xf3\xa4\x4b\x80\xfb\x01\x75\xd4\xe8\xa4\xff\xff\xff\xff\xe7"</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;&nbsp;&nbsp;&nbsp;Omelet&nbsp;size&nbsp;:&nbsp;%d&nbsp;bytes"</span>&nbsp;%&nbsp;<span style="color:#ff9d00;font-weight:700">len</span>(omelet))<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#0088ff;font-weight:400">#write&nbsp;omelet&nbsp;to&nbsp;file</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cnt=<span style="color:#ff0044;font-weight:400">0</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;linecnt=<span style="color:#ff0044;font-weight:400">0</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;byteperline=<span style="color:#ff0044;font-weight:400">16</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;hexchar=<span style="color:#3ad900;font-weight:400">""</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tofile(<span style="color:#3ad900;font-weight:400">""</span>,filename)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tofile(<span style="color:#3ad900;font-weight:400">"#corelanc0d3r's&nbsp;eggs-to-omelet&nbsp;hunter"</span>,filename)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tofile(<span style="color:#3ad900;font-weight:400">"#"</span>&nbsp;+&nbsp;<span style="color:#ff9d00;font-weight:700">str</span>(<span style="color:#ff9d00;font-weight:700">len</span>(omelet))+<span style="color:#3ad900;font-weight:400">"&nbsp;bytes&nbsp;//&nbsp;http://www.corelan.be:8800"</span>,filename)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tofile(<span style="color:#3ad900;font-weight:400">"my&nbsp;$omelet&nbsp;=&nbsp;"</span>,filename)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;omeletstring=<span style="color:#3ad900;font-weight:400">""</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">while</span>&nbsp;(cnt&nbsp;&lt;&nbsp;<span style="color:#ff9d00;font-weight:700">len</span>(omelet)):<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;<span style="color:#ff9d00;font-weight:700">len</span>((<span style="color:#ff9d00;font-weight:700">hex</span>(<span style="color:#ff9d00;font-weight:700">ord</span>(omelet[cnt]))).replace(<span style="color:#3ad900;font-weight:400">'0x'</span>,<span style="color:#3ad900;font-weight:400">''</span>))==<span style="color:#ff0044;font-weight:400">1</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;hexchar=&nbsp;hexchar&nbsp;+&nbsp;<span style="color:#3ad900;font-weight:400">"\\x"</span>&nbsp;+&nbsp;<span style="color:#ff9d00;font-weight:700">hex</span>(<span style="color:#ff9d00;font-weight:700">ord</span>(omelet[cnt])).replace(<span style="color:#3ad900;font-weight:400">'0x'</span>,&nbsp;<span style="color:#3ad900;font-weight:400">'0'</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">else</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;hexchar&nbsp;=&nbsp;hexchar&nbsp;+&nbsp;<span style="color:#3ad900;font-weight:400">"\\x"</span>&nbsp;+&nbsp;<span style="color:#ff9d00;font-weight:700">hex</span>(<span style="color:#ff9d00;font-weight:700">ord</span>(omelet[cnt])).replace(<span style="color:#3ad900;font-weight:400">'0x'</span>,&nbsp;<span style="color:#3ad900;font-weight:400">''</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;linecnt=linecnt+<span style="color:#ff0044;font-weight:400">1</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cnt=cnt+<span style="color:#ff0044;font-weight:400">1</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;linecnt==(byteperline-<span style="color:#ff0044;font-weight:400">1</span>)&nbsp;<span style="color:#ff9d00;font-weight:700">or</span>&nbsp;(cnt&nbsp;==&nbsp;<span style="color:#ff9d00;font-weight:700">len</span>(omelet)):<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;cnt&nbsp;==&nbsp;<span style="color:#ff9d00;font-weight:700">len</span>(omelet):<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tofile(<span style="color:#3ad900;font-weight:400">"\""</span>+hexchar+<span style="color:#3ad900;font-weight:400">"\";"</span>,filename)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;hexchar=<span style="color:#3ad900;font-weight:400">""</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">else</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;linecnt==(byteperline-<span style="color:#ff0044;font-weight:400">1</span>):<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tofile(<span style="color:#3ad900;font-weight:400">"\""</span>+hexchar+&nbsp;<span style="color:#3ad900;font-weight:400">"\"&nbsp;."</span>,filename)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;hexchar=<span style="color:#3ad900;font-weight:400">""</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;linecnt=<span style="color:#ff0044;font-weight:400">0</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#0088ff;font-weight:400">#adding&nbsp;nops&nbsp;if&nbsp;necessary</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;&nbsp;&nbsp;&nbsp;Original&nbsp;shellcode&nbsp;size&nbsp;:&nbsp;%d"</span>&nbsp;%&nbsp;<span style="color:#ff9d00;font-weight:700">len</span>(srcdata))<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;nops=<span style="color:#3ad900;font-weight:400">"A"</span>&nbsp;*&nbsp;((nr_eggs&nbsp;*&nbsp;egg_size)&nbsp;-&nbsp;<span style="color:#ff9d00;font-weight:700">len</span>(srcdata))<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">for</span>&nbsp;nopbyte&nbsp;<span style="color:#ff9d00;font-weight:700">in</span>&nbsp;nops:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;srcdata.append(nopbyte)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;shell_size=<span style="color:#ff9d00;font-weight:700">len</span>(srcdata)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;&nbsp;&nbsp;&nbsp;Total&nbsp;shellcode&nbsp;size,&nbsp;%d&nbsp;byte&nbsp;aligned&nbsp;:&nbsp;%d"</span>&nbsp;%&nbsp;(egg_size,shell_size))<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"[+]&nbsp;Generating&nbsp;eggs..."</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;eggcnt=nr_eggs+<span style="color:#ff0044;font-weight:400">2</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;startcode=<span style="color:#ff0044;font-weight:400">0</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cnt=<span style="color:#ff0044;font-weight:400">0</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;eggbytes=<span style="color:#ff0044;font-weight:400">0</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;eggsdone=<span style="color:#ff0044;font-weight:400">0</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;source=<span style="color:#3ad900;font-weight:400">""</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;hexchar=<span style="color:#3ad900;font-weight:400">""</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;thisegg=<span style="color:#3ad900;font-weight:400">""</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">while</span>&nbsp;(cnt&nbsp;&lt;&nbsp;shell_size):<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">while</span>&nbsp;(eggbytes&nbsp;&lt;&nbsp;egg_size)&nbsp;<span style="color:#ff9d00;font-weight:700">and</span>&nbsp;(cnt&nbsp;&lt;&nbsp;shell_size):<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">try</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;<span style="color:#ff9d00;font-weight:700">len</span>((<span style="color:#ff9d00;font-weight:700">hex</span>(<span style="color:#ff9d00;font-weight:700">ord</span>(srcdata[cnt]))).replace(<span style="color:#3ad900;font-weight:400">'0x'</span>,<span style="color:#3ad900;font-weight:400">''</span>))==<span style="color:#ff0044;font-weight:400">1</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;hexchar=<span style="color:#ff9d00;font-weight:700">hex</span>(<span style="color:#ff9d00;font-weight:700">ord</span>(srcdata[cnt])).replace(<span style="color:#3ad900;font-weight:400">'0x'</span>,&nbsp;<span style="color:#3ad900;font-weight:400">'0'</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">else</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;hexchar&nbsp;=&nbsp;<span style="color:#ff9d00;font-weight:700">hex</span>(<span style="color:#ff9d00;font-weight:700">ord</span>(srcdata[cnt])).replace(<span style="color:#3ad900;font-weight:400">'0x'</span>,&nbsp;<span style="color:#3ad900;font-weight:400">''</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;thisegg&nbsp;+=&nbsp;srcdata[cnt]<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cnt=cnt+<span style="color:#ff0044;font-weight:400">1</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;eggbytes=eggbytes+<span style="color:#ff0044;font-weight:400">1</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">except</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"Unable&nbsp;to&nbsp;process&nbsp;byte&nbsp;%d&nbsp;"</span>&nbsp;%&nbsp;cnt)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cnt=cnt+<span style="color:#ff0044;font-weight:400">1</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;eggbytes=eggbytes+<span style="color:#ff0044;font-weight:400">1</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">pass</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;eggbytes&nbsp;==&nbsp;egg_size:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;eggsdone=eggsdone+<span style="color:#ff0044;font-weight:400">1</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;thistag&nbsp;=&nbsp;<span style="color:#3ad900;font-weight:400">"\\x"</span>+tohexbyte(eggcnt)+<span style="color:#3ad900;font-weight:400">"\\x"</span>+egg_tag[<span style="color:#ff0044;font-weight:400">0</span>]+egg_tag[<span style="color:#ff0044;font-weight:400">1</span>]+<span style="color:#3ad900;font-weight:400">"\\x"</span>+egg_tag[<span style="color:#ff0044;font-weight:400">2</span>]+egg_tag[<span style="color:#ff0044;font-weight:400">3</span>]+<span style="color:#3ad900;font-weight:400">"\\x"</span>&nbsp;+&nbsp;egg_tag[<span style="color:#ff0044;font-weight:400">4</span>]+egg_tag[<span style="color:#ff0044;font-weight:400">5</span>]<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tagbyte=binascii.unhexlify(tohexbyte(eggcnt)+egg_tag)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;thisegg&nbsp;=&nbsp;tagbyte&nbsp;+&nbsp;thisegg<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;&nbsp;-&nbsp;Created&nbsp;egg&nbsp;%d,&nbsp;tag&nbsp;%s,&nbsp;len&nbsp;%d&nbsp;"</span>&nbsp;%&nbsp;(eggsdone,thistag,<span style="color:#ff9d00;font-weight:700">len</span>(thisegg)))<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#0088ff;font-weight:400">#write&nbsp;this&nbsp;one&nbsp;to&nbsp;file</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tofile(<span style="color:#3ad900;font-weight:400">""</span>,filename)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tofile(<span style="color:#3ad900;font-weight:400">"#egg&nbsp;"</span>&nbsp;+&nbsp;<span style="color:#ff9d00;font-weight:700">str</span>(eggsdone)+<span style="color:#3ad900;font-weight:400">"&nbsp;:&nbsp;"</span>,filename)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tofile(<span style="color:#3ad900;font-weight:400">"my&nbsp;$egg"</span>&nbsp;+&nbsp;<span style="color:#ff9d00;font-weight:700">str</span>(eggsdone)+<span style="color:#3ad900;font-weight:400">"&nbsp;=&nbsp;"</span>,filename)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ecnt=<span style="color:#ff0044;font-weight:400">0</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;linecnt=<span style="color:#ff0044;font-weight:400">0</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;byteperline=<span style="color:#ff0044;font-weight:400">16</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;hexchar=<span style="color:#3ad900;font-weight:400">""</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">while</span>&nbsp;(ecnt&nbsp;&lt;&nbsp;<span style="color:#ff9d00;font-weight:700">len</span>(thisegg)):<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;<span style="color:#ff9d00;font-weight:700">len</span>((<span style="color:#ff9d00;font-weight:700">hex</span>(<span style="color:#ff9d00;font-weight:700">ord</span>(thisegg[ecnt]))).replace(<span style="color:#3ad900;font-weight:400">'0x'</span>,<span style="color:#3ad900;font-weight:400">''</span>))==<span style="color:#ff0044;font-weight:400">1</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;hexchar=&nbsp;hexchar&nbsp;+&nbsp;<span style="color:#3ad900;font-weight:400">"\\x"</span>&nbsp;+&nbsp;<span style="color:#ff9d00;font-weight:700">hex</span>(<span style="color:#ff9d00;font-weight:700">ord</span>(thisegg[ecnt])).replace(<span style="color:#3ad900;font-weight:400">'0x'</span>,&nbsp;<span style="color:#3ad900;font-weight:400">'0'</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">else</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;hexchar&nbsp;=&nbsp;hexchar&nbsp;+&nbsp;<span style="color:#3ad900;font-weight:400">"\\x"</span>&nbsp;+&nbsp;<span style="color:#ff9d00;font-weight:700">hex</span>(<span style="color:#ff9d00;font-weight:700">ord</span>(thisegg[ecnt])).replace(<span style="color:#3ad900;font-weight:400">'0x'</span>,&nbsp;<span style="color:#3ad900;font-weight:400">''</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;linecnt=linecnt+<span style="color:#ff0044;font-weight:400">1</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ecnt=ecnt+<span style="color:#ff0044;font-weight:400">1</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;linecnt==(byteperline-<span style="color:#ff0044;font-weight:400">1</span>)&nbsp;<span style="color:#ff9d00;font-weight:700">or</span>&nbsp;(ecnt&nbsp;==&nbsp;<span style="color:#ff9d00;font-weight:700">len</span>(thisegg)):<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;ecnt&nbsp;==&nbsp;<span style="color:#ff9d00;font-weight:700">len</span>(thisegg):<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tofile(<span style="color:#3ad900;font-weight:400">"\""</span>+hexchar+<span style="color:#3ad900;font-weight:400">"\";"</span>,filename)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;hexchar=<span style="color:#3ad900;font-weight:400">""</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">else</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;linecnt==(byteperline-<span style="color:#ff0044;font-weight:400">1</span>):<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tofile(<span style="color:#3ad900;font-weight:400">"\""</span>+hexchar+&nbsp;<span style="color:#3ad900;font-weight:400">"\"&nbsp;."</span>,filename)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;hexchar=<span style="color:#3ad900;font-weight:400">""</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;linecnt=<span style="color:#ff0044;font-weight:400">0</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;eggcnt=eggcnt-<span style="color:#ff0044;font-weight:400">1</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;eggbytes=<span style="color:#ff0044;font-weight:400">0</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;thisegg=<span style="color:#3ad900;font-weight:400">""</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;[+]&nbsp;Done&nbsp;-&nbsp;check&nbsp;omelet.txt"</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">else</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"Could&nbsp;not&nbsp;read&nbsp;shellcode&nbsp;file"</span>,highlight=<span style="color:#ff0044;font-weight:400">1</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">return</span>&nbsp;<span style="color:#3ad900;font-weight:400">"Error"</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">return</span>&nbsp;<span style="color:#3ad900;font-weight:400">"Done&nbsp;-&nbsp;check&nbsp;omelet.txt"</span><br /><br />&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;args[<span style="color:#ff0044;font-weight:400">0</span>]&nbsp;==&nbsp;<span style="color:#3ad900;font-weight:400">"filecompare"</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;filename=<span style="color:#3ad900;font-weight:400">"filecompare.txt"</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;allfiles=[]<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rawfilenames=<span style="color:#3ad900;font-weight:400">""</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;refpointer=<span style="color:#3ad900;font-weight:400">""</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;comppointers=<span style="color:#ff0044;font-weight:400">0</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;<span style="color:#ff9d00;font-weight:700">len</span>(args)&nbsp;&gt;&nbsp;<span style="color:#ff0044;font-weight:400">1</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cnt=<span style="color:#ff0044;font-weight:400">1</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;paramf=<span style="color:#ff0044;font-weight:400">0</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">while</span>&nbsp;cnt&nbsp;&lt;&nbsp;<span style="color:#ff9d00;font-weight:700">len</span>(args):<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;args[cnt]==<span style="color:#3ad900;font-weight:400">'-f'</span>&nbsp;<span style="color:#ff9d00;font-weight:700">or</span>&nbsp;paramf==<span style="color:#ff0044;font-weight:400">1</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#0088ff;font-weight:400">#read&nbsp;all&nbsp;filenames</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;paramf=<span style="color:#ff0044;font-weight:400">1</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;cnt&nbsp;&lt;&nbsp;(<span style="color:#ff9d00;font-weight:700">len</span>(args)-<span style="color:#ff0044;font-weight:400">1</span>):<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rawfilenames=rawfilenames&nbsp;+&nbsp;<span style="color:#3ad900;font-weight:400">"&nbsp;"</span>&nbsp;+args[cnt+<span style="color:#ff0044;font-weight:400">1</span>].lower()<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cnt=cnt+<span style="color:#ff0044;font-weight:400">1</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rawfilenames=rawfilenames.replace(<span style="color:#3ad900;font-weight:400">'"'</span>,<span style="color:#3ad900;font-weight:400">""</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;allfiles&nbsp;=&nbsp;rawfilenames.split(<span style="color:#3ad900;font-weight:400">','</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"Number&nbsp;of&nbsp;files&nbsp;to&nbsp;be&nbsp;examined&nbsp;:&nbsp;%d&nbsp;:&nbsp;"</span>&nbsp;%&nbsp;<span style="color:#ff9d00;font-weight:700">len</span>(allfiles))<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#0088ff;font-weight:400">#check&nbsp;if&nbsp;file&nbsp;exists</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fcnt=<span style="color:#ff0044;font-weight:400">0</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;filesok=<span style="color:#ff0044;font-weight:400">0</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">while</span>&nbsp;fcnt&nbsp;&lt;&nbsp;<span style="color:#ff9d00;font-weight:700">len</span>(allfiles):<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;allfiles[fcnt]=allfiles[fcnt].strip()<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;os.path.exists(allfiles[fcnt]):<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;-&nbsp;%s"</span>&nbsp;%&nbsp;allfiles[fcnt])<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;filesok=filesok+<span style="color:#ff0044;font-weight:400">1</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">else</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"**&nbsp;%s&nbsp;:&nbsp;Does&nbsp;not&nbsp;exist&nbsp;!"</span>&nbsp;%&nbsp;allfiles[fcnt])<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fcnt=fcnt+<span style="color:#ff0044;font-weight:400">1</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;filesok&nbsp;&gt;&nbsp;<span style="color:#ff0044;font-weight:400">1</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;resetfile(filename)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tofile(<span style="color:#3ad900;font-weight:400">"Source&nbsp;files&nbsp;:"</span>,filename)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fcnt=<span style="color:#ff0044;font-weight:400">0</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">while</span>&nbsp;fcnt&nbsp;&lt;&nbsp;<span style="color:#ff9d00;font-weight:700">len</span>(allfiles):<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tofile(<span style="color:#3ad900;font-weight:400">"&nbsp;-&nbsp;"</span>&nbsp;+&nbsp;allfiles[fcnt],filename)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fcnt=fcnt+<span style="color:#ff0044;font-weight:400">1</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tofile(<span style="color:#3ad900;font-weight:400">""</span>,filename)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tofile(<span style="color:#3ad900;font-weight:400">"Pointers&nbsp;found&nbsp;:"</span>,filename)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tofile(<span style="color:#3ad900;font-weight:400">"----------------"</span>,filename)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"Reading&nbsp;reference&nbsp;file&nbsp;%s&nbsp;"</span>&nbsp;%&nbsp;allfiles[<span style="color:#ff0044;font-weight:400">0</span>])<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.updateLog()<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#0088ff;font-weight:400">#open&nbsp;reference&nbsp;file&nbsp;and&nbsp;read&nbsp;all&nbsp;records&nbsp;that&nbsp;contain&nbsp;a&nbsp;pointers</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;reffile&nbsp;=&nbsp;<span style="color:#ff9d00;font-weight:700">open</span>(allfiles[<span style="color:#ff0044;font-weight:400">0</span>],<span style="color:#3ad900;font-weight:400">"rb"</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;refcontent&nbsp;=&nbsp;reffile.readlines()<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;reffile.close()<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#0088ff;font-weight:400">#read&nbsp;all&nbsp;other&nbsp;files&nbsp;into&nbsp;a&nbsp;big&nbsp;array</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;targetfiles=[]<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;filecnt=<span style="color:#ff0044;font-weight:400">1</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"Reading&nbsp;other&nbsp;files..."</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.updateLog()<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">while</span>&nbsp;filecnt&nbsp;&lt;&nbsp;<span style="color:#ff9d00;font-weight:700">len</span>(allfiles):<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;&nbsp;&nbsp;%s"</span>&nbsp;%&nbsp;allfiles[filecnt])<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.updateLog()<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;targetfiles.append([])<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tfile=<span style="color:#ff9d00;font-weight:700">open</span>(allfiles[filecnt],<span style="color:#3ad900;font-weight:400">"rb"</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tcontent&nbsp;=&nbsp;tfile.readlines()<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tfile.close()<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;nrlines=<span style="color:#ff0044;font-weight:400">0</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">for</span>&nbsp;myLine&nbsp;<span style="color:#ff9d00;font-weight:700">in</span>&nbsp;tcontent:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;targetfiles[filecnt-<span style="color:#ff0044;font-weight:400">1</span>].append(myLine)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;nrlines=nrlines+<span style="color:#ff0044;font-weight:400">1</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;filecnt=filecnt+<span style="color:#ff0044;font-weight:400">1</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;totalptr=<span style="color:#ff0044;font-weight:400">0</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"Starting&nbsp;compare&nbsp;operation,&nbsp;please&nbsp;wait..."</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.updateLog()<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">for</span>&nbsp;thisLine&nbsp;<span style="color:#ff9d00;font-weight:700">in</span>&nbsp;refcontent:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;refpointer=<span style="color:#3ad900;font-weight:400">""</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pointerfound=<span style="color:#ff0044;font-weight:400">1</span>&nbsp;&nbsp;<span style="color:#0088ff;font-weight:400">#pointer&nbsp;is&nbsp;in&nbsp;source&nbsp;file&nbsp;for&nbsp;sure</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#0088ff;font-weight:400">#is&nbsp;this&nbsp;a&nbsp;pointer&nbsp;line&nbsp;?</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;thisLine.lower().find(<span style="color:#3ad900;font-weight:400">"at&nbsp;0x"</span>)&nbsp;&gt;&nbsp;-<span style="color:#ff0044;font-weight:400">1</span>&nbsp;<span style="color:#ff9d00;font-weight:700">or</span>&nbsp;thisLine.lower().find(<span style="color:#3ad900;font-weight:400">"0x"</span>)&nbsp;==&nbsp;<span style="color:#ff0044;font-weight:400">0</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#0088ff;font-weight:400">#yes,&nbsp;get&nbsp;pointer</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pointerraw=[]<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;thisLine.lower().find(<span style="color:#3ad900;font-weight:400">"at&nbsp;0x"</span>)&nbsp;&gt;&nbsp;-<span style="color:#ff0044;font-weight:400">1</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pointerraw=thisLine.split(<span style="color:#3ad900;font-weight:400">"&nbsp;at&nbsp;"</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;thisLine.lower().find(<span style="color:#3ad900;font-weight:400">"0x"</span>)&nbsp;==&nbsp;<span style="color:#ff0044;font-weight:400">0</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pointerraw.append(<span style="color:#3ad900;font-weight:400">""</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pointerraw.append(thisLine)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;<span style="color:#ff9d00;font-weight:700">len</span>(pointerraw)&nbsp;&gt;&nbsp;<span style="color:#ff0044;font-weight:400">1</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;totalptr=totalptr+<span style="color:#ff0044;font-weight:400">1</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ptrparts=pointerraw[<span style="color:#ff0044;font-weight:400">1</span>].split(<span style="color:#3ad900;font-weight:400">"&nbsp;"</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;refpointer&nbsp;=&nbsp;ptrparts[<span style="color:#ff0044;font-weight:400">0</span>].strip().lower()<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#0088ff;font-weight:400">#try&nbsp;to&nbsp;find&nbsp;pointer&nbsp;in&nbsp;array&nbsp;of&nbsp;files</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;filecnt=<span style="color:#ff0044;font-weight:400">0</span>&nbsp;&nbsp;<span style="color:#0088ff;font-weight:400">#0&nbsp;is&nbsp;actually&nbsp;the&nbsp;second&nbsp;file</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">while</span>&nbsp;filecnt&nbsp;&lt;&nbsp;<span style="color:#ff9d00;font-weight:700">len</span>(allfiles)-<span style="color:#ff0044;font-weight:400">1</span>&nbsp;:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;foundinfile=<span style="color:#ff0044;font-weight:400">0</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">for</span>&nbsp;srcLine&nbsp;<span style="color:#ff9d00;font-weight:700">in</span>&nbsp;targetfiles[filecnt]:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;srcLine.lower().find(refpointer)&nbsp;&gt;&nbsp;-<span style="color:#ff0044;font-weight:400">1</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;foundinfile=<span style="color:#ff0044;font-weight:400">1</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pointerfound=pointerfound+foundinfile<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;filecnt=filecnt+<span style="color:#ff0044;font-weight:400">1</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#0088ff;font-weight:400">#search&nbsp;done</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;pointerfound&nbsp;==&nbsp;<span style="color:#ff9d00;font-weight:700">len</span>(allfiles):<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;-&gt;&nbsp;Pointer&nbsp;%s&nbsp;found&nbsp;in&nbsp;%d&nbsp;files"</span>&nbsp;%&nbsp;(refpointer,pointerfound))<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tofile(refpointer&nbsp;+&nbsp;<span style="color:#3ad900;font-weight:400">"&nbsp;::&nbsp;"</span>&nbsp;+&nbsp;thisLine.replace(<span style="color:#3ad900;font-weight:400">'\n'</span>,<span style="color:#3ad900;font-weight:400">''</span>).replace(<span style="color:#3ad900;font-weight:400">'\r'</span>,<span style="color:#3ad900;font-weight:400">''</span>),filename)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;comppointers=comppointers+<span style="color:#ff0044;font-weight:400">1</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.updateLog()<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"Total&nbsp;number&nbsp;of&nbsp;pointers&nbsp;queried&nbsp;:&nbsp;%d"</span>&nbsp;%&nbsp;totalptr)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"Number&nbsp;of&nbsp;matching&nbsp;pointers&nbsp;found&nbsp;:&nbsp;%d&nbsp;-&nbsp;check&nbsp;filecompare.txt&nbsp;for&nbsp;more&nbsp;info"</span>&nbsp;%&nbsp;comppointers)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">return</span>(<span style="color:#3ad900;font-weight:400">"Operation&nbsp;completed,&nbsp;"</span>&nbsp;+&nbsp;<span style="color:#ff9d00;font-weight:700">str</span>(comppointers)&nbsp;+&nbsp;<span style="color:#3ad900;font-weight:400">"&nbsp;pointers&nbsp;found&nbsp;-&nbsp;check&nbsp;filecompare.txt"</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">else</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;filesok&nbsp;==&nbsp;<span style="color:#ff0044;font-weight:400">1</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"**&nbsp;Only&nbsp;one&nbsp;file&nbsp;was&nbsp;found.&nbsp;You&nbsp;need&nbsp;at&nbsp;least&nbsp;2&nbsp;files&nbsp;to&nbsp;do&nbsp;a&nbsp;compare"</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">return</span>(<span style="color:#3ad900;font-weight:400">"Only&nbsp;one&nbsp;file&nbsp;found.&nbsp;You&nbsp;need&nbsp;at&nbsp;least&nbsp;2&nbsp;files&nbsp;to&nbsp;do&nbsp;a&nbsp;compare"</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">else</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"**&nbsp;No&nbsp;files&nbsp;could&nbsp;be&nbsp;found,&nbsp;operation&nbsp;aborted"</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">return</span>(<span style="color:#3ad900;font-weight:400">"No&nbsp;files&nbsp;could&nbsp;be&nbsp;found,&nbsp;check&nbsp;input"</span>)<br /><br /><br />&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;(args[<span style="color:#ff0044;font-weight:400">0</span>]&nbsp;==&nbsp;<span style="color:#3ad900;font-weight:400">"dump"</span>):<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dodump(args)<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>(args[<span style="color:#ff0044;font-weight:400">0</span>]&nbsp;==&nbsp;<span style="color:#3ad900;font-weight:400">"retslide"</span>):<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;filename=<span style="color:#3ad900;font-weight:400">"retslide.txt"</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"--------------------------"</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;Searching&nbsp;for&nbsp;ret&nbsp;slides"</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"--------------------------"</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.updateLog()<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;resetfile(filename)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;<span style="color:#ff9d00;font-weight:700">len</span>(g_modules)==<span style="color:#ff0044;font-weight:400">0</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;moduleinfo()<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;opcodej=[]<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ignorefixup=<span style="color:#ff0044;font-weight:400">0</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;maxretval&nbsp;=&nbsp;<span style="color:#ff0044;font-weight:400">32</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cnt=<span style="color:#ff0044;font-weight:400">1</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">while</span>&nbsp;cnt&nbsp;&lt;&nbsp;<span style="color:#ff9d00;font-weight:700">len</span>(args):<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;args[cnt]==<span style="color:#3ad900;font-weight:400">'-r'</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;cnt&nbsp;&lt;&nbsp;(<span style="color:#ff9d00;font-weight:700">len</span>(args)-<span style="color:#ff0044;font-weight:400">1</span>):<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;maxretval=<span style="color:#ff9d00;font-weight:700">int</span>(args[cnt+<span style="color:#ff0044;font-weight:400">1</span>])<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cnt=cnt+<span style="color:#ff0044;font-weight:400">1</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;opcodej.append(<span style="color:#3ad900;font-weight:400">"RET"</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;c1=<span style="color:#ff0044;font-weight:400">2</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">while</span>&nbsp;c1&nbsp;&lt;=&nbsp;maxretval:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;opcodej.append(<span style="color:#3ad900;font-weight:400">"RET&nbsp;"</span>&nbsp;+&nbsp;tohexbyte(c1)+<span style="color:#3ad900;font-weight:400">"\n"</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;c1=c1+<span style="color:#ff0044;font-weight:400">2</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.updateLog()<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;nrslides=<span style="color:#ff0044;font-weight:400">0</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;nrgood=<span style="color:#ff0044;font-weight:400">0</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;addys=[]<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#0088ff;font-weight:400">#get&nbsp;all&nbsp;search&nbsp;results</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;-&nbsp;Searching&nbsp;memory&nbsp;for&nbsp;slides,&nbsp;please&nbsp;wait..."</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;scnt=<span style="color:#ff0044;font-weight:400">1</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;opnr=<span style="color:#ff9d00;font-weight:700">len</span>(opcodej)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">for</span>&nbsp;searchcmd&nbsp;<span style="color:#ff9d00;font-weight:700">in</span>&nbsp;opcodej:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;&nbsp;&nbsp;Search&nbsp;sequence&nbsp;%d&nbsp;/&nbsp;%d"</span>&nbsp;%&nbsp;(scnt,opnr))<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;addys&nbsp;+=&nbsp;imm.searchCommands(searchcmd.strip())<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;scnt=scnt+<span style="color:#ff0044;font-weight:400">1</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.updateLog()<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;-&nbsp;Total&nbsp;number&nbsp;of&nbsp;ret&nbsp;pointers&nbsp;found&nbsp;in&nbsp;memory:&nbsp;%d&nbsp;"</span>&nbsp;%&nbsp;<span style="color:#ff9d00;font-weight:700">len</span>(addys))<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"&nbsp;-&nbsp;Now&nbsp;filtering&nbsp;for&nbsp;pointers&nbsp;that&nbsp;could&nbsp;be&nbsp;used&nbsp;to&nbsp;slide"</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">for</span>&nbsp;ad1&nbsp;<span style="color:#ff9d00;font-weight:700">in</span>&nbsp;addys:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ad1&nbsp;=&nbsp;ad1[<span style="color:#ff0044;font-weight:400">0</span>]<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;hexaddr&nbsp;=&nbsp;tohex(ad1)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;modulename&nbsp;=&nbsp;getmodnamefromptr(ad1)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;b1&nbsp;=&nbsp;hexaddr[<span style="color:#ff0044;font-weight:400">0</span>]&nbsp;+&nbsp;hexaddr[<span style="color:#ff0044;font-weight:400">1</span>]<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;b2&nbsp;=&nbsp;hexaddr[<span style="color:#ff0044;font-weight:400">2</span>]&nbsp;+&nbsp;hexaddr[<span style="color:#ff0044;font-weight:400">3</span>]<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;b3&nbsp;=&nbsp;hexaddr[<span style="color:#ff0044;font-weight:400">4</span>]&nbsp;+&nbsp;hexaddr[<span style="color:#ff0044;font-weight:400">5</span>]<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;b4&nbsp;=&nbsp;hexaddr[<span style="color:#ff0044;font-weight:400">6</span>]&nbsp;+&nbsp;hexaddr[<span style="color:#ff0044;font-weight:400">7</span>]<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;b1&nbsp;==&nbsp;b2&nbsp;<span style="color:#ff9d00;font-weight:700">and</span>&nbsp;b2&nbsp;==&nbsp;b3&nbsp;<span style="color:#ff9d00;font-weight:700">and</span>&nbsp;b3&nbsp;==&nbsp;b4:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"Full&nbsp;ret&nbsp;slide&nbsp;pointer&nbsp;found&nbsp;at&nbsp;0x%s"</span>&nbsp;%&nbsp;hexaddr)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;op&nbsp;=&nbsp;imm.Disasm(&nbsp;ad1&nbsp;)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;opstring=op.getDisasm()<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tofile(<span style="color:#3ad900;font-weight:400">"0x"</span>&nbsp;+&nbsp;hexaddr&nbsp;+&nbsp;<span style="color:#3ad900;font-weight:400">"&nbsp;:&nbsp;FULL&nbsp;-&nbsp;"</span>&nbsp;+&nbsp;opstring&nbsp;+&nbsp;<span style="color:#3ad900;font-weight:400">"&nbsp;["</span>&nbsp;+&nbsp;modulename+<span style="color:#3ad900;font-weight:400">"]"</span>,filename,ad1)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.updateLog()<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;nrslides=nrslides+<span style="color:#ff0044;font-weight:400">1</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;nrgood=nrgood+<span style="color:#ff0044;font-weight:400">1</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">else</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;b1==b2&nbsp;<span style="color:#ff9d00;font-weight:700">and</span>&nbsp;b2==b3&nbsp;<span style="color:#ff9d00;font-weight:700">and</span>&nbsp;addresstoint(b4)&nbsp;&gt;=&nbsp;addresstoint(b3):<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"Close&nbsp;full&nbsp;ret&nbsp;slide&nbsp;pointer&nbsp;found&nbsp;at&nbsp;0x%s"</span>&nbsp;%&nbsp;hexaddr)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;op&nbsp;=&nbsp;imm.Disasm(&nbsp;ad1&nbsp;)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;opstring=op.getDisasm()<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tofile(<span style="color:#3ad900;font-weight:400">"0x"</span>&nbsp;+&nbsp;hexaddr&nbsp;+&nbsp;<span style="color:#3ad900;font-weight:400">"&nbsp;:&nbsp;CLOSE&nbsp;-&nbsp;"</span>&nbsp;+&nbsp;opstring&nbsp;+&nbsp;<span style="color:#3ad900;font-weight:400">"&nbsp;["</span>&nbsp;+&nbsp;modulename+<span style="color:#3ad900;font-weight:400">"]"</span>,filename,ad1)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.updateLog()<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;nrslides=nrslides+<span style="color:#ff0044;font-weight:400">1</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">else</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;b1==b2&nbsp;<span style="color:#ff9d00;font-weight:700">and</span>&nbsp;b3==b4:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"Half&nbsp;ret&nbsp;slide&nbsp;pointer&nbsp;found&nbsp;at&nbsp;0x%s"</span>&nbsp;%&nbsp;hexaddr)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;op&nbsp;=&nbsp;imm.Disasm(&nbsp;ad1&nbsp;)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;opstring=op.getDisasm()<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tofile(<span style="color:#3ad900;font-weight:400">"0x"</span>&nbsp;+&nbsp;hexaddr&nbsp;+&nbsp;<span style="color:#3ad900;font-weight:400">"&nbsp;:&nbsp;HALF&nbsp;-&nbsp;"</span>&nbsp;+&nbsp;opstring&nbsp;+&nbsp;<span style="color:#3ad900;font-weight:400">"&nbsp;["</span>&nbsp;+&nbsp;modulename+<span style="color:#3ad900;font-weight:400">"]"</span>,filename,ad1)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.updateLog()<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;nrslides=nrslides+<span style="color:#ff0044;font-weight:400">1</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imm.log(<span style="color:#3ad900;font-weight:400">"Number&nbsp;of&nbsp;slide&nbsp;pointers&nbsp;found&nbsp;:&nbsp;%d&nbsp;(out&nbsp;of&nbsp;which&nbsp;%d&nbsp;are&nbsp;full&nbsp;slides)"</span>&nbsp;%&nbsp;(nrslides,nrgood))<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">return</span>&nbsp;<span style="color:#3ad900;font-weight:400">"Done"</span><br /></div></div></div></body></html>