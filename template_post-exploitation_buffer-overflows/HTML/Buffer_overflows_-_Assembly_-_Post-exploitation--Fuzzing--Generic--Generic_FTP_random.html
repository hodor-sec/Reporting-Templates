<!doctype html><html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>Generic FTP random</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles3.css" type="text/css" />
  
    <script type="text/javascript">
        function in_frame () { try { return window.self !== window.top; } catch (e) { return true; } }
        if (!in_frame()) {
            var page = location.pathname.substring(location.pathname.lastIndexOf("/") + 1);
            window.location = 'index.html#' + page;
        }
    </script>
</head>
<body><div class="page"><h1 class="title">Generic FTP random</h1><br/><div class="codebox"><div class="codebox"><span style="color:#0088ff;font-weight:400">#!/usr/bin/env&nbsp;python</span><br /><span style="color:#333333;font-weight:400">import</span>&nbsp;sys,&nbsp;socket,&nbsp;struct,&nbsp;random,&nbsp;string,&nbsp;time<br />&nbsp;<br /><span style="color:#ff9d00;font-weight:700">if</span>&nbsp;<span style="color:#ff9d00;font-weight:700">len</span>(sys.argv)&nbsp;&lt;=&nbsp;<span style="color:#ff0044;font-weight:400">2</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">print</span>&nbsp;<span style="color:#3ad900;font-weight:400">"Usage:&nbsp;python&nbsp;"</span>&nbsp;+&nbsp;sys.argv[<span style="color:#ff0044;font-weight:400">0</span>]&nbsp;+&nbsp;<span style="color:#3ad900;font-weight:400">"&nbsp;[host]&nbsp;[port]"</span><br />&nbsp;&nbsp;&nbsp;&nbsp;exit()<br /><br /><span style="color:#ff9d00;font-weight:700">def</span>&nbsp;random_string(str_size,&nbsp;allowed_chars):<br />&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">return</span>&nbsp;<span style="color:#3ad900;font-weight:400">''</span>.join(random.choice(allowed_chars)&nbsp;<span style="color:#ff9d00;font-weight:700">for</span>&nbsp;x&nbsp;<span style="color:#ff9d00;font-weight:700">in</span>&nbsp;<span style="color:#ff9d00;font-weight:700">range</span>(str_size))<br /><br />host&nbsp;=&nbsp;sys.argv[<span style="color:#ff0044;font-weight:400">1</span>]&nbsp;&nbsp;&nbsp;&nbsp;<br />port&nbsp;=&nbsp;<span style="color:#ff9d00;font-weight:700">int</span>(sys.argv[<span style="color:#ff0044;font-weight:400">2</span>])<br /><br />maxlength&nbsp;=&nbsp;<span style="color:#ff0044;font-weight:400">20000</span><br />mess_size&nbsp;=&nbsp;<span style="color:#ff0044;font-weight:400">0</span><br />increment&nbsp;=&nbsp;<span style="color:#ff0044;font-weight:400">1000</span><br /><br />chars&nbsp;=&nbsp;string.ascii_letters&nbsp;+&nbsp;string.punctuation<br /><br />commands&nbsp;=&nbsp;([<span style="color:#3ad900;font-weight:400">'ABORT'</span>,<span style="color:#3ad900;font-weight:400">'ACCT'</span>,<span style="color:#3ad900;font-weight:400">'CCC'</span>,<span style="color:#3ad900;font-weight:400">'CDUP'</span>,<span style="color:#3ad900;font-weight:400">'CWD'</span>,<span style="color:#3ad900;font-weight:400">'DELE'</span>,<span style="color:#3ad900;font-weight:400">'FEAT'</span>,<span style="color:#3ad900;font-weight:400">'HELP'</span>,<span style="color:#3ad900;font-weight:400">'LIST'</span>,<span style="color:#3ad900;font-weight:400">'MDTM'</span>,<span style="color:#3ad900;font-weight:400">'MKD'</span>,<span style="color:#3ad900;font-weight:400">'MODE'</span>,<span style="color:#3ad900;font-weight:400">'NOOP'</span>,<span style="color:#3ad900;font-weight:400">'OPTS'</span>,<span style="color:#3ad900;font-weight:400">'PASS'</span>,<span style="color:#3ad900;font-weight:400">'PASV'</span>,<span style="color:#3ad900;font-weight:400">'PORT'</span>,<span style="color:#3ad900;font-weight:400">'PROT'</span>,<span style="color:#3ad900;font-weight:400">'PWD'</span>,<span style="color:#3ad900;font-weight:400">'QUIT'</span>,<span style="color:#3ad900;font-weight:400">'REST'</span>,<span style="color:#3ad900;font-weight:400">'RETR'</span>,<span style="color:#3ad900;font-weight:400">'RMD'</span>,<span style="color:#3ad900;font-weight:400">'RNFR'</span>,<span style="color:#3ad900;font-weight:400">'SIZE'</span>,<span style="color:#3ad900;font-weight:400">'STOR'</span>,<span style="color:#3ad900;font-weight:400">'STRU'</span>,<span style="color:#3ad900;font-weight:400">'TYPE'</span>,<span style="color:#3ad900;font-weight:400">'USER'</span>,<span style="color:#3ad900;font-weight:400">'UTF8'</span>,<span style="color:#3ad900;font-weight:400">'XCRC'</span>])<br /><br /><span style="color:#ff9d00;font-weight:700">print</span>&nbsp;<span style="color:#3ad900;font-weight:400">"[+]&nbsp;Connecting&nbsp;to&nbsp;"</span>&nbsp;+&nbsp;host&nbsp;+&nbsp;<span style="color:#3ad900;font-weight:400">"\n"</span><br /><br /><span style="color:#ff9d00;font-weight:700">for</span>&nbsp;command&nbsp;<span style="color:#ff9d00;font-weight:700">in</span>&nbsp;commands:<br />&nbsp;&nbsp;&nbsp;&nbsp;mess_size&nbsp;=&nbsp;<span style="color:#ff0044;font-weight:400">0</span><br />&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">while</span>&nbsp;(mess_size&nbsp;&lt;&nbsp;maxlength):<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">try</span>:<br />		payload&nbsp;=&nbsp;random_string(mess_size,chars)<br />		<br />		<span style="color:#ff9d00;font-weight:700">print</span>&nbsp;<span style="color:#3ad900;font-weight:400">"\n[+]&nbsp;Fuzzing&nbsp;string:&nbsp;"</span><br />		<span style="color:#ff9d00;font-weight:700">for</span>&nbsp;char&nbsp;<span style="color:#ff9d00;font-weight:700">in</span>&nbsp;payload:<br />		&nbsp;&nbsp;&nbsp;&nbsp;sys.stdout.write(<span style="color:#3ad900;font-weight:400">"\\x%x"</span>&nbsp;%&nbsp;<span style="color:#ff9d00;font-weight:700">ord</span>(char))<br />		<span style="color:#ff9d00;font-weight:700">print</span>&nbsp;<span style="color:#3ad900;font-weight:400">'\n'</span><br />		<span style="color:#ff9d00;font-weight:700">print</span>&nbsp;<span style="color:#3ad900;font-weight:400">"[+]&nbsp;Fuzzing&nbsp;"</span>&nbsp;+&nbsp;command&nbsp;+&nbsp;<span style="color:#3ad900;font-weight:400">"&nbsp;with&nbsp;"</span>&nbsp;+&nbsp;<span style="color:#ff9d00;font-weight:700">str</span>(mess_size)&nbsp;+&nbsp;<span style="color:#3ad900;font-weight:400">"&nbsp;length&nbsp;message..."</span><br />		<br />		req&nbsp;=&nbsp;(<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;command&nbsp;+&nbsp;<span style="color:#3ad900;font-weight:400">"&nbsp;"</span>&nbsp;+&nbsp;payload<br />		)<br />	&nbsp;&nbsp;&nbsp;&nbsp;<br />		s&nbsp;=&nbsp;socket.socket(socket.AF_INET,&nbsp;socket.SOCK_STREAM)<br />		s.settimeout(<span style="color:#ff0044;font-weight:400">2</span>)<br />		s.connect((host,&nbsp;port))<br />		s.recv(<span style="color:#ff0044;font-weight:400">1024</span>)<br />		s.send(<span style="color:#3ad900;font-weight:400">"USER&nbsp;anonymous\r\n"</span>)<br />		s.recv(<span style="color:#ff0044;font-weight:400">1024</span>)<br />		s.send(<span style="color:#3ad900;font-weight:400">"PASS&nbsp;anonymous\r\n"</span>)<br />		s.recv(<span style="color:#ff0044;font-weight:400">1024</span>)<br />		s.send(req)<br />		s.recv(<span style="color:#ff0044;font-weight:400">1024</span>)<br />		s.close()<br /><br />		mess_size&nbsp;+=&nbsp;increment<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">except</span>&nbsp;<span style="color:#7f0044;font-weight:400">Exception</span>,e:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">print</span>&nbsp;<span style="color:#3ad900;font-weight:400">"[!]&nbsp;Error&nbsp;occured:&nbsp;"</span>&nbsp;+&nbsp;<span style="color:#ff9d00;font-weight:700">str</span>(e)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">print</span>&nbsp;<span style="color:#3ad900;font-weight:400">"[*]&nbsp;Crashed&nbsp;occured&nbsp;at&nbsp;buffer&nbsp;length:&nbsp;"</span>&nbsp;+&nbsp;<span style="color:#ff9d00;font-weight:700">str</span>(<span style="color:#ff9d00;font-weight:700">len</span>(payload))<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sys.exit()<br /></div></div></div></body></html>