<!doctype html><html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>CoreFTP / Generic CMD fuzzer</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles3.css" type="text/css" />
  
    <script type="text/javascript">
        function in_frame () { try { return window.self !== window.top; } catch (e) { return true; } }
        if (!in_frame()) {
            var page = location.pathname.substring(location.pathname.lastIndexOf("/") + 1);
            window.location = 'index.html#' + page;
        }
    </script>
</head>
<body><div class="page"><h1 class="title">CoreFTP / Generic CMD fuzzer</h1><br/><div class="codebox"><div class="codebox"><span style="color:#0088ff;font-weight:400">#!/usr/bin/env&nbsp;python</span><br /><span style="color:#0088ff;font-weight:400">#&nbsp;Designed&nbsp;for&nbsp;use&nbsp;with&nbsp;boofuzz&nbsp;v0.0.8</span><br /><span style="color:#333333;font-weight:400">from</span>&nbsp;boofuzz&nbsp;<span style="color:#333333;font-weight:400">import</span>&nbsp;*<br /><span style="color:#333333;font-weight:400">import</span>&nbsp;sys,time<br /><br />host&nbsp;=&nbsp;<span style="color:#3ad900;font-weight:400">'192.168.252.10'</span><br />port&nbsp;=&nbsp;<span style="color:#ff0044;font-weight:400">21</span><br />program&nbsp;=&nbsp;<span style="color:#3ad900;font-weight:400">'csrv.exe'</span><br /><br /><span style="color:#ff9d00;font-weight:700">def</span>&nbsp;banner(sock):<br />&nbsp;&nbsp;&nbsp;&nbsp;sock.recv(<span style="color:#ff0044;font-weight:400">1024</span>)<br /><br /><span style="color:#ff9d00;font-weight:700">def</span>&nbsp;main():<br />&nbsp;&nbsp;&nbsp;&nbsp;start_cmd&nbsp;=&nbsp;[<span style="color:#3ad900;font-weight:400">'C:\\Program&nbsp;Files&nbsp;(x86)\\CoreFTPServer\\'</span>&nbsp;+&nbsp;program]<br />&nbsp;&nbsp;&nbsp;&nbsp;session&nbsp;=&nbsp;Session(<br />&nbsp;&nbsp;&nbsp;&nbsp;	target&nbsp;=&nbsp;Target(<br />	&nbsp;&nbsp;&nbsp;&nbsp;connection&nbsp;=&nbsp;SocketConnection(host,&nbsp;port,&nbsp;proto=<span style="color:#3ad900;font-weight:400">'tcp'</span>),<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;procmon&nbsp;=&nbsp;pedrpc.Client(host,&nbsp;<span style="color:#ff0044;font-weight:400">26002</span>),<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;procmon_options&nbsp;=&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#3ad900;font-weight:400">"proc_name"</span>&nbsp;:&nbsp;program,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#3ad900;font-weight:400">"stop_commands"</span>&nbsp;:&nbsp;[<span style="color:#3ad900;font-weight:400">'net&nbsp;stop&nbsp;"Core&nbsp;FTP&nbsp;Server"'</span>],<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#3ad900;font-weight:400">"start_commands"</span>&nbsp;:&nbsp;[start_cmd],<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;},<br />	),<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;session_filename&nbsp;=&nbsp;<span style="color:#3ad900;font-weight:400">"coresvr.session"</span>,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;check_data_received_each_request&nbsp;=&nbsp;<span style="color:#ff0044;font-weight:400">True</span>,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;receive_data_after_fuzz&nbsp;=&nbsp;<span style="color:#ff0044;font-weight:400">True</span>,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;receive_data_after_each_request&nbsp;=&nbsp;<span style="color:#ff0044;font-weight:400">True</span>,<br />&nbsp;&nbsp;&nbsp;&nbsp;)<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#3ad900;font-weight:400">"""&nbsp;Define&nbsp;data&nbsp;model.&nbsp;"""</span><br />&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#0088ff;font-weight:400">#&nbsp;User</span><br />&nbsp;&nbsp;&nbsp;&nbsp;s_initialize(<span style="color:#3ad900;font-weight:400">"user"</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;s_static(<span style="color:#3ad900;font-weight:400">"USER&nbsp;hodor\r\n"</span>)<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#0088ff;font-weight:400">#&nbsp;Pass</span><br />&nbsp;&nbsp;&nbsp;&nbsp;s_initialize(<span style="color:#3ad900;font-weight:400">"pass"</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;s_static(<span style="color:#3ad900;font-weight:400">"PASS&nbsp;hodorhodor\r\n"</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#0088ff;font-weight:400">#&nbsp;PASV&nbsp;mode</span><br />&nbsp;&nbsp;&nbsp;&nbsp;s_initialize(<span style="color:#3ad900;font-weight:400">'pasv'</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;s_static(<span style="color:#3ad900;font-weight:400">'PASV\r\n'</span>)<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#0088ff;font-weight:400">#&nbsp;FTP&nbsp;CMD's</span><br />&nbsp;&nbsp;&nbsp;&nbsp;s_initialize(<span style="color:#3ad900;font-weight:400">"FTP_CMD"</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#0088ff;font-weight:400">#&nbsp;s_group("commands",&nbsp;values=['CWD','MDTM','MKD','PORT','RETR','RMD','RNFR','RNTO','SIZE','CDUP'])</span><br />&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#0088ff;font-weight:400">#&nbsp;s_group("commands",&nbsp;values=['PBSZ','PORT','PROT','PWD','QUIT','REST','RETR','RMD','RNFR','SIZE','STOR','STRU','TYPE','USER','UTF8','XCRC'])</span><br />&nbsp;&nbsp;&nbsp;&nbsp;s_group(<span style="color:#3ad900;font-weight:400">"commands"</span>,&nbsp;values=[<span style="color:#3ad900;font-weight:400">'ABORT'</span>,<span style="color:#3ad900;font-weight:400">'ACCT'</span>,<span style="color:#3ad900;font-weight:400">'CCC'</span>,<span style="color:#3ad900;font-weight:400">'CDUP'</span>,<span style="color:#3ad900;font-weight:400">'CWD'</span>,<span style="color:#3ad900;font-weight:400">'DELE'</span>,<span style="color:#3ad900;font-weight:400">'FEAT'</span>,<span style="color:#3ad900;font-weight:400">'HELP'</span>,<span style="color:#3ad900;font-weight:400">'LIST'</span>,<span style="color:#3ad900;font-weight:400">'MDTM'</span>,<span style="color:#3ad900;font-weight:400">'MKD'</span>,<span style="color:#3ad900;font-weight:400">'MODE'</span>,<span style="color:#3ad900;font-weight:400">'NOOP'</span>,<span style="color:#3ad900;font-weight:400">'OPTS'</span>,<span style="color:#3ad900;font-weight:400">'PASS'</span>,<span style="color:#3ad900;font-weight:400">'PASV'</span>,<span style="color:#3ad900;font-weight:400">'PBSZ'</span>,<span style="color:#3ad900;font-weight:400">'PORT'</span>,<span style="color:#3ad900;font-weight:400">'PROT'</span>,<span style="color:#3ad900;font-weight:400">'PWD'</span>,<span style="color:#3ad900;font-weight:400">'QUIT'</span>,<span style="color:#3ad900;font-weight:400">'REST'</span>,<span style="color:#3ad900;font-weight:400">'RETR'</span>,<span style="color:#3ad900;font-weight:400">'RMD'</span>,<span style="color:#3ad900;font-weight:400">'RNFR'</span>,<span style="color:#3ad900;font-weight:400">'SIZE'</span>,<span style="color:#3ad900;font-weight:400">'STOR'</span>,<span style="color:#3ad900;font-weight:400">'STRU'</span>,<span style="color:#3ad900;font-weight:400">'TYPE'</span>,<span style="color:#3ad900;font-weight:400">'USER'</span>,<span style="color:#3ad900;font-weight:400">'UTF8'</span>,<span style="color:#3ad900;font-weight:400">'XCRC'</span>])<br />&nbsp;&nbsp;&nbsp;&nbsp;s_block_start(<span style="color:#3ad900;font-weight:400">"CommandBlock"</span>,&nbsp;group=<span style="color:#3ad900;font-weight:400">"commands"</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;s_static(<span style="color:#3ad900;font-weight:400">'&nbsp;'</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;s_string(<span style="color:#3ad900;font-weight:400">'fuzz'</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;s_static(<span style="color:#3ad900;font-weight:400">'\r\n'</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;s_block_end()<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#0088ff;font-weight:400">#&nbsp;Define&nbsp;order&nbsp;to&nbsp;send&nbsp;data</span><br />&nbsp;&nbsp;&nbsp;&nbsp;session.connect(s_get(<span style="color:#3ad900;font-weight:400">"user"</span>))<br />&nbsp;&nbsp;&nbsp;&nbsp;session.connect(s_get(<span style="color:#3ad900;font-weight:400">"user"</span>),&nbsp;s_get(<span style="color:#3ad900;font-weight:400">"pass"</span>))<br />&nbsp;&nbsp;&nbsp;&nbsp;session.connect(s_get(<span style="color:#3ad900;font-weight:400">"pass"</span>),&nbsp;s_get(<span style="color:#3ad900;font-weight:400">"FTP_CMD"</span>))<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#3ad900;font-weight:400">"""&nbsp;grab&nbsp;the&nbsp;banner&nbsp;from&nbsp;the&nbsp;server&nbsp;"""</span><br />&nbsp;&nbsp;&nbsp;&nbsp;session.pre_send&nbsp;=&nbsp;banner<br />&nbsp;&nbsp;&nbsp;&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#3ad900;font-weight:400">"""&nbsp;start&nbsp;fuzzing&nbsp;-&nbsp;define&nbsp;target&nbsp;and&nbsp;data&nbsp;"""</span><br />&nbsp;&nbsp;&nbsp;&nbsp;session.fuzz()<br /><br /><span style="color:#ff9d00;font-weight:700">if</span>&nbsp;<span style="color:#333333;font-weight:400">__name__</span>&nbsp;==&nbsp;<span style="color:#3ad900;font-weight:400">"__main__"</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;main()<br /></div></div></div></body></html>