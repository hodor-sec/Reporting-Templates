<!doctype html><html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>Compile ASM and convert to HEX</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles3.css" type="text/css" />
  
    <script type="text/javascript">
        function in_frame () { try { return window.self !== window.top; } catch (e) { return true; } }
        if (!in_frame()) {
            var page = location.pathname.substring(location.pathname.lastIndexOf("/") + 1);
            window.location = 'index.html#' + page;
        }
    </script>
</head>
<body><div class="page"><h1 class="title">Compile ASM and convert to HEX</h1><br/><strong>Compile</strong><br />$ nasm -f elf msgbox_hodor.asm; ld -m i386pe -o msgbox_hodor msgbox_hodor.o; objdump -M intel -d msgbox_hodor.o<br />msgbox_hodor.asm:66: warning: label alone on a line without a colon might be in error [-w+orphan-labels]<br />msgbox_hodor.asm:69: warning: label alone on a line without a colon might be in error [-w+orphan-labels]<br /><br />msgbox_hodor.o:     file format elf32-i386<br /><br /><br />Disassembly of section .text:<br /><br />00000000 &lt;_start&gt;:<br />   0:	31 d2                	xor    edx,edx<br />   2:	eb 30                	jmp    34 &lt;GetLibrary&gt;<br /><br />00000004 &lt;LibraryReturn&gt;:<br />   4:	59                   	pop    ecx<br />   5:	88 51 0a             	mov    BYTE PTR [ecx+0xa],dl<br />   8:	bb 5c 39 e3 77       	mov    ebx,0x77e3395c<br />   d:	51                   	push   ecx<br />   e:	ff d3                	call   ebx<br />  10:	eb 32                	jmp    44 &lt;FunctionName&gt;<br /><br />00000012 &lt;FunctionReturn&gt;:<br />  12:	59                   	pop    ecx<br />  13:	31 d2                	xor    edx,edx<br />  15:	88 51 0b             	mov    BYTE PTR [ecx+0xb],dl<br />  18:	51                   	push   ecx<br />  19:	50                   	push   eax<br />  1a:	bb d3 33 e3 77       	mov    ebx,0x77e333d3<br />  1f:	ff d3                	call   ebx<br />  21:	eb 32                	jmp    55 &lt;Message&gt;<br /><br />00000023 &lt;MessageReturn&gt;:<br />  23:	59                   	pop    ecx<br />  24:	31 d2                	xor    edx,edx<br />  26:	52                   	push   edx<br />  27:	52                   	push   edx<br />  28:	51                   	push   ecx<br />  29:	51                   	push   ecx<br />  2a:	52                   	push   edx<br />  2b:	ff d0                	call   eax<br /><br />0000002d &lt;ender&gt;:<br />  2d:	b8 4f 21 e3 77       	mov    eax,0x77e3214f<br />  32:	ff d0                	call   eax<br /><br />00000034 &lt;GetLibrary&gt;:<br />  34:	e8 cb ff ff ff       	call   4 &lt;LibraryReturn&gt;<br />  39:	75 73                	jne    ae &lt;Message+0x59&gt;<br />  3b:	65 72 33             	gs jb  71 &lt;Message+0x1c&gt;<br />  3e:	32 2e                	xor    ch,BYTE PTR [esi]<br />  40:	64 6c                	fs ins BYTE PTR es:[edi],dx<br />  42:	6c                   	ins    BYTE PTR es:[edi],dx<br />  43:	4e                   	dec    esi<br /><br />00000044 &lt;FunctionName&gt;:<br />  44:	e8 c9 ff ff ff       	call   12 &lt;FunctionReturn&gt;<br /><br />00000049 &lt;FuncName&gt;:<br />  49:	4d                   	dec    ebp<br />  4a:	65 73 73             	gs jae c0 &lt;Message+0x6b&gt;<br />  4d:	61                   	popa   <br />  4e:	67 65 42             	addr16 gs inc edx<br />  51:	6f                   	outs   dx,DWORD PTR ds:[esi]<br />  52:	78 41                	js     95 &lt;Message+0x40&gt;<br />  54:	4e                   	dec    esi<br /><br />00000055 &lt;Message&gt;:<br />  55:	e8 c9 ff ff ff       	call   23 &lt;MessageReturn&gt;<br />  5a:	48                   	dec    eax<br />  5b:	4f                   	dec    edi<br />  5c:	44                   	inc    esp<br />  5d:	4f                   	dec    edi<br />  5e:	52                   	push   edx<br />  5f:	48                   	dec    eax<br />  60:	4f                   	dec    edi<br />  61:	44                   	inc    esp<br />  62:	4f                   	dec    edi<br />  63:	52                   	push   edx<br />  64:	48                   	dec    eax<br />  65:	4f                   	dec    edi<br />  66:	44                   	inc    esp<br />  67:	4f                   	dec    edi<br />  68:	52                   	push   edx<br /><br /><br /><br /><br /><strong>Convert </strong><br />$ bash convert_bin_sc.sh msgbox_hodor.o<br />"\x31\xd2\xeb\x30\x59\x88\x51\x0a"<br />"\xbb\x5c\x39\xe3\x77\x51\xff\xd3"<br />"\xeb\x32\x59\x31\xd2\x88\x51\x0b"<br />"\x51\x50\xbb\xd3\x33\xe3\x77\xff"<br />"\xd3\xeb\x32\x59\x31\xd2\x52\x52"<br />"\x51\x51\x52\xff\xd0\xb8\x4f\x21"<br />"\xe3\x77\xff\xd0\xe8\xcb\xff\xff"<br />"\xff\x75\x73\x65\x72\x33\x32\x2e"<br />"\x64\x6c\x6c\x4e\xe8\xc9\xff\xff"<br />"\xff\x4d\x65\x73\x73\x61\x67\x65"<br />"\x42\x6f\x78\x41\x4e\xe8\xc9\xff"<br />"\xff\xff\x48\x4f\x44\x4f\x52\x48"<br />"\x4f\x44\x4f\x52\x48\x4f\x44\x4f"<br />"\x52"</div></body></html>