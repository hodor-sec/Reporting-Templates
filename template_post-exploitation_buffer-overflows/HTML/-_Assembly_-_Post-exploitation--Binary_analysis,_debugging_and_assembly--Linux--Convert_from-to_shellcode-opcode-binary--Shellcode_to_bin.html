<!doctype html><html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>Shellcode to bin</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles3.css" type="text/css" />
  
    <script type="text/javascript">
        function in_frame () { try { return window.self !== window.top; } catch (e) { return true; } }
        if (!in_frame()) {
            var page = location.pathname.substring(location.pathname.lastIndexOf("/") + 1);
            window.location = 'index.html#' + page;
        }
    </script>
</head>
<body><div class="page"><h1 class="title">Shellcode to bin</h1><br/>#!/bin/bash<br /><br />INPUT=<br />OUTPUT=<br />TYPE=<br /><br />while getopts ":i:o:t:" OPTIONS<br />do<br />            case $OPTIONS in<br />            i)     INPUT=$OPTARG;;<br />            o)     OUTPUT=$OPTARG;;<br />            t)     TYPE=$OPTARG;;<br />            ?)     printf "Invalid option: -$OPTARG\n" $0<br />                          exit 2;;<br />           esac<br />done<br /><br />INPUT=${INPUT:=NULL}<br />OUTPUT=${OUTPUT:=NULL}<br />TYPE=${TYPE:=NULL}<br /><br />##################<br />#  ~~~ Menu ~~~  #<br />##################<br /><br />if [ $INPUT = NULL ] || [ $OUTPUT = NULL ] || [ $TYPE = NULL ]; then<br /><br />echo "--------------------------------------------------------------------"<br />echo "|                          Bin v1.0 ~ b33f                         |"<br />echo "|                  -Convert you shellcode to *.bin-                |"<br />echo "--------------------------------------------------------------------"<br />echo "| USAGE: ./bin.sh -i [Input File] -o [Output File] -t [B/Z]        |"<br />echo "|                                                                  |"<br />echo "| REQUIRED                                                         |"<br />echo "|         -i  Input (text) file containing the shellcode.          |"<br />echo "|         -o  Output filename without extention (eg: shell).       |"<br />echo "|         -t  Type can be B (regular bin file) or Z (zipped.       |"<br />echo "|             bin file).                                           |"<br />echo "|                                                                  |"<br />echo "| DETAILS                                                          |"<br />echo "|         The input text file should just contain the shellcode.   |"<br />echo "|         If you are using msfpayload (possibly/probably in        |"<br />echo "|         combinatione with msfencode) set the output type to      |"<br />echo "|         c or perl. If you have some shellcode in an exploit      |"<br />echo "|         just copy it to a text file...                           |"<br />echo "--------------------------------------------------------------------"<br /><br />######################<br />#  ~~~ Type = B ~~~  #<br />######################<br />elif [ $TYPE = B ]; then<br /><br />echo "[&gt;] Parsing Input File"<br />cat $INPUT |grep '"' |tr -d " " |tr -d "\n" |sed 's/[\"x.;(){}]//g' &gt;&gt; /tmp/$OUTPUT.txt<br />echo "[&gt;] Pipe output to xxd"<br />xxd -r -p /tmp/$OUTPUT.txt $OUTPUT.bin<br />echo "[&gt;] Clean up"<br />rm /tmp/$OUTPUT.txt<br />echo "[&gt;] Done!!"<br /><br />######################<br />#  ~~~ Type = Z ~~~  #<br />######################<br />elif [ $TYPE = Z ]; then<br /><br />echo "[&gt;] Parsing Input File"<br />cat $INPUT |grep '"' |tr -d " " |tr -d "\n" |sed 's/[\"x.;(){}]//g' &gt;&gt; /tmp/$OUTPUT.txt<br />echo "[&gt;] Pipe output to xxd"<br />xxd -r -p /tmp/$OUTPUT.txt /tmp/$OUTPUT.bin<br />echo "[&gt;] Zipping the *.bin file"<br />zip $OUTPUT.zip /tmp/$OUTPUT.bin &amp;&gt;/dev/null<br />echo "[&gt;] Clean up"<br />rm /tmp/$OUTPUT.bin<br />rm /tmp/$OUTPUT.txt<br />echo "[&gt;] Done!!"<br /><br />fi</div></body></html>