<!doctype html><html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>Code Caves</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles3.css" type="text/css" />
  
    <script type="text/javascript">
        function in_frame () { try { return window.self !== window.top; } catch (e) { return true; } }
        if (!in_frame()) {
            var page = location.pathname.substring(location.pathname.lastIndexOf("/") + 1);
            window.location = 'index.html#' + page;
        }
    </script>
</head>
<body><div class="page"><h1 class="title">Code Caves</h1><br/><strong><h2>Code Caves</h2></strong><br /><a href="https://www.exploit-db.com/docs/english/42061-introduction-to-manual-backdooring.pdf">https://www.exploit-db.com/docs/english/42061-introduction-to-manual-backdooring.pdf</a><br /><br />An excellent article about code caves written by Drew Benton defined code caves as "a redirection of program <br />execution to another location and then returning back to the area where program execution had previously left."<br />In context of backdooring, a code cave is a new or unused dead space where we can put custom code and redirect the execution to it, without breaking the actual executable. <br /><br />Couple of techniques we'll review:<br /><br /><strong>Adding a new section</strong><br />Pros:<br />Lots of space.<br />Cons:<br />Binary size increases, more susceptible to get flagged as malicious.<br />•<br /><strong>Using existing dead space</strong><br />Pros:<br />File size doesn'<br />t change, less susceptible to get flagged as malicious. <br />Cons:<br />Might be very low on space, section permissions might need to change to allow code execution.<br />There are 2 more techniques which this paper doesn't cover:<br />•<br /><strong>Extending last section</strong><br />Pros:<br />Number o<br />f sections doesn't change.<br />Cons:<br />Binary size increases, more susceptible to get flagged as malicious, heavy dependency on the <br />last section. Doesn't perform better than adding a new section.<br />•<br /><strong>Cave jumping</strong><br />Pros:<br />Flexible, can utilize a single or a mix of ex<br />isting techniques. Possibly stealthier.<br />Cons:<br />Tricky to break payload into smaller parts, might require changing permissions on multiple <br />sections.</div></body></html>