<!doctype html><html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>banned_functions.py</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles3.css" type="text/css" />
  
    <script type="text/javascript">
        function in_frame () { try { return window.self !== window.top; } catch (e) { return true; } }
        if (!in_frame()) {
            var page = location.pathname.substring(location.pathname.lastIndexOf("/") + 1);
            window.location = 'index.html#' + page;
        }
    </script>
</head>
<body><div class="page"><h1 class="title">banned_functions.py</h1><br/><div class="codebox"><div class="codebox"><span style="color:#3ad900;font-weight:400">"""<br />Author:&nbsp;Stephen&nbsp;Sims&nbsp;-&nbsp;@Steph3nSims<br />Topic:&nbsp;IDAPython&nbsp;scripting&nbsp;-&nbsp;SANS&nbsp;SEC760&nbsp;-&nbsp;http://www.sans.org/sec760<br />Tested&nbsp;with&nbsp;IDA&nbsp;6.7<br /><br />Style&nbsp;Improvements&nbsp;by:&nbsp;Tim&nbsp;Medin&nbsp;(B33f&nbsp;Supreme)<br /><br />Script&nbsp;to&nbsp;check&nbsp;an&nbsp;PE/COFF&nbsp;or&nbsp;ELF&nbsp;input&nbsp;file&nbsp;to&nbsp;see&nbsp;if&nbsp;it<br />includes&nbsp;banned&nbsp;functions&nbsp;from&nbsp;MS&nbsp;SDL's&nbsp;banned.h&nbsp;module.&nbsp;If&nbsp;it<br />does,&nbsp;it&nbsp;lists&nbsp;them&nbsp;out&nbsp;and&nbsp;sets&nbsp;breakpoints&nbsp;on&nbsp;each&nbsp;call.<br />Some&nbsp;compilers/linker&nbsp;options&nbsp;add&nbsp;an&nbsp;intermediary&nbsp;jmp&nbsp;before<br />reaching&nbsp;IAT&nbsp;thunk.&nbsp;Code&nbsp;compensates&nbsp;for&nbsp;either&nbsp;case.&nbsp;If&nbsp;you<br />run&nbsp;the&nbsp;script&nbsp;a&nbsp;second&nbsp;time,&nbsp;it&nbsp;will&nbsp;disable&nbsp;the&nbsp;setting&nbsp;of<br />all&nbsp;breakpoints&nbsp;it&nbsp;set&nbsp;on&nbsp;the&nbsp;first&nbsp;run.<br /><br />I&nbsp;have&nbsp;run&nbsp;this&nbsp;against&nbsp;quite&nbsp;a&nbsp;few&nbsp;programs<br />and&nbsp;fixed&nbsp;a&nbsp;few&nbsp;bugs,&nbsp;and&nbsp;have&nbsp;had<br />no&nbsp;further&nbsp;issues.&nbsp;If&nbsp;the&nbsp;script&nbsp;crashes,&nbsp;send&nbsp;me&nbsp;back&nbsp;the<br />output&nbsp;to&nbsp;stephen@deadlisting.com&nbsp;and&nbsp;I&nbsp;will&nbsp;try&nbsp;to&nbsp;fix.&nbsp;<br />Global&nbsp;flags&nbsp;are&nbsp;used&nbsp;to&nbsp;deal&nbsp;with&nbsp;issues<br />around&nbsp;the&nbsp;different&nbsp;ways&nbsp;in&nbsp;which&nbsp;the&nbsp;IAT&nbsp;is&nbsp;hit,&nbsp;as&nbsp;well&nbsp;as<br />xref&nbsp;types.<br /><br />e.g.&nbsp;Running&nbsp;against&nbsp;Microsoft's&nbsp;IE11&nbsp;64-bit&nbsp;MSHTML.DLL&nbsp;from&nbsp;MS14-080.<br /><br />Running&nbsp;banned_functions.py&nbsp;-&nbsp;One&nbsp;moment...<br /><br />Found&nbsp;function&nbsp;StrCpyNW&nbsp;in&nbsp;IAT&nbsp;at&nbsp;0x18169cd88<br />***&nbsp;calls&nbsp;to&nbsp;StrCpyNW&nbsp;***<br />=&gt;&nbsp;0x180810274&nbsp;-&nbsp;Added&nbsp;BP<br />=&gt;&nbsp;0x1812f10ce&nbsp;-&nbsp;Added&nbsp;BP<br />=&gt;&nbsp;0x1812f1fd1&nbsp;-&nbsp;Added&nbsp;BP<br /><br />=&gt;&nbsp;This&nbsp;program&nbsp;calls&nbsp;direct&nbsp;to&nbsp;IAT.<br />=&gt;&nbsp;The&nbsp;following&nbsp;banned&nbsp;functions&nbsp;were&nbsp;found:<br /><br />=&gt;&nbsp;StrCpyNW<br /><br />Finished!&nbsp;Breakpoints&nbsp;added.&nbsp;Run&nbsp;again&nbsp;to&nbsp;delete.<br />"""</span><br /><span style="color:#333333;font-weight:400">import</span>&nbsp;idaapi,&nbsp;idc,&nbsp;idautils<br /><br />checked&nbsp;=&nbsp;[]<br />bpflag&nbsp;=&nbsp;<span style="color:#ff0044;font-weight:400">0</span><br />codeflag&nbsp;=&nbsp;<span style="color:#ff0044;font-weight:400">0</span><br /><br /><span style="color:#0088ff;font-weight:400">#&nbsp;Microsoft&nbsp;SDL&nbsp;banned.h&nbsp;list.&nbsp;Feel&nbsp;free&nbsp;to&nbsp;add/remove&nbsp;names.</span><br />bannedList&nbsp;=&nbsp;([<span style="color:#3ad900;font-weight:400">"strcpy"</span>,&nbsp;<span style="color:#3ad900;font-weight:400">"strcpyA"</span>,&nbsp;<span style="color:#3ad900;font-weight:400">"strcpyW"</span>,&nbsp;<span style="color:#3ad900;font-weight:400">"wcscpy"</span>,&nbsp;<span style="color:#3ad900;font-weight:400">"_tcscpy"</span>,&nbsp;<span style="color:#3ad900;font-weight:400">"_mbscpy"</span>,&nbsp;<span style="color:#3ad900;font-weight:400">"StrCpy"</span>,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#3ad900;font-weight:400">"StrCpyA"</span>,&nbsp;<span style="color:#3ad900;font-weight:400">"StrCpyW"</span>,&nbsp;<span style="color:#3ad900;font-weight:400">"lstrcpy"</span>,&nbsp;<span style="color:#3ad900;font-weight:400">"lstrcpyA"</span>,&nbsp;<span style="color:#3ad900;font-weight:400">"lstrcpyW"</span>,&nbsp;<span style="color:#3ad900;font-weight:400">"_tccpy"</span>,&nbsp;<span style="color:#3ad900;font-weight:400">"_mbccpy"</span>,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#3ad900;font-weight:400">"_ftcscpy"</span>,&nbsp;<span style="color:#3ad900;font-weight:400">"strcat"</span>,&nbsp;<span style="color:#3ad900;font-weight:400">"strcatA"</span>,&nbsp;<span style="color:#3ad900;font-weight:400">"strcatW"</span>,&nbsp;<span style="color:#3ad900;font-weight:400">"wcscat"</span>,&nbsp;<span style="color:#3ad900;font-weight:400">"_tcscat"</span>,&nbsp;<span style="color:#3ad900;font-weight:400">"_mbscat"</span>,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#3ad900;font-weight:400">"StrCat"</span>,&nbsp;<span style="color:#3ad900;font-weight:400">"StrCatA"</span>,&nbsp;<span style="color:#3ad900;font-weight:400">"StrCatW"</span>,&nbsp;<span style="color:#3ad900;font-weight:400">"lstrcat"</span>,&nbsp;<span style="color:#3ad900;font-weight:400">"lstrcatA"</span>,&nbsp;<span style="color:#3ad900;font-weight:400">"lstrcatW"</span>,&nbsp;<span style="color:#3ad900;font-weight:400">"StrCatBuff"</span>,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#3ad900;font-weight:400">"StrCatBuffA"</span>,&nbsp;<span style="color:#3ad900;font-weight:400">"StrCatBuffW"</span>,&nbsp;<span style="color:#3ad900;font-weight:400">"StrCatChainW"</span>,&nbsp;<span style="color:#3ad900;font-weight:400">"_tccat"</span>,&nbsp;<span style="color:#3ad900;font-weight:400">"_mbccat"</span>,&nbsp;<span style="color:#3ad900;font-weight:400">"_ftcscat"</span>,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#3ad900;font-weight:400">"sprintfW"</span>,&nbsp;<span style="color:#3ad900;font-weight:400">"sprintfA"</span>,&nbsp;<span style="color:#3ad900;font-weight:400">"wsprintf"</span>,&nbsp;<span style="color:#3ad900;font-weight:400">"wsprintfW"</span>,&nbsp;<span style="color:#3ad900;font-weight:400">"wsprintfA"</span>,&nbsp;<span style="color:#3ad900;font-weight:400">"sprintf"</span>,&nbsp;<span style="color:#3ad900;font-weight:400">"swprintf"</span>,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#3ad900;font-weight:400">"_stprintf"</span>,&nbsp;<span style="color:#3ad900;font-weight:400">"wvsprintf"</span>,&nbsp;<span style="color:#3ad900;font-weight:400">"wvsprintfA"</span>,&nbsp;<span style="color:#3ad900;font-weight:400">"wvsprintfW"</span>,&nbsp;<span style="color:#3ad900;font-weight:400">"vsprintf"</span>,&nbsp;<span style="color:#3ad900;font-weight:400">"_vstprintf"</span>,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#3ad900;font-weight:400">"vswprintf"</span>,&nbsp;<span style="color:#3ad900;font-weight:400">"strncpy"</span>,&nbsp;<span style="color:#3ad900;font-weight:400">"wcsncpy"</span>,&nbsp;<span style="color:#3ad900;font-weight:400">"_tcsncpy"</span>,&nbsp;<span style="color:#3ad900;font-weight:400">"_mbsncpy"</span>,&nbsp;<span style="color:#3ad900;font-weight:400">"_mbsnbcpy"</span>,&nbsp;<span style="color:#3ad900;font-weight:400">"StrCpyN"</span>,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#3ad900;font-weight:400">"StrCpyNA"</span>,&nbsp;<span style="color:#3ad900;font-weight:400">"StrCpyNW"</span>,&nbsp;<span style="color:#3ad900;font-weight:400">"StrNCpy"</span>,&nbsp;<span style="color:#3ad900;font-weight:400">"strcpynA"</span>,&nbsp;<span style="color:#3ad900;font-weight:400">"StrNCpyA"</span>,&nbsp;<span style="color:#3ad900;font-weight:400">"StrNCpyW"</span>,&nbsp;<span style="color:#3ad900;font-weight:400">"lstrcpyn"</span>,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#3ad900;font-weight:400">"lstrcpynA"</span>,&nbsp;<span style="color:#3ad900;font-weight:400">"lstrcpynW"</span>,&nbsp;<span style="color:#3ad900;font-weight:400">"strncat"</span>,&nbsp;<span style="color:#3ad900;font-weight:400">"wcsncat"</span>,&nbsp;<span style="color:#3ad900;font-weight:400">"_tcsncat"</span>,&nbsp;<span style="color:#3ad900;font-weight:400">"_mbsncat"</span>,&nbsp;<span style="color:#3ad900;font-weight:400">"_mbsnbcat"</span>,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#3ad900;font-weight:400">"StrCatN"</span>,&nbsp;<span style="color:#3ad900;font-weight:400">"StrCatNA"</span>,&nbsp;<span style="color:#3ad900;font-weight:400">"StrCatNW"</span>,&nbsp;<span style="color:#3ad900;font-weight:400">"StrNCat"</span>,&nbsp;<span style="color:#3ad900;font-weight:400">"StrNCatA"</span>,&nbsp;<span style="color:#3ad900;font-weight:400">"StrNCatW"</span>,&nbsp;<span style="color:#3ad900;font-weight:400">"lstrncat"</span>,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#3ad900;font-weight:400">"lstrcatnA"</span>,&nbsp;<span style="color:#3ad900;font-weight:400">"lstrcatnW"</span>,&nbsp;<span style="color:#3ad900;font-weight:400">"lstrcatn"</span>,&nbsp;<span style="color:#3ad900;font-weight:400">"gets"</span>,&nbsp;<span style="color:#3ad900;font-weight:400">"_getts"</span>,&nbsp;<span style="color:#3ad900;font-weight:400">"_gettws"</span>,&nbsp;<span style="color:#3ad900;font-weight:400">"IsBadWritePtr"</span>,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#3ad900;font-weight:400">"IsBadHugeWritePtr"</span>,&nbsp;<span style="color:#3ad900;font-weight:400">"IsBadReadPtr"</span>,&nbsp;<span style="color:#3ad900;font-weight:400">"IsBadHugeReadPtr"</span>,&nbsp;<span style="color:#3ad900;font-weight:400">"IsBadCodePtr"</span>,&nbsp;<span style="color:#3ad900;font-weight:400">"IsBadStringPtr"</span>])<br /><br /><br /><span style="color:#ff9d00;font-weight:700">def</span>&nbsp;iatCallback(addr,&nbsp;name,&nbsp;<span style="color:#ff9d00;font-weight:700">ord</span>):&nbsp;&nbsp;&nbsp;<span style="color:#0088ff;font-weight:400">#&nbsp;Don't&nbsp;care&nbsp;about&nbsp;ord,&nbsp;but&nbsp;required&nbsp;for&nbsp;enum_import_names</span><br />&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">global</span>&nbsp;bpflag,&nbsp;codeflag,&nbsp;checked,&nbsp;bannedList&nbsp;&nbsp;<span style="color:#0088ff;font-weight:400">#&nbsp;Function&nbsp;got&nbsp;a&nbsp;bit&nbsp;out&nbsp;of&nbsp;hand.&nbsp;Sorry.</span><br /><br />&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;name&nbsp;<span style="color:#ff9d00;font-weight:700">in</span>&nbsp;bannedList&nbsp;<span style="color:#ff9d00;font-weight:700">and</span>&nbsp;name&nbsp;<span style="color:#ff9d00;font-weight:700">not</span>&nbsp;<span style="color:#ff9d00;font-weight:700">in</span>&nbsp;checked:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;checked.append(name)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;loopflag&nbsp;=&nbsp;<span style="color:#ff0044;font-weight:400">0</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;xref&nbsp;=&nbsp;XrefsTo(addr,&nbsp;<span style="color:#ff0044;font-weight:400">0</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">for</span>&nbsp;checkXrefType&nbsp;<span style="color:#ff9d00;font-weight:700">in</span>&nbsp;xref:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;XrefTypeName(checkXrefType.type)&nbsp;==&nbsp;<span style="color:#3ad900;font-weight:400">"Code_Near_Call"</span>&nbsp;<span style="color:#ff9d00;font-weight:700">and</span>&nbsp;loopflag&nbsp;!=&nbsp;<span style="color:#ff0044;font-weight:400">1</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">print</span>&nbsp;<span style="color:#3ad900;font-weight:400">"\nFound&nbsp;function&nbsp;%s&nbsp;in&nbsp;IAT&nbsp;at&nbsp;0x%08x"</span>&nbsp;%&nbsp;(name,&nbsp;addr)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">print</span>&nbsp;<span style="color:#3ad900;font-weight:400">"***&nbsp;calls&nbsp;to&nbsp;%s&nbsp;***"</span>&nbsp;%&nbsp;name<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;loopflag&nbsp;=&nbsp;<span style="color:#ff0044;font-weight:400">1</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;codeflag&nbsp;=&nbsp;<span style="color:#ff0044;font-weight:400">1</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;xref&nbsp;=&nbsp;CodeRefsTo(addr,&nbsp;<span style="color:#ff0044;font-weight:400">1</span>)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#0088ff;font-weight:400">#&nbsp;Ref&nbsp;to&nbsp;IAT&nbsp;should&nbsp;be&nbsp;of&nbsp;type&nbsp;code.</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">for</span>&nbsp;lines&nbsp;<span style="color:#ff9d00;font-weight:700">in</span>&nbsp;xref:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;CheckBpt(lines)&nbsp;&gt;&nbsp;<span style="color:#ff0044;font-weight:400">0</span>:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#0088ff;font-weight:400">#&nbsp;Adding&nbsp;or&nbsp;deleting&nbsp;BP's</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;idaapi.del_bpt(lines)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">print</span>&nbsp;<span style="color:#3ad900;font-weight:400">"=&gt;&nbsp;0x%08x&nbsp;-&nbsp;Deleted&nbsp;BP"</span>&nbsp;%&nbsp;lines<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">else</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;idaapi.add_bpt(lines,&nbsp;<span style="color:#ff0044;font-weight:400">0</span>,&nbsp;BPT_SOFT)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EnableBpt(lines,&nbsp;<span style="color:#ff0044;font-weight:400">True</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;checked.append(lines)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">print</span>&nbsp;<span style="color:#3ad900;font-weight:400">"=&gt;&nbsp;0x%08x&nbsp;-&nbsp;Added&nbsp;BP"</span>&nbsp;%&nbsp;lines<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;bpflag&nbsp;=&nbsp;<span style="color:#ff0044;font-weight:400">1</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">elif</span>&nbsp;XrefTypeName(checkXrefType.type)&nbsp;==&nbsp;<span style="color:#3ad900;font-weight:400">"Data_Read"</span>&nbsp;<span style="color:#ff9d00;font-weight:700">and</span>&nbsp;codeflag&nbsp;==&nbsp;<span style="color:#ff0044;font-weight:400">0</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">print</span>&nbsp;<span style="color:#3ad900;font-weight:400">"\nFound&nbsp;function&nbsp;%s&nbsp;in&nbsp;IAT&nbsp;at&nbsp;0x%08x"</span>&nbsp;%&nbsp;(name,&nbsp;addr)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">print</span>&nbsp;<span style="color:#3ad900;font-weight:400">"***&nbsp;calls&nbsp;to&nbsp;%s&nbsp;***"</span>&nbsp;%&nbsp;name<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;xref&nbsp;=&nbsp;DataRefsTo(addr)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#0088ff;font-weight:400">#&nbsp;Ref&nbsp;to&nbsp;IAT&nbsp;should&nbsp;be&nbsp;of&nbsp;type&nbsp;data.</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">for</span>&nbsp;line&nbsp;<span style="color:#ff9d00;font-weight:700">in</span>&nbsp;xref:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;xref2&nbsp;=&nbsp;CodeRefsTo(line,&nbsp;<span style="color:#ff0044;font-weight:400">1</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">for</span>&nbsp;lines&nbsp;<span style="color:#ff9d00;font-weight:700">in</span>&nbsp;xref2:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;CheckBpt(lines)&nbsp;&gt;&nbsp;<span style="color:#ff0044;font-weight:400">0</span>:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#0088ff;font-weight:400">#&nbsp;Adding&nbsp;or&nbsp;deleting&nbsp;BP's</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;idaapi.del_bpt(lines)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">print</span>&nbsp;<span style="color:#3ad900;font-weight:400">"=&gt;&nbsp;0x%08x&nbsp;-&nbsp;Deleted&nbsp;BP"</span>&nbsp;%&nbsp;lines<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">else</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;idaapi.add_bpt(lines,&nbsp;<span style="color:#ff0044;font-weight:400">0</span>,&nbsp;BPT_SOFT)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EnableBpt(lines,&nbsp;<span style="color:#ff0044;font-weight:400">True</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;checked.append(lines)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">print</span>&nbsp;<span style="color:#3ad900;font-weight:400">"=&gt;&nbsp;0x%08x&nbsp;-&nbsp;Added&nbsp;BP"</span>&nbsp;%&nbsp;lines<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;bpflag&nbsp;=&nbsp;<span style="color:#ff0044;font-weight:400">1</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">elif</span>&nbsp;XrefTypeName(checkXrefType.type)&nbsp;==&nbsp;<span style="color:#3ad900;font-weight:400">"Code_Near_Jump"</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOT&nbsp;=&nbsp;DataRefsTo(addr)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">for</span>&nbsp;line&nbsp;<span style="color:#ff9d00;font-weight:700">in</span>&nbsp;GOT:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">print</span>&nbsp;<span style="color:#3ad900;font-weight:400">"\n&nbsp;Found&nbsp;function&nbsp;%s&nbsp;in&nbsp;GOT&nbsp;at&nbsp;0x%08x"</span>&nbsp;%&nbsp;(name,&nbsp;line)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">print</span>&nbsp;<span style="color:#3ad900;font-weight:400">"***&nbsp;calls&nbsp;to&nbsp;%s&nbsp;***"</span>&nbsp;%&nbsp;name<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;codeflag&nbsp;=&nbsp;<span style="color:#ff0044;font-weight:400">2</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;xref&nbsp;=&nbsp;CodeRefsTo(addr,&nbsp;<span style="color:#ff0044;font-weight:400">1</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">for</span>&nbsp;line&nbsp;<span style="color:#ff9d00;font-weight:700">in</span>&nbsp;xref:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;xref2&nbsp;=&nbsp;CodeRefsTo(line,&nbsp;<span style="color:#ff0044;font-weight:400">1</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">for</span>&nbsp;lines&nbsp;<span style="color:#ff9d00;font-weight:700">in</span>&nbsp;xref2:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;CheckBpt(lines)&nbsp;&gt;&nbsp;<span style="color:#ff0044;font-weight:400">0</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;idaapi.del_bpt(lines)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">print</span>&nbsp;<span style="color:#3ad900;font-weight:400">"=&gt;&nbsp;0x%08x&nbsp;-&nbsp;Deleted&nbsp;BP"</span>&nbsp;%&nbsp;lines<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">else</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;idaapi.add_bpt(lines,&nbsp;<span style="color:#ff0044;font-weight:400">0</span>,&nbsp;BPT_SOFT)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EnableBpt(lines,&nbsp;<span style="color:#ff0044;font-weight:400">True</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;checked.append(lines)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">print</span>&nbsp;<span style="color:#3ad900;font-weight:400">"=&gt;&nbsp;0x%08x&nbsp;=&nbsp;Added&nbsp;BP"</span>&nbsp;%&nbsp;lines<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;bpflag&nbsp;=&nbsp;<span style="color:#ff0044;font-weight:400">1</span>							<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#0088ff;font-weight:400">#elif&nbsp;loopflag&nbsp;!=&nbsp;1:</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#0088ff;font-weight:400">#&nbsp;&nbsp;&nbsp;&nbsp;codeflag&nbsp;=&nbsp;2</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#0088ff;font-weight:400">#	&nbsp;&nbsp;&nbsp;&nbsp;break</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">else</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">continue</span>&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#0088ff;font-weight:400">#Need&nbsp;to&nbsp;compensate&nbsp;for&nbsp;other&nbsp;xref&nbsp;types.</span><br /><br />&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">return</span>&nbsp;<span style="color:#ff0044;font-weight:400">True</span>				<span style="color:#0088ff;font-weight:400">#Has&nbsp;to&nbsp;be&nbsp;here&nbsp;for&nbsp;the&nbsp;callback.&nbsp;</span><br /><br /><span style="color:#ff9d00;font-weight:700">def</span>&nbsp;ToggleBreakpoints():<br />&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">global</span>&nbsp;bpflag,&nbsp;codeflag,&nbsp;checked,&nbsp;bannedList&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">print</span>&nbsp;<span style="color:#3ad900;font-weight:400">"\nRunning&nbsp;banned_functions.py&nbsp;-&nbsp;One&nbsp;moment..."</span><br /><br />&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">for</span>&nbsp;i&nbsp;<span style="color:#ff9d00;font-weight:700">in</span>&nbsp;<span style="color:#ff9d00;font-weight:700">xrange</span>(<span style="color:#ff0044;font-weight:400">0</span>,&nbsp;idaapi.get_import_module_qty()):<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;name&nbsp;=&nbsp;idaapi.get_import_module_name(i)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;idaapi.enum_import_names(i,&nbsp;iatCallback)<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;codeflag&nbsp;==&nbsp;<span style="color:#ff0044;font-weight:400">0</span>&nbsp;<span style="color:#ff9d00;font-weight:700">and</span>&nbsp;checked&nbsp;!=&nbsp;[]:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">print</span>&nbsp;<span style="color:#3ad900;font-weight:400">"\n=&gt;&nbsp;This&nbsp;PE/COFF&nbsp;program&nbsp;uses&nbsp;an&nbsp;intermediary&nbsp;jmp&nbsp;to&nbsp;IAT."</span><br />&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">elif</span>&nbsp;codeflag&nbsp;==&nbsp;<span style="color:#ff0044;font-weight:400">1</span>&nbsp;<span style="color:#ff9d00;font-weight:700">and</span>&nbsp;checked&nbsp;!=&nbsp;[]:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">print</span>&nbsp;<span style="color:#3ad900;font-weight:400">"\n=&gt;&nbsp;This&nbsp;PE/COFF&nbsp;program&nbsp;calls&nbsp;direct&nbsp;to&nbsp;IAT."</span><br />&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">elif</span>&nbsp;codeflag&nbsp;==&nbsp;<span style="color:#ff0044;font-weight:400">2</span>&nbsp;<span style="color:#ff9d00;font-weight:700">and</span>&nbsp;checked&nbsp;!=&nbsp;[]:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">print</span>&nbsp;<span style="color:#3ad900;font-weight:400">"\n=&gt;&nbsp;Looks&nbsp;like&nbsp;an&nbsp;ELF&nbsp;file.&nbsp;CS&nbsp;=&gt;&nbsp;PLT&nbsp;=&gt;&nbsp;*GOT."</span><br />&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">else</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">print</span>&nbsp;<span style="color:#3ad900;font-weight:400">""</span><br /><br />&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">print</span>&nbsp;<span style="color:#3ad900;font-weight:400">"=&gt;&nbsp;The&nbsp;following&nbsp;banned&nbsp;functions&nbsp;were&nbsp;found:\n&nbsp;"</span><br /><br />&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">for</span>&nbsp;item&nbsp;<span style="color:#ff9d00;font-weight:700">in</span>&nbsp;checked:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;item&nbsp;<span style="color:#ff9d00;font-weight:700">in</span>&nbsp;bannedList:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">print</span>&nbsp;<span style="color:#3ad900;font-weight:400">"=&gt;&nbsp;%s"</span>&nbsp;%&nbsp;item<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;bpflag&nbsp;==&nbsp;<span style="color:#ff0044;font-weight:400">0</span>&nbsp;<span style="color:#ff9d00;font-weight:700">and</span>&nbsp;codeflag&nbsp;==&nbsp;<span style="color:#ff0044;font-weight:400">1</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">print</span>&nbsp;<span style="color:#3ad900;font-weight:400">"\nFinished!&nbsp;Breakpoints&nbsp;deleted.&nbsp;Run&nbsp;again&nbsp;to&nbsp;add."</span><br />&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">elif</span>&nbsp;bpflag&nbsp;==&nbsp;<span style="color:#ff0044;font-weight:400">1</span>&nbsp;<span style="color:#ff9d00;font-weight:700">and</span>&nbsp;codeflag&nbsp;&lt;=&nbsp;<span style="color:#ff0044;font-weight:400">1</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">print</span>&nbsp;<span style="color:#3ad900;font-weight:400">"\nFinished!&nbsp;Breakpoints&nbsp;added.&nbsp;Run&nbsp;again&nbsp;to&nbsp;delete."</span><br />&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">elif</span>&nbsp;bpflag&nbsp;==&nbsp;<span style="color:#ff0044;font-weight:400">0</span>&nbsp;<span style="color:#ff9d00;font-weight:700">and</span>&nbsp;codeflag&nbsp;==&nbsp;<span style="color:#ff0044;font-weight:400">0</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;<span style="color:#ff9d00;font-weight:700">not</span>&nbsp;checked:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">print</span>&nbsp;<span style="color:#3ad900;font-weight:400">"\nNo&nbsp;banned&nbsp;functions&nbsp;found!"</span><br />&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">else</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">print</span>&nbsp;<span style="color:#3ad900;font-weight:400">"\n"</span><br /><br /><span style="color:#ff9d00;font-weight:700">if</span>&nbsp;<span style="color:#333333;font-weight:400">__name__</span>&nbsp;==&nbsp;<span style="color:#3ad900;font-weight:400">'__main__'</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;ToggleBreakpoints()<br /><br /></div></div></div></body></html>